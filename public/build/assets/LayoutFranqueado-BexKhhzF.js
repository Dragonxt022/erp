import{d as _,i as h,j as C,a6 as V,e as d,o,a as e,af as G,c as M,f as P,b as E,w as N,t as $,n as q,u as I,a2 as F,ag as W,s as U,a5 as z,ah as H,q as Z,F as T,h as B,a7 as J,ai as D,k as R,a1 as K,Z as Q,r as X,ae as Y}from"./app-BXAXZzIC.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee=["href"],te=["src"],se={__name:"iconeNotificacao",setup(f){const t=_(null),a=_(null),r=_(!1),k=_(!0),S=h(()=>a.value?`https://alertas.taiksu.com.br/callback?token=${a.value}`:"https://alertas.taiksu.com.br"),y=h(()=>k.value?"https://login.taiksu.com.br/frontend/img/sinale0.png":r.value?"https://login.taiksu.com.br/frontend/img/sino-alerta-com-mensagem.png":"https://login.taiksu.com.br/frontend/img/sinale0.png"),g=async()=>{try{const c=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!c.ok)throw new Error("Erro ao carregar perfil do usuário");const p=await c.json();p.status==="success"&&p.data&&(t.value=p.data.id,a.value=p.data.rh_token||p.data.id,await s())}catch(c){console.error("Erro ao buscar dados do usuário:",c)}finally{k.value=!1}},s=async()=>{if(t.value)try{const c=`https://alertas.taiksu.com.br/api/status/${t.value}`,p=await fetch(c,{method:"GET",headers:{Accept:"application/json"}});if(!p.ok)throw new Error("Erro ao verificar status das notificações");const L=await p.json();r.value=L.status===!0}catch(c){console.error("Erro ao consultar status das notificações:",c),r.value=!1}};let n;return C(async()=>{await g(),n=setInterval(()=>{s()},3e5)}),V(()=>{n&&clearInterval(n)}),(c,p)=>(o(),d("a",{class:"notification-link",href:S.value,target:"_blank",rel:"noopener noreferrer"},[e("img",{src:y.value,alt:"Notificações",class:"notification-icon"},null,8,te)],8,ee))}},ae=A(se,[["__scopeId","data-v-81702bd5"]]),O=G("sidebar",{state:()=>({isOpen:!1}),actions:{toggle(){this.isOpen=!this.isOpen},open(){this.isOpen=!0},close(){this.isOpen=!1}}}),ne={class:"navbar"},oe={class:"navbar-content"},re={class:"navbar-left"},ie={class:"navbar-logo items-center flex flex-row gap-2"},le=["href"],ce={class:"navbar-right"},ue={class:"mr-4"},de={key:0,href:"https://login.taiksu.com.br/perfil",class:"user-info"},ve=["src"],me={class:"user-details"},fe={class:"user-name"},pe={class:"user-location"},he={key:1,class:"user-info loading"},ge={__name:"Navbar",setup(f){const t=O(),a=()=>{t.toggle()},r=_(null),k=h(()=>{var s;return(s=r.value)==null?void 0:s.unidade}),S=h(()=>{var s,n;return((s=r.value)==null?void 0:s.profile_photo_url)||`https://ui-avatars.com/api/?name=${y((n=r.value)==null?void 0:n.name)}&color=7F9CF5&background=EBF4FF`}),y=s=>s?s.split(" ").map(c=>c.charAt(0).toUpperCase()).join(""):"*",g=async()=>{try{const s=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar perfil do usuário");const n=await s.json();r.value=n.data}catch(s){console.error("Erro ao buscar perfil:",s),r.value=null}};return C(()=>{g()}),(s,n)=>(o(),d("div",ne,[n[4]||(n[4]=e("div",{class:"navbar-background"},null,-1)),e("div",oe,[e("div",re,[e("div",ie,[n[1]||(n[1]=e("div",{class:"hide-mobile"},[e("a",{href:"https://login.taiksu.com.br/"},[e("img",{src:"https://login.taiksu.com.br/frontend/img/menu_service.png",alt:"Menu",class:"w-7 h-7"})])],-1)),e("div",null,[e("a",{href:s.route("franqueado.painel")},n[0]||(n[0]=[e("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,le)])])]),e("div",ce,[e("div",ue,[E(ae)]),e("div",{class:"view-mobile"},[e("button",{onClick:a},n[2]||(n[2]=[e("img",{src:"/storage/images/bx-menuv.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),r.value?(o(),M(I(F),{key:0,href:"https://login.taiksu.com.br/perfil",class:q(["user-info hide-mobile",{loading:!r.value}])},{default:N(()=>{var c;return[r.value?(o(),d("a",de,[e("img",{src:S.value,alt:"Avatar",class:"avatar"},null,8,ve),e("div",me,[e("div",fe,$(r.value.name),1),e("div",pe,$(((c=k.value)==null?void 0:c.cidade)||"Taiksu Franchising"),1)])])):(o(),d("div",he,n[3]||(n[3]=[e("div",{class:"avatar-skeleton"},null,-1),e("div",{class:"user-details-skeleton"},[e("div",{class:"name-skeleton"}),e("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["class"])):P("",!0)])])]))}},be=A(ge,[["__scopeId","data-v-5a62d7d0"]]),_e={class:"icon"},ke=["src"],we={class:"label"},Se={type:"submit",class:"w-full h-full flex items-center"},ye={class:"icon"},Le=["src"],xe={class:"label"},Ie={key:2,class:"submenu"},$e={class:"label"},Pe={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(f){const t=f,a=W("openSubmenuLink",_(null)),r=h(()=>a.value===t.link),k=h(()=>r.value),S=h(()=>t.link&&/^https?:\/\//.test(t.link)),y=h(()=>S.value?t.link:t.link?route(t.link):"#"),g=h(()=>!0),s=h(()=>t.submenuItems),n=u=>{s.value.length>0&&(u.preventDefault(),c())},c=()=>{a.value===t.link?a.value=null:a.value=t.link,L()},p=()=>{const u=localStorage.getItem("openSubmenuLink");u!==null&&(a.value=u)},L=()=>{a.value?localStorage.setItem("openSubmenuLink",a.value):localStorage.removeItem("openSubmenuLink")},m=h(()=>i.value||t.isActive?"submenu-active":""),v=u=>{const b=window.location.pathname,x=new URL(route(u),window.location.origin).pathname;return b===x},i=h(()=>s.value.some(u=>v(u.link))),l=()=>{t.isLogout&&J.post(route("logout.sair"))};return p(),U(i,()=>{!i.value&&a.value===t.link&&z(()=>{a.value=null,L()})}),U(a,()=>{z(()=>L())}),(u,b)=>(o(),d("div",null,[!f.isLogout&&f.link&&g.value?(o(),M(H(S.value?"a":I(F)),{key:0,class:q(["menu-item",[m.value,{active:f.isActive||i.value}]]),href:y.value,target:S.value?"_blank":null,onClick:n},{default:N(()=>[e("div",_e,[e("img",{src:f.icon,alt:"icon"},null,8,ke)]),e("div",we,$(f.label),1),s.value.length>0?(o(),d("div",{key:0,class:q(["right-icon",{"rotate-icon":k.value}])},b[0]||(b[0]=[e("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):P("",!0)]),_:1},8,["class","href","target"])):f.isLogout&&g.value?(o(),d("form",{key:1,onSubmit:Z(l,["prevent"]),class:"menu-item"},[e("button",Se,[e("div",ye,[e("img",{src:f.icon,alt:"icon"},null,8,Le)]),e("div",xe,$(f.label),1)])],32)):P("",!0),s.value.length>0&&(r.value||i.value)?(o(),d("div",Ie,[(o(!0),d(T,null,B(s.value,(x,j)=>(o(),d("div",{key:j},[E(I(F),{class:q(["submenu-item",{active:v(x.link)}]),href:u.route(x.link)},{default:N(()=>[e("div",$e,$(x.label),1)]),_:2},1032,["href","class"])]))),128))])):P("",!0)]))}},Ee=A(Pe,[["__scopeId","data-v-53add217"]]),qe={key:0,class:"loader-container"},Ae={key:0,class:"category-title menu-categorias text-sm sm:text-base font-medium text-[#87ba73] mb-3 pl-4"},Ce={__name:"Slidebar",setup(f){const t=_(null),a=_([]),r=O(),k=_(!0),S=_(null),y=_({}),g=_({}),s=async()=>{try{const v=(await R.get("/api/navbar-profile")).data.data;y.value={franqueado:v.franqueado,colaborador:v.colaborador},g.value=v.permissions||{}}catch(m){console.error("Erro ao carregar permissões:",m),y.value={},g.value={}}},n=async()=>{var m;try{const i=((m=(await R.get(`/api/menu?t=${Date.now()}`)).data)==null?void 0:m.data)||[];a.value=i.map(l=>{const w=(l.items||[]).slice().sort((u,b)=>u.order-b.order).map(u=>{const b=u.children?u.children.slice().sort((x,j)=>x.order-j.order):[];return{...u,children:b}});return{...l,items:w}}).sort((l,w)=>l.order-w.order)}catch(v){console.error("[Menu] Erro ao carregar menu:",v),a.value=[]}};D("userPermissions",g),D("openSubmenuLink",S);const c=h(()=>{const{franqueado:m,colaborador:v}=y.value;return a.value.map(i=>{const l=i.items.map(w=>{if(w.required_permission==="dre"&&!(m===!0&&v===!1)||w.required_permission&&g.value[w.required_permission]!==!0)return null;const u=(w.children||[]).filter(b=>b.required_permission?g.value[b.required_permission]===!0:!0);return{...w,children:u}}).filter(Boolean);return{...i,items:l}}).filter(i=>i.items.length>0)});C(async()=>{k.value=!0,await s(),await n();const m=localStorage.getItem("sidebarScrollPosition");m&&t.value&&(t.value.scrollTop=m),k.value=!1});const p=()=>{t.value&&localStorage.setItem("sidebarScrollPosition",t.value.scrollTop)},L=m=>{const v=window.location.pathname,i=new URL(m,window.location.origin).pathname;return v===i||v.startsWith(i)};return(m,v)=>(o(),d("div",null,[k.value?(o(),d("div",qe,v[0]||(v[0]=[e("div",{class:"spinner"},null,-1)]))):(o(),d("div",{key:1,class:q(["sidebar z-50 bg-[#164110] text-white flex flex-col p-3 transition-transform duration-300 ease-in-out","fixed inset-y-0 left-0 transform",I(r).isOpen?"translate-x-0":"-translate-x-full","md:relative md:translate-x-0 md:h-screen md:sticky md:top-0"]),ref_key:"sidebar",ref:t,onScroll:p},[(o(!0),d(T,null,B(c.value,i=>(o(),d("div",{key:i.name,class:"menu-category mb-6"},[i.items.length>0?(o(),d("div",Ae,$(i.name),1)):P("",!0),(o(!0),d(T,null,B(i.items,l=>(o(),M(Ee,{key:l.link||"no-link",label:l.label,icon:l.icon,link:l.link,submenuItems:l.children,isActive:l.link?L(l.link):!1,isLogout:l.isLogout,requiredPermission:l.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],34))]))}},je=A(Ce,[["__scopeId","data-v-2c941bf8"]]),Ne={__name:"LayoutFranqueado",props:{title:String},setup(f){const t=O();function a(){window.innerWidth<768?t.close():t.open()}return C(()=>{window.addEventListener("resize",a),a()}),K(()=>{window.removeEventListener("resize",a)}),(r,k)=>(o(),d("div",null,[E(I(Q),{title:f.title},null,8,["title"]),E(be),E(je),e("main",{class:"content",style:Y({left:I(t).isOpen?"252px":"0",width:I(t).isOpen?"calc(100vw - 250px)":"100vw"})},[X(r.$slots,"default",{},void 0,!0)],4)]))}},Be=A(Ne,[["__scopeId","data-v-d63d761a"]]);export{Be as L};
