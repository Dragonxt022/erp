import{l as se,d as _,i as qe,o as i,e as c,a as e,j as D,s as Fe,F as E,g as O,t as h,b as C,h as w,v as F,w as A,f as U,p as Te,k as Q,y as Ue,q as Se,c as L,R as B,P as Ve,m as Me,u as Ie,Z as Le}from"./app-dVJc_tjc.js";import{_ as ue}from"./LabelModel-BV1tvPkL.js";import{I as Oe}from"./InputModel-BGTjpHhQ.js";import{B as Ne}from"./ButtonPrimary-CoS0bVlF.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as ie}from"./ButtonPrimaryMedio-DE8QcIIu.js";import"./index-DWu0kWy3.js";import{B as Ce}from"./ButtonCancelar-C6t_BeMB.js";import{B as Be}from"./ButtonEditeMedio-DbTHzbe4.js";import{L as Ae}from"./LayoutFranqueado-DFKHMw9m.js";import"./user-B5PrcdWX.js";const Qe={key:0,class:"w-[100%] h-full flex flex-col p-4 bg-gray-50"},Ge={class:"mb-6 relative"},ze={class:"relative"},Ke=["value"],We={class:"w-full bg-white rounded-lg p-6 mb-6"},He={class:"flex items-center"},Je={class:"flex-shrink-0"},Xe=["src"],Ze={class:"ml-6"},Ye={class:"text-2xl font-semibold text-gray-800"},et={key:0,class:"text-red-500 text-sm text-center"},tt={class:"relative flex items-center w-full"},ot={class:"flex justify-end space-x-4"},at={__name:"CadastrarInsumoEstoque",props:{produtoSelecionado:{type:Object,required:!1}},setup(t,{emit:o}){var P;const s=se(),d=o,l=t,g=_([]),p=_(""),v=_(""),x=_(((P=l.produtoSelecionado)==null?void 0:P.valor)||""),u=_(!1);_(!1);const f=_(!1),m=_(""),S=qe(()=>l.produtoSelecionado.unidadeDeMedida==="a_granel"?"Kg":"Quantidade"),I=()=>{if(!v.value.trim()){u.value=!1;return}let q=/^[0-9]+([.,][0-9]+)?$/;if(l.produtoSelecionado.unidadeDeMedida==="unidade"&&(q=/^[0-9]+$/),u.value=!q.test(v.value),["a_granel","quilo"].includes(l.produtoSelecionado.unidadeDeMedida)){let b=v.value.replace(/\D/g,""),T=b.slice(0,-3)||"0",M=b.slice(-3).padStart(3,"0");v.value=`${Number(T).toLocaleString("pt-BR")},${M}`}},a=()=>{const q=x.value.replace(/\D/g,""),b=q.slice(0,-2)||"0",T=q.slice(-2).padStart(2,"0");x.value=`R$ ${Number(b).toLocaleString("pt-BR")},${T}`},r=()=>{v.value="",x.value=""};(async()=>{try{const q=await Q.get("/api/estoque/fornecedores");g.value=q.data.data.map(b=>({id:b.id||"N/D",razao_social:b.razao_social||"N/D"}))}catch(q){console.error("Erro ao carregar fornecedores:",q)}})();const y=q=>q?new URL(q,window.location.origin).href:"/storage/images/no_imagem.svg",k=()=>(m.value="",p.value?!v.value||u.value?(s.error("Quantidade inválida."),m.value="Quantidade inválida.",!1):!x.value||f.value?(s.error("Valor inválido."),m.value="Valor inválido.",!1):!0:(s.error("Fornecedor não selecionado."),m.value="Fornecedor não selecionado.",!1)),R=()=>{if(!k())return;const q={...l.produtoSelecionado,fornecedor_id:p.value,quantidade:v.value,valor:x.value,unidade_de_medida:l.produtoSelecionado.unidadeDeMedida};s.success("Inusmo adicionado"),r(),d("adicionarAoCarrinho",q)};return(q,b)=>t.produtoSelecionado?(i(),c("div",Qe,[b[5]||(b[5]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",Ge,[e("div",ze,[D(e("select",{"onUpdate:modelValue":b[0]||(b[0]=T=>p.value=T),id:"fornecedor",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-green-600 focus:ring-2 focus:ring-green-500 font-['Figtree']"},[b[3]||(b[3]=e("option",{value:"",disabled:""},"Selecione um fornecedor",-1)),(i(!0),c(E,null,O(g.value,T=>(i(),c("option",{key:T.id,value:T.id},h(T.razao_social),9,Ke))),128))],512),[[Fe,p.value]])])]),e("div",We,[e("div",He,[e("div",Je,[e("img",{src:y(t.produtoSelecionado.profile_photo),alt:"Foto do Produto",class:"w-24 h-24 rounded-lg"},null,8,Xe)]),e("div",Ze,[e("div",Ye,h(t.produtoSelecionado.nome||"N/A"),1)])])]),e("form",{onSubmit:Te(R,["prevent"]),class:"space-y-4"},[e("div",null,[C(ue,{text:S.value},null,8,["text"]),C(Oe,{modelValue:v.value,"onUpdate:modelValue":b[1]||(b[1]=T=>v.value=T),placeholder:"0,000",onInput:I},null,8,["modelValue"]),u.value?(i(),c("p",et," Insira um valor válido. ")):w("",!0)]),e("div",null,[C(ue,{text:"Valor"}),e("div",tt,[D(e("input",{"onUpdate:modelValue":b[2]||(b[2]=T=>x.value=T),placeholder:"R$ 0,00",onInput:a,class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},null,544),[[F,x.value]])])]),e("div",ot,[C(Ne,{onClick:R},{default:A(()=>b[4]||(b[4]=[U("Adicionar")])),_:1})])],32)])):w("",!0)}},rt=V(at,[["__scopeId","data-v-833469c3"]]),nt={class:"flex gap-5"},st={key:0,class:"loading-overlay"},it={class:"flex-1"},dt={class:"min-w-full table-auto"},lt=["onDblclick"],ut={class:"px-6 py-4 text-[16px] text-left text-gray-900 font-semibold"},ct={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-center"},pt=["onUpdate:modelValue"],ft={key:1},vt={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-left"},mt={key:0},gt=["onUpdate:modelValue"],xt={key:2},_t={class:"px-6 py-4 text-[16px] text-gray-500 text-center"},ht=["onUpdate:modelValue"],bt={key:1},yt={class:"px-6 py-4 text-center"},$t=["onClick"],wt={key:0,class:"botao-container"},kt={__name:"ResumoCarrinho",props:{carrinho:{type:Array,required:!0}},emits:["confirmar","cancelar"],setup(t,{emit:o}){const s=se(),d=t,l=o,g=_(!1),p=_(!1),v=_(null),x=a=>{d.carrinho.splice(a,1),s.info("Item removido com sucesso!")},u=a=>{v.value=a},f=a=>{const r=parseFloat(a.valor.replace("R$","").replace(/\./g,"").replace(",",".")),n=parseFloat(a.quantidade.replace(/\./g,"").replace(",","."));return n>0?r/n:0},m=a=>{const r=parseFloat(a.quantidade.replace(/\./g,"").replace(",","."));if(a.unidadeDeMedida==="a_granel"||a.unidadeDeMedida==="quilo")return f(a)*r||0;{const n=parseFloat(a.valor.replace("R$","").replace(/\./g,"").replace(",","."));return r*n}},S=async()=>{var a;g.value=!0;try{const r={fornecedor_id:((a=d.carrinho[0])==null?void 0:a.fornecedor_id)||null,itens:d.carrinho.map(y=>{const k=parseFloat(y.quantidade.replace(/\./g,"").replace(",","."));let R=parseFloat(y.valor.replace("R$","").replace(/\./g,"").replace(",","."));R=R.toFixed(2);const P=parseFloat(m(y).toFixed(2));return console.log("Quantidade:",k),console.log("Valor Unitário:",R),console.log("Total:",P),{id:y.id,nome:y.nome,quantidade:k,unidadeDeMedida:y.unidadeDeMedida,valorUnitario:R,total:P}})};console.log("Dados enviados:",JSON.stringify(r,null,2));const n=await axios.post("/api/estoque/armazenar-entrada",r);n.status===201?(console.log("Resposta da API:",n.data),s.success("Lista de insumos salvas em seu estoque.")):s.error("Erro ao salvar no estoque, tente novamente.")}catch(r){console.error("Erro ao enviar entrada:",r),s.error("Erro ao confirmar entrada. Tente novamente ou chame o suporte.")}finally{g.value=!1}},I=()=>{l("cancelar")};return(a,r)=>(i(),c("div",nt,[g.value?(i(),c("div",st,r[0]||(r[0]=[e("div",{class:"spinner"},null,-1)]))):w("",!0),r[3]||(r[3]=e("div",{class:"flex-1"},[e("div",{class:"painel-title"},"Confirmar entrada"),e("div",{class:"painel-subtitle"},[e("p",null,"Vamos conferir se está tudo certo")]),e("div",{class:"mt-[25%] text-[#6d6d6d] text-[18px] font-normal font-['Figtree'] leading-[23px] tracking-tight"},[U(" Você confirma que está "),e("br"),U(" realizando uma nova entrada "),e("br"),U(" com os seguintes itens? ")])],-1)),e("div",it,[e("table",dt,[r[2]||(r[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-xs text-left font-medium text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," Item "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," QTD. "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," V. UN/KG "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," TOTAL "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider TrRedonDireita"}," AÇÃO ")])],-1)),e("tbody",null,[(i(!0),c(E,null,O(t.carrinho,(n,y)=>(i(),c("tr",{key:n.id,onDblclick:k=>u(y)},[e("td",ut,h(n.nome),1),e("td",ct,[v.value===y?D((i(),c("input",{key:0,type:"number","onUpdate:modelValue":k=>n.quantidade=k,class:"border border-gray-300 rounded px-2 py-1 w-16"},null,8,pt)),[[F,n.quantidade,void 0,{number:!0}]]):(i(),c("span",ft,h(n.quantidade)+" "+h(n.unidadeDeMedida==="a_granel"?"KG":"UN"),1))]),e("td",vt,[n.unidadeDeMedida==="a_granel"?(i(),c("span",mt," R$ "+h(f(n).toFixed(2)),1)):v.value===y?D((i(),c("input",{key:1,type:"text","onUpdate:modelValue":k=>n.valor=k,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,gt)),[[F,n.valor]]):(i(),c("span",xt,h(n.valor),1))]),e("td",_t,[v.value===y&&n.unidadeDeMedida==="a_granel"?D((i(),c("input",{key:0,type:"number","onUpdate:modelValue":k=>n.valorTotal=k,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,ht)),[[F,n.valorTotal,void 0,{number:!0}]]):(i(),c("span",bt,h(m(n).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1))]),e("td",yt,[e("button",{onClick:k=>x(y),class:"w-[16] h-[16]"},r[1]||(r[1]=[e("img",{src:"/storage/images/delete.svg",alt:"icone de excluir",class:"w-[16px] h-[16px]"},null,-1)]),8,$t)])],40,lt))),128))])]),p.value?w("",!0):(i(),c("div",wt,[C(Ce,{text:"Voltar",onClick:I}),C(ie,{text:"Confirmar",onClick:S})]))])]))}},qt=V(kt,[["__scopeId","data-v-5849860d"]]),Tt={key:0},St={key:0,class:"sidebar-container"},It={key:0,class:"loading-overlay"},Ct={key:1,class:"flex"},Rt={class:"flex-1 p-4"},Pt={class:"relative flex items-center w-full mb-4"},jt={class:"space-y-4 compromissos-container overflow-hidden"},Dt=["onClick"],Et={class:"flex-shrink-0"},Ft=["src"],Ut={class:"ml-4 flex-1"},Vt={class:"text-lg font-semibold flex items-center"},Mt={key:0,class:"ml-5 text-xs bg-green-100 text-green-600 font-bold rounded-full px-2 py-1"},Lt={key:1,class:"mr-2 ml-5 text-yellow-500",title:"Essa estrela sigifinica que esse insumo e um produto princial"},Ot={class:"absolute bottom-4 right-4 mt-5 botao-container"},Nt={class:"flex-1 p-4"},Bt={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},setup(t){const o=_([]),s=_(""),d=_(!1),l=_(null),g=_([]),p=_(!1),v=()=>{console.log("Entrada confirmada",g.value),mostrarModalRevisao.value=!1,g.value=[]},x=async()=>{d.value=!0;try{const a=await Q.get("/api/produtos/lista");o.value=a.data}catch(a){console.error("Erro ao carregar os produtos:",a)}finally{d.value=!1}},u=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",f=a=>{l.value=a},m=a=>g.value.filter(r=>r.id===a).length,S=a=>{g.value.push(a),l.value=null},I=qe(()=>o.value.filter(a=>a.nome.toLowerCase().includes(s.value.toLowerCase())));return Ue(x),(a,r)=>(i(),c(E,null,[C(Se,{name:"fade"},{default:A(()=>[p.value?w("",!0):(i(),c("div",Tt,[t.isVisible?(i(),c("div",St,[d.value?(i(),c("div",It,r[3]||(r[3]=[e("div",{class:"spinner"},null,-1)]))):(i(),c("div",Ct,[e("div",Rt,[r[5]||(r[5]=e("div",{class:"painel-title"},"Nova entrada",-1)),r[6]||(r[6]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",Pt,[r[4]||(r[4]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),D(e("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=n=>s.value=n),placeholder:"Buscar um produto",class:"pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[F,s.value]])]),e("div",jt,[(i(!0),c(E,null,O(I.value,n=>(i(),c("div",{key:n.id,class:"flex items-center p-4 bg-white rounded-lg cursor-pointer",onClick:y=>f(n)},[e("div",Et,[e("img",{src:u(n.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,Ft)]),e("div",Ut,[e("div",Vt,[U(h(n.nome)+" ",1),m(n.id)>0?(i(),c("span",Mt,h(m(n.id)),1)):w("",!0),n.estrela?(i(),c("span",Lt," ★ ")):w("",!0)])])],8,Dt))),128))])]),e("div",Ot,[C(ie,{text:"Finalizar",onClick:r[1]||(r[1]=n=>p.value=!0),iconPath:"/storage/images/arrow_left_alt.svg"})]),e("div",Nt,[C(rt,{produtoSelecionado:l.value,onAdicionarAoCarrinho:S},null,8,["produtoSelecionado"])])]))])):w("",!0)]))]),_:1}),p.value?(i(),L(qt,{key:0,carrinho:g.value,onConfirmar:v,onCancelar:r[2]||(r[2]=n=>p.value=!1)},null,8,["carrinho"])):w("",!0)],64))}},At=V(Bt,[["__scopeId","data-v-ded827eb"]]);var z,ce;function Re(){if(ce)return z;ce=1;function t(o){var s=typeof o;return o!=null&&(s=="object"||s=="function")}return z=t,z}var K,pe;function Qt(){if(pe)return K;pe=1;var t=typeof B=="object"&&B&&B.Object===Object&&B;return K=t,K}var W,fe;function Pe(){if(fe)return W;fe=1;var t=Qt(),o=typeof self=="object"&&self&&self.Object===Object&&self,s=t||o||Function("return this")();return W=s,W}var H,ve;function Gt(){if(ve)return H;ve=1;var t=Pe(),o=function(){return t.Date.now()};return H=o,H}var J,me;function zt(){if(me)return J;me=1;var t=/\s/;function o(s){for(var d=s.length;d--&&t.test(s.charAt(d)););return d}return J=o,J}var X,ge;function Kt(){if(ge)return X;ge=1;var t=zt(),o=/^\s+/;function s(d){return d&&d.slice(0,t(d)+1).replace(o,"")}return X=s,X}var Z,xe;function je(){if(xe)return Z;xe=1;var t=Pe(),o=t.Symbol;return Z=o,Z}var Y,_e;function Wt(){if(_e)return Y;_e=1;var t=je(),o=Object.prototype,s=o.hasOwnProperty,d=o.toString,l=t?t.toStringTag:void 0;function g(p){var v=s.call(p,l),x=p[l];try{p[l]=void 0;var u=!0}catch{}var f=d.call(p);return u&&(v?p[l]=x:delete p[l]),f}return Y=g,Y}var ee,he;function Ht(){if(he)return ee;he=1;var t=Object.prototype,o=t.toString;function s(d){return o.call(d)}return ee=s,ee}var te,be;function Jt(){if(be)return te;be=1;var t=je(),o=Wt(),s=Ht(),d="[object Null]",l="[object Undefined]",g=t?t.toStringTag:void 0;function p(v){return v==null?v===void 0?l:d:g&&g in Object(v)?o(v):s(v)}return te=p,te}var oe,ye;function Xt(){if(ye)return oe;ye=1;function t(o){return o!=null&&typeof o=="object"}return oe=t,oe}var ae,$e;function Zt(){if($e)return ae;$e=1;var t=Jt(),o=Xt(),s="[object Symbol]";function d(l){return typeof l=="symbol"||o(l)&&t(l)==s}return ae=d,ae}var re,we;function Yt(){if(we)return re;we=1;var t=Kt(),o=Re(),s=Zt(),d=NaN,l=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,p=/^0o[0-7]+$/i,v=parseInt;function x(u){if(typeof u=="number")return u;if(s(u))return d;if(o(u)){var f=typeof u.valueOf=="function"?u.valueOf():u;u=o(f)?f+"":f}if(typeof u!="string")return u===0?u:+u;u=t(u);var m=g.test(u);return m||p.test(u)?v(u.slice(2),m?2:8):l.test(u)?d:+u}return re=x,re}var ne,ke;function eo(){if(ke)return ne;ke=1;var t=Re(),o=Gt(),s=Yt(),d="Expected a function",l=Math.max,g=Math.min;function p(v,x,u){var f,m,S,I,a,r,n=0,y=!1,k=!1,R=!0;if(typeof v!="function")throw new TypeError(d);x=s(x)||0,t(u)&&(y=!!u.leading,k="maxWait"in u,S=k?l(s(u.maxWait)||0,x):S,R="trailing"in u?!!u.trailing:R);function P($){var j=f,N=m;return f=m=void 0,n=$,I=v.apply(N,j),I}function q($){return n=$,a=setTimeout(M,x),y?P($):I}function b($){var j=$-r,N=$-n,le=x-j;return k?g(le,S-N):le}function T($){var j=$-r,N=$-n;return r===void 0||j>=x||j<0||k&&N>=S}function M(){var $=o();if(T($))return de($);a=setTimeout(M,b($))}function de($){return a=void 0,R&&f?P($):(f=m=void 0,I)}function De(){a!==void 0&&clearTimeout(a),n=0,f=r=m=a=void 0}function Ee(){return a===void 0?I:de(o())}function G(){var $=o(),j=T($);if(f=arguments,m=this,r=$,j){if(a===void 0)return q(r);if(k)return clearTimeout(a),a=setTimeout(M,x),P(r)}return a===void 0&&(a=setTimeout(M,x)),I}return G.cancel=De,G.flush=Ee,G}return ne=p,ne}var to=eo();const oo=Ve(to),ao={key:0,class:"sidebar-container"},ro={key:0,class:"loading-overlay"},no={key:1},so={class:"w-full h-[80%] bg-white rounded-[20px] p-12"},io={class:"relative w-full h-full"},lo={class:"flex items-center"},uo={class:"w-1/1 flex justify-center"},co=["src"],po={class:"w-2/3 pl-5"},fo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},vo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},mo={class:"mt-5"},go={class:"min-w-full table-auto"},xo={class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonDireita"},_o={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},ho={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},bo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},yo=["onUpdate:modelValue","onInput"],$o={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},wo={class:"flex justify-left mt-12"},ko={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(t,{emit:o}){const s=se(),d=t,l=o,g=_(""),p=_(""),v=_(!1),x=_(!1),u=_("");Me(()=>d.produto,a=>{a&&(g.value=a.nome||"",p.value=a.categoria||"")},{immediate:!0});const f=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",m=oo(a=>{Q.put(`/api/estoque/estoque/lote/${a.id}`,{quantidade:a.quantidade}).then(r=>{s.success("Quantidade do lote atualizada!")}).catch(r=>{s.error("Erro ao atualizar o lote.")})},1e3),S=a=>{u.value=a,x.value=!0},I=()=>{l("cancelar")};return(a,r)=>(i(),L(Se,{name:"fade"},{default:A(()=>[t.isVisible?(i(),c("div",ao,[v.value?(i(),c("div",ro,r[1]||(r[1]=[e("div",{class:"spinner"},null,-1)]))):(i(),c("div",no,[e("div",so,[e("div",io,[e("div",lo,[e("div",uo,[e("img",{src:f(t.produto.profile_photo),alt:"Foto do Produto",class:"w-20 h-20 rounded-md shadow-lg"},null,8,co)]),e("div",po,[e("div",fo,[U(h(t.produto.nome||"N/A")+" ",1),e("div",vo,h(t.produto.unidadeDeMedida==="a_granel"&&t.produto.valor_pago_por_quilo_lote?t.produto.valor_pago_por_quilo_lote:t.produto.valor_total_lote),1)])])])])]),e("form",{onSubmit:r[0]||(r[0]=Te(n=>S("Atualizar este produto?"),["prevent"]))},[e("div",mo,[e("table",go,[e("thead",null,[e("tr",null,[r[2]||(r[2]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),r[3]||(r[3]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," Fornecedor ",-1)),r[4]||(r[4]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," qtd ",-1)),e("th",xo,h(t.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1)])]),e("tbody",null,[(i(!0),c(E,null,O(t.produto.lotes,n=>(i(),c("tr",{key:n.id},[e("td",_o,h(n.data),1),e("td",ho,h(n.fornecedor),1),e("td",bo,[D(e("input",{"onUpdate:modelValue":y=>n.quantidade=y,type:"number",min:"0",class:"border rounded-lg px-2 py-1 w-[75px] h-[32px] text-center",onInput:y=>Ie(m)(n)},null,40,yo),[[F,n.quantidade]])]),e("td",$o,h(n.preco_unitario),1)]))),128))])])]),e("div",wo,[C(Ce,{text:"Voltar",onClick:I})])],32)]))])):w("",!0)]),_:1}))}},qo=V(ko,[["__scopeId","data-v-9ad6d994"]]),To={class:"elemento-fixo"},So={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Io={class:"relative w-full h-full"},Co={class:"flex items-center"},Ro={class:"w-1/1 flex justify-center"},Po=["src"],jo={class:"w-2/3 pl-5"},Do={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Eo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},Fo={key:1,class:""},Uo={class:"mt-8"},Vo={class:"min-w-full table-auto"},Mo={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Lo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Oo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},No={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Bo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ao={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Qo={key:0,class:"mt-4"},Go={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},emits:["atualizar"],setup(t,{emit:o}){const s=o,d=_(!1),l=_(!1),g=()=>{_.dadosProduto.fetchProduto()},p=u=>u?new URL(u,window.location.origin).href:"/storage/images/no_imagem.svg",v=()=>{l.value=!l.value,d.value=!1},x=()=>{s("atualizar"),l.value=!1,d.value=!0};return(u,f)=>(i(),c("div",To,[l.value?w("",!0):(i(),c("div",So,[e("div",Io,[e("div",Co,[e("div",Ro,[e("img",{src:p(t.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Po)]),e("div",jo,[e("div",Do,[U(h(t.produto.nome||"N/A")+" ",1),e("div",Eo,h(t.produto.unidadeDeMedida==="a_granel"&&t.produto.valor_pago_por_quilo_lote?t.produto.valor_pago_por_quilo_lote:t.produto.valor_total_lote),1)])])])])])),l.value?w("",!0):(i(),c("div",Fo,[e("div",Uo,[e("table",Vo,[e("thead",null,[e("tr",null,[f[0]||(f[0]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),f[1]||(f[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),f[2]||(f[2]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),e("th",Mo,h(t.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),f[3]||(f[3]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),e("tbody",null,[(i(!0),c(E,null,O(t.produto.lotes,(m,S)=>(i(),c("tr",{key:S,class:"text-center"},[e("td",Lo,h(m.data),1),e("td",Oo,h(m.fornecedor),1),e("td",No,h(m.quantidade)+" "+h(t.produto.unidadeDeMedida==="unitario"?"uni":"kg"),1),e("td",Bo,h(t.produto.unidadeDeMedida==="unitario"?m.preco_unitario:m.valor_pago_por_quilo),1),e("td",Ao,h(t.produto.unidadeDeMedida==="unitario"?m.valor_total:m.preco_unitario),1)]))),128))])])]),t.produto.id&&!l.value?(i(),c("div",Qo,[C(Be,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:v,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):w("",!0)])),l.value?(i(),L(qo,{key:2,ref:"dadosProduto",isVisible:l.value,produto:t.produto,onDadosProduto:g,onCancelar:x},null,8,["isVisible","produto"])):w("",!0)]))}},zo=V(Go,[["__scopeId","data-v-1594529a"]]),Ko={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const t=await Q.get("/api/estoque/lista");console.log("Produtos carregados:",t.data),this.produtos=Object.values(t.data)}catch(t){console.error("Erro ao carregar os produtos:",t)}},getProfilePhotoUrl(t){return t?new URL(t,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(t){this.$emit("produto-selecionado",t)},arredondarQuantidade(t,o){const s=o==="a_granel"?3:0;return parseFloat(t).toFixed(s)},getQuantidadeTotal(t){var s;if(!Array.isArray(t))return console.warn("getQuantidadeTotal recebeu um valor inválido:",t),0;const o=t.reduce((d,l)=>d+(l.quantidade||0),0);return this.arredondarQuantidade(o,((s=t[0])==null?void 0:s.unidadeDeMedida)||"unitario")}},computed:{filteredProdutos(){const t=this.searchQuery.toLowerCase();return this.produtos.filter(o=>o.nome.toLowerCase().includes(t))}}},Wo={class:"search-container relative flex items-center w-full mb-4"},Ho={class:"card-container compromissos-container overflow-hidden"},Jo=["onClick"],Xo={class:"card-inner"},Zo={class:"icon-container"},Yo={class:"icon-leaf"},ea=["src"],ta={class:"text-container flex justify-between items-center p-2"},oa={class:"city"},aa={class:"quantidade text-gray-600 font-semibold"},ra={class:"text-gray-600 font-semibold"};function na(t,o,s,d,l,g){return i(),c("div",null,[o[3]||(o[3]=e("div",{class:"painel-title"},"Inventário da loja",-1)),o[4]||(o[4]=e("div",{class:"painel-subtitle"},[e("p",null,"Verifique a quantidade de cada item")],-1)),e("div",Wo,[o[1]||(o[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),D(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=p=>l.searchQuery=p),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[F,l.searchQuery]])]),e("div",Ho,[(i(!0),c(E,null,O(g.filteredProdutos,p=>(i(),c("div",{key:p.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:v=>g.selecionarProduto(p)},[e("div",Xo,[e("div",Zo,[o[2]||(o[2]=e("div",{class:"icon-bg"},null,-1)),e("div",Yo,[e("img",{src:g.getProfilePhotoUrl(p.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,ea)])]),e("div",ta,[e("div",oa,h(p.nome),1),e("div",aa,[e("div",ra,h(g.getQuantidadeTotal(p.lotes))+" "+h(p.unidadeDeMedida==="unitario"?"uni":"kg"),1)])])])],8,Jo))),128))])])}const sa=V(Ko,[["render",na],["__scopeId","data-v-9e86367c"]]),ia={key:0,class:"mt-6"},da={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},la={key:0},ua={class:"flex flex-col gap-4"},ca={key:1,class:"absolute bottom-4 right-4 botao-container"},pa={__name:"Index",setup(t){const o=_(null),s=_(0),d=_(!1),l=_(!1),g=()=>{d.value=!d.value},p=()=>{console.log("atualizando a lista"),o.value=null,s.value+=1},v=()=>{x(),d.value=!1},x=()=>{var m;(m=_("listarUnidades").value)==null||m.fetchUnidades()},u=f=>{f&&typeof f=="object"?o.value=f:console.warn("Dados inválidos recebidos no evento produto-selecionado:",f)};return(f,m)=>(i(),L(Ae,null,{default:A(()=>[C(Ie(Le),{title:"Insumos"}),d.value?(i(),c("div",ia,[C(At,{isVisible:d.value,onUnidadeCadastrada:v,onCancelar:g},null,8,["isVisible"])])):w("",!0),e("div",da,[d.value?w("",!0):(i(),c("div",la,[(i(),L(sa,{key:s.value,ref:"listarUnidades",onUnidadeCadastrada:x,onProdutoSelecionado:u}))])),e("div",ua,[d.value?w("",!0):(i(),c(E,{key:0},[o.value?(i(),L(zo,{key:0,onAtualizar:p,produto:o.value},null,8,["produto"])):w("",!0),l.value?w("",!0):(i(),c("div",ca,[C(ie,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:g})]))],64))])])]),_:1}))}},ka=V(pa,[["__scopeId","data-v-65e679f0"]]);export{ka as default};
