import{A as G}from"./LayoutFranqueadora-BZAchjeC.js";import{e as f,o as i,a as e,m as P,v as I,F,h as D,t as w,g as M,k as S,d,l as z,q as H,f as k,p as L,b as s,c as N,w as K,u as W,Z as X,n as Y}from"./app-BCWFP67y.js";import{B as q}from"./ButtonPrimaryMedio-9fGTOSrL.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as ee}from"./ButtonEditeMedio-Bfy_S8um.js";import{d as A}from"./index-gbNUZaaC.js";import{I as $}from"./InputModel-DjqPdDUm.js";import{_ as C}from"./LabelModel-DoqHgfI2.js";import{B as J}from"./ButtonCancelar-CeYAldPs.js";import{C as ae}from"./ConfirmDialog-BaSvRfB-.js";d([]);const se={data(){return{unidades:[],searchQuery:""}},mounted(){this.fetchUnidades()},methods:{async fetchUnidades(){try{const t=await S.get("/api/unidades");this.unidades=t.data}catch(t){console.error("Erro ao carregar unidades:",t)}},selecionarUnidade(t){this.$emit("unidade-selecionada",{unidade:t.unidade,usuarios:t.usuarios,cidade:t.cidade,quantidade_usuarios:t.quantidade_usuarios})}},computed:{filteredUnidades(){return this.unidades.filter(t=>{const o=t.unidade.cidade||t.cidade;return o&&o.toLowerCase().includes(this.searchQuery.toLowerCase())})}}},te={class:"search-container relative flex items-center w-full mb-4"},oe={class:"card-container"},de=["onClick"],le={class:"card-inner"},ie={class:"text-container"},ne={class:"city"},re={class:"owner"};function ue(t,o,n,r,v,c){return i(),f("div",null,[o[4]||(o[4]=e("div",{class:"painel-title"},"Nossas Unidades",-1)),o[5]||(o[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Listagem de todas as unidades da franquia")],-1)),e("div",te,[o[1]||(o[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),P(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>v.searchQuery=l),placeholder:"Pesquisar unidades",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[I,v.searchQuery]])]),e("div",oe,[(i(!0),f(F,null,D(c.filteredUnidades,l=>(i(),f("div",{key:l.unidade.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:g=>c.selecionarUnidade(l)},[e("div",le,[o[2]||(o[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/storefront-verde.svg",alt:"Ícone da Unidade"})])],-1)),e("div",ie,[e("div",ne,w(l.unidade.cidade||l.cidade),1),e("div",re,[l.usuarios.length>0?(i(),f(F,{key:0},[M(" Colaboradores: "+w(l.quantidade_usuarios),1)],64)):(i(),f(F,{key:1},[M("Unidade sem Franqueado")],64))])]),o[3]||(o[3]=e("div",{class:"action-icon"},null,-1))])],8,de))),128))])])}const ce=j(se,[["render",ue],["__scopeId","data-v-e1e82e72"]]),ve={key:0,class:"sidebar-container"},me={class:"w-full h-[680px] bg-white rounded-[20px] p-12"},pe={class:"flex space-x-4"},fe={class:"flex flex-col w-1/2"},ge={class:"flex flex-col w-1/2"},xe={key:0,class:"error-message"},be={class:"form-buttons"},he={__name:"EditarUnidade",props:{isVisible:{type:Boolean,required:!0},unidade:{type:Object,required:!0}},emits:["cancelar"],setup(t,{emit:o}){const n=z(),r=t,v=o,c=d(""),l=d(""),g=d(""),u=d(""),h=d(""),_=d(""),y=d(""),U=d("");H(()=>r.unidade.unidade,b=>{b&&(c.value=b.id||"",g.value=b.cidade||"",l.value=b.cep||"",u.value=b.bairro||"",h.value=b.rua||"",_.value=b.numero||"",y.value=b.cnpj||"")},{immediate:!0});const E=()=>{v("cancelar")},B=async()=>{var b,m;if(!c.value||!y.value||!l.value||!h.value||!_.value){U.value="Por favor, preencha todos os campos obrigatórios.";return}try{await A.Inertia.put(route("unidades.update",r.unidade.unidade.id),{id:c.value,cep:l.value,cidade:g.value,bairro:u.value,rua:h.value,numero:_.value,cnpj:y.value}),n.success("Unidade atualizada com sucesso!"),v("cancelar")}catch(p){n.error("Erro ao atualizar a unidade."),U.value=((m=(b=p.response)==null?void 0:b.data)==null?void 0:m.message)||"Erro ao atualizar a unidade.",console.error("Erro na atualização:",p)}};return(b,m)=>t.isVisible?(i(),f("div",ve,[e("div",me,[e("form",{onSubmit:L(B,["prevent"])},[P(e("input",{type:"hidden","onUpdate:modelValue":m[0]||(m[0]=p=>c.value=p)},null,512),[[I,c.value]]),s(C,{text:"CNPJ"}),s($,{modelValue:y.value,"onUpdate:modelValue":m[1]||(m[1]=p=>y.value=p),placeholder:"CNPJ"},null,8,["modelValue"]),s(C,{text:"Cidade"}),s($,{modelValue:g.value,"onUpdate:modelValue":m[2]||(m[2]=p=>g.value=p),placeholder:"Cidade"},null,8,["modelValue"]),s(C,{text:"CEP"}),s($,{modelValue:l.value,"onUpdate:modelValue":m[3]||(m[3]=p=>l.value=p),placeholder:"CEP"},null,8,["modelValue"]),e("div",pe,[e("div",fe,[s(C,{text:"Rua"}),s($,{modelValue:h.value,"onUpdate:modelValue":m[4]||(m[4]=p=>h.value=p),placeholder:"Rua"},null,8,["modelValue"])]),e("div",ge,[s(C,{text:"Número"}),s($,{modelValue:_.value,"onUpdate:modelValue":m[5]||(m[5]=p=>_.value=p),placeholder:"Número"},null,8,["modelValue"])])]),s(C,{text:"Bairro"}),s($,{modelValue:u.value,"onUpdate:modelValue":m[6]||(m[6]=p=>u.value=p),placeholder:"Bairro"},null,8,["modelValue"]),U.value?(i(),f("div",xe,w(U.value),1)):k("",!0),e("div",be,[s(J,{text:"Cancelar",onClick:E}),s(q,{text:"Atualizar",onClick:B})])],32)])])):k("",!0)}},_e=j(he,[["__scopeId","data-v-b009dee9"]]),ye={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ue={class:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] p-6 shadow-lg relative overflow-hidden"},$e={class:"space-y-4 overflow-y-auto pr-2 max-h-[60vh]",style:{"scrollbar-width":"none","-ms-overflow-style":"none"}},Ce=["src"],Ve={class:"flex flex-col"},we={class:"text-[#262a27] font-semibold"},ke={class:"text-sm text-gray-500"},Ee={key:0,class:"text-sm text-gray-500"},Fe={__name:"ModalUsuariosUnidade",props:{usuarios:{type:Array,required:!0}},setup(t){return(o,n)=>(i(),f("div",ye,[e("div",Ue,[n[1]||(n[1]=e("h2",{class:"text-xl font-bold text-[#262a27] mb-4"},"Colaboradores nesta unidade",-1)),e("div",$e,[(i(!0),f(F,null,D(t.usuarios,r=>{var v;return i(),f("div",{key:r.id,class:"flex items-center gap-4 border-b pb-3"},[e("img",{src:r.profile_photo_url,alt:"Foto do usuário",class:"w-12 h-12 rounded-full object-cover"},null,8,Ce),e("div",Ve,[e("span",we,w(r.name),1),e("span",ke,w(((v=r.cargo)==null?void 0:v.nome)||"Cargo não informado"),1)])])}),128)),t.usuarios.length?k("",!0):(i(),f("p",Ee,"Sem informações"))]),e("button",{onClick:n[0]||(n[0]=r=>o.$emit("close")),class:"absolute top-2 right-2 text-gray-500 hover:text-gray-800 text-xl"}," × ")])]))}},Be=j(Fe,[["__scopeId","data-v-d859c5ee"]]),Ne={key:0,class:"w-full h-[350px] bg-white rounded-[20px] p-12"},je={class:"relative w-full h-full"},qe={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},Me={class:"w-[135px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Pe={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Ie={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},De={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Se={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[34px] tracking-tight"},ze={class:"absolute bottom-0 left-0 w-full min-h-[100px] flex flex-col gap-1"},Le={class:"pl-4 pr-3 py-3 bg-[#f3f8f3] rounded-lg"},Ae={class:"flex justify-between items-center mb-1"},Je={class:"text-[#6db631] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Qe={key:1,class:"mt-4"},Re={__name:"DetalhesUnidade",props:{unidade:{type:Object,required:!0}},setup(t){const o=d(!1),n=d(!1),r=d(!1),v=()=>{d.dadosUnidade.fetchUnidades()},c=()=>{r.value=!r.value,o.value=!1},l=()=>{r.value=!1,o.value=!0};return(g,u)=>{var h,_,y,U;return i(),f(F,null,[r.value?k("",!0):(i(),f("div",Ne,[e("div",je,[e("div",qe,[e("div",Me,[u[2]||(u[2]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",Pe," ID# "+w((((h=t.unidade.unidade)==null?void 0:h.id)??0).toString().padStart(4,"0")),1)]),e("div",Ie,[u[3]||(u[3]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",De,w(((_=t.unidade.unidade)==null?void 0:_.cnpj)||"N/A"),1)])]),e("div",Se,w(((y=t.unidade.unidade)==null?void 0:y.cidade)||t.unidade.cidade||"N/A"),1),e("div",ze,[u[4]||(u[4]=e("div",{class:"text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight"}," Colaboradores nesta unidade ",-1)),e("div",Le,[e("div",Ae,[e("div",Je,w(((U=t.unidade)==null?void 0:U.quantidade_usuarios)||0)+" usuário(s) ",1),e("button",{onClick:u[0]||(u[0]=E=>n.value=!0),class:"text-[#6db631] text-sm font-medium underline"}," Mostrar ")])])])])])),t.unidade.unidade.id&&!r.value?(i(),f("div",Qe,[s(ee,{text:"Editar Unidade","icon-path":"/storage/images/border_color.svg",onClick:c,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):k("",!0),r.value?(i(),N(_e,{key:2,ref:"dadosUnidade",isVisible:r.value,unidade:t.unidade,onDadosUnidade:v,onCancelar:l},null,8,["isVisible","unidade"])):k("",!0),n.value?(i(),N(Be,{key:3,usuarios:t.unidade.usuarios,onClose:u[1]||(u[1]=E=>n.value=!1)},null,8,["usuarios"])):k("",!0)],64)}}},Te={key:0,class:"sidebar-container"},Oe={key:0,class:"loading-overlay"},Ze={key:1,class:"painel-title"},Ge={class:"w-full h-[525px] bg-white rounded-[20px] p-12"},He={class:"flex space-x-4"},Ke={class:"flex flex-col w-1/2"},We={class:"flex flex-col w-1/2"},Xe={class:"form-buttons"},Ye={__name:"CadastroUnidade",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(t,{emit:o}){const n=z(),r=o,v=d(""),c=d(""),l=d(""),g=d(""),u=d(""),h=d(""),_=d(""),y=d(!1),U=d(!1),E=d(""),B=()=>{b(),r("cancelar")},b=()=>{v.value="",c.value="",l.value="",g.value="",u.value="",h.value="",_.value=""},m=()=>!v.value||!c.value||!g.value?(n.error("Por favor, preencha todos os campos obrigatórios."),_.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,p=async()=>{var V,a;if(m())try{y.value=!0;const x=await S.post("/api/unidades",{cnpj:v.value,cep:c.value,cidade:l.value,bairro:g.value,rua:u.value,numero:h.value});A.Inertia.replace(route("franqueadora.unidades"),{unidades:x.data.unidades,preserveState:!0}),n.success("Unidade cadastrada com sucesso!"),b()}catch(x){n.error("Erro ao cadastrar unidade."),_.value=((a=(V=x.response)==null?void 0:V.data)==null?void 0:a.message)||"Erro ao cadastrar unidade."}finally{y.value=!1}},Q=V=>{let a=V.target.value.replace(/\D/g,"");a.length>14&&(a=a.slice(0,14)),a=a.replace(/^(\d{2})(\d)/,"$1.$2"),a=a.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),a=a.replace(/\.(\d{3})(\d)/,".$1/$2"),a=a.replace(/(\d{4})(\d)/,"$1-$2"),v.value=a},R=V=>{let a=V.target.value.replace(/\D/g,"");a.length>8&&(a=a.slice(0,8)),a=a.replace(/(\d{5})(\d)/,"$1-$2"),c.value=a},T=V=>{E.value=V,U.value=!0},O=()=>{p(),U.value=!1},Z=()=>{U.value=!1};return(V,a)=>t.isVisible?(i(),f("div",Te,[y.value?(i(),f("div",Oe,a[7]||(a[7]=[e("div",{class:"spinner"},null,-1)]))):(i(),f("div",Ze,"Dados da nova unidade")),a[8]||(a[8]=e("div",{class:"painel-subtitle"},[e("p",null,"Informações básicas sobre a operação")],-1)),e("div",Ge,[e("form",{onSubmit:L(p,["prevent"])},[s(C,{text:"CNPJ"}),s($,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=x=>v.value=x),onInput:Q,placeholder:"CNPJ"},null,8,["modelValue"]),s(C,{text:"Cidade"}),s($,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=x=>l.value=x),placeholder:"Cidade"},null,8,["modelValue"]),s(C,{text:"CEP"}),s($,{modelValue:c.value,"onUpdate:modelValue":a[2]||(a[2]=x=>c.value=x),onInput:R,placeholder:"CEP"},null,8,["modelValue"]),e("div",He,[e("div",Ke,[s(C,{text:"Rua"}),s($,{modelValue:u.value,"onUpdate:modelValue":a[3]||(a[3]=x=>u.value=x),placeholder:"Rua"},null,8,["modelValue"])]),e("div",We,[s(C,{text:"Número"}),s($,{modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=x=>h.value=x),placeholder:"Número"},null,8,["modelValue"])])]),s(C,{text:"Bairro"}),s($,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=x=>g.value=x),placeholder:"Bairro"},null,8,["modelValue"]),s(ae,{isVisible:U.value,motivo:E.value,onConfirm:O,onCancel:Z},null,8,["isVisible","motivo"]),e("div",Xe,[s(J,{text:"Cancelar",onClick:B}),s(q,{text:"Cadastrar",onClick:a[6]||(a[6]=x=>T("Criar nova unidade?"))})])],32)])])):k("",!0)}},ea=j(Ye,[["__scopeId","data-v-1bd4ab58"]]),aa={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2"},sa={class:"flex flex-col gap-4"},ta={class:"absolute bottom-4 right-4"},oa={key:1,class:"mt-4"},fa={__name:"Index",setup(t){const o=d(null),n=d(!1),r=()=>{n.value=!n.value},v=()=>{c(),n.value=!1},c=()=>{d.listarUnidades.fetchUnidades()},l=g=>{o.value=g};return(g,u)=>(i(),N(G,null,{default:K(()=>[s(W(X),{title:"Unidades"}),e("div",aa,[e("div",null,[s(ce,{ref:"listarUnidades",onUnidadeCadastrada:c,onUnidadeSelecionada:l},null,512)]),e("div",sa,[n.value?(i(),f("div",oa,[s(ea,{isVisible:n.value,onUnidadeCadastrada:v,onCancelar:r},null,8,["isVisible"])])):(i(),f(F,{key:0},[o.value?(i(),N(Re,{key:0,unidade:o.value},null,8,["unidade"])):k("",!0),e("div",ta,[s(q,{text:"Nova Unidade",iconPath:"/storage/images/arrow_left_alt.svg",onClick:r,class:Y({hidden:g.isEditMode})},null,8,["class"])])],64))])])]),_:1}))}};export{fa as default};
