import{L}from"./LayoutFranqueado-jmbTUkwP.js";import{d,x as C,i as V,o as n,e as r,a,h as f,F as D,g as I,t as w,k as $,l as M,m as z,b as g,c as y,w as j,u as E,Z as P}from"./app-9S55-VCN.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as S}from"./InputModel-EzHzxHDE.js";import{_ as k}from"./LabelModel-BQZozZ6I.js";import{D as U}from"./Deslizante-BZhsaDll.js";import"./user-B6yIILm4.js";const B={key:0,class:"loading-overlay"},F={class:"card-container"},N=["onClick"],q={class:"card-inner"},A={class:"icon-container"},O={class:"icon-leaf"},Q=["src"],T={class:"text-container"},K={class:"city"},R={__name:"ListarCanaisVendas",emits:["dado-selecionado"],setup(h,{emit:u}){const m=u,l=d([]),_=d(""),t=d(!1),i=async()=>{t.value=!0;try{const s=await $.get("/api/canais-vendas/lista");l.value=Object.values(s.data)}catch(s){console.error("Erro ao carregar os dados:",s)}finally{t.value=!1}},c=s=>s?new URL(s,window.location.origin).href:"/storage/images/no_imagem.svg";C(i);const p=s=>{m("dado-selecionado",s)},x=V(()=>{const s=_.value.toLowerCase();return l.value.filter(e=>String(e.id).toLowerCase().includes(s)||e.fornecedor_nome.toLowerCase().includes(s))});return(s,e)=>(n(),r("div",null,[t.value?(n(),r("div",B,e[0]||(e[0]=[a("div",{class:"spinner"},null,-1)]))):f("",!0),e[3]||(e[3]=a("div",{class:"painel-title"},"Canais de venda",-1)),e[4]||(e[4]=a("div",{class:"painel-subtitle"},[a("p",null,"Plataformas de e-commerce da sua unidade")],-1)),a("div",F,[(n(!0),r(D,null,I(x.value,o=>(n(),r("div",{key:o.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:v=>p(o)},[a("div",q,[a("div",A,[e[1]||(e[1]=a("div",{class:"icon-bg"},null,-1)),a("div",O,[a("img",{src:c(o.img_icon),alt:"Ícone"},null,8,Q)])]),a("div",T,[a("div",K,w(o.nome),1)]),e[2]||(e[2]=a("div",{class:"action-icon"},null,-1))])],8,N))),128))])]))}},Z=b(R,[["__scopeId","data-v-5efceed0"]]),G={class:"elemento-fixo"},H={key:0},J={key:0,class:"loading-overlay"},W={class:"w-full h-[237px] p-12 bg-white rounded-[20px] flex-col justify-center items-center gap-10 inline-flex"},X={class:"self-stretch text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[34px] tracking-tight"},Y={class:"w-full h-[63px] relative"},ee={class:"mt-8 w-full p-12 bg-white rounded-[20px] flex justify-between items-center gap-5"},ae={class:"flex flex-col w-2/3"},se={class:"text-sm font-semibold text-gray-700"},te={class:"w-1/2 flex justify-end"},oe={__name:"DetalhesCanaisVendas",props:{dados:{type:Object,required:!0}},emits:["atualizar"],setup(h,{emit:u}){const m=M(),l=h,_=d(!1),t=d(0),i=d(!1),c=d(!1);let p=!1;const x=async()=>{c.value=!0;try{const e=await $.get(`/api/canais-vendas/verificar-pagamentos/${l.dados.id}`);e.status===200&&e.data?(console.log("Dados recebidos:",e.data),t.value=e.data.data.porcentagem||0,i.value=e.data.data.status===1):(e.status===404||!e.data)&&(console.info("Nenhum canal de vendas foi encontrado."),t.value=0,i.value=!1)}catch(e){console.error("Erro ao busca canais de venda:",e),t.value=0,i.value=!1}finally{c.value=!1}},s=async()=>{try{await new Promise(v=>setTimeout(v,2e3)),c.value=!0;const e={unidade_id:l.dados.id,canal_venda_method_id:l.dados.id,porcentagem:t.value,status:i.value?1:0},o=await $.post("/api/canais-vendas/upsert",e);p||(p=!0,m.success("Método atualizado",{onClose:()=>{p=!1}}))}catch(e){console.error("Erro ao atualizar o método de pagamento:",e)}finally{c.value=!1}};return z(()=>l.dados.id,()=>{x()}),C(()=>{x()}),(e,o)=>(n(),r("div",G,[_.value?f("",!0):(n(),r("div",H,[c.value?(n(),r("div",J,o[2]||(o[2]=[a("div",{class:"spinner"},null,-1)]))):f("",!0),a("div",W,[a("div",X,w(h.dados.nome),1),a("div",Y,[g(k,{class:"font-semibold text-gray-900",text:"Quanto você paga de taxa?"}),g(S,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=v=>t.value=v),placeholder:"5%",onInput:s},null,8,["modelValue"])])]),a("div",ee,[a("div",ae,[g(k,{class:"font-semibold text-gray-900",text:"Utilizar este método de pagamento?"}),a("span",se,w(i.value?"Ativado":"Desativado"),1)]),a("div",te,[g(U,{status:i.value,"onUpdate:status":o[1]||(o[1]=v=>i.value=v),onClick:s},null,8,["status"])])])]))]))}},ne=b(oe,[["__scopeId","data-v-47a9196d"]]),le={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},ie={key:0},de={class:"flex flex-col gap-4"},re={__name:"Index",setup(h){const u=d(null),m=d(0),l=d(!1),_=t=>{u.value=t};return(t,i)=>(n(),y(L,null,{default:j(()=>[g(E(P),{title:"Métodos de pagamentos"}),a("div",le,[l.value?f("",!0):(n(),r("div",ie,[(n(),y(Z,{key:m.value,ref:"listaDados",onDadoSelecionado:_}))])),a("div",de,[l.value?f("",!0):(n(),r(D,{key:0},[u.value?(n(),y(ne,{key:0,dados:u.value},null,8,["dados"])):f("",!0)],64))])])]),_:1}))}},ge=b(re,[["__scopeId","data-v-6a31bc40"]]);export{ge as default};
