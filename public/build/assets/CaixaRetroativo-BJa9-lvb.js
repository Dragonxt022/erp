import{d as c,j as L,e as v,o as n,a,b as d,F as $,h as R,t as l,n as S,k as P,m as M,i as j,c as C,f as h,w as q,u as K,Z as O}from"./app-BpJtz6--.js";import{L as T}from"./LayoutFranqueado-Dw886fCe.js";import{C as U}from"./CadastroColaborador-CBXleJ78.js";import{B as Z}from"./ButtonPrimaryMedio-BRqVjWrU.js";import{d as G}from"./index-v4jOKryR.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as E}from"./LabelModel-C-tTOP4a.js";import{C as w}from"./ConfirmDialog-CYtxjl0O.js";/* empty css                                                                   */import{B as H}from"./ButtonEditeMedio-Byi6W2uz.js";import{E as J}from"./EditarColaborador-Agawmkkj.js";import{A as Q}from"./AvisoSistemaNovo-CDHOIB_P.js";import"./ButtonCancelar-X2pMg5D-.js";const W=["onClick"],X={class:"text-lg font-medium text-gray-900"},Y={class:"flex items-center space-x-1"},aa={class:"text-sm text-gray-600"},ta={class:"flex items-center space-x-4"},oa={class:"text-sm text-gray-600"},ea={class:"text-sm text-gray-600"},sa={class:"text-sm text-gray-600"},ra={__name:"ListarCaixas",emits:["caixa-selecionado","abrir-cadastro"],setup(u,{emit:f}){const s=f,o=c([]),g=async()=>{try{const e=await P.get("/api/caixas/lista");o.value=e.data.data}catch(e){console.error("Erro ao carregar os caixas:",e)}},r=e=>new Date(e).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"});L(g);const x=e=>{s("caixa-selecionado",e)},p=()=>{G.Inertia.visit(route("franqueado.abrirCaixa"))};return(e,i)=>(n(),v("div",null,[i[1]||(i[1]=a("div",{class:"painel-title"},"Caixa Retroativo",-1)),i[2]||(i[2]=a("div",{class:"painel-subtitle"},[a("p",null,"Edite, exclua e adicione caixas retroativos")],-1)),d(Z,{text:"Adicionar um novo caixa",class:"w-full",onClick:p}),(n(!0),v($,null,R(o.value,t=>(n(),v("div",{key:t.id,onClick:b=>x(t),class:"relative flex items-center bg-white p-4 rounded-lg cursor-pointer hover:bg-gray-100 transition mt-3"},[a("div",null,[a("p",X," Caixa N° "+l(t.id)+" | Valor "+l(t.valor_total_fechamento||0),1),a("div",Y,[i[0]||(i[0]=a("img",{src:"/storage/images/usc.svg",alt:"Ícone",class:"w-[14px] h-[14px]"},null,-1)),a("p",aa,l(t.usuario_fechou),1)]),a("div",ta,[a("p",oa," Abriu: "+l(r(t.hora_abertura)),1),a("p",ea," Fechou: "+l(r(t.hora_fechamento)),1),a("p",sa,"Ativo: "+l(t.horas_aberto),1)])]),a("div",{class:S(["absolute right-4 top-1/2 transform -translate-y-1/2 px-2 py-1 rounded-full text-xs font-semibold text-white",{"bg-yellow-500":t.status==="Aberto","bg-green-500":t.status==="Fechado"}])},l(t.status),3)],8,W))),128))]))}},ia=k(ra,[["__scopeId","data-v-3db1602c"]]),la={class:"elemento-fixo"},na={key:0},ca={key:0,class:"loading-overlay"},da={class:"w-full h-[250px] bg-white rounded-tl-[20px] rounded-tr-[20px] p-7 relative"},ua={class:"flex justify-between items-center"},ma={class:"w-2/3"},va={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},fa={class:"text-[20px] text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500 mt-2 flex items-center"},xa={class:"grid grid-cols-2 gap-4 mt-8"},ga={class:"text-[17px] font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},pa={class:"text-[17px] font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},_a={key:0,class:"mt-4"},ha={__name:"DetalhesCaixa",props:{dados:{type:Object,required:!0}},emits:["voltar","atualiza"],setup(u,{emit:f}){const s=M(),o=u,g=f,r=c(!1),x=c(!1),p=c(!1),e=c(!1),i=c(!1),t=c("");c(!0);const b=()=>{r.value=!r.value,i.value=!1},V=()=>{g("atualizar"),r.value=!1,i.value=!0},z=j(()=>o.dados.salario?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o.dados.salario):"R$ 0,00"),A=async()=>{try{p.value=!1,e.value=!0;const m=await axios.post("/api/usuarios/regenera-pin",{user_id:o.dados.id});s.success("PIN atualizado com sucesso"),g("voltar")}catch(m){console.error("Erro ao atualizar o PIN:",m),s.error("Erro ao atualizar o PIN")}finally{e.value=!1}},D=m=>{t.value=m,x.value=!0},B=()=>{p.value=!1},F=()=>{x.value=!1,I()},N=()=>{x.value=!1},I=async()=>{if(!o.dados||!o.dados.id){s.error("Erro: Dados da conta não encontrados.");return}try{const m=await axios.delete(`/api/usuarios/delete/${o.dados.id}`);s.success("Conta excluída com sucesso"),g("voltar")}catch(m){s.error("Erro ao excluir a conta"),console.error("Erro ao excluir a conta:",m)}};return(m,_)=>{var y;return n(),v($,null,[a("div",la,[r.value?h("",!0):(n(),v("div",na,[e.value?(n(),v("div",ca,_[1]||(_[1]=[a("div",{class:"spinner"},null,-1)]))):h("",!0),a("div",null,[a("div",da,[a("div",ua,[a("div",ma,[a("div",va," ID #"+l(u.dados.id)+" | "+l(u.dados.name||"sem informações"),1),a("div",fa,[a("span",null,l(((y=u.dados.cargo)==null?void 0:y.nome)||"sem informações"),1)])]),a("button",{class:"text-gray-500 hover:text-red-600",onClick:_[0]||(_[0]=wa=>D("Excluir essa conta?"))},_[2]||(_[2]=[a("img",{src:"/storage/images/delete.svg",alt:"Excluir",class:"w-6 h-6"},null,-1)]))]),a("div",xa,[a("div",null,[d(E,{text:"Aberto por:"}),a("p",ga,l(u.dados.email),1)]),a("div",null,[d(E,{text:"Fechado por:"}),a("p",pa,l(z.value),1)])]),u.dados.id&&!r.value?(n(),v("div",_a,[d(H,{text:"Editar caixa","icon-path":"/storage/images/border_color.svg",onClick:b})])):h("",!0)])])]))]),r.value?(n(),C(J,{key:0,user:u.dados,isVisible:r.value,onVoltar:V,onAtualizado:m.handleAtualizacao},null,8,["user","isVisible","onAtualizado"])):h("",!0),d(w,{isVisible:x.value,motivo:t.value,onConfirm:F,onCancel:N},null,8,["isVisible","motivo"]),d(w,{isVisible:p.value,motivo:t.value,onConfirm:A,onCancel:B},null,8,["isVisible","motivo"])],64)}}},Ca=k(ha,[["__scopeId","data-v-0a7b1d08"]]),ba={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mt-3 h-full"},ya={key:0,class:"mt-3"},Ea={key:1},Pa={__name:"CaixaRetroativo",setup(u){const f=c(0),s=c(null),o=c(!1),g=()=>{o.value=!o.value,o.value&&(s.value=null)},r=i=>{s.value=i},x=()=>{o.value=!1,f.value+=1,console.log("cancelarCadastro")},p=()=>{s.value=null,f.value+=1},e=()=>{f.value+=1,r.value=null};return(i,t)=>(n(),C(T,null,{default:q(()=>[d(K(O),{title:"Caixa Retroativo"}),a("div",ba,[(n(),C(ia,{key:f.value,ref:"listaDados",onUsuarioSelecionado:r,onAbrirCadastro:g})),o.value?(n(),v("div",ya,[d(U,{onVoltar:x})])):h("",!0),s.value?(n(),v("div",Ea,[d(Ca,{dados:s.value,onVoltar:p,onAtualiza:e},null,8,["dados"])])):h("",!0)]),d(Q)]),_:1}))}};export{Pa as default};
