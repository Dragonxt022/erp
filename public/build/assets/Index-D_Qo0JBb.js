import{s as S,d as i,m as B,x as O,o as u,e as m,a as e,b as r,j as h,v as y,h as F,y as k,c as V,w as L,i as T,t as $,z as W,F as P,g as H,u as Q,Z}from"./app-DnQVHGg4.js";import{_,B as E,I as w,C as G,a as K}from"./ConfirmDialog-DW2kaX9X.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as R}from"./AppLayout-BreoiuAe.js";const X={class:"w-full h-[400px] bg-white rounded-[20px] p-7 relative"},Y={class:"relative w-full h-full"},ee={class:"flex items-center"},oe={class:"w-full"},se={class:"text-[#262a27] text-[28px] font-['Figtree']"},ae={class:"text-sm text-gray-500"},te={class:"text-sm text-gray-500"},re={class:"text-sm text-gray-500"},le={key:0,class:"mt-4 text-right"},ne={__name:"DetalhesFornecedor",props:{fornecedor:{type:Object,required:!0}},setup(b){const f=S(),d=b,t=i({...d.fornecedor}),v=B(()=>JSON.stringify(t.value)!==JSON.stringify(d.fornecedor)),p=async()=>{try{const n=await k.put(`/api/fornecedores/${t.value.id}`,t.value);Object.assign(d.fornecedor,n.data.data),f.success("Fornecedor atualizado com sucesso!")}catch(n){f.error("Erro ao atualizar fornecedor."),console.error(n)}};return O(()=>d.fornecedor,n=>{t.value={...n}}),(n,s)=>(u(),m("div",X,[e("div",Y,[e("div",ee,[e("div",oe,[e("div",se,[r(_,{text:"Fornecedor"}),h(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value.nome_completo=o),class:"w-full text-center border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Nome Completo"},null,512),[[y,t.value.nome_completo]])]),e("div",ae,[r(_,{text:"CNPJ"}),h(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.cnpj=o),class:"w-full text-center py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"CNPJ"},null,512),[[y,t.value.cnpj]])]),e("div",te,[r(_,{text:"WhatsApp"}),h(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.whatsapp=o),class:"w-full text-center py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"WhatsApp"},null,512),[[y,t.value.whatsapp]])]),e("div",re,[r(_,{text:"Estado"}),h(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.estado=o),class:"w-full text-center py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Estado"},null,512),[[y,t.value.estado]])]),r(_,{text:"E-mail"}),h(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.value.email=o),class:"w-full text-center py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"E-mail"},null,512),[[y,t.value.email]])])]),v.value?(u(),m("div",le,[r(E,{text:"Atualizar",onClick:p})])):F("",!0)])]))}},de=N(ne,[["__scopeId","data-v-9b290acd"]]),ie={key:0,class:"sidebar-container"},ce={key:0,class:"loading-overlay"},ue={key:1,class:"w-full h-[525px] bg-white rounded-[20px] p-12"},ve={key:0,class:"error-message"},pe={class:"form-buttons"},me={__name:"CadastroFornecedor",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(b,{emit:f}){const d=S(),t=f,v=i(""),p=i(""),n=i(""),s=i(""),o=i(""),l=i(""),g=i(!1),C=i(!1),U=i(""),z=()=>{j(),t("cancelar")},j=()=>{v.value="",p.value="",n.value="",s.value="",o.value="",l.value=""},I=()=>!v.value||!p.value||!n.value?(d.error("Por favor, preencha todos os campos obrigatórios."),l.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,D=async()=>{var x,a;if(I())try{g.value=!0;const c=await k.post("/api/fornecedores",{nome_completo:v.value,email:p.value,cnpj:n.value,whatsapp:s.value,estado:o.value});console.log("Fornecedor cadastrado com sucesso:",c.data),d.success("Fornecedor cadastrado com sucesso!"),j(),t("cancelar")}catch(c){d.error("Erro ao realizar o cadastro."),l.value=((a=(x=c.response)==null?void 0:x.data)==null?void 0:a.message)||"Erro ao realizar o cadastro."}finally{g.value=!1}},A=x=>{let a=x.target.value.replace(/\D/g,"");a.length>14&&(a=a.slice(0,14)),a=a.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"),n.value=a},J=x=>{U.value=x,C.value=!0},M=()=>{D(),C.value=!1},q=()=>{C.value=!1};return(x,a)=>(u(),V(W,{name:"fade"},{default:L(()=>[b.isVisible?(u(),m("div",ie,[g.value?(u(),m("div",ce,a[6]||(a[6]=[e("div",{class:"spinner"},null,-1)]))):(u(),m("div",ue,[e("form",{onSubmit:T(D,["prevent"])},[r(_,{text:"Nome Completo"}),r(w,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=c=>v.value=c),placeholder:"João Silva Souza"},null,8,["modelValue"]),r(_,{text:"E-mail"}),r(w,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=c=>p.value=c),placeholder:"usuario@email.com"},null,8,["modelValue"]),r(_,{text:"CNPJ"}),r(w,{modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=c=>n.value=c),onInput:A,placeholder:"000.000.000/0000-00"},null,8,["modelValue"]),r(_,{text:"WhatsApp"}),r(w,{modelValue:s.value,"onUpdate:modelValue":a[3]||(a[3]=c=>s.value=c),placeholder:"(00) 00000-0000"},null,8,["modelValue"]),r(_,{text:"Estado"}),r(w,{modelValue:o.value,"onUpdate:modelValue":a[4]||(a[4]=c=>o.value=c),placeholder:"ex.São Paulo"},null,8,["modelValue"]),l.value?(u(),m("div",ve,$(l.value),1)):F("",!0),r(G,{isVisible:C.value,motivo:U.value,onConfirm:M,onCancel:q},null,8,["isVisible","motivo"]),e("div",pe,[r(K,{text:"Cancelar",onClick:z}),r(E,{text:"Cadastrar",onClick:a[5]||(a[5]=c=>J("Criar novo Fornecedor?"))})])],32)]))])):F("",!0)]),_:1}))}},fe=N(me,[["__scopeId","data-v-f7ef7946"]]),ge={class:"search-container relative flex items-center w-full mb-4"},_e={class:"card-container"},xe=["onClick"],he={class:"card-inner"},ye={class:"text-container"},be={class:"city"},Ce={class:"owner"},we={__name:"ListarFornecedores",emits:["fornecedor-selecionado"],setup(b,{emit:f}){const d=f,t=i([]),v=i(""),p=async()=>{try{const o=await k.get("/api/fornecedores");t.value=o.data.data}catch(o){console.error("Erro ao carregar fornecedores:",o)}},n=o=>{d("fornecedor-selecionado",o)},s=B(()=>{const o=v.value.toLowerCase();return t.value.filter(l=>l.nome_completo.toLowerCase().includes(o)||l.cnpj.toLowerCase().includes(o))});return p(),(o,l)=>(u(),m("div",null,[l[4]||(l[4]=e("div",{class:"painel-title"},"Fornecedores",-1)),l[5]||(l[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Fornecedores de insumos homologados")],-1)),e("div",ge,[l[1]||(l[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),h(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=g=>v.value=g),placeholder:"Buscar um fornecedor",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[y,v.value]])]),e("div",_e,[(u(!0),m(P,null,H(s.value,g=>(u(),m("div",{key:g.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:C=>n(g)},[e("div",he,[l[2]||(l[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/servicos_verde.svg",alt:"Ícone do fornecedor",class:"w-5 h-5 rounded-lg"})])],-1)),e("div",ye,[e("div",be,$(g.nome_completo),1),e("div",Ce,$(g.cnpj),1)]),l[3]||(l[3]=e("div",{class:"action-icon"},null,-1))])],8,xe))),128))])]))}},Fe=N(we,[["__scopeId","data-v-8e104672"]]),Ve={class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2"},$e={class:"flex flex-col gap-4"},ke={class:"absolute bottom-4 right-4"},Ee={key:1,class:"mt-4"},Se={__name:"Index",setup(b){const f=i(null),d=i(!1),t=()=>{d.value=!d.value},v=()=>{p(),d.value=!1},p=()=>{var o;(o=i("listarFornecedores").value)==null||o.fetchFornecedores()},n=s=>{s&&typeof s=="object"?f.value=s:console.warn("Dados inválidos recebidos no evento fornecedor-selecionado:",s)};return(s,o)=>(u(),V(R,null,{default:L(()=>[r(Q(Z),{title:"Fornecedores"}),e("div",Ve,[e("div",null,[r(Fe,{ref:"listarFornecedores",onFornecedorCadastrado:p,onFornecedorSelecionado:n},null,512)]),e("div",$e,[d.value?(u(),m("div",Ee,[r(fe,{isVisible:d.value,onFornecedorCadastrado:v,onCancelar:t},null,8,["isVisible"])])):(u(),m(P,{key:0},[f.value?(u(),V(de,{key:0,fornecedor:f.value},null,8,["fornecedor"])):F("",!0),e("div",ke,[r(E,{text:"Novo Fornecedor",iconPath:"/storage/images/arrow_left_alt.svg",onClick:t})])],64))])])]),_:1}))}};export{Se as default};
