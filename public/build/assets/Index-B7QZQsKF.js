import{d as o,e as u,o as d,a as t,t as n,i as D,j as z,c as O,w as Z,b as I,u as Q,Z as W,F as G,h as H,f as J,g as c}from"./app-eiwQENIW.js";import{d as K}from"./index-WEYC5Oad.js";import{C as V,r as U}from"./chart-lMt0pmU3.js";import{L as X}from"./LayoutFranqueado-DmIUjQ66.js";import{d as E}from"./dayjs.min-Cjg-eHvc.js";import"./pt-br-Bk9-Ljux.js";import{_ as tt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const et={class:"relative"},st={class:"flex items-center justify-center rounded-md"},at={class:"font-semibold text-lg"},ot={__name:"CalendarSimples",setup(S){E.locale("pt-br");const m=o(E());return(p,g)=>(d(),u("div",et,[t("div",st,[t("span",at,n(m.value.format("MMMM YYYY")),1)])]))}},lt={class:"flex justify-between items-center mb-4"},nt={class:"text-[#262a27] text-[15px] font-semibold font-['Figtree'] leading-tight"},rt={class:"flex items-center space-x-2"},it={class:"text-gray-900 text-[17px] font-semibold"},dt={class:"mt-5"},ct={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ut={class:"md:row-span-3"},mt={class:"bg-white rounded-lg p-5 h-full w-full"},pt={class:"compromissos-container flex flex-col gap-2 overflow-hidden"},gt={class:"flex flex-col"},ft={class:"text-[14px] font-medium text-gray-900"},xt={class:"text-sm text-gray-600"},vt=["src","alt"],bt={class:"bg-white rounded-lg p-7"},_t={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},ht={class:"bg-white rounded-lg p-7"},yt={class:"flex items-center mb-4"},wt={xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 24 24",style:{fill:"rgba(0, 0, 0, 1)",transform:"msfilter"}},Ct={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},Ft={key:0,class:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50"},kt={class:"bg-white rounded-lg p-7 w-[350px] shadow-lg"},$t={class:"text-sm text-gray-600 space-y-2"},jt={class:"text-lg font-bold text-gray-900 mt-3"},Mt={class:"bg-white rounded-lg p-7"},Dt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},It={class:"bg-white rounded-lg p-4"},Vt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},Et={class:"bg-white rounded-lg p-4 col-span-1 md:col-span-3"},St={class:"w-full h-[220px]"},qt={__name:"Index",setup(S){V.register(...U);const m=o(null),p=o(null),g=o([]),b=o([]),f=o([]),_=o("0,00"),h=o("0,00"),y=o("0,00"),w=o("0,00"),C=o("0,00"),x=o("0,00"),F=o("0,00"),k=o(0),$=o("0,00"),v=o(!1),q=()=>{K.Inertia.replace(route("franqueado.contasApagar"))},A=()=>{v.value=!0},R=()=>{v.value=!1},L=async(s=null,e=null)=>{try{let a="/api/painel-analitycos/calcular-cmv";const r=[];s&&r.push(`start_date=${s}`),e&&r.push(`end_date=${e}`),r.length>0&&(a+=`?${r.join("&")}`);const l=(await axios.get(a)).data;l.saldo_estoque_inicial?(_.value=l.start_date||"não informado",h.value=l.end_date||"não informado",y.value=l.saldo_estoque_inicial||"0,00",w.value=l.entradas_durante_periodo||"0,00",C.value=l.saldo_estoque_final||"0,00",x.value=l.cmv||"0,00"):console.warn("Dados analíticos não encontrados.")}catch(a){console.error("Erro ao buscar dados analíticos:",a)}},P=async(s=null,e=null)=>{try{let a="/api/painel-analitycos/calcular-fluxo-caixa";const r=[];s&&r.push(`start_date=${s}`),e&&r.push(`end_date=${e}`),r.length>0&&(a+=`?${r.join("&")}`);const l=(await axios.get(a)).data;F.value=l.total_caixas||"0,00",k.value=l.quantidade_pedidos||0,$.value=l.ticket_medio||"0,00"}catch(a){console.error("Erro ao buscar dados analíticos:",a)}};D(()=>{L(),P(),j(),Y(),M()});const j=async()=>{try{const s=await axios.get("/api/cursto/listar-contas-a-pagar");f.value=s.data.data}catch(s){console.error("Erro ao carregar os dados:",s)}};D(j),z(()=>{const s=searchQuery.value.toLowerCase();return f.value.filter(e=>e.nome.toLowerCase().includes(s)||String(e.valor).includes(s))});const B=s=>{const e=s.split("-");return`${e[2]}/${e[1]}/${e[0]}`},N={pendente:"/storage/images/check_circle_laranja.svg",pago:"/storage/images/check_circle_verde.svg",agendada:"/storage/images/agendada.svg",atrasado:"/storage/images/atrasada.svg"},T=s=>N[s]||"/storage/images/check_circle_laranja.svg",Y=async()=>{try{const e=(await axios.get("/api/painel-analitycos/faturamento-por-dia-mes")).data,a=new Date().getMonth()+1,r=Object.values(e.faturamento).filter(i=>(parseInt(i.dia)<=new Date().getDate()?a:a-1)===a).sort((i,l)=>i.dia-l.dia);Array.isArray(r)?(b.value=r.map(i=>i.dia),g.value=r.map(i=>parseFloat(i.total)),M()):console.error("Erro: Os dados recebidos não estão no formato esperado.",e)}catch(s){console.error("Erro ao buscar dados:",s)}},M=()=>{p.value&&p.value.destroy(),p.value=new V(m.value.getContext("2d"),{type:"bar",data:{labels:b.value,datasets:[{label:"Faturamento Diário",data:g.value,backgroundColor:"rgba(75, 192, 75, 0.6)",borderColor:"rgba(75, 192, 75, 1)",borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{callback:function(s){return s>=1e3?`${s/1e3} mil`:s}}}}}})};return(s,e)=>(d(),O(X,null,{default:Z(()=>[I(Q(W),{title:"Painel"}),t("div",lt,[e[1]||(e[1]=t("div",null,[t("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Visão geral da loja "),t("div",{class:"painel-subtitle"},[t("p",{class:"text-sm sm:text-base md:text-lg"}," Acompanhe o desempenho geral ")])],-1)),t("div",nt,[t("div",rt,[e[0]||(e[0]=t("img",{src:"/storage/images/calendar_month.svg",alt:"Filtro",class:"w-5 h-5"},null,-1)),t("span",it,[I(ot)])])])]),t("div",dt,[t("div",ct,[t("div",ut,[t("div",mt,[e[2]||(e[2]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-2"}," Compromissos ",-1)),t("div",pt,[(d(!0),u(G,null,H(f.value,a=>(d(),u("div",{key:a.id,onClick:q,class:"flex justify-between items-center bg-[#F5FAF4] p-3 rounded-lg cursor-pointer hover:bg-gray-100 transition-all ease-in-out duration-300"},[t("div",gt,[t("p",ft,n(a.nome),1),t("p",xt,n(a.valor_formatado)+" - Vence em "+n(B(a.vencimento)),1)]),t("div",null,[t("img",{src:T(a.status),alt:"Status: "+a.status,class:"w-6 h-6 object-contain transition-transform transform hover:scale-105"},null,8,vt)])]))),128))])])]),t("div",bt,[e[3]||(e[3]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Faturamento",-1)),t("div",_t," R$ "+n(F.value),1),e[4]||(e[4]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",ht,[t("div",yt,[e[6]||(e[6]=t("h3",{class:"text-lg font-semibold text-gray-700"},"CMV",-1)),t("button",{onClick:A,class:"ml-2"},[(d(),u("svg",wt,e[5]||(e[5]=[t("path",{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"},null,-1)])))])]),t("div",Ct," R$ "+n(x.value),1),e[14]||(e[14]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1)),v.value?(d(),u("div",Ft,[t("div",kt,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"}," Detalhes do CMV ",-1)),t("div",$t,[t("p",null,[e[7]||(e[7]=t("span",{class:"font-semibold text-gray-800"},"Período:",-1)),c(" "+n(_.value)+" - "+n(h.value),1)]),t("p",null,[e[8]||(e[8]=t("span",{class:"font-semibold text-gray-800"},"Saldo Inicial:",-1)),c(" R$ "+n(y.value),1)]),t("p",null,[e[9]||(e[9]=t("span",{class:"font-semibold text-gray-800"},"Entradas:",-1)),c(" R$ "+n(w.value),1)]),t("p",null,[e[10]||(e[10]=t("span",{class:"font-semibold text-gray-800"},"Saldo Final:",-1)),c(" R$ "+n(C.value),1)]),t("p",jt,[e[11]||(e[11]=t("span",{class:"font-semibold"},"CMV:",-1)),c(" R$ "+n(x.value),1)]),e[12]||(e[12]=t("p",null," Parâmetros: Saldo Inicial + Entradas nesse período - Saldo Final = Total CMV ",-1))]),t("button",{onClick:R,class:"mt-4 text-red-800 rounded-md transition"}," Fechar ")])])):J("",!0)]),t("div",Mt,[e[15]||(e[15]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Ticket médio",-1)),t("div",Dt," R$ "+n($.value),1),e[16]||(e[16]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",It,[e[17]||(e[17]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Pedidos",-1)),t("div",Vt,n(k.value),1),e[18]||(e[18]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",Et,[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold text-gray-700"},"Faturamento diário",-1)),t("div",St,[t("canvas",{ref_key:"barChart",ref:m},null,512)])])])])]),_:1}))}},Yt=tt(qt,[["__scopeId","data-v-8c61025f"]]);export{Yt as default};
