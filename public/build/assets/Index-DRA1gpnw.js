import{L}from"./LayoutFranqueado-Dw886fCe.js";import{d as i,j as D,i as C,e as r,o as n,f as p,a as t,F as M,h as I,t as w,k as b,m as P,s as j,b as v,c as y,w as z,u as S,Z as V}from"./app-BpJtz6--.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A}from"./AvisoSistemaNovo-CDHOIB_P.js";import{I as E}from"./InputModel-C-mF94Ir.js";import{_ as k}from"./LabelModel-C-tTOP4a.js";import{D as N}from"./Deslizante-BHoHKvHC.js";/* empty css                                                                   */const U={key:0,class:"loading-overlay"},B={class:"card-container"},F=["onClick"],q={class:"card-inner"},O={class:"icon-container"},Q={class:"icon-leaf"},T=["src"],K={class:"text-container"},R={class:"city"},Z={__name:"ListarMetodosPagamentos",emits:["dado-selecionado"],setup(x,{emit:u}){const f=u,l=i([]),_=i(""),a=i(!1),d=async()=>{a.value=!0;try{const o=await b.get("/api/metodos-pagamentos/lista");l.value=Object.values(o.data)}catch(o){console.error("Erro ao carregar os dados:",o)}finally{a.value=!1}},c=o=>o?new URL(o,window.location.origin).href:"/storage/images/no_imagem.svg";D(d);const g=o=>{f("dado-selecionado",o)},h=C(()=>{const o=_.value.toLowerCase();return l.value.filter(e=>String(e.id).toLowerCase().includes(o)||e.fornecedor_nome.toLowerCase().includes(o))});return(o,e)=>(n(),r("div",null,[a.value?(n(),r("div",U,e[0]||(e[0]=[t("div",{class:"spinner"},null,-1)]))):p("",!0),e[3]||(e[3]=t("div",{class:"painel-title"},"Métodos de pagamento",-1)),e[4]||(e[4]=t("div",{class:"painel-subtitle"},[t("p",null,"Ative formas de pagamento para o fluxo de caixa")],-1)),t("div",B,[(n(!0),r(M,null,I(h.value,s=>(n(),r("div",{key:s.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:m=>g(s)},[t("div",q,[t("div",O,[e[1]||(e[1]=t("div",{class:"icon-bg"},null,-1)),t("div",Q,[t("img",{src:c(s.img_icon),alt:"Ícone"},null,8,T)])]),t("div",K,[t("div",R,w(s.nome),1)]),e[2]||(e[2]=t("div",{class:"action-icon"},null,-1))])],8,F))),128))])]))}},G=$(Z,[["__scopeId","data-v-3609b031"]]),H={class:"elemento-fixo"},J={key:0},W={key:0,class:"loading-overlay"},X={class:"w-full h-[237px] p-12 bg-white rounded-[20px] flex-col justify-center items-center gap-10 inline-flex"},Y={class:"self-stretch text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[34px] tracking-tight"},ee={class:"w-full h-[63px] relative"},te={class:"mt-8 w-full p-12 bg-white rounded-[20px] flex justify-between items-center gap-5"},oe={class:"flex flex-col w-2/3"},ae={class:"text-sm font-semibold text-gray-700"},se={class:"w-1/2 flex justify-end"},ne={__name:"DetalhesMetodosPagamento",props:{dados:{type:Object,required:!0}},emits:["atualizar"],setup(x,{emit:u}){const f=P(),l=x,_=i(!1),a=i(0),d=i(!1),c=i(!1);let g=!1;const h=async()=>{c.value=!0;try{const e=await b.get(`/api/metodos-pagamentos/verificar-pagamentos/${l.dados.id}`);e.status===200&&e.data?(console.log("Dados recebidos:",e.data),a.value=e.data.data.porcentagem||0,d.value=e.data.data.status===1):(e.status===404||!e.data)&&(console.info("Nenhum método de pagamento encontrado para esta unidade."),a.value=0,d.value=!1)}catch(e){console.error("Erro ao buscar o método de pagamento:",e),a.value=0,d.value=!1}finally{c.value=!1}},o=async()=>{try{await new Promise(m=>setTimeout(m,2e3)),c.value=!0;const e={unidade_id:l.dados.id,default_payment_method_id:l.dados.id,porcentagem:a.value,status:d.value?1:0},s=await b.post("/api/metodos-pagamentos/upsert",e);g||(g=!0,f.success("Método atualizado",{onClose:()=>{g=!1}}))}catch(e){console.error("Erro ao atualizar o método de pagamento:",e)}finally{c.value=!1}};return j(()=>l.dados.id,()=>{h()}),D(()=>{h()}),(e,s)=>(n(),r("div",H,[_.value?p("",!0):(n(),r("div",J,[c.value?(n(),r("div",W,s[2]||(s[2]=[t("div",{class:"spinner"},null,-1)]))):p("",!0),t("div",X,[t("div",Y,w(x.dados.nome),1),t("div",ee,[v(k,{class:"font-semibold text-gray-900",text:"Quanto você paga de taxa?"}),v(E,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=m=>a.value=m),placeholder:"5%",onInput:o},null,8,["modelValue"])])]),t("div",te,[t("div",oe,[v(k,{class:"font-semibold text-gray-900",text:"Utilizar este método de pagamento?"}),t("span",ae,w(d.value?"Ativado":"Desativado"),1)]),t("div",se,[v(N,{status:d.value,"onUpdate:status":s[1]||(s[1]=m=>d.value=m),onClick:o},null,8,["status"])])])]))]))}},le=$(ne,[["__scopeId","data-v-84194dde"]]),de={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},ie={key:0},re={class:"flex flex-col gap-4"},ce={__name:"Index",setup(x){const u=i(null),f=i(0),l=i(!1),_=a=>{u.value=a};return(a,d)=>(n(),y(L,null,{default:z(()=>[v(S(V),{title:"Métodos de pagamentos"}),t("div",de,[l.value?p("",!0):(n(),r("div",ie,[(n(),y(G,{key:f.value,ref:"listaDados",onDadoSelecionado:_}))])),t("div",re,[l.value?p("",!0):(n(),r(M,{key:0},[u.value?(n(),y(le,{key:0,dados:u.value},null,8,["dados"])):p("",!0)],64))])]),v(A)]),_:1}))}},he=$(ce,[["__scopeId","data-v-af15d11b"]]);export{he as default};
