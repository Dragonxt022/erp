import{l as de,d as _,i as ie,o as s,e as c,a as e,j as R,s as Ue,F as j,g as M,t as h,b as C,h as w,v as D,w as G,f as E,p as Te,k as Q,y as Ve,q as Se,c as F,R as A,P as Fe,m as Me,u as Ie,Z as Le}from"./app-DLahf_Hr.js";import{_ as ce}from"./LabelModel-fySqtuRo.js";import{I as Oe}from"./InputModel-Dv40jhF2.js";import{B as Ne}from"./ButtonPrimary-CKWuLGuY.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as le}from"./ButtonPrimaryMedio-D87LOTv3.js";import{d as Be}from"./index-DhwclLOQ.js";import{B as Ce}from"./ButtonCancelar-DITp8ZTT.js";import{B as Ae}from"./ButtonEditeMedio--_paeVzO.js";import{L as Ge}from"./LayoutFranqueado-fYTxNu3s.js";import"./user-CkocNwRq.js";const Qe={key:0,class:"w-[100%] h-full flex flex-col p-4 bg-gray-50"},ze={class:"mb-6 relative"},Ke={class:"relative"},We=["value"],He={class:"w-full bg-white rounded-lg p-6 mb-6"},Je={class:"flex items-center"},Xe={class:"flex-shrink-0"},Ze=["src"],Ye={class:"ml-6"},et={class:"text-2xl font-semibold text-gray-800"},tt={key:0,class:"text-red-500 text-sm text-center"},ot={class:"relative flex items-center w-full"},rt={class:"flex justify-end space-x-4"},at={__name:"CadastrarInsumoEstoque",props:{produtoSelecionado:{type:Object,required:!1}},setup(t,{emit:o}){var N;const i=de(),l=o,u=t,g=_([]),f=_(""),v=_(""),x=_(((N=u.produtoSelecionado)==null?void 0:N.valor)||""),d=_(!1);_(!1);const p=_(!1),m=_(""),S=ie(()=>u.produtoSelecionado.unidadeDeMedida==="a_granel"?"Kg":"Quantidade"),I=ie(()=>u.produtoSelecionado.unidadeDeMedida==="a_granel"?"Digite o peso (ex: 1.5)":"Digite a quantidade"),r=()=>{if(!v.value.trim()){d.value=!1;return}let q=/^[0-9]+([.,][0-9]+)?$/;if(u.produtoSelecionado.unidadeDeMedida==="unidade"&&(q=/^[0-9]+$/),d.value=!q.test(v.value),["a_granel","quilo"].includes(u.produtoSelecionado.unidadeDeMedida)){let b=v.value.replace(/\D/g,""),k=b.slice(0,-3)||"0",B=b.slice(-3).padStart(3,"0");v.value=`${Number(k).toLocaleString("pt-BR")},${B}`}},a=()=>{const q=x.value.replace(/\D/g,""),b=q.slice(0,-2)||"0",k=q.slice(-2).padStart(2,"0");x.value=`R$ ${Number(b).toLocaleString("pt-BR")},${k}`},n=()=>{v.value="",x.value=""};(async()=>{try{const q=await Q.get("/api/estoque/fornecedores");g.value=q.data.data.map(b=>({id:b.id||"N/D",razao_social:b.razao_social||"N/D"}))}catch(q){console.error("Erro ao carregar fornecedores:",q)}})();const T=q=>q?new URL(q,window.location.origin).href:"/storage/images/no_imagem.svg",L=()=>(m.value="",f.value?!v.value||d.value?(i.error("Quantidade inválida."),m.value="Quantidade inválida.",!1):!x.value||p.value?(i.error("Valor inválido."),m.value="Valor inválido.",!1):!0:(i.error("Fornecedor não selecionado."),m.value="Fornecedor não selecionado.",!1)),V=()=>{if(!L())return;const q={...u.produtoSelecionado,fornecedor_id:f.value,quantidade:v.value,valor:x.value,unidade_de_medida:u.produtoSelecionado.unidadeDeMedida};i.success("Inusmo adicionado"),n(),l("adicionarAoCarrinho",q)};return(q,b)=>t.produtoSelecionado?(s(),c("div",Qe,[b[5]||(b[5]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",ze,[e("div",Ke,[R(e("select",{"onUpdate:modelValue":b[0]||(b[0]=k=>f.value=k),id:"fornecedor",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-green-600 focus:ring-2 focus:ring-green-500 font-['Figtree']"},[b[3]||(b[3]=e("option",{value:"",disabled:""},"Selecione um fornecedor",-1)),(s(!0),c(j,null,M(g.value,k=>(s(),c("option",{key:k.id,value:k.id},h(k.razao_social),9,We))),128))],512),[[Ue,f.value]])])]),e("div",He,[e("div",Je,[e("div",Xe,[e("img",{src:T(t.produtoSelecionado.profile_photo),alt:"Foto do Produto",class:"w-24 h-24 rounded-lg"},null,8,Ze)]),e("div",Ye,[e("div",et,h(t.produtoSelecionado.nome||"N/A"),1)])])]),e("form",{onSubmit:Te(V,["prevent"]),class:"space-y-4"},[e("div",null,[C(ce,{text:S.value},null,8,["text"]),C(Oe,{modelValue:v.value,"onUpdate:modelValue":b[1]||(b[1]=k=>v.value=k),placeholder:I.value,onInput:r},null,8,["modelValue","placeholder"]),d.value?(s(),c("p",tt," Insira um valor válido. ")):w("",!0)]),e("div",null,[C(ce,{text:"Valor"}),e("div",ot,[R(e("input",{"onUpdate:modelValue":b[2]||(b[2]=k=>x.value=k),placeholder:"R$ 0,00",onInput:a,class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},null,544),[[D,x.value]])])]),e("div",rt,[C(Ne,{onClick:V},{default:G(()=>b[4]||(b[4]=[E("Adicionar")])),_:1})])],32)])):w("",!0)}},nt=U(at,[["__scopeId","data-v-299cbcb1"]]),st={class:"flex gap-5"},it={key:0,class:"loading-overlay"},dt={class:"flex-1"},lt={class:"min-w-full table-auto"},ut=["onDblclick"],ct={class:"px-6 py-4 text-[16px] text-left text-gray-900 font-semibold"},ft={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-center"},pt=["onUpdate:modelValue"],vt={key:1},mt={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-left"},gt={key:0},xt=["onUpdate:modelValue"],_t={key:2},ht={class:"px-6 py-4 text-[16px] text-gray-500 text-center"},bt=["onUpdate:modelValue"],yt={key:1},$t={class:"px-6 py-4 text-center"},wt=["onClick"],kt={key:0,class:"botao-container"},qt={__name:"ResumoCarrinho",props:{carrinho:{type:Array,required:!0}},emits:["confirmar","cancelar"],setup(t,{emit:o}){const i=de(),l=t,u=o,g=_(!1),f=_(!1),v=_(null),x=r=>{l.carrinho.splice(r,1),i.info("Item removido com sucesso!")},d=r=>{v.value=r},p=r=>{const a=parseFloat(r.valor.replace("R$","").replace(/\./g,"").replace(",",".")),n=parseFloat(r.quantidade.replace(/\./g,"").replace(",","."));return n>0?a/n:0},m=r=>{const a=parseFloat(r.quantidade.replace(/\./g,"").replace(",","."));if(r.unidadeDeMedida==="a_granel"||r.unidadeDeMedida==="quilo")return p(r)*a||0;{const n=parseFloat(r.valor.replace("R$","").replace(/\./g,"").replace(",","."));return a*n}},S=async()=>{var r;g.value=!0,f.value=!0;try{const a={fornecedor_id:((r=l.carrinho[0])==null?void 0:r.fornecedor_id)||null,itens:l.carrinho.map(y=>({id:y.id,nome:y.nome,quantidade:y.quantidade,unidadeDeMedida:y.unidadeDeMedida,valorUnitario:parseFloat(y.valor.replace("R$","").replace(",",".")),total:parseFloat(m(y).toFixed(2))}))};console.log("Dados enviados:",JSON.stringify(a,null,2));const n=await axios.post("/api/estoque/armazenar-entrada",a);n.status===201?(console.log("Resposta da API:",n.data),Be.Inertia.visit(route("franqueado.inventario")),i.success("Lista de insumos salvas em seu estoque.")):i.error("Erro ao salvar no estoque, tente novamente.")}catch(a){console.error("Erro ao enviar entrada:",a),i.error("Erro ao confirmar entrada. Tente novamente ou chame o suporte.")}finally{g.value=!1}},I=()=>{u("cancelar")};return(r,a)=>(s(),c("div",st,[g.value?(s(),c("div",it,a[0]||(a[0]=[e("div",{class:"spinner"},null,-1)]))):w("",!0),a[3]||(a[3]=e("div",{class:"flex-1"},[e("div",{class:"painel-title"},"Confirmar entrada"),e("div",{class:"painel-subtitle"},[e("p",null,"Vamos conferir se está tudo certo")]),e("div",{class:"mt-[25%] text-[#6d6d6d] text-[18px] font-normal font-['Figtree'] leading-[23px] tracking-tight"},[E(" Você confirma que está "),e("br"),E(" realizando uma nova entrada "),e("br"),E(" com os seguintes itens? ")])],-1)),e("div",dt,[e("table",lt,[a[2]||(a[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-xs text-left font-medium text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," Item "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," QTD. "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," V. UN/KG "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," TOTAL "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider TrRedonDireita"}," AÇÃO ")])],-1)),e("tbody",null,[(s(!0),c(j,null,M(t.carrinho,(n,y)=>(s(),c("tr",{key:n.id,onDblclick:T=>d(y)},[e("td",ct,h(n.nome),1),e("td",ft,[v.value===y?R((s(),c("input",{key:0,type:"number","onUpdate:modelValue":T=>n.quantidade=T,class:"border border-gray-300 rounded px-2 py-1 w-16"},null,8,pt)),[[D,n.quantidade,void 0,{number:!0}]]):(s(),c("span",vt,h(n.quantidade)+" "+h(n.unidadeDeMedida==="a_granel"?"KG":"UN"),1))]),e("td",mt,[n.unidadeDeMedida==="a_granel"?(s(),c("span",gt," R$ "+h(p(n).toFixed(2)),1)):v.value===y?R((s(),c("input",{key:1,type:"text","onUpdate:modelValue":T=>n.valor=T,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,xt)),[[D,n.valor]]):(s(),c("span",_t,h(n.valor),1))]),e("td",ht,[v.value===y&&n.unidadeDeMedida==="a_granel"?R((s(),c("input",{key:0,type:"number","onUpdate:modelValue":T=>n.valorTotal=T,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,bt)),[[D,n.valorTotal,void 0,{number:!0}]]):(s(),c("span",yt,h(m(n).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1))]),e("td",$t,[e("button",{onClick:T=>x(y),class:"w-[16] h-[16]"},a[1]||(a[1]=[e("img",{src:"/storage/images/delete.svg",alt:"icone de excluir",class:"w-[16px] h-[16px]"},null,-1)]),8,wt)])],40,ut))),128))])]),f.value?w("",!0):(s(),c("div",kt,[C(Ce,{text:"Voltar",onClick:I}),C(le,{text:"Confirmar",onClick:S})]))])]))}},Tt=U(qt,[["__scopeId","data-v-7cd40a79"]]),St={key:0},It={key:0,class:"sidebar-container"},Ct={key:0,class:"loading-overlay"},Pt={key:1,class:"flex"},Rt={class:"flex-1 p-4"},jt={class:"relative flex items-center w-full mb-4"},Dt={class:"space-y-4 compromissos-container overflow-hidden"},Et=["onClick"],Ut={class:"flex-shrink-0"},Vt=["src"],Ft={class:"ml-4 flex-1"},Mt={class:"text-lg font-semibold flex items-center"},Lt={key:0,class:"ml-5 text-xs bg-green-100 text-green-600 font-bold rounded-full px-2 py-1"},Ot={key:1,class:"mr-2 ml-5 text-yellow-500",title:"Essa estrela sigifinica que esse insumo e um produto princial"},Nt={class:"absolute bottom-4 right-4 mt-5 botao-container"},Bt={class:"flex-1 p-4"},At={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},setup(t){const o=_([]),i=_(""),l=_(!1),u=_(null),g=_([]),f=_(!1),v=()=>{console.log("Entrada confirmada",g.value),mostrarModalRevisao.value=!1,g.value=[]},x=async()=>{l.value=!0;try{const r=await Q.get("/api/produtos/lista");o.value=r.data}catch(r){console.error("Erro ao carregar os produtos:",r)}finally{l.value=!1}},d=r=>r?new URL(r,window.location.origin).href:"/storage/images/no_imagem.svg",p=r=>{u.value=r},m=r=>g.value.filter(a=>a.id===r).length,S=r=>{g.value.push(r),u.value=null},I=ie(()=>o.value.filter(r=>r.nome.toLowerCase().includes(i.value.toLowerCase())));return Ve(x),(r,a)=>(s(),c(j,null,[C(Se,{name:"fade"},{default:G(()=>[f.value?w("",!0):(s(),c("div",St,[t.isVisible?(s(),c("div",It,[l.value?(s(),c("div",Ct,a[3]||(a[3]=[e("div",{class:"spinner"},null,-1)]))):(s(),c("div",Pt,[e("div",Rt,[a[5]||(a[5]=e("div",{class:"painel-title"},"Nova entrada",-1)),a[6]||(a[6]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",jt,[a[4]||(a[4]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),R(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=n=>i.value=n),placeholder:"Buscar um produto",class:"pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[D,i.value]])]),e("div",Dt,[(s(!0),c(j,null,M(I.value,n=>(s(),c("div",{key:n.id,class:"flex items-center p-4 bg-white rounded-lg cursor-pointer",onClick:y=>p(n)},[e("div",Ut,[e("img",{src:d(n.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,Vt)]),e("div",Ft,[e("div",Mt,[E(h(n.nome)+" ",1),m(n.id)>0?(s(),c("span",Lt,h(m(n.id)),1)):w("",!0),n.estrela?(s(),c("span",Ot," ★ ")):w("",!0)])])],8,Et))),128))])]),e("div",Nt,[C(le,{text:"Finalizar",onClick:a[1]||(a[1]=n=>f.value=!0),iconPath:"/storage/images/arrow_left_alt.svg"})]),e("div",Bt,[C(nt,{produtoSelecionado:u.value,onAdicionarAoCarrinho:S},null,8,["produtoSelecionado"])])]))])):w("",!0)]))]),_:1}),f.value?(s(),F(Tt,{key:0,carrinho:g.value,onConfirmar:v,onCancelar:a[2]||(a[2]=n=>f.value=!1)},null,8,["carrinho"])):w("",!0)],64))}},Gt=U(At,[["__scopeId","data-v-ded827eb"]]);var K,fe;function Pe(){if(fe)return K;fe=1;function t(o){var i=typeof o;return o!=null&&(i=="object"||i=="function")}return K=t,K}var W,pe;function Qt(){if(pe)return W;pe=1;var t=typeof A=="object"&&A&&A.Object===Object&&A;return W=t,W}var H,ve;function Re(){if(ve)return H;ve=1;var t=Qt(),o=typeof self=="object"&&self&&self.Object===Object&&self,i=t||o||Function("return this")();return H=i,H}var J,me;function zt(){if(me)return J;me=1;var t=Re(),o=function(){return t.Date.now()};return J=o,J}var X,ge;function Kt(){if(ge)return X;ge=1;var t=/\s/;function o(i){for(var l=i.length;l--&&t.test(i.charAt(l)););return l}return X=o,X}var Z,xe;function Wt(){if(xe)return Z;xe=1;var t=Kt(),o=/^\s+/;function i(l){return l&&l.slice(0,t(l)+1).replace(o,"")}return Z=i,Z}var Y,_e;function je(){if(_e)return Y;_e=1;var t=Re(),o=t.Symbol;return Y=o,Y}var ee,he;function Ht(){if(he)return ee;he=1;var t=je(),o=Object.prototype,i=o.hasOwnProperty,l=o.toString,u=t?t.toStringTag:void 0;function g(f){var v=i.call(f,u),x=f[u];try{f[u]=void 0;var d=!0}catch{}var p=l.call(f);return d&&(v?f[u]=x:delete f[u]),p}return ee=g,ee}var te,be;function Jt(){if(be)return te;be=1;var t=Object.prototype,o=t.toString;function i(l){return o.call(l)}return te=i,te}var oe,ye;function Xt(){if(ye)return oe;ye=1;var t=je(),o=Ht(),i=Jt(),l="[object Null]",u="[object Undefined]",g=t?t.toStringTag:void 0;function f(v){return v==null?v===void 0?u:l:g&&g in Object(v)?o(v):i(v)}return oe=f,oe}var re,$e;function Zt(){if($e)return re;$e=1;function t(o){return o!=null&&typeof o=="object"}return re=t,re}var ae,we;function Yt(){if(we)return ae;we=1;var t=Xt(),o=Zt(),i="[object Symbol]";function l(u){return typeof u=="symbol"||o(u)&&t(u)==i}return ae=l,ae}var ne,ke;function eo(){if(ke)return ne;ke=1;var t=Wt(),o=Pe(),i=Yt(),l=NaN,u=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,f=/^0o[0-7]+$/i,v=parseInt;function x(d){if(typeof d=="number")return d;if(i(d))return l;if(o(d)){var p=typeof d.valueOf=="function"?d.valueOf():d;d=o(p)?p+"":p}if(typeof d!="string")return d===0?d:+d;d=t(d);var m=g.test(d);return m||f.test(d)?v(d.slice(2),m?2:8):u.test(d)?l:+d}return ne=x,ne}var se,qe;function to(){if(qe)return se;qe=1;var t=Pe(),o=zt(),i=eo(),l="Expected a function",u=Math.max,g=Math.min;function f(v,x,d){var p,m,S,I,r,a,n=0,y=!1,T=!1,L=!0;if(typeof v!="function")throw new TypeError(l);x=i(x)||0,t(d)&&(y=!!d.leading,T="maxWait"in d,S=T?u(i(d.maxWait)||0,x):S,L="trailing"in d?!!d.trailing:L);function V($){var P=p,O=m;return p=m=void 0,n=$,I=v.apply(O,P),I}function N($){return n=$,r=setTimeout(k,x),y?V($):I}function q($){var P=$-a,O=$-n,ue=x-P;return T?g(ue,S-O):ue}function b($){var P=$-a,O=$-n;return a===void 0||P>=x||P<0||T&&O>=S}function k(){var $=o();if(b($))return B($);r=setTimeout(k,q($))}function B($){return r=void 0,L&&p?V($):(p=m=void 0,I)}function De(){r!==void 0&&clearTimeout(r),n=0,p=a=m=r=void 0}function Ee(){return r===void 0?I:B(o())}function z(){var $=o(),P=b($);if(p=arguments,m=this,a=$,P){if(r===void 0)return N(a);if(T)return clearTimeout(r),r=setTimeout(k,x),V(a)}return r===void 0&&(r=setTimeout(k,x)),I}return z.cancel=De,z.flush=Ee,z}return se=f,se}var oo=to();const ro=Fe(oo),ao={key:0,class:"sidebar-container"},no={key:0,class:"loading-overlay"},so={key:1},io={class:"w-full h-[80%] bg-white rounded-[20px] p-12"},lo={class:"relative w-full h-full"},uo={class:"flex items-center"},co={class:"w-1/1 flex justify-center"},fo=["src"],po={class:"w-2/3 pl-5"},vo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},mo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},go={class:"mt-5"},xo={class:"min-w-full table-auto"},_o={class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonDireita"},ho={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},bo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},yo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},$o=["onUpdate:modelValue","onInput"],wo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},ko={class:"flex justify-left mt-12"},qo={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(t,{emit:o}){const i=de(),l=t,u=o,g=_(""),f=_(""),v=_(!1),x=_(!1),d=_("");Me(()=>l.produto,r=>{r&&(g.value=r.nome||"",f.value=r.categoria||"")},{immediate:!0});const p=r=>r?new URL(r,window.location.origin).href:"/storage/images/no_imagem.svg",m=ro(r=>{Q.put(`/api/estoque/estoque/lote/${r.id}`,{quantidade:r.quantidade}).then(a=>{i.success("Quantidade do lote atualizada!")}).catch(a=>{i.error("Erro ao atualizar o lote.")})},1e3),S=r=>{d.value=r,x.value=!0},I=()=>{u("cancelar")};return(r,a)=>(s(),F(Se,{name:"fade"},{default:G(()=>[t.isVisible?(s(),c("div",ao,[v.value?(s(),c("div",no,a[1]||(a[1]=[e("div",{class:"spinner"},null,-1)]))):(s(),c("div",so,[e("div",io,[e("div",lo,[e("div",uo,[e("div",co,[e("img",{src:p(t.produto.profile_photo),alt:"Foto do Produto",class:"w-20 h-20 rounded-md shadow-lg"},null,8,fo)]),e("div",po,[e("div",vo,[E(h(t.produto.nome||"N/A")+" ",1),e("div",mo,h(t.produto.unidadeDeMedida==="a_granel"&&t.produto.valor_pago_por_quilo_lote?t.produto.valor_pago_por_quilo_lote:t.produto.valor_total_lote),1)])])])])]),e("form",{onSubmit:a[0]||(a[0]=Te(n=>S("Atualizar este produto?"),["prevent"]))},[e("div",go,[e("table",xo,[e("thead",null,[e("tr",null,[a[2]||(a[2]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),a[3]||(a[3]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," Fornecedor ",-1)),a[4]||(a[4]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," qtd ",-1)),e("th",_o,h(t.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1)])]),e("tbody",null,[(s(!0),c(j,null,M(t.produto.lotes,n=>(s(),c("tr",{key:n.id},[e("td",ho,h(n.data),1),e("td",bo,h(n.fornecedor),1),e("td",yo,[R(e("input",{"onUpdate:modelValue":y=>n.quantidade=y,type:"number",min:"0",class:"border rounded-lg px-2 py-1 w-[75px] h-[32px] text-center",onInput:y=>Ie(m)(n)},null,40,$o),[[D,n.quantidade]])]),e("td",wo,h(n.preco_unitario),1)]))),128))])])]),e("div",ko,[C(Ce,{text:"Voltar",onClick:I})])],32)]))])):w("",!0)]),_:1}))}},To=U(qo,[["__scopeId","data-v-9ad6d994"]]),So={class:"elemento-fixo"},Io={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Co={class:"relative w-full h-full"},Po={class:"flex items-center"},Ro={class:"w-1/1 flex justify-center"},jo=["src"],Do={class:"w-2/3 pl-5"},Eo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Uo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},Vo={key:1,class:""},Fo={class:"mt-8"},Mo={class:"min-w-full table-auto"},Lo={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Oo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},No={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Bo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ao={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Go={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Qo={key:0,class:"mt-4"},zo={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},emits:["atualizar"],setup(t,{emit:o}){const i=o,l=_(!1),u=_(!1),g=()=>{_.dadosProduto.fetchProduto()},f=d=>d?new URL(d,window.location.origin).href:"/storage/images/no_imagem.svg",v=()=>{u.value=!u.value,l.value=!1},x=()=>{i("atualizar"),u.value=!1,l.value=!0};return(d,p)=>(s(),c("div",So,[u.value?w("",!0):(s(),c("div",Io,[e("div",Co,[e("div",Po,[e("div",Ro,[e("img",{src:f(t.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,jo)]),e("div",Do,[e("div",Eo,[E(h(t.produto.nome||"N/A")+" ",1),e("div",Uo,h(t.produto.unidadeDeMedida==="a_granel"&&t.produto.valor_pago_por_quilo_lote?t.produto.valor_pago_por_quilo_lote:t.produto.valor_total_lote),1)])])])])])),u.value?w("",!0):(s(),c("div",Vo,[e("div",Fo,[e("table",Mo,[e("thead",null,[e("tr",null,[p[0]||(p[0]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),p[1]||(p[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),p[2]||(p[2]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),e("th",Lo,h(t.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),p[3]||(p[3]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),e("tbody",null,[(s(!0),c(j,null,M(t.produto.lotes,(m,S)=>(s(),c("tr",{key:S,class:"text-center"},[e("td",Oo,h(m.data),1),e("td",No,h(m.fornecedor),1),e("td",Bo,h(m.quantidade)+" "+h(t.produto.unidadeDeMedida==="unitario"?"uni":"kg"),1),e("td",Ao,h(t.produto.unidadeDeMedida==="unitario"?m.preco_unitario:m.valor_pago_por_quilo),1),e("td",Go,h(t.produto.unidadeDeMedida==="unitario"?m.valor_total:m.preco_unitario),1)]))),128))])])]),t.produto.id&&!u.value?(s(),c("div",Qo,[C(Ae,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:v,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):w("",!0)])),u.value?(s(),F(To,{key:2,ref:"dadosProduto",isVisible:u.value,produto:t.produto,onDadosProduto:g,onCancelar:x},null,8,["isVisible","produto"])):w("",!0)]))}},Ko=U(zo,[["__scopeId","data-v-1594529a"]]),Wo={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const t=await Q.get("/api/estoque/lista");console.log("Produtos carregados:",t.data),this.produtos=Object.values(t.data)}catch(t){console.error("Erro ao carregar os produtos:",t)}},getProfilePhotoUrl(t){return t?new URL(t,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(t){this.$emit("produto-selecionado",t)},getQuantidadeTotal(t){return Array.isArray(t)?t.reduce((o,i)=>o+(i.quantidade||0),0):(console.warn("getQuantidadeTotal recebeu um valor inválido:",t),0)}},computed:{filteredProdutos(){const t=this.searchQuery.toLowerCase();return this.produtos.filter(o=>o.nome.toLowerCase().includes(t))}}},Ho={class:"search-container relative flex items-center w-full mb-4"},Jo={class:"card-container compromissos-container overflow-hidden"},Xo=["onClick"],Zo={class:"card-inner"},Yo={class:"icon-container"},er={class:"icon-leaf"},tr=["src"],or={class:"text-container flex justify-between items-center p-2"},rr={class:"city"},ar={class:"quantidade text-gray-600 font-semibold"},nr={class:"text-gray-600 font-semibold"};function sr(t,o,i,l,u,g){return s(),c("div",null,[o[3]||(o[3]=e("div",{class:"painel-title"},"Inventário da loja",-1)),o[4]||(o[4]=e("div",{class:"painel-subtitle"},[e("p",null,"Verifique a quantidade de cada item")],-1)),e("div",Ho,[o[1]||(o[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),R(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=f=>u.searchQuery=f),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[D,u.searchQuery]])]),e("div",Jo,[(s(!0),c(j,null,M(g.filteredProdutos,f=>(s(),c("div",{key:f.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:v=>g.selecionarProduto(f)},[e("div",Zo,[e("div",Yo,[o[2]||(o[2]=e("div",{class:"icon-bg"},null,-1)),e("div",er,[e("img",{src:g.getProfilePhotoUrl(f.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,tr)])]),e("div",or,[e("div",rr,h(f.nome),1),e("div",ar,[e("div",nr,h(g.getQuantidadeTotal(f.lotes))+" "+h(f.unidadeDeMedida==="unitario"?"uni":"kg"),1)])])])],8,Xo))),128))])])}const ir=U(Wo,[["render",sr],["__scopeId","data-v-81dedca2"]]),dr={key:0,class:"mt-6"},lr={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},ur={key:0},cr={class:"flex flex-col gap-4"},fr={key:1,class:"absolute bottom-4 right-4 botao-container"},pr={__name:"Index",setup(t){const o=_(null),i=_(0),l=_(!1),u=_(!1),g=()=>{l.value=!l.value},f=()=>{console.log("atualizando a lista"),o.value=null,i.value+=1},v=()=>{x(),l.value=!1},x=()=>{var m;(m=_("listarUnidades").value)==null||m.fetchUnidades()},d=p=>{p&&typeof p=="object"?o.value=p:console.warn("Dados inválidos recebidos no evento produto-selecionado:",p)};return(p,m)=>(s(),F(Ge,null,{default:G(()=>[C(Ie(Le),{title:"Insumos"}),l.value?(s(),c("div",dr,[C(Gt,{isVisible:l.value,onUnidadeCadastrada:v,onCancelar:g},null,8,["isVisible"])])):w("",!0),e("div",lr,[l.value?w("",!0):(s(),c("div",ur,[(s(),F(ir,{key:i.value,ref:"listarUnidades",onUnidadeCadastrada:x,onProdutoSelecionado:d}))])),e("div",cr,[l.value?w("",!0):(s(),c(j,{key:0},[o.value?(s(),F(Ko,{key:0,onAtualizar:f,produto:o.value},null,8,["produto"])):w("",!0),u.value?w("",!0):(s(),c("div",fr,[C(le,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:g})]))],64))])])]),_:1}))}},qr=U(pr,[["__scopeId","data-v-65e679f0"]]);export{qr as default};
