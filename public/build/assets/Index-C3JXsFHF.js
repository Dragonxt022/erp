import{d as n,i as R,o as f,e as g,a as t,t as d,h as q,F as O,g as S,n as V,y as B,c as L,w as P,b as A,u as z,Z as N}from"./app-BZjZIgR3.js";import{d as T}from"./index-C3T0sxka.js";import{C as I,r as Q}from"./chart-C6b6o4TJ.js";import{L as U}from"./LayoutFranqueado-BHUkhYyu.js";import{d as h}from"./dayjs.min-t_CAx_xf.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-CArEvR6n.js";const Z={class:"relative"},K={key:0},G={key:0,class:"absolute z-10 bg-white border rounded-xl shadow-lg w-[300px] p-4 left-[68px] transform -translate-x-1/2"},H={class:"flex justify-between items-center mb-3"},J={class:"font-semibold flex items-center"},X={class:"ml-[90px]"},tt={class:"grid grid-cols-7 gap-1 text-center text-sm"},et=["onClick"],st={__name:"CalendarFilterDiaPainel",setup(E,{emit:_}){const v=_,p=n(!1),i=n(h().startOf("month")),r=n(h().endOf("month")),x=n(h()),Y=["D","S","T","Q","Q","S","S"],$=R(()=>{const s=[],c=x.value.startOf("month"),l=x.value.endOf("month");for(let u=0;u<c.day();u++)s.push({day:"",date:null});for(let u=1;u<=l.date();u++){const b=c.date(u);s.push({day:u,date:b})}return s}),y=s=>s&&(s.isSame(i.value)||s.isSame(r.value)),w=s=>!s||!i.value||!r.value?!1:s.isAfter(i.value,"day")&&s.isBefore(r.value,"day")||s.isSame(i.value,"day")||s.isSame(r.value,"day"),k=s=>{s&&(i.value.isAfter(r.value)?i.value=s.startOf("day"):r.value=s.endOf("day"))},D=()=>{C(),p.value=!1},j=()=>{p.value=!p.value},F=()=>{const s=i.value.format("DD-MM-YYYY"),c=r.value.format("DD-MM-YYYY");console.log("Data inicial:",s),console.log("Data final:",c),v("update-filters",{startDate:s,endDate:c}),p.value=!1},C=()=>{i.value=h().startOf(""),r.value=h().endOf("")};return(s,c)=>(f(),g("div",Z,[t("div",{class:"flex items-center justify-between p-3 rounded-md cursor-pointer",onClick:j},[t("span",null,[i.value&&r.value?(f(),g("span",K,d(i.value.format("DD/MM/YYYY"))+" - "+d(r.value.format("DD/MM/YYYY")),1)):q("",!0)])]),p.value?(f(),g("div",G,[t("div",H,[t("button",{onClick:c[0]||(c[0]=(...l)=>s.prevMonth&&s.prevMonth(...l)),class:"p-2 rounded hover:bg-gray-300"}," < "),t("span",J,[t("span",null,d(x.value.format("MMM")),1),t("span",X,d(x.value.format("YYYY")),1)]),t("button",{onClick:c[1]||(c[1]=(...l)=>s.nextMonth&&s.nextMonth(...l)),class:"p-2 rounded hover:bg-gray-300"}," > ")]),t("div",tt,[(f(),g(O,null,S(Y,l=>t("div",{class:"font-semibold text-gray-600",key:l},d(l),1)),64)),(f(!0),g(O,null,S($.value,(l,u)=>(f(),g("div",{key:u,onClick:b=>k(l.date),class:V(["p-2 rounded-full cursor-pointer",y(l.date)?"bg-[#6db631] text-white":w(l.date)?"bg-[#b3dca6]":"hover:bg-gray-200"])},d(l.day),11,et))),128))]),t("div",{class:"w-full mt-4 flex justify-between items-center"},[t("div",{class:"h-10 rounded-full flex justify-center items-center px-3 py-2.5 cursor-pointer text-[#6db631] text-[15px] font-semibold font-['Figtree'] leading-tight",onClick:C}," Limpar "),t("div",{class:"flex gap-2"},[t("div",{class:"h-10 rounded-full flex justify-center items-center px-3 py-2.5 cursor-pointer text-[#6db631] text-[15px] font-semibold font-['Figtree'] leading-tight",onClick:D}," Cancelar "),t("div",{class:"h-10 rounded-full flex justify-center items-center px-3 py-2.5 cursor-pointer text-[#6db631] text-[15px] font-semibold font-['Figtree'] leading-tight",onClick:F}," OK ")])])])):q("",!0)]))}},at={class:"flex justify-between items-center mb-4"},ot={class:"text-[#262a27] text-[15px] font-semibold font-['Figtree'] leading-tight"},nt={class:"flex items-center space-x-2"},lt={class:"text-gray-900 text-[17px] font-semibold"},it={class:"mt-5"},rt={class:"grid grid-cols-3 grid-rows-1 gap-4"},dt={class:"row-span-3"},ct={class:"bg-white rounded-lg p-5"},ut={class:"compromissos-container flex flex-col gap-2 overflow-hidden"},ft={class:"flex flex-col"},pt={class:"text-[14px] font-medium text-gray-900"},mt={class:"text-sm text-gray-600"},gt=["src","alt"],xt={class:"bg-white rounded-lg p-7"},vt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},bt={class:"bg-white rounded-lg p-7"},ht={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},_t={class:"bg-white rounded-lg p-7"},yt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},wt={class:"bg-white rounded-lg p-4"},kt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},Dt={class:"bg-white rounded-lg p-4 col-span-3"},Ft={class:"w-full h-[220px]"},Ct={__name:"Index",setup(E){I.register(...Q);const _=n(null),v=n(null),p=n([]),i=n([]),r=n([]),x=n("0,00"),Y=n("0,00"),$=n("0,00"),y=n("0,00"),w=n("0,00"),k=n(0),D=n("0,00"),j=()=>{T.Inertia.replace(route("franqueado.contasApagar"))},F=async(a=null,e=null)=>{try{let o="/api/painel-analitycos/calcular-cmv-caixas-tickets";const M=[];a&&M.push(`start_date=${a}`),e&&M.push(`end_date=${e}`),M.length>0&&(o+=`?${M.join("&")}`);const m=(await axios.get(o)).data;m.saldo_estoque_inicial?(x.value=m.saldo_estoque_inicial||"0,00",Y.value=m.entradas_durante_periodo||"0,00",$.value=m.saldo_estoque_final||"0,00",y.value=m.cmv||"0,00",w.value=m.total_caixas||"0,00",k.value=m.quantidade_pedidos||0,D.value=m.ticket_medio||"0,00",b()):console.warn("Dados analíticos não encontrados.")}catch(o){console.error("Erro ao buscar dados analíticos:",o)}};B(()=>{F(),c(),s()});const C=a=>{console.log("Filtros atualizados:",a);const{startDate:e,endDate:o}=a;F(e,o)},s=async()=>{try{const a=await axios.get("/api/cursto/listar-contas-a-pagar");r.value=a.data.data}catch(a){console.error("Erro ao carregar os dados:",a)}},c=async()=>{try{const e=(await axios.get("/api/painel-analitycos/faturamento-por-semana")).data;e.faturamento&&(i.value=e.faturamento.map(o=>o.dia),p.value=e.faturamento.map(o=>o.total),b())}catch(a){console.error("Erro ao buscar dados:",a)}},l=a=>{const e=a.split("-");return`${e[2]}/${e[1]}/${e[0]}`},u=a=>a==="pendente"?"/storage/images/check_circle_laranja.svg":"/storage/images/check_circle_verde.svg",b=()=>{v.value&&v.value.destroy(),v.value=new I(_.value.getContext("2d"),{type:"bar",data:{labels:i.value,datasets:[{label:"Faturamento Diário",data:p.value,backgroundColor:"rgba(75, 192, 75, 0.6)",borderColor:"rgba(75, 192, 75, 1)",borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return a>=1e3?`${a/1e3}mil`:a}}}}}})};return(a,e)=>(f(),L(U,null,{default:P(()=>[A(z(N),{title:"Painel"}),t("div",at,[e[1]||(e[1]=t("div",null,[t("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Visão geral da loja "),t("div",{class:"painel-subtitle"},[t("p",{class:"text-sm sm:text-base md:text-lg"}," Acompanhe o desempenho geral ")])],-1)),t("div",ot,[t("div",nt,[e[0]||(e[0]=t("img",{src:"/storage/images/calendar_month.svg",alt:"Filtro",class:"w-5 h-5"},null,-1)),t("span",lt,[A(st,{onUpdateFilters:C})])])])]),t("div",it,[t("div",rt,[t("div",dt,[t("div",ct,[e[2]||(e[2]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-2"}," Compromissos ",-1)),t("div",ut,[(f(!0),g(O,null,S(r.value,o=>(f(),g("div",{key:o.id,onClick:j,class:"flex justify-between items-center bg-[#F5FAF4] p-3 rounded-lg cursor-pointer hover:bg-gray-100 transition-all ease-in-out duration-300"},[t("div",ft,[t("p",pt,d(o.nome),1),t("p",mt,d(o.valor_formatado)+" - Vencimento "+d(l(o.vencimento)),1)]),t("div",null,[t("img",{src:u(o.status),alt:"Status: "+o.status,class:"w-6 h-6 object-contain transition-transform transform hover:scale-105"},null,8,gt)])]))),128))])])]),t("div",xt,[e[3]||(e[3]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Faturamento",-1)),t("div",vt," R$ "+d(w.value),1),e[4]||(e[4]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",bt,[e[5]||(e[5]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"CMV",-1)),t("div",ht," R$ "+d(y.value),1),e[6]||(e[6]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",_t,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Ticket médio",-1)),t("div",yt," R$ "+d(D.value),1),e[8]||(e[8]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",wt,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Pedidos",-1)),t("div",kt,d(k.value),1),e[10]||(e[10]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",Dt,[e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-700"}," Faturamento diário ",-1)),t("div",Ft,[t("canvas",{ref_key:"barChart",ref:_},null,512)])])])])]),_:1}))}},It=W(Ct,[["__scopeId","data-v-3f97c3a5"]]);export{It as default};
