import{d as i,Q as V,j as B,a0 as E,c as T,o as d,w as N,b as x,a as e,e as c,u as M,Z,f as Q,F as W,h as z,t as n,k as h}from"./app-Dv-t-2ap.js";import{C as S,r as G}from"./chart-CX66tr7T.js";import{A as H}from"./LayoutFranqueadora-D-Ci0_wi.js";import{U as J}from"./UnidadeSelectorDropdown-C_fBU8kw.js";import{_ as K}from"./CalendarSimples2-BcTfDNDc.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./dayjs.min-LkPhaykg.js";import"./pt-br-BVmHx1ou.js";const X={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4"},Y={class:"flex flex-col sm:flex-row gap-3 w-full md:w-auto"},ee={class:"w-full sm:w-64"},te={class:"text-[#262a27] text-[15px] font-semibold font-['Figtree'] leading-tight"},ae={class:"flex items-center space-x-2"},se={class:"text-gray-900 text-[17px] font-semibold"},oe={key:0,class:"flex justify-center items-center py-20"},ne={key:1,class:"mt-5"},ie={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},re={class:"md:row-span-3"},de={class:"bg-white rounded-lg p-5 h-full"},le={class:"compromissos-container flex flex-col gap-3"},ce={class:"flex flex-col flex-1"},ue={class:"text-[14px] font-medium text-gray-900"},me={class:"text-sm text-gray-600"},ge=["src","alt"],pe={key:0,class:"text-center py-8 text-gray-500"},ve={class:"bg-white rounded-lg p-7"},fe={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},_e={class:"flex items-center gap-2 mt-[35px]"},xe={class:"w-6 h-6 rounded-full flex items-center justify-center"},he=["src"],be={class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"},we={class:"bg-white rounded-lg p-7"},ye={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},ke={class:"flex items-center gap-2 mt-[35px]"},Fe={class:"w-6 h-6 rounded-full flex items-center justify-center"},Ce=["src"],Se={class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"},De={class:"bg-white rounded-lg p-7"},$e={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},je={class:"flex items-center gap-2 mt-[35px]"},Re={class:"w-6 h-6 rounded-full flex items-center justify-center"},Ae=["src"],Ue={class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"},Ie={class:"bg-white rounded-lg p-4"},Pe={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},qe={class:"flex items-center gap-2 mt-[35px]"},Le={class:"w-6 h-6 rounded-full flex items-center justify-center"},Ve=["src"],Be={class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"},Ee={class:"bg-white rounded-lg p-4 col-span-1 md:col-span-3"},Te={class:"w-full h-[220px]"},Ne={__name:"Index",setup(Me){S.register(...G);const u=i(null),l=i(null),m=i(!1),D=V(),r=i(D.props.auth.user.unidade_id),g=i(null),p=i(null),b=i("0,00"),w=i("0,00"),y=i("0,00"),k=i(0),v=i([]),s=i({faturamento:{percentage:0,direction:"neutral",formatted:"0%"},cmv:{percentage:0,direction:"neutral",formatted:"0%"},ticket_medio:{percentage:0,direction:"neutral",formatted:"0%"},pedidos:{percentage:0,direction:"neutral",formatted:"0%"}}),F=i([]),C=i([]),$=t=>{r.value=t,f()},j=t=>{g.value=t.start_date,p.value=t.end_date,f()},f=async()=>{m.value=!0;try{await Promise.all([R(),A(),U()])}catch(t){console.error("Erro ao buscar dados:",t)}finally{m.value=!1}},R=async()=>{try{const t=new URLSearchParams;r.value!==null&&t.append("unidade_id",r.value),g.value&&t.append("start_date",g.value),p.value&&t.append("end_date",p.value);const o=(await h.get(`/api/admin/painel/indicadores?${t.toString()}`)).data;b.value=o.faturamento||"0,00",w.value=o.cmv||"0,00",y.value=o.ticket_medio||"0,00",k.value=o.quantidade_pedidos||0,s.value=o.comparisons||s.value}catch(t){console.error("Erro ao buscar indicadores:",t)}},A=async()=>{try{const t=new URLSearchParams;r.value!==null&&t.append("unidade_id",r.value);const o=(await h.get(`/api/admin/painel/faturamento-diario?${t.toString()}`)).data;o.faturamento&&Array.isArray(o.faturamento)&&(C.value=o.faturamento.map(_=>_.dia),F.value=o.faturamento.map(_=>parseFloat(_.total)),I())}catch(t){console.error("Erro ao buscar faturamento diário:",t)}},U=async()=>{try{const t=new URLSearchParams;r.value!==null&&t.append("unidade_id",r.value);const a=await h.get(`/api/admin/painel/compromissos?${t.toString()}`);v.value=a.data.compromissos||[]}catch(t){console.error("Erro ao buscar compromissos:",t)}},I=()=>{l.value&&l.value.destroy(),u.value&&(l.value=new S(u.value.getContext("2d"),{type:"bar",data:{labels:C.value,datasets:[{label:"Faturamento Diário",data:F.value,backgroundColor:"rgba(75, 192, 75, 0.6)",borderColor:"rgba(75, 192, 75, 1)",borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{enabled:!0,callbacks:{label:function(t){return"R$ "+t.parsed.y.toLocaleString("pt-BR",{minimumFractionDigits:2})}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(t){return t>=1e3?`${t/1e3}k`:t}}}}}}))},P=t=>{const a=t.split("-");return`${a[2]}/${a[1]}/${a[0]}`},q={pendente:"/storage/images/check_circle_laranja.svg",pago:"/storage/images/check_circle_verde.svg",agendada:"/storage/images/agendada.svg",atrasado:"/storage/images/atrasada.svg"},L=t=>q[t]||"/storage/images/check_circle_laranja.svg";return B(()=>{f()}),E(()=>{l.value&&l.value.destroy()}),(t,a)=>(d(),T(H,null,{default:N(()=>[x(M(Z),{title:"Painel"}),e("div",X,[a[1]||(a[1]=e("div",null,[e("div",{class:"painel-title"},"Visão geral da franquia"),e("div",{class:"painel-subtitle"},[e("p",null,"Acompanhe o desempenho das unidades")])],-1)),e("div",Y,[e("div",ee,[x(J,{"default-unit-id":r.value,onUnitSelected:$},null,8,["default-unit-id"])]),e("div",te,[e("div",ae,[a[0]||(a[0]=e("img",{src:"/storage/images/calendar_month.svg",alt:"Filtro",class:"w-5 h-5"},null,-1)),e("span",se,[x(K,{"default-to-previous-month":!0,onDateRangeSelected:j})])])])])]),m.value?(d(),c("div",oe,a[2]||(a[2]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"},null,-1)]))):(d(),c("div",ne,[e("div",ie,[e("div",re,[e("div",de,[a[4]||(a[4]=e("h3",{class:"text-lg font-semibold text-gray-700 mb-4"}," Compromissos Próximos ",-1)),e("div",le,[(d(!0),c(W,null,z(v.value,o=>(d(),c("div",{key:o.id,class:"flex justify-between items-center bg-[#F5FAF4] p-3 rounded-lg hover:bg-gray-100 transition-all cursor-pointer"},[e("div",ce,[e("p",ue,n(o.nome),1),e("p",me,n(o.valor_formatado)+" - Vence em "+n(P(o.vencimento)),1)]),e("div",null,[e("img",{src:L(o.status),alt:"Status: "+o.status,class:"w-6 h-6 object-contain"},null,8,ge)])]))),128)),v.value.length===0?(d(),c("div",pe,a[3]||(a[3]=[e("p",null,"Nenhum compromisso próximo",-1)]))):Q("",!0)])])]),e("div",ve,[a[5]||(a[5]=e("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Faturamento",-1)),e("div",fe," R$ "+n(b.value),1),e("div",_e,[e("div",xe,[e("img",{src:s.value.faturamento.direction==="up"?"/storage/images/trending_up.svg":s.value.faturamento.direction==="down"?"/storage/images/trending_down.svg":"/storage/images/trending_neutral.svg",alt:"Tendência"},null,8,he)]),e("div",be,n(s.value.faturamento.formatted)+" "+n(s.value.faturamento.direction==="up"?"maior":s.value.faturamento.direction==="down"?"menor":"igual")+" que no período anterior ",1)])]),e("div",we,[a[6]||(a[6]=e("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"CMV",-1)),e("div",ye," R$ "+n(w.value),1),e("div",ke,[e("div",Fe,[e("img",{src:s.value.cmv.direction==="up"?"/storage/images/trending_up.svg":s.value.cmv.direction==="down"?"/storage/images/trending_down.svg":"/storage/images/trending_neutral.svg",alt:"Tendência"},null,8,Ce)]),e("div",Se,n(s.value.cmv.formatted)+" "+n(s.value.cmv.direction==="up"?"maior":s.value.cmv.direction==="down"?"menor":"igual")+" que no período anterior ",1)])]),e("div",De,[a[7]||(a[7]=e("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Ticket médio",-1)),e("div",$e," R$ "+n(y.value),1),e("div",je,[e("div",Re,[e("img",{src:s.value.ticket_medio.direction==="up"?"/storage/images/trending_up.svg":s.value.ticket_medio.direction==="down"?"/storage/images/trending_down.svg":"/storage/images/trending_neutral.svg",alt:"Tendência"},null,8,Ae)]),e("div",Ue,n(s.value.ticket_medio.formatted)+" "+n(s.value.ticket_medio.direction==="up"?"maior":s.value.ticket_medio.direction==="down"?"menor":"igual")+" que no período anterior ",1)])]),e("div",Ie,[a[8]||(a[8]=e("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Pedidos",-1)),e("div",Pe,n(k.value),1),e("div",qe,[e("div",Le,[e("img",{src:s.value.pedidos.direction==="up"?"/storage/images/trending_up.svg":s.value.pedidos.direction==="down"?"/storage/images/trending_down.svg":"/storage/images/trending_neutral.svg",alt:"Tendência"},null,8,Ve)]),e("div",Be,n(s.value.pedidos.formatted)+" "+n(s.value.pedidos.direction==="up"?"maior":s.value.pedidos.direction==="down"?"menor":"igual")+" que no período anterior ",1)])]),e("div",Ee,[a[9]||(a[9]=e("h3",{class:"text-lg font-semibold text-gray-700"}," Faturamento diário ",-1)),e("div",Te,[e("canvas",{ref_key:"barChart",ref:u},null,512)])])])]))]),_:1}))}},Oe=O(Ne,[["__scopeId","data-v-5b6d13b6"]]);export{Oe as default};
