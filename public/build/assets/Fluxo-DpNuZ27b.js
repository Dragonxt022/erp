import{e as r,o as i,a as e,f,t as m,l as le,d as p,j as R,i as ne,c as ie,w as re,b as x,u as de,Z as ce,F as q,h as L,g as S,p as P,m as $,v as k,n as U,k as y}from"./app-6ALQyFZF.js";import{L as ue}from"./LayoutFranqueado-BdGRoPWh.js";import{I as M}from"./InputModel-098JuleM.js";import{B}from"./ButtonPrimaryMedio-CEYzZz4t.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as z}from"./index-JFsPzvDJ.js";import"./user-D97Xh9Q9.js";const pe=["type"],xe={class:"text-center uppercase text-[#5a9f28] upp text-[15px] font-semibold font-['Figtree'] leading-tight"},me=["src"],ve={__name:"ButtonSuave",props:{text:{type:String,required:!0,default:"Nome do Botão"},type:{type:String,default:"button"},iconPath:{type:String,required:!1}},emits:["click"],setup(u,{emit:s}){const c=s,v=()=>{c("click")};return(g,h)=>(i(),r("button",{type:u.type,onClick:v,class:"h-[46px] px-[38px] py-3 bg-white rounded-[133.33px] flex justify-center items-center gap-2.5"},[e("span",xe,m(u.text),1),u.iconPath?(i(),r("img",{key:0,src:u.iconPath,alt:"icon",class:"h-6 w-6"},null,8,me)):f("",!0)],8,pe))}},A=E(ve,[["__scopeId","data-v-0a3ca3a8"]]),fe=["type"],ge={class:"text-center text-[#f3f8f3] text-[15px] font-semibold font-['Figtree'] leading-tight"},_e=["src"],be={__name:"ButtonPrimaryMedioRed",props:{text:{type:String,required:!0,default:"Nome do Botão"},type:{type:String,default:"button"},iconPath:{type:String,required:!1}},emits:["click"],setup(u,{emit:s}){const c=s,v=()=>{c("click")};return(g,h)=>(i(),r("button",{type:u.type,onClick:v,class:"h-[46px] px-[38px] py-3 bg-[#FF2D55] rounded-[10px] shadow-[2px_2px_10px_0px_rgba(0,0,0,0.04)] flex justify-center items-center gap-2.5"},[e("span",ge,m(u.text),1),u.iconPath?(i(),r("img",{key:0,src:u.iconPath,alt:"icon",class:"h-6 w-6"},null,8,_e)):f("",!0)],8,fe))}},he=E(be,[["__scopeId","data-v-d3892524"]]),ye={key:0,class:"loading-overlay"},we={class:"mt-5"},Fe={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-6"},Ce={class:"bg-white rounded-lg px-12 py-8"},$e={class:"w-full"},ke={class:"py-3 flex items-center gap-5"},Ve=["src","alt"],Re={class:"w-fill text-[#262a27] text-[17px] font-semibold font-['Figtree'] leading-snug"},Se={class:"py-2 w-ful"},Pe={class:"w-full h-[60px] bg-[#d2fac3] rounded-bl-[10px] rounded-br-[10px] px-12 flex justify-between items-center"},Me={class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"},Be={class:"bg-white rounded-lg px-12 py-8"},Ee={class:"w-full"},Ie={class:"w-[85px]"},je=["src","alt"],De={class:"py-4 px-3 flex items-center gap-5"},Ne={class:"w-fill text-[#262a27] text-[17px] font-semibold font-['Figtree'] leading-snug w-[170px]"},qe={class:"py-2"},Le={class:"py-2"},Ue={class:"w-full h-[60px] bg-[#d2fac3] rounded-bl-[10px] rounded-br-[10px] px-12 flex justify-between items-center"},ze={class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"},Ae={class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"},Te={class:"mt-5 bottom-0 left-[250px] w-full max-w-screen-xl mx-auto"},Qe={class:"w-full h-[85px] p-5 flex justify-between items-center"},Oe={class:"flex gap-[13px]"},Ze={class:"flex justify-center items-center gap-2.5"},Ge={class:"w-[267px] h-auto"},He={class:"w-full mb-8"},Je={class:"w-full mb-8"},Ke={class:"w-full mb-8"},We={class:"w-[267px] h-auto"},Xe={class:"w-full mb-8"},Ye={class:"text-center text-gray-800 text-[12.93px] font-semibold font-['Figtree'] mt-1"},et={class:"font-bold"},tt={class:"w-full mb-8"},at={class:"w-full mb-8"},ot={key:3,class:"fixed top-0 left-0 right-0 bottom-0 bg-opacity-50 bg-gray-900 flex justify-center items-center"},st={class:"w-[267px] h-auto"},lt={class:"w-full"},nt={__name:"Fluxo",setup(u){const s=le(),c=p(!1),v=p([]),g=p([]),h=p(!1),F=p(!1),C=p(!1),l=p(""),_=p(null),b=p(null),I=p("R$ 0,00"),j=R(()=>`R$ ${v.value.reduce((t,a)=>t+parseFloat(a.total_vendas_metodos_pagamento.replace("R$","").replace(/\./g,"").replace(",","."))||0,0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),D=R(()=>`R$ ${g.value.reduce((t,a)=>t+parseFloat(a.total_vendas_canais_vendas.replace("R$","").replace(/\./g,"").replace(",","."))||0,0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),T=R(()=>g.value.reduce((o,t)=>o+(parseInt(t.quantidade_vendas_canais_vendas)||0),0)),Q=()=>{if(!l.value.trim()){s.warning("Motivo não pode estar vazio!");return}if(l.value.length>50){s.warning("Motivo excede o limite de 50 caracteres!");return}const o=parseFloat(b.value.replace("R$","").replace(".","").replace(",",".").trim());if(isNaN(o)){s.warning("Valor inválido!");return}y.post("/api/caixas/adicionar-suprimento",{valor:o,motivo:l.value}).then(t=>{console.log("Sucesso:",t.data),s.success("Suprimento adicionado com sucesso!")}).catch(t=>{console.error("Erro:",t),s.error("Erro ao adicionar suprimento.")}),b.value="",l.value="",h.value=!1},O=()=>{if(l.value.length<5){s.warning("Precisa conter no minimo 5 caracteres!");return}if(l.value.length>50){s.warning("Excede o limite de 50 caracteres!");return}const o=parseFloat(_.value.replace("R$","").replace(".","").replace(",",".").trim());if(isNaN(o)){s.warning("Valor inválido!");return}y.post("/api/caixas/remover-suprimento",{valor:o,motivo:l.value}).then(t=>{console.log("Sucesso:",t.data),s.success("Sangria realizada com sucesso!")}).catch(t=>{console.error("Erro:",t),s.error("Erro ao realizar a Sangria.")}),console.log("Valor retirado:",o),console.log("Motivo:",l.value),_.value="",l.value="Não informado",F.value=!1},Z=async()=>{try{const o=await y.get("/api/caixas/valor-disponivel");o.data.status==="success"?I.value=`R$ ${o.data.data.valor_disponivel}`:s.error("Erro ao carregar o valor do caixa.")}catch(o){console.error("Erro ao buscar valor do caixa:",o),s.error("Erro ao carregar o valor do caixa.")}},G=()=>{h.value=!0},H=()=>{h.value=!1,l.value="",b.value=null},J=()=>{C.value=!0},K=()=>{C.value=!1},W=()=>{C.value=!1,oe()},X=()=>{F.value=!0,Z()},Y=()=>{F.value=!1,l.value="",_.value=null},N=o=>{let t=o.replace(/\D/g,"");t||(t="0");const a=t.slice(0,-2)||"0",n=t.slice(-2);return`R$ ${Number(a).toLocaleString("pt-BR")},${n}`},ee=(o,t)=>{const a=o.target;let n=a.value.replace(/\D/g,"");n||(n="0");const d=n.slice(0,-2)||"0",V=n.slice(-2).padStart(2,"0"),w=`R$ ${Number(d).toLocaleString("pt-BR")},${V}`;a.value=w,t.total_vendas_metodos_pagamento=w},te=(o,t)=>{const a=o.target;let n=a.value.replace(/\D/g,"");n||(n="0");const d=n.slice(0,-2)||"0",V=n.slice(-2).padStart(2,"0"),w=`R$ ${Number(d).toLocaleString("pt-BR")},${V}`;a.value=w,t.total_vendas_canais_vendas=w},ae=async()=>{c.value=!0;try{const o=await y.get("/api/caixas/metodos-canais-ativos");o.data.status==="success"?(console.log("Métodos de pagamento:",o.data.metodosPagamento),console.log("Canais de vendas:",o.data.canaisVendas),v.value=o.data.metodosPagamento.filter(t=>{var a;return(a=t.default_payment_method)==null?void 0:a.img_icon}).map(t=>({...t,total_vendas_metodos_pagamento:"R$ 0,00"})),g.value=o.data.canaisVendas.filter(t=>{var a;return(a=t.default_canal_de_vendas)==null?void 0:a.img_icon}).map(t=>({...t,total_vendas_canais_vendas:"R$ 0,00",quantidade_vendas_canais_vendas:0}))):s.error("Erro ao carregar os dados")}catch(o){console.error("Erro ao buscar métodos e canais ativos:",o),s.error("Erro ao carregar os dados")}finally{c.value=!1}},oe=async()=>{c.value=!0;try{(await y.post("/api/caixas/fechar-caixa",{metodos:v.value,canais:g.value,total_metodos_pagamento:j.value,total_canais_vendas:D.value})).data.status==="success"?(s.success("Fechamento realizado com sucesso!"),z.Inertia.visit(route("franqueado.abrirCaixa"))):s.error("Erro ao realizar o fechamento")}catch(o){console.error("Erro ao enviar fechamento de caixa:",o),s.error("Erro ao realizar o fechamento")}finally{c.value=!1}},se=async()=>{c.value=!0;try{const o=await y.get("/api/caixas/abertos");o.data&&o.data.aberto?console.log("caixa aberto, permanecendo na pagina"):(s.warning("Abra o caixa primeiro!"),z.Inertia.visit(route("franqueado.abrirCaixa")))}catch(o){console.error("Erro ao verificar caixa aberto:",o)}finally{c.value=!1}};return ne(()=>{se(),ae()}),(o,t)=>(i(),ie(ue,null,{default:re(()=>[x(de(ce),{title:"Fluxo do Caixa"}),c.value?(i(),r("div",ye,t[9]||(t[9]=[e("div",{class:"spinner"},null,-1)]))):f("",!0),t[22]||(t[22]=e("div",{class:"flex justify-between items-center mb-4"},[e("div",null,[e("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Fluxo do caixa "),e("div",{class:"painel-subtitle"},[e("p",{class:"text-sm sm:text-base md:text-lg"}," Acompanhe seu negócio em tempo real ")])])],-1)),e("div",we,[e("div",Fe,[e("div",null,[e("div",Ce,[e("table",$e,[t[10]||(t[10]=e("thead",null,[e("tr",null,[e("th",{class:"text-gray-500 text-left text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Método de pagamento ")])],-1)),e("tbody",null,[(i(!0),r(q,null,L(v.value,a=>{var n;return i(),r("tr",{key:a.id},[e("td",ke,[a.default_payment_method&&a.default_payment_method.img_icon?(i(),r("img",{key:0,src:`/${a.default_payment_method.img_icon}`,alt:a.default_payment_method.nome||"Método de pagamento",class:"w-8 h-8"},null,8,Ve)):f("",!0),e("div",Re,m(((n=a.default_payment_method)==null?void 0:n.nome)||"Desconhecido"),1)]),e("td",Se,[x(M,{modelValue:a.total_vendas_metodos_pagamento,"onUpdate:modelValue":d=>a.total_vendas_metodos_pagamento=d,onInput:d=>ee(d,a),class:"w-[120px]"},null,8,["modelValue","onUpdate:modelValue","onInput"])])])}),128))])])]),e("div",Pe,[t[11]||(t[11]=e("div",{class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"}," TOTAL ",-1)),e("div",Me,m(j.value),1)])]),e("div",null,[e("div",Be,[e("table",Ee,[t[12]||(t[12]=e("thead",null,[e("tr",null,[e("th"),e("th",{class:"px-2 text-left text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Canais de venda "),e("th",{class:"text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Valor vendido "),e("th",{class:"text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Pedidos ")])],-1)),e("tbody",null,[(i(!0),r(q,null,L(g.value,a=>{var n;return i(),r("tr",{key:a.id},[e("td",Ie,[a.default_canal_de_vendas&&a.default_canal_de_vendas.img_icon?(i(),r("img",{key:0,src:`/${a.default_canal_de_vendas.img_icon}`,alt:a.default_canal_de_vendas.nome||"Canal de venda",class:"h-7 w-17 fill-stone-950"},null,8,je)):f("",!0)]),e("td",De,[e("div",Ne,m(((n=a.default_canal_de_vendas)==null?void 0:n.nome)||"Desconhecido"),1)]),e("td",qe,[x(M,{modelValue:a.total_vendas_canais_vendas,"onUpdate:modelValue":d=>a.total_vendas_canais_vendas=d,onInput:d=>te(d,a),class:"w-[120px]",placeholder:"R$ 0,00"},null,8,["modelValue","onUpdate:modelValue","onInput"])]),e("td",Le,[x(M,{modelValue:a.quantidade_vendas_canais_vendas,"onUpdate:modelValue":d=>a.quantidade_vendas_canais_vendas=d,placeholder:"0",class:"w-[120px]"},null,8,["modelValue","onUpdate:modelValue"])])])}),128))])])]),e("div",Ue,[e("div",ze,[t[13]||(t[13]=e("span",null,"Total:",-1)),S(" "+m(D.value),1)]),e("div",Ae,[t[14]||(t[14]=e("span",null,"Pedidos:",-1)),S(" "+m(T.value),1)])])])])]),e("div",Te,[e("div",Qe,[e("div",Oe,[x(A,{class:"w-full",text:"Suprimento",iconPath:"",onClick:G}),x(A,{class:"w-full",text:"Sangria",iconPath:"",onClick:X})]),e("div",Ze,[x(B,{class:"w-full max-w-[200px]",text:"Fechar caixa",iconPath:"/storage/images/arrow_left_alt.svg",onClick:J})])])]),h.value?(i(),r("div",{key:1,onClick:H,class:"fixed top-0 left-0 right-0 bottom-0 bg-opacity-50 bg-gray-900 flex justify-center items-center"},[e("div",{onClick:t[3]||(t[3]=P(()=>{},["stop"])),class:"w-[405px] h-auto px-[19px] py-[20px] bg-white rounded-[20px] flex flex-col justify-center items-center gap-[20px]"},[t[16]||(t[16]=e("div",{class:"w-[280px] h-auto relative"},[e("div",{class:"w-[83.46px] h-[83.46px] mx-auto mb-8"},[e("img",{src:"/storage/images/add_circle.svg",alt:""})]),e("div",{class:"text-center text-[#262a27] text-[22px] font-bold font-['Figtree']"},[e("p",null,"Quanto você vai adicionar?")])],-1)),e("div",Ge,[e("div",He,[$(e("input",{id:"valor","onUpdate:modelValue":t[0]||(t[0]=a=>b.value=a),onInput:t[1]||(t[1]=a=>b.value=N(b.value)),class:"w-full h-[42.16px] bg-white rounded-lg border-2 border-[#d7d7db] px-2 text-[17px] outline-none text-center",placeholder:"R$ 0,00"},null,544),[[k,b.value]])]),e("div",Je,[t[15]||(t[15]=e("label",{for:"motivo",class:"block text-gray-800 text-[14.93px] font-semibold font-['Figtree']"}," Informações adicionais ",-1)),$(e("textarea",{id:"motivo","onUpdate:modelValue":t[2]||(t[2]=a=>l.value=a),class:"w-full h-24 bg-white rounded-lg border-2 border-[#d7d7db] px-2 py-1 text-[14px] outline-none resize-none",placeholder:"Digite aqui..."},null,512),[[k,l.value]]),e("p",{class:U(["text-right text-xs mt-1",{"text-gray-500":l.value.length<=50,"text-red-500":l.value.length>50}])},m(l.value.length)+"/50 caracteres ",3)]),e("div",Ke,[x(B,{onClick:Q,text:"Adicionar",class:"w-full"})])])])])):f("",!0),F.value?(i(),r("div",{key:2,onClick:Y,class:"fixed top-0 left-0 right-0 bottom-0 bg-opacity-50 bg-gray-900 flex justify-center items-center"},[e("div",{onClick:t[7]||(t[7]=P(()=>{},["stop"])),class:"w-[405px] h-auto px-[19px] py-[20px] bg-white rounded-[20px] flex flex-col justify-center items-center gap-[20px]"},[t[19]||(t[19]=e("div",{class:"w-[280px] h-auto relative"},[e("div",{class:"w-[83.46px] h-[83.46px] mx-auto mb-8"},[e("img",{src:"/storage/images/do_not_disturb_on.svg",alt:""})]),e("div",{class:"text-center text-[#262a27] text-[22px] font-bold font-['Figtree']"},[e("p",null,"Quanto você vai retirar?")])],-1)),e("div",We,[e("div",Xe,[$(e("input",{id:"valor","onUpdate:modelValue":t[4]||(t[4]=a=>_.value=a),onInput:t[5]||(t[5]=a=>_.value=N(_.value)),class:"w-full h-[42.16px] bg-white rounded-lg border-2 border-[#d7d7db] px-2 text-[17px] outline-none text-center",placeholder:"R$ 0,00"},null,544),[[k,_.value]]),e("div",Ye,[e("p",null,[t[17]||(t[17]=S(" Valor disponível no caixa: ")),e("span",et,m(I.value),1)])])]),e("div",tt,[t[18]||(t[18]=e("label",{for:"motivo",class:"block text-gray-800 text-[14.93px] font-semibold font-['Figtree']"}," Informações adicionais ",-1)),$(e("textarea",{id:"motivo","onUpdate:modelValue":t[6]||(t[6]=a=>l.value=a),class:"w-full h-24 bg-white rounded-lg border-2 border-[#d7d7db] px-2 py-1 text-[14px] outline-none resize-none",placeholder:"Digite aqui..."},null,512),[[k,l.value]]),e("p",{class:U(["text-right text-xs mt-1",{"text-gray-500":l.value.length<=50,"text-red-500":l.value.length>50}])},m(l.value.length)+"/50 caracteres ",3)]),e("div",at,[x(he,{onClick:O,text:"Retirar",class:"w-full"})])])])])):f("",!0),C.value?(i(),r("div",ot,[e("div",{onClick:t[8]||(t[8]=P(()=>{},["stop"])),class:"w-[405px] h-auto px-[19px] py-[20px] bg-white rounded-[20px] flex flex-col justify-center items-center gap-[20px]"},[t[21]||(t[21]=e("div",{class:"w-[280px] h-auto relative p-5"},[e("div",{class:"w-[83.46px] h-[83.46px] mx-auto mb-5"},[e("img",{src:"/storage/images/thumb_up_confirmar.svg",alt:""})]),e("div",{class:"text-center text-[#262a27] text-[22px] font-bold font-['Figtree']"},[e("p",null,"Confirmar fechamento do caixa de hoje?")])],-1)),e("div",st,[e("div",lt,[x(B,{onClick:W,text:"Confirmar",class:"w-full"})]),e("div",{class:"mt-3 text-center text-[#ff2d55] text-[15px] font-bold font-['Figtree']",onClick:K},t[20]||(t[20]=[e("p",{class:"cursor-pointer"},"Corrigir informações?",-1)]))])])])):f("",!0)]),_:1}))}},mt=E(nt,[["__scopeId","data-v-66fb579c"]]);export{mt as default};
