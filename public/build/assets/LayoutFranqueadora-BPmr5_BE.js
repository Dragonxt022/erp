import{d as _,j as y,i as D,D as H,e as n,o as t,a as e,c as P,f as w,A as j,F as L,h as A,n as S,t as g,w as x,u as q,z as N,k as z,q as M,C as F,p as T,b as I,N as U,Z as G,r as O}from"./app-C6S9B82p.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"navbar"},Z={class:"navbar-content"},J={class:"navbar-left"},Q={class:"navbar-logo"},W=["href"],K={class:"navbar-right"},X={class:"notification-container"},Y={key:0,class:"notification-badge"},ee={key:0,class:"notification-tray"},ae={class:"notification-header"},se={class:"notification-list"},te={key:0,class:"notification-loading"},oe={key:1,class:"no-notifications"},ne=["onClick"],ie={class:"notification-icon-type"},le={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},re={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ce={key:2,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ue={class:"notification-content"},de={class:"notification-title"},ve={class:"notification-message"},me={class:"notification-time"},fe={key:0,class:"user-info"},ge=["src"],he={class:"user-details"},ke={class:"user-name"},pe={class:"user-location"},be={key:1,class:"user-info loading"},_e={__name:"Navbar",setup(i){const o=_(null),u=y(()=>{var s;return(s=o.value)==null?void 0:s.unidade}),c=_([]),k=_(!1),r=_(!1),p=y(()=>c.value.filter(s=>s.lida===0).length),v=y(()=>{var s,a;return((s=o.value)==null?void 0:s.profile_photo_url)||`https://ui-avatars.com/api/?name=${d((a=o.value)==null?void 0:a.name)}&color=7F9CF5&background=EBF4FF`}),d=s=>s?s.split(" ").map(l=>l.charAt(0).toUpperCase()).join(""):"*",C=async()=>{try{const s=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar perfil do usuário");const a=await s.json();o.value=a.data}catch(s){console.error("Erro ao buscar perfil:",s),o.value=null}},f=async()=>{k.value=!0;try{const s=await fetch("/api/notificacoes",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar notificações");const a=await s.json();c.value=a.data}catch(s){console.error("Erro ao buscar notificações:",s),c.value=[]}finally{k.value=!1}},$=async s=>{try{if((await z.post(`/api/notificacoes/${s}/ler`)).status===200){const l=c.value.findIndex(E=>E.id===s);l!==-1&&(c.value[l].lida=1,c.value[l].lida_em=new Date().toISOString())}}catch(a){console.error("Erro ao marcar notificação como lida:",a)}},B=async()=>{try{(await z.post("/api/notificacoes/ler-todas")).status===200&&c.value.forEach(a=>{a.lida=1,a.lida_em=new Date().toISOString()})}catch(s){console.error("Erro ao marcar todas notificações como lidas:",s)}},m=s=>{s.stopPropagation(),r.value=!r.value,r.value&&f()},b=s=>{const a=document.querySelector(".notification-container");a&&!a.contains(s.target)&&(r.value=!1)};let h;return D(()=>{C(),f(),document.addEventListener("click",b),h=setInterval(()=>{r.value||f()},3e5)}),H(()=>{document.removeEventListener("click",b),clearInterval(h)}),(s,a)=>(t(),n("div",R,[a[9]||(a[9]=e("div",{class:"navbar-background"},null,-1)),e("div",Z,[e("div",J,[e("div",Q,[a[1]||(a[1]=e("div",{class:"mr-4"},[e("a",{href:"https://www.taiksu.com.br/office/",target:"_blank"},[e("img",{src:"/storage/images/quadrados_verdes.svg",alt:"Quadrados verdes",class:"w-full h-full"})])],-1)),e("div",null,[e("a",{href:s.route("franqueado.painel")},a[0]||(a[0]=[e("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,W)])])]),e("div",K,[e("div",X,[e("div",{class:"notification-icon",onClick:m},[a[2]||(a[2]=j('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-1a7823b4><mask id="mask0_4631_13059" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24" data-v-1a7823b4><rect width="24" height="24" fill="#D9D9D9" data-v-1a7823b4></rect></mask><g mask="url(#mask0_4631_13059)" data-v-1a7823b4><path d="M2.40039 20.4V18H4.80039V9.6C4.80039 7.94 5.30039 6.465 6.30039 5.175C7.30039 3.885 8.60039 3.04 10.2004 2.64V1.8C10.2004 1.3 10.3754 0.875 10.7254 0.525C11.0754 0.175 11.5004 0 12.0004 0C12.5004 0 12.9254 0.175 13.2754 0.525C13.6254 0.875 13.8004 1.3 13.8004 1.8V2.64C15.4004 3.04 16.7004 3.885 17.7004 5.175C18.7004 6.465 19.2004 7.94 19.2004 9.6V18H21.6004V20.4H2.40039ZM12.0004 24C11.3404 24 10.7754 23.765 10.3054 23.295C9.83539 22.825 9.60039 22.26 9.60039 21.6H14.4004C14.4004 22.26 14.1654 22.825 13.6954 23.295C13.2254 23.765 12.6604 24 12.0004 24ZM7.20039 18H16.8004V9.6C16.8004 8.28 16.3304 7.15 15.3904 6.21C14.4504 5.27 13.3204 4.8 12.0004 4.8C10.6804 4.8 9.55039 5.27 8.61039 6.21C7.67039 7.15 7.20039 8.28 7.20039 9.6V18Z" fill="#6DB631" data-v-1a7823b4></path></g></svg>',1)),p.value>0?(t(),n("div",Y)):w("",!0)]),r.value?(t(),n("div",ee,[e("div",ae,[a[3]||(a[3]=e("h3",null,"Notificações",-1)),c.value.length>0?(t(),n("span",{key:0,onClick:B,class:"mark-all-read"},"Marcar todas como lidas")):w("",!0)]),e("div",se,[k.value?(t(),n("div",te,a[4]||(a[4]=[e("div",{class:"notification-skeleton"},null,-1),e("div",{class:"notification-skeleton"},null,-1)]))):c.value.length===0?(t(),n("div",oe," Nenhuma notificação no momento ")):(t(!0),n(L,{key:2},A(c.value,l=>(t(),n("div",{key:l.id,class:S(["notification-item",{unread:l.lida===0}]),onClick:E=>$(l.id)},[e("div",ie,[l.tipo==="info"?(t(),n("svg",le,a[5]||(a[5]=[e("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 100-16 8 8 0 000 16zM11 7h2v2h-2V7zm0 4h2v6h-2v-6z",fill:"#6DB631"},null,-1)]))):l.tipo==="alerta"?(t(),n("svg",re,a[6]||(a[6]=[e("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-1-7v2h2v-2h-2zm0-8v6h2V7h-2z",fill:"#FF9800"},null,-1)]))):(t(),n("svg",ce,a[7]||(a[7]=[e("path",{d:"M4 19h16v2H4v-2zm5-4h11v2H9v-2zm-5-4h16v2H4v-2zm5-4h11v2H9V7zM4 3h16v2H4V3z",fill:"#6DB631"},null,-1)])))]),e("div",ue,[e("div",de,g(l.titulo),1),e("div",ve,g(l.mensagem),1),e("div",me,g(l.tempo),1)])],10,ne))),128))])])):w("",!0)]),o.value?(t(),P(q(N),{key:0,href:s.route("franqueadora.perfil"),class:S(["user-info",{loading:!o.value}])},{default:x(()=>{var l;return[o.value?(t(),n("div",fe,[e("img",{src:v.value,alt:"Avatar",class:"avatar"},null,8,ge),e("div",he,[e("div",ke,g(o.value.name),1),e("div",pe,g(((l=u.value)==null?void 0:l.cidade)||"Taiksu Franchising"),1)])])):(t(),n("div",be,a[8]||(a[8]=[e("div",{class:"avatar-skeleton"},null,-1),e("div",{class:"user-details-skeleton"},[e("div",{class:"name-skeleton"}),e("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["href","class"])):w("",!0)])])]))}},we=V(_e,[["__scopeId","data-v-1a7823b4"]]),ye={class:"icon"},Se=["src"],Ce={class:"label"},Ie={type:"submit",class:"w-full h-full flex items-center"},Le={class:"icon"},Ae=["src"],qe={class:"label"},Ve={key:2,class:"submenu"},$e={class:"label"},xe={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]}},setup(i){const o=i,u=_(!1),c=y(()=>u.value),k=m=>{o.submenuItems&&o.submenuItems.length>0&&(m.preventDefault(),r())},r=()=>{u.value=!u.value,v()},p=()=>{const m=localStorage.getItem(`submenu-${o.link}`);m!==null&&(u.value=JSON.parse(m))},v=()=>{localStorage.setItem(`submenu-${o.link}`,JSON.stringify(u.value))},d=y(()=>f.value||o.isActive?"submenu-active":""),C=m=>{const b=window.location.pathname,h=new URL(route(m),window.location.origin).pathname;return b===h},f=y(()=>o.submenuItems.some(m=>C(m.link))),$=()=>{o.isLogout&&U.post(route("logout"))};return p(),M(f,()=>{f.value||F(()=>{u.value=!1,v()})}),M(u,()=>{F(()=>{v()})}),(m,b)=>(t(),n("div",null,[!i.isLogout&&i.link?(t(),P(q(N),{key:0,class:S(["menu-item",[d.value,{active:i.isActive||f.value}]]),href:i.link||"#",onClick:k},{default:x(()=>[e("div",ye,[e("img",{src:i.icon,alt:"icon"},null,8,Se)]),e("div",Ce,g(i.label),1),i.submenuItems&&i.submenuItems.length>0?(t(),n("div",{key:0,class:S(["right-icon",{"rotate-icon":c.value}])},b[0]||(b[0]=[e("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):w("",!0)]),_:1},8,["class","href"])):(t(),n("form",{key:1,onSubmit:T($,["prevent"]),class:"menu-item"},[e("button",Ie,[e("div",Le,[e("img",{src:i.icon,alt:"icon"},null,8,Ae)]),e("div",qe,g(i.label),1)])],32)),i.submenuItems&&i.submenuItems.length>0&&(u.value||f.value)?(t(),n("div",Ve,[(t(!0),n(L,null,A(i.submenuItems,(h,s)=>(t(),n("div",{key:s},[I(q(N),{class:S(["submenu-item",{active:C(h.link)}]),href:m.route(h.link)},{default:x(()=>[e("div",$e,g(h.label),1)]),_:2},1032,["href","class"])]))),128))])):w("",!0)]))}},Ne=V(xe,[["__scopeId","data-v-c01c688f"]]),Pe={class:"category-title"},Be={__name:"Slidebar",setup(i){const o=_(null);D(()=>{const r=localStorage.getItem("sidebarScrollPosition");r&&o.value&&(o.value.scrollTop=r)});const u=()=>{o.value&&localStorage.setItem("sidebarScrollPosition",o.value.scrollTop)},c=r=>{const p=window.location.pathname,v=new URL(r,window.location.origin).pathname;return p===v||p.startsWith(v)},k=[{name:"",items:[{label:"Visão Geral",icon:"/storage/images/insert_chart.svg",link:"franqueadora.painel",isLogout:!1}]},{name:"Gestão da rede",items:[{label:"Franqueados",icon:"/storage/images/person.svg",link:"franqueadora.franqueados",isLogout:!1},{label:"Produtividade",icon:"/storage/images/skillet.svg",link:"franqueadora.produtividade.geral",isLogout:!1,submenuItems:[{label:"Visão Geral",link:"franqueadora.produtividade.geral"},{label:"Gestão de atividades",link:"franqueadora.GestaoAtividades"},{label:"Setores operacionais",link:"franqueadora.SetorOperacionais"}],isActive:!1},{label:"Unidades",icon:"/storage/images/storefront.svg",link:"franqueadora.unidades",isLogout:!1}]},{name:"Parâmetros da franquia",items:[{label:"Fornecedores",icon:"/storage/images/handshake_branca.svg",link:"franqueadora.fornecedores",isLogout:!1},{label:"Insumos",icon:"/storage/images/insumos_nova.svg",link:"franqueadora.insumos",isLogout:!1},{label:"Inspetor",icon:"/storage/images/inspecionador.svg",link:"franqueadora.inspetor",isLogout:!1},{label:"Caixa",icon:"/storage/images/fluxo_caixa.svg",link:"franqueadora.metodosPagamentos",isLogout:!1,submenuItems:[{label:"Métodos de pagamento",link:"franqueadora.metodosPagamentos"},{label:"Canais de Vendas",link:"franqueadora.canaisVendas"}],isActive:!1},{label:"Sair",icon:"/storage/images/log-out.png",link:"logout",isLogout:!0}]}];return(r,p)=>(t(),n("div",{class:"sidebar",ref_key:"sidebar",ref:o,onScroll:u},[(t(),n(L,null,A(k,v=>e("div",{key:v.name,class:"menu-category"},[e("div",Pe,g(v.name),1),(t(!0),n(L,null,A(v.items,d=>(t(),P(Ne,{key:d.link||"no-link",label:d.label,icon:d.icon,link:d.link?r.route(d.link):null,submenuItems:d.submenuItems,isActive:d.link?c(r.route(d.link)):!1,isLogout:d.isLogout},null,8,["label","icon","link","submenuItems","isActive","isLogout"]))),128))])),64))],544))}},Ee=V(Be,[["__scopeId","data-v-f5b596ca"]]),ze={class:"content"},Me={__name:"LayoutFranqueadora",props:{title:String},setup(i){return(o,u)=>(t(),n("div",null,[I(q(G),{title:i.title},null,8,["title"]),I(we),I(Ee),e("main",ze,[O(o.$slots,"default",{},void 0,!0)])]))}},He=V(Me,[["__scopeId","data-v-bd0a65dc"]]);export{He as A};
