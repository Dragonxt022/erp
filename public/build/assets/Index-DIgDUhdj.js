import{x as T,d as r,o as l,e as u,a as e,i as J,b as o,t as _,h as w,s as j,j as R,v as z,F as y,g as B,f as V,c as E,w as O,u as Z,Z as G,n as H}from"./app-CdeH1AjD.js";import{_ as C,I as $,C as K,a as W,b as D,d as X,B as Y,E as ee}from"./ConfirmDialog-KXNEAOhE.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as ae}from"./AppLayout-CpTsiLAg.js";const se={key:0,class:"sidebar-container"},te={key:0,class:"loading-overlay"},de={key:1,class:"painel-title"},oe={class:"w-full h-[525px] bg-white rounded-[20px] p-12"},le={class:"flex space-x-4"},ie={class:"flex flex-col w-1/2"},ne={class:"flex flex-col w-1/2"},re={key:0,class:"error-message"},ue={class:"form-buttons"},ce={__name:"CadastroUnidade",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(t,{emit:s}){const i=T(),x=s,f=r(""),v=r(""),n=r(""),d=r(""),m=r(""),h=r(""),g=r(""),U=r(!1),b=r(!1),k=r(""),I=()=>{F(),x("cancelar")},F=()=>{f.value="",v.value="",n.value="",d.value="",m.value="",h.value="",g.value=""},P=()=>!f.value||!v.value||!d.value?(i.error("Por favor, preencha todos os campos obrigatórios."),g.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,N=async()=>{var p,a;if(P())try{U.value=!0;const c=await j.post("/api/unidades",{cnpj:f.value,cep:v.value,cidade:n.value,bairro:d.value,rua:m.value,numero:h.value});console.log("Unidade cadastrada com sucesso:",c.data),i.success("Unidade cadastrada com sucesso!"),X.Inertia.visit("/unidades"),F()}catch(c){i.error("Erro ao cadastrar unidade."),g.value=((a=(p=c.response)==null?void 0:p.data)==null?void 0:a.message)||"Erro ao cadastrar unidade."}finally{U.value=!1}},L=p=>{let a=p.target.value.replace(/\D/g,"");a.length>14&&(a=a.slice(0,14)),a=a.replace(/^(\d{2})(\d)/,"$1.$2"),a=a.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),a=a.replace(/\.(\d{3})(\d)/,".$1/$2"),a=a.replace(/(\d{4})(\d)/,"$1-$2"),f.value=a},S=p=>{let a=p.target.value.replace(/\D/g,"");a.length>8&&(a=a.slice(0,8)),a=a.replace(/(\d{5})(\d)/,"$1-$2"),v.value=a},q=p=>{k.value=p,b.value=!0},A=()=>{N(),b.value=!1},Q=()=>{b.value=!1};return(p,a)=>t.isVisible?(l(),u("div",se,[U.value?(l(),u("div",te,a[7]||(a[7]=[e("div",{class:"spinner"},null,-1)]))):(l(),u("div",de,"Dados da nova unidade")),a[8]||(a[8]=e("div",{class:"painel-subtitle"},[e("p",null,"Informações básicas sobre a operação")],-1)),e("div",oe,[e("form",{onSubmit:J(N,["prevent"])},[o(C,{text:"CNPJ"}),o($,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=c=>f.value=c),onInput:L,placeholder:"CNPJ"},null,8,["modelValue"]),o(C,{text:"Cidade"}),o($,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=c=>n.value=c),placeholder:"Cidade"},null,8,["modelValue"]),o(C,{text:"CEP"}),o($,{modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=c=>v.value=c),onInput:S,placeholder:"CEP"},null,8,["modelValue"]),e("div",le,[e("div",ie,[o(C,{text:"Rua"}),o($,{modelValue:m.value,"onUpdate:modelValue":a[3]||(a[3]=c=>m.value=c),placeholder:"Rua"},null,8,["modelValue"])]),e("div",ne,[o(C,{text:"Número"}),o($,{modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=c=>h.value=c),placeholder:"Número"},null,8,["modelValue"])])]),o(C,{text:"Bairro"}),o($,{modelValue:d.value,"onUpdate:modelValue":a[5]||(a[5]=c=>d.value=c),placeholder:"Bairro"},null,8,["modelValue"]),g.value?(l(),u("div",re,_(g.value),1)):w("",!0),o(K,{isVisible:b.value,motivo:k.value,onConfirm:A,onCancel:Q},null,8,["isVisible","motivo"]),e("div",ue,[o(W,{text:"Cancelar",onClick:I}),o(D,{text:"Cadastrar",onClick:a[6]||(a[6]=c=>q("Criar nova unidade?"))})])],32)])])):w("",!0)}},ve=M(ce,[["__scopeId","data-v-2e163658"]]);r([]);const fe={data(){return{unidades:[],searchQuery:""}},mounted(){this.fetchUnidades()},methods:{async fetchUnidades(){try{const t=await j.get("/api/unidades");this.unidades=t.data}catch(t){console.error("Erro ao carregar unidades:",t)}},selecionarUnidade(t){this.$emit("unidade-selecionada",{unidade:t.unidade,usuarios:t.usuarios,cidade:t.cidade})}},computed:{filteredUnidades(){return this.unidades.filter(t=>{const s=t.unidade.cidade||t.cidade;return s&&s.toLowerCase().includes(this.searchQuery.toLowerCase())})}}},pe={class:"search-container relative flex items-center w-full mb-4"},me={class:"card-container"},ge=["onClick"],xe={class:"card-inner"},he={class:"text-container"},be={class:"city"},_e={class:"owner"};function ye(t,s,i,x,f,v){return l(),u("div",null,[s[4]||(s[4]=e("div",{class:"painel-title"},"Nossas Unidades",-1)),s[5]||(s[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Listagem de todas as unidades da franquia")],-1)),e("div",pe,[s[1]||(s[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),R(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=n=>f.searchQuery=n),placeholder:"Pesquisar unidades",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[z,f.searchQuery]])]),e("div",me,[(l(!0),u(y,null,B(v.filteredUnidades,n=>(l(),u("div",{key:n.unidade.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:d=>v.selecionarUnidade(n)},[e("div",xe,[s[2]||(s[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/storefront-verde.svg",alt:"Ícone da Unidade"})])],-1)),e("div",he,[e("div",be,_(n.unidade.cidade||n.cidade),1),e("div",_e,[n.usuarios.length>0?(l(),u(y,{key:0},[V(_(n.usuarios.map(d=>d.name).join(", ")),1)],64)):(l(),u(y,{key:1},[V("Unidade sem Franqueado")],64))])]),s[3]||(s[3]=e("div",{class:"action-icon"},null,-1))])],8,ge))),128))])])}const Ue=M(fe,[["render",ye],["__scopeId","data-v-d2a9f774"]]),Ce={key:0,class:"w-full h-[350px] bg-white rounded-[20px] p-12"},$e={class:"relative w-full h-full"},we={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},ke={class:"w-[135px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Ve={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Ee={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Fe={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Ne={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[34px] tracking-tight"},je={class:"absolute bottom-0 left-0 w-full h-[100px] flex flex-col gap-1"},Be={class:"h-[43px] pl-4 pr-3 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},De={class:"text-[#6db631] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Me={key:0,class:"mt-4"},Ie={__name:"DetalhesUnidade",props:{unidade:{type:Object,required:!0}},setup(t){const s=r(!1),i=r(!1),x=()=>{r.dadosUnidade.fetchUnidades()},f=()=>{i.value=!i.value,s.value=!1},v=()=>{i.value=!1,s.value=!0};return(n,d)=>{var m,h,g,U,b;return l(),u(y,null,[i.value?w("",!0):(l(),u("div",Ce,[e("div",$e,[e("div",we,[e("div",ke,[d[0]||(d[0]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",Ve," ID# "+_((((m=t.unidade.unidade)==null?void 0:m.id)??0).toString().padStart(4,"0")),1)]),e("div",Ee,[d[1]||(d[1]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",Fe,_(((h=t.unidade.unidade)==null?void 0:h.cnpj)||"N/A"),1)])]),e("div",Ne,_(((g=t.unidade.unidade)==null?void 0:g.cidade)||t.unidade.cidade||"N/A"),1),e("div",je,[d[2]||(d[2]=e("div",{class:"text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight"}," Esta unidade pertence a ",-1)),e("div",Be,[e("div",De,[(b=(U=t.unidade)==null?void 0:U.usuarios)!=null&&b.length?(l(!0),u(y,{key:0},B(t.unidade.usuarios,k=>(l(),u("div",{key:k.id},_(k.name),1))),128)):(l(),u(y,{key:1},[V("Sem informações")],64))])]),t.unidade.unidade.id?(l(),u("div",Me,[o(Y,{text:"Editar Unidade","icon-path":"/storage/images/border_color.svg",onClick:f,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):w("",!0)])])])),i.value?(l(),E(ee,{key:1,ref:"dadosUnidade",isVisible:i.value,unidade:t.unidade,onDadosUnidade:x,onCancelar:v},null,8,["isVisible","unidade"])):w("",!0)],64)}}},Pe={class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2"},Le={class:"flex flex-col gap-4"},Se={class:"absolute bottom-4 right-4"},qe={key:1,class:"mt-4"},Re={__name:"Index",setup(t){const s=r(null),i=r(!1),x=()=>{i.value=!i.value},f=()=>{v(),i.value=!1},v=()=>{r.listarUnidades.fetchUnidades()},n=d=>{s.value=d};return(d,m)=>(l(),E(ae,null,{default:O(()=>[o(Z(G),{title:"Unidades"}),e("div",Pe,[e("div",null,[o(Ue,{ref:"listarUnidades",onUnidadeCadastrada:v,onUnidadeSelecionada:n},null,512)]),e("div",Le,[i.value?(l(),u("div",qe,[o(ve,{isVisible:i.value,onUnidadeCadastrada:f,onCancelar:x},null,8,["isVisible"])])):(l(),u(y,{key:0},[s.value?(l(),E(Ie,{key:0,unidade:s.value},null,8,["unidade"])):w("",!0),e("div",Se,[o(D,{text:"Nova Unidade",iconPath:"/storage/images/arrow_left_alt.svg",onClick:x,class:H({hidden:d.isEditMode})},null,8,["class"])])],64))])])]),_:1}))}};export{Re as default};
