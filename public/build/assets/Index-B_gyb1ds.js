import{C as Se}from"./CadastroProduto-DTBwDxMU.js";import{R as O,S as Ie,l as Pe,d as h,m as Oe,k as ge,o as c,c as S,w as ve,e as x,a as t,f as _e,t as _,p as Re,F as R,g as Z,j as xe,u as be,v as he,b as I,h as y,q as Ce,Z as Ee}from"./app-nikgK0qS.js";import{B as De,a as Le}from"./ButtonCancelar-BTyy3aOP.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as Ue}from"./ButtonEditeMedio-DA8JFdce.js";import{L as Fe}from"./LayoutFranqueado-C2yN6MR5.js";import"./ButtonPrimary-Cfkpbydk.js";import"./user-Cep6zz7g.js";var U,te;function ye(){if(te)return U;te=1;function e(o){var n=typeof o;return o!=null&&(n=="object"||n=="function")}return U=e,U}var F,oe;function Me(){if(oe)return F;oe=1;var e=typeof O=="object"&&O&&O.Object===Object&&O;return F=e,F}var M,re;function we(){if(re)return M;re=1;var e=Me(),o=typeof self=="object"&&self&&self.Object===Object&&self,n=e||o||Function("return this")();return M=n,M}var N,ae;function Ne(){if(ae)return N;ae=1;var e=we(),o=function(){return e.Date.now()};return N=o,N}var V,ne;function Ve(){if(ne)return V;ne=1;var e=/\s/;function o(n){for(var a=n.length;a--&&e.test(n.charAt(a)););return a}return V=o,V}var B,ie;function Be(){if(ie)return B;ie=1;var e=Ve(),o=/^\s+/;function n(a){return a&&a.slice(0,e(a)+1).replace(o,"")}return B=n,B}var G,se;function qe(){if(se)return G;se=1;var e=we(),o=e.Symbol;return G=o,G}var z,de;function Ge(){if(de)return z;de=1;var e=qe(),o=Object.prototype,n=o.hasOwnProperty,a=o.toString,i=e?e.toStringTag:void 0;function f(d){var p=n.call(d,i),g=d[i];try{d[i]=void 0;var r=!0}catch{}var s=a.call(d);return r&&(p?d[i]=g:delete d[i]),s}return z=f,z}var A,ue;function ze(){if(ue)return A;ue=1;var e=Object.prototype,o=e.toString;function n(a){return o.call(a)}return A=n,A}var Q,le;function Ae(){if(le)return Q;le=1;var e=qe(),o=Ge(),n=ze(),a="[object Null]",i="[object Undefined]",f=e?e.toStringTag:void 0;function d(p){return p==null?p===void 0?i:a:f&&f in Object(p)?o(p):n(p)}return Q=d,Q}var W,ce;function Qe(){if(ce)return W;ce=1;function e(o){return o!=null&&typeof o=="object"}return W=e,W}var H,fe;function We(){if(fe)return H;fe=1;var e=Ae(),o=Qe(),n="[object Symbol]";function a(i){return typeof i=="symbol"||o(i)&&e(i)==n}return H=a,H}var K,me;function He(){if(me)return K;me=1;var e=Be(),o=ye(),n=We(),a=NaN,i=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,d=/^0o[0-7]+$/i,p=parseInt;function g(r){if(typeof r=="number")return r;if(n(r))return a;if(o(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=o(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=e(r);var l=f.test(r);return l||d.test(r)?p(r.slice(2),l?2:8):i.test(r)?a:+r}return K=g,K}var X,pe;function Ke(){if(pe)return X;pe=1;var e=ye(),o=Ne(),n=He(),a="Expected a function",i=Math.max,f=Math.min;function d(p,g,r){var s,l,w,q,u,m,b=0,k=!1,j=!1,E=!0;if(typeof p!="function")throw new TypeError(a);g=n(g)||0,e(r)&&(k=!!r.leading,j="maxWait"in r,w=j?i(n(r.maxWait)||0,g):w,E="trailing"in r?!!r.trailing:E);function D(v){var T=s,$=l;return s=l=void 0,b=v,q=p.apply($,T),q}function Te(v){return b=v,u=setTimeout(P,g),k?D(v):q}function ke(v){var T=v-m,$=v-b,ee=g-T;return j?f(ee,w-$):ee}function J(v){var T=v-m,$=v-b;return m===void 0||T>=g||T<0||j&&$>=w}function P(){var v=o();if(J(v))return Y(v);u=setTimeout(P,ke(v))}function Y(v){return u=void 0,E&&s?D(v):(s=l=void 0,q)}function je(){u!==void 0&&clearTimeout(u),b=0,s=m=l=u=void 0}function $e(){return u===void 0?q:Y(o())}function L(){var v=o(),T=J(v);if(s=arguments,l=this,m=v,T){if(u===void 0)return Te(m);if(j)return clearTimeout(u),u=setTimeout(P,g),D(m)}return u===void 0&&(u=setTimeout(P,g)),q}return L.cancel=je,L.flush=$e,L}return X=d,X}var Xe=Ke();const Ze=Ie(Xe),Je={key:0,class:"sidebar-container"},Ye={key:0,class:"loading-overlay"},et={key:1},tt={class:"w-full h-[80%] bg-white rounded-[20px] p-12"},ot={class:"relative w-full h-full"},rt={class:"flex items-center"},at={class:"w-1/1 flex justify-center"},nt=["src"],it={class:"w-2/3 pl-5"},st={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},dt={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},ut={class:"mt-5"},lt={class:"min-w-full table-auto"},ct={class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonDireita"},ft={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},mt={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},pt={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},gt=["onUpdate:modelValue","onInput"],vt={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},_t={class:"flex justify-left mt-12"},xt={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(e,{emit:o}){const n=Pe(),a=e,i=o,f=h(""),d=h(""),p=h(!1),g=h(!1),r=h("");Oe(()=>a.produto,u=>{u&&(f.value=u.nome||"",d.value=u.categoria||"")},{immediate:!0});const s=u=>u?new URL(u,window.location.origin).href:"/storage/images/no_imagem.svg",l=Ze(u=>{ge.put(`/api/estoque/estoque/lote/${u.id}`,{quantidade:u.quantidade}).then(m=>{n.success("Quantidade do lote atualizada!")}).catch(m=>{n.error("Erro ao atualizar o lote.")})},1e3),w=u=>{r.value=u,g.value=!0},q=()=>{i("cancelar")};return(u,m)=>(c(),S(Ce,{name:"fade"},{default:ve(()=>[e.isVisible?(c(),x("div",Je,[p.value?(c(),x("div",Ye,m[1]||(m[1]=[t("div",{class:"spinner"},null,-1)]))):(c(),x("div",et,[t("div",tt,[t("div",ot,[t("div",rt,[t("div",at,[t("img",{src:s(e.produto.profile_photo),alt:"Foto do Produto",class:"w-20 h-20 rounded-md shadow-lg"},null,8,nt)]),t("div",it,[t("div",st,[_e(_(e.produto.nome||"N/A")+" ",1),t("div",dt,_(e.produto.unidadeDeMedida==="a_granel"&&e.produto.valor_pago_por_quilo_lote?e.produto.valor_pago_por_quilo_lote:e.produto.valor_total_lote),1)])])])])]),t("form",{onSubmit:m[0]||(m[0]=Re(b=>w("Atualizar este produto?"),["prevent"]))},[t("div",ut,[t("table",lt,[t("thead",null,[t("tr",null,[m[2]||(m[2]=t("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),m[3]||(m[3]=t("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," Fornecedor ",-1)),m[4]||(m[4]=t("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," qtd ",-1)),t("th",ct,_(e.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1)])]),t("tbody",null,[(c(!0),x(R,null,Z(e.produto.lotes,b=>(c(),x("tr",{key:b.id},[t("td",ft,_(b.data),1),t("td",mt,_(b.fornecedor),1),t("td",pt,[xe(t("input",{"onUpdate:modelValue":k=>b.quantidade=k,type:"number",min:"0",class:"border rounded-lg px-2 py-1 w-[75px] h-[32px] text-center",onInput:k=>be(l)(b)},null,40,gt),[[he,b.quantidade]])]),t("td",vt,_(b.preco_unitario),1)]))),128))])])]),t("div",_t,[I(De,{text:"Voltar",onClick:q})])],32)]))])):y("",!0)]),_:1}))}},bt=C(xt,[["__scopeId","data-v-9ad6d994"]]),ht={class:"elemento-fixo"},yt={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},wt={class:"relative w-full h-full"},qt={class:"flex items-center"},Tt={class:"w-1/1 flex justify-center"},kt=["src"],jt={class:"w-2/3 pl-5"},$t={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},St={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},It={key:1,class:""},Pt={class:"mt-8"},Ot={class:"min-w-full table-auto"},Rt={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Ct={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Et={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Dt={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Lt={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ut={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ft={key:0,class:"mt-4"},Mt={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},emits:["atualizar"],setup(e,{emit:o}){const n=o,a=h(!1),i=h(!1),f=()=>{h.dadosProduto.fetchProduto()},d=r=>r?new URL(r,window.location.origin).href:"/storage/images/no_imagem.svg",p=()=>{i.value=!i.value,a.value=!1},g=()=>{n("atualizar"),i.value=!1,a.value=!0};return(r,s)=>(c(),x("div",ht,[i.value?y("",!0):(c(),x("div",yt,[t("div",wt,[t("div",qt,[t("div",Tt,[t("img",{src:d(e.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,kt)]),t("div",jt,[t("div",$t,[_e(_(e.produto.nome||"N/A")+" ",1),t("div",St,_(e.produto.unidadeDeMedida==="a_granel"&&e.produto.valor_pago_por_quilo_lote?e.produto.valor_pago_por_quilo_lote:e.produto.valor_total_lote),1)])])])])])),i.value?y("",!0):(c(),x("div",It,[t("div",Pt,[t("table",Ot,[t("thead",null,[t("tr",null,[s[0]||(s[0]=t("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),s[1]||(s[1]=t("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),s[2]||(s[2]=t("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),t("th",Rt,_(e.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),s[3]||(s[3]=t("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),t("tbody",null,[(c(!0),x(R,null,Z(e.produto.lotes,(l,w)=>(c(),x("tr",{key:w,class:"text-center"},[t("td",Ct,_(l.data),1),t("td",Et,_(l.fornecedor),1),t("td",Dt,_(l.quantidade)+" "+_(e.produto.unidadeDeMedida==="unitario"?"uni":"kg"),1),t("td",Lt,_(e.produto.unidadeDeMedida==="unitario"?l.preco_unitario:l.valor_pago_por_quilo),1),t("td",Ut,_(e.produto.unidadeDeMedida==="unitario"?l.valor_total:l.preco_unitario),1)]))),128))])])]),e.produto.id&&!i.value?(c(),x("div",Ft,[I(Ue,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:p,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):y("",!0)])),i.value?(c(),S(bt,{key:2,ref:"dadosProduto",isVisible:i.value,produto:e.produto,onDadosProduto:f,onCancelar:g},null,8,["isVisible","produto"])):y("",!0)]))}},Nt=C(Mt,[["__scopeId","data-v-1594529a"]]),Vt={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const e=await ge.get("/api/estoque/lista");console.log("Produtos carregados:",e.data),this.produtos=Object.values(e.data)}catch(e){console.error("Erro ao carregar os produtos:",e)}},getProfilePhotoUrl(e){return e?new URL(e,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(e){this.$emit("produto-selecionado",e)},getQuantidadeTotal(e){return e.reduce((o,n)=>o+n.quantidade,0)}},computed:{filteredProdutos(){const e=this.searchQuery.toLowerCase();return this.produtos.filter(o=>o.nome.toLowerCase().includes(e))}}},Bt={class:"search-container relative flex items-center w-full mb-4"},Gt={class:"card-container"},zt=["onClick"],At={class:"card-inner"},Qt={class:"icon-container"},Wt={class:"icon-leaf"},Ht=["src"],Kt={class:"text-container flex justify-between items-center p-2"},Xt={class:"city"},Zt={class:"quantidade text-gray-600 font-semibold"},Jt={class:"text-gray-600 font-semibold"};function Yt(e,o,n,a,i,f){return c(),x("div",null,[o[3]||(o[3]=t("div",{class:"painel-title"},"Inventário da loja",-1)),o[4]||(o[4]=t("div",{class:"painel-subtitle"},[t("p",null,"Verifique a quantidade de cada item")],-1)),t("div",Bt,[o[1]||(o[1]=t("div",{class:"absolute left-3"},[t("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),xe(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=d=>i.searchQuery=d),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[he,i.searchQuery]])]),t("div",Gt,[(c(!0),x(R,null,Z(f.filteredProdutos,d=>(c(),x("div",{key:d.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:p=>f.selecionarProduto(d)},[t("div",At,[t("div",Qt,[o[2]||(o[2]=t("div",{class:"icon-bg"},null,-1)),t("div",Wt,[t("img",{src:f.getProfilePhotoUrl(d.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,Ht)])]),t("div",Kt,[t("div",Xt,_(d.nome),1),t("div",Zt,[t("div",Jt,_(f.getQuantidadeTotal(d.lotes))+" "+_(d.unidadeDeMedida==="unitario"?"uni":"kg"),1)])])])],8,zt))),128))])])}const eo=C(Vt,[["render",Yt],["__scopeId","data-v-4a66bd72"]]),to={key:0,class:"mt-6"},oo={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},ro={key:0},ao={class:"flex flex-col gap-4"},no={key:1,class:"absolute bottom-4 right-4 botao-container"},io={__name:"Index",setup(e){const o=h(null),n=h(0),a=h(!1),i=h(!1),f=()=>{a.value=!a.value},d=()=>{console.log("atualizando a lista"),o.value=null,n.value+=1},p=()=>{g(),a.value=!1},g=()=>{var l;(l=h("listarUnidades").value)==null||l.fetchUnidades()},r=s=>{s&&typeof s=="object"?o.value=s:console.warn("Dados inválidos recebidos no evento produto-selecionado:",s)};return(s,l)=>(c(),S(Fe,null,{default:ve(()=>[I(be(Ee),{title:"Insumos"}),a.value?(c(),x("div",to,[I(Se,{isVisible:a.value,onUnidadeCadastrada:p,onCancelar:f},null,8,["isVisible"])])):y("",!0),t("div",oo,[a.value?y("",!0):(c(),x("div",ro,[(c(),S(eo,{key:n.value,ref:"listarUnidades",onUnidadeCadastrada:g,onProdutoSelecionado:r}))])),t("div",ao,[a.value?y("",!0):(c(),x(R,{key:0},[o.value?(c(),S(Nt,{key:0,onAtualizar:d,produto:o.value},null,8,["produto"])):y("",!0),i.value?y("",!0):(c(),x("div",no,[I(Le,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:f})]))],64))])])]),_:1}))}},vo=C(io,[["__scopeId","data-v-65e679f0"]]);export{vo as default};
