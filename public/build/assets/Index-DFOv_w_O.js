import{l as T,d as f,j as K,e as d,o as t,a as e,f as y,c as k,b as c,t as v,g as Z,F,h as D,i as H,k as J,w as Q,u as W,Z as X}from"./app-C6S9B82p.js";import{L as Y}from"./LayoutFranqueado-02yHi17o.js";import{_ as w}from"./LabelModel-IJoYw9zD.js";import{C as z}from"./ConfirmDialog-DhHMDAdA.js";import{D as ee}from"./Deslizante-IN2cM-Tu.js";import{B as se}from"./ButtonEditeMedio-CkiQrXg7.js";import{E as oe,C as ae}from"./EditarColaborador-ollV14oM.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as te}from"./ButtonPrimaryMedio-DLBJAL6-.js";/* empty css                                                                   */import"./ButtonCancelar-DMT6YXo3.js";const re={class:"elemento-fixo"},le={key:0},ie={key:0,class:"loading-overlay"},ne={class:"w-full h-[300px] bg-white rounded-tl-[20px] rounded-tr-[20px] p-7 relative"},de={class:"flex justify-between items-center"},ue={class:"w-1/1 flex justify-center"},ce=["src"],me={class:"w-2/3"},fe={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},pe={class:"flex"},_e={class:"w-full h-[44px] mr-2 bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500 mt-2 flex items-center"},ge={class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500 mt-2 flex items-center"},ve={class:"grid grid-cols-2 gap-4 mt-8"},xe={class:"w-full h-[44px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] p-2 text-base font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},be={class:"w-full h-[44px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] p-2 text-base font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},ye={class:"flex justify-between items-center mt-5 w-full p-1"},he={class:"flex items-center w-2/3"},Ce={key:0,class:"bg-[#EFEFEF] p-3 px-8 w-full rounded-bl-[20px] rounded-br-[20px]"},we={class:"flex flex-col w-2/3"},Ee={class:"w-1/2 flex justify-end"},ke={key:1,class:"flex flex-col h-[270px] items-center justify-center bg-[#EFEFEF] rounded-lg"},Fe={class:"text-[100px] font-bold text-[#6DB631]"},qe={key:0,class:"mt-4"},ze={__name:"DetalhesColaborador",props:{dados:{type:Object,required:!0}},emits:["voltar","atualiza"],setup(i,{emit:_}){const a=T(),s=i,x=_,u=f(!1),g=f(!1),n=f(!1),r=f(!1),m=f(!1),b=f(""),E=f(!0),$=["id","user_id","created_at","updated_at"],P=()=>{u.value=!u.value,m.value=!1},B=()=>{x("atualizar"),u.value=!1,m.value=!0},N=()=>{E.value=!E.value},j=o=>({controle_estoque:"Gestão de Estoque",controle_saida_estoque:"Saída de Estoque",gestao_equipe:"Gestão de Equipe",fluxo_caixa:"Fluxo de Caixa",dre:"DRE",contas_pagar:"Contas a Pagar",gestao_salmao:"Gestão de Salmão"})[o]||o,A=K(()=>s.dados.salario?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.dados.salario):"R$ 0,00"),I=async(o,l)=>{s.dados.user_permission||(s.dados.user_permission={}),s.dados.user_permission[o]=!!l,console.log(`Alterando ${o} para`,s.dados.user_permission[o]);const C={user_id:s.dados.id,controle_estoque:s.dados.user_permission.controle_estoque||!1,controle_saida_estoque:s.dados.user_permission.controle_saida_estoque||!1,gestao_equipe:s.dados.user_permission.gestao_equipe||!1,fluxo_caixa:s.dados.user_permission.fluxo_caixa||!1,dre:s.dados.user_permission.dre||!1,contas_pagar:s.dados.user_permission.contas_pagar||!1,gestao_salmao:s.dados.user_permission.gestao_salmao||!1};try{r.value=!0;const h=await axios.post("/api/usuarios/upsert-permissions",C);a.success("Permissões atualizadas com sucesso"),x("atualiza")}catch(h){console.error("Erro ao atualizar permissões:",h),a.error("Erro ao atualizar permissões")}finally{r.value=!1}},S=async()=>{try{n.value=!1,r.value=!0;const o=await axios.post("/api/usuarios/regenera-pin",{user_id:s.dados.id});a.success("PIN atualizado com sucesso"),x("voltar")}catch(o){console.error("Erro ao atualizar o PIN:",o),a.error("Erro ao atualizar o PIN")}finally{r.value=!1}},L=o=>{b.value=o,g.value=!0},U=o=>{b.value=o,n.value=!0},G=()=>{n.value=!1},M=()=>{g.value=!1,O()},R=()=>{g.value=!1},O=async()=>{if(!s.dados||!s.dados.id){a.error("Erro: Dados da conta não encontrados.");return}try{const o=await axios.delete(`/api/usuarios/delete/${s.dados.id}`);a.success("Conta excluída com sucesso"),x("voltar")}catch(o){a.error("Erro ao excluir a conta"),console.error("Erro ao excluir a conta:",o)}};return(o,l)=>{var C,h;return t(),d(F,null,[e("div",re,[u.value?y("",!0):(t(),d("div",le,[r.value?(t(),d("div",ie,l[2]||(l[2]=[e("div",{class:"spinner"},null,-1)]))):y("",!0),e("div",null,[e("div",ne,[e("div",de,[e("div",ue,[e("img",{src:i.dados.profile_photo_url||"/storage/images/default-profile.png",alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-sm"},null,8,ce)]),e("div",me,[e("div",fe,v(i.dados.name||"N/A"),1),e("div",pe,[e("div",_e,[e("span",null,v(((C=i.dados.cargo)==null?void 0:C.nome)||"Cargo não atribuído"),1)]),e("div",ge,[e("span",null,v(((h=i.dados.setor)==null?void 0:h.name)||"Setor não atribuído"),1)])])]),e("button",{class:"text-gray-500 hover:text-red-600 mt-8",onClick:l[0]||(l[0]=p=>L("Excluir essa conta?"))},l[3]||(l[3]=[e("img",{src:"/storage/images/delete.svg",alt:"Excluir",class:"w-6 h-6"},null,-1)]))]),e("div",ve,[e("div",null,[c(w,{text:"E-mail"}),e("p",xe,v(i.dados.email),1)]),e("div",null,[c(w,{text:"Salário"}),e("p",be,v(A.value),1)])]),e("div",ye,[e("div",he,[l[4]||(l[4]=e("img",{class:"w-5 h-5 mr-2",src:"/storage/images/security_bleck.svg",alt:"icone svg"},null,-1)),c(w,{class:"font-semibold text-gray-900",text:"Permissões"})]),e("div",{class:"w-1/2 flex justify-end"},[e("p",{class:"font-bold text-[#6DB631] cursor-pointer",onClick:N},l[5]||(l[5]=[e("span",{class:"underline"},"***",-1),Z(" PIN ")]))])])]),E.value?(t(),d("div",Ce,[(t(!0),d(F,null,D(Object.keys(i.dados.user_permission||{}).filter(p=>!$.includes(p)),p=>(t(),d("div",{key:p,class:"flex justify-between items-center"},[e("div",we,[c(w,{class:"font-semibold text-gray-900",text:j(p)},null,8,["text"])]),e("div",Ee,[c(ee,{status:i.dados.user_permission[p],"onUpdate:status":q=>i.dados.user_permission[p]=q,onClick:q=>I(p,i.dados.user_permission[p])},null,8,["status","onUpdate:status","onClick"])])]))),128))])):(t(),d("div",ke,[e("p",Fe,v(s.dados.pin),1),e("button",{onClick:l[1]||(l[1]=p=>U("Redefinir PIN?")),class:"text-[#FF2D55] font-semibold rounded-lg underline"}," Redefinir PIN ")]))])]))]),i.dados.id&&!u.value?(t(),d("div",qe,[c(se,{text:"Editar Colaborador","icon-path":"/storage/images/border_color.svg",onClick:P,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):y("",!0),u.value?(t(),k(oe,{key:1,user:i.dados,isVisible:u.value,onVoltar:B,onAtualizado:o.handleAtualizacao},null,8,["user","isVisible","onAtualizado"])):y("",!0),c(z,{isVisible:g.value,motivo:b.value,onConfirm:M,onCancel:R},null,8,["isVisible","motivo"]),c(z,{isVisible:n.value,motivo:b.value,onConfirm:S,onCancel:G},null,8,["isVisible","motivo"])],64)}}},De=V(ze,[["__scopeId","data-v-6db8230d"]]),Ve=["onClick"],$e=["src"],Pe={class:"text-lg font-medium text-gray-900"},Be={class:"text-sm text-gray-600"},Ne={__name:"ListarColaboradores",emits:["usuario-selecionado","abrir-cadastro"],setup(i,{emit:_}){const a=_,s=f([]);H(async()=>{try{const n=await J.get("/api/usuarios/colaboradores");s.value=n.data.map(r=>({...r,permissions:r.permissions||{controle_estoque:!1,controle_saida_estoque:!1,gestao_equipe:!1,fluxo_caixa:!1,dre:!1,contas_pagar:!1}}))}catch(n){console.error("Erro ao carregar os usuários:",n)}});const u=n=>{a("usuario-selecionado",n)},g=()=>{a("abrir-cadastro")};return(n,r)=>(t(),d("div",null,[r[0]||(r[0]=e("div",{class:"painel-title"},"Gestão de equipe",-1)),r[1]||(r[1]=e("div",{class:"painel-subtitle"},[e("p",null,"Gerencie a sua equipe e permissões aqui")],-1)),c(te,{text:"Cadastrar colaborador",class:"w-full",onClick:g}),(t(!0),d(F,null,D(s.value,m=>(t(),d("div",{key:m.id,onClick:b=>u(m),class:"flex items-center bg-white p-4 rounded-lg cursor-pointer hover:bg-gray-100 transition mt-3"},[e("img",{src:m.profile_photo_url,alt:"Foto de perfil",class:"w-12 h-12 object-cover mr-4"},null,8,$e),e("div",null,[e("p",Pe,v(m.name),1),e("p",Be,v(m.email),1)])],8,Ve))),128))]))}},je=V(Ne,[["__scopeId","data-v-8e977923"]]),Ae={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mt-3 h-full"},Ie={key:0,class:"mt-3"},Se={key:1},Qe={__name:"Index",setup(i){const _=f(0),a=f(null),s=f(!1),x=()=>{s.value=!s.value,s.value&&(a.value=null)},u=m=>{a.value=m},g=()=>{s.value=!1,_.value+=1,console.log("cancelarCadastro")},n=()=>{a.value=null,_.value+=1},r=()=>{_.value+=1,u.value=null};return(m,b)=>(t(),k(Y,null,{default:Q(()=>[c(W(X),{title:"Gestão de Equipe"}),e("div",Ae,[(t(),k(je,{key:_.value,ref:"listaDados",onUsuarioSelecionado:u,onAbrirCadastro:x})),s.value?(t(),d("div",Ie,[c(ae,{onVoltar:g})])):y("",!0),a.value?(t(),d("div",Se,[c(De,{dados:a.value,onVoltar:n,onAtualiza:r},null,8,["dados"])])):y("",!0)])]),_:1}))}};export{Qe as default};
