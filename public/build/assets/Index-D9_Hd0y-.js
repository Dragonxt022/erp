import{l as O,d as u,i as J,o as t,e as r,a as e,j as I,s as te,F as S,g as j,t as x,b as $,h as y,v as E,w as A,f as M,p as Q,k as N,y as oe,q as X,c as F,m as se,x as z,u as ae,Z as re}from"./app-CKlGL9XP.js";import{_ as L,I as H,B as W,a as K,d as Z,C as ne}from"./ConfirmDialog-BT5jkdop.js";import{B as le}from"./ButtonPrimary-B-sHPTUI.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                         */import{L as ie}from"./LayoutFranqueado-DfcWf3v8.js";import"./user-DnO8vchV.js";const de={key:0,class:"w-[100%] h-full flex flex-col p-4 bg-gray-50"},ue={class:"mb-6 relative"},ce={class:"relative"},pe=["value"],ve={class:"w-full bg-white rounded-lg p-6 mb-6"},fe={class:"flex items-center"},me={class:"flex-shrink-0"},ge=["src"],_e={class:"ml-6"},xe={class:"text-2xl font-semibold text-gray-800"},ye={key:0,class:"text-red-500 text-sm text-center"},he={class:"relative flex items-center w-full"},be={class:"flex justify-end space-x-4"},$e={__name:"CadastrarInsumoEstoque",props:{produtoSelecionado:{type:Object,required:!1}},setup(i,{emit:n}){var B;const d=O(),h=n,_=i,c=u([]),l=u(""),p=u(""),g=u(((B=_.produtoSelecionado)==null?void 0:B.valor)||""),V=u(!1);u(!1);const P=u(!1),q=u(""),D=J(()=>_.produtoSelecionado.unidadeDeMedida==="a_granel"?"Kg":"Quantidade"),U=J(()=>_.produtoSelecionado.unidadeDeMedida==="a_granel"?"Digite o peso (ex: 1.5)":"Digite a quantidade"),s=()=>{const C=_.produtoSelecionado.unidadeDeMedida==="a_granel"?/^[0-9]+(\.[0-9]+)?$/:/^[0-9]+$/;V.value=!C.test(p.value)},o=()=>{const C=g.value.replace(/\D/g,""),w=C.slice(0,-2)||"0",f=C.slice(-2).padStart(2,"0");g.value=`R$ ${Number(w).toLocaleString("pt-BR")},${f}`},a=()=>{p.value="",g.value=""};(async()=>{try{const C=await N.get("/api/estoque/fornecedores");c.value=C.data.data.map(w=>({id:w.id||"N/D",razao_social:w.razao_social||"N/D"}))}catch(C){console.error("Erro ao carregar fornecedores:",C)}})();const k=C=>C?new URL(C,window.location.origin).href:"/storage/images/no_imagem.svg",G=()=>(q.value="",l.value?!p.value||V.value?(d.error("Quantidade inválida."),q.value="Quantidade inválida.",!1):!g.value||P.value?(d.error("Valor inválido."),q.value="Valor inválido.",!1):!0:(d.error("Fornecedor não selecionado."),q.value="Fornecedor não selecionado.",!1)),T=()=>{if(!G())return;const C={..._.produtoSelecionado,fornecedor_id:l.value,quantidade:p.value,valor:g.value,unidade_de_medida:_.produtoSelecionado.unidadeDeMedida};d.success("Inusmo adicionado"),a(),h("adicionarAoCarrinho",C)};return(C,w)=>i.produtoSelecionado?(t(),r("div",de,[w[5]||(w[5]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",ue,[e("div",ce,[I(e("select",{"onUpdate:modelValue":w[0]||(w[0]=f=>l.value=f),id:"fornecedor",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-green-600 focus:ring-2 focus:ring-green-500 font-['Figtree']"},[w[3]||(w[3]=e("option",{value:"",disabled:""},"Selecione um fornecedor",-1)),(t(!0),r(S,null,j(c.value,f=>(t(),r("option",{key:f.id,value:f.id},x(f.razao_social),9,pe))),128))],512),[[te,l.value]])])]),e("div",ve,[e("div",fe,[e("div",me,[e("img",{src:k(i.produtoSelecionado.profile_photo),alt:"Foto do Produto",class:"w-24 h-24 rounded-lg"},null,8,ge)]),e("div",_e,[e("div",xe,x(i.produtoSelecionado.nome||"N/A"),1)])])]),e("form",{onSubmit:Q(T,["prevent"]),class:"space-y-4"},[e("div",null,[$(L,{text:D.value},null,8,["text"]),$(H,{modelValue:p.value,"onUpdate:modelValue":w[1]||(w[1]=f=>p.value=f),placeholder:U.value,onInput:s},null,8,["modelValue","placeholder"]),V.value?(t(),r("p",ye," Insira um valor válido. ")):y("",!0)]),e("div",null,[$(L,{text:"Valor"}),e("div",he,[I(e("input",{"onUpdate:modelValue":w[2]||(w[2]=f=>g.value=f),placeholder:"R$ 0,00",onInput:o,class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},null,544),[[E,g.value]])])]),e("div",be,[$(le,{onClick:T},{default:A(()=>w[4]||(w[4]=[M("Adicionar")])),_:1})])],32)])):y("",!0)}},we=R($e,[["__scopeId","data-v-1cab2bac"]]),ke={class:"flex gap-5"},Ce={key:0,class:"loading-overlay"},qe={class:"flex-1"},Ve={class:"min-w-full table-auto"},Pe=["onDblclick"],Ue={class:"px-6 py-4 text-[16px] text-left text-gray-900 font-semibold"},De={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-center"},Ie=["onUpdate:modelValue"],Se={key:1},Re={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-left"},Ee={key:0},Me=["onUpdate:modelValue"],Fe={key:2},Le={class:"px-6 py-4 text-[16px] text-gray-500 text-center"},je=["onUpdate:modelValue"],Ae={key:1},Ne={class:"px-6 py-4 text-center"},Te=["onClick"],Be={key:0,class:"botao-container"},ze={__name:"ResumoCarrinho",props:{carrinho:{type:Array,required:!0}},emits:["confirmar","cancelar"],setup(i,{emit:n}){const d=O(),h=i,_=n,c=u(!1),l=u(!1),p=u(null),g=s=>{h.carrinho.splice(s,1),d.info("Item removido com sucesso!")},V=s=>{p.value=s},P=s=>{const o=parseFloat((s.valor||"0").replace("R$","").replace(",","."));return s.quantidade>0?o/s.quantidade:0},q=s=>s.unidadeDeMedida==="a_granel"?P(s)*s.quantidade:s.quantidade*parseFloat(s.valor.replace("R$","").replace(",",".")),D=async()=>{var s;c.value=!0,l.value=!0;try{const o={fornecedor_id:((s=h.carrinho[0])==null?void 0:s.fornecedor_id)||null,itens:h.carrinho.map(b=>({id:b.id,nome:b.nome,quantidade:b.quantidade,unidadeDeMedida:b.unidadeDeMedida,valorUnitario:Math.round(parseFloat(b.valor.replace("R$","").replace(",","."))*100),total:Math.round(q(b)*100)}))};console.log("Dados enviados:",JSON.stringify(o,null,2));const a=await axios.post("/api/estoque/armazenar-entrada",o);a.status===201?(console.log("Resposta da API:",a.data),Z.Inertia.visit(route("franqueado.inventario")),d.success("Lista de insumos salvas em seu estoque.")):d.error("Erro ao salvar no estoque, tente novamente.")}catch(o){console.error("Erro ao enviar entrada:",o),d.error("Erro ao confirmar entrada. Tente novamente ou chame o suporte.")}finally{c.value=!1}},U=()=>{_("cancelar")};return(s,o)=>(t(),r("div",ke,[c.value?(t(),r("div",Ce,o[0]||(o[0]=[e("div",{class:"spinner"},null,-1)]))):y("",!0),o[3]||(o[3]=e("div",{class:"flex-1"},[e("div",{class:"painel-title"},"Confirmar entrada"),e("div",{class:"painel-subtitle"},[e("p",null,"Vamos conferir se está tudo certo")]),e("div",{class:"mt-[25%] text-[#6d6d6d] text-[18px] font-normal font-['Figtree'] leading-[23px] tracking-tight"},[M(" Você confirma que está "),e("br"),M(" realizando uma nova entrada "),e("br"),M(" com os seguintes itens? ")])],-1)),e("div",qe,[e("table",Ve,[o[2]||(o[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-xs text-left font-medium text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," Item "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," QTD. "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," V. UN/KG "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," TOTAL "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider TrRedonDireita"}," AÇÃO ")])],-1)),e("tbody",null,[(t(!0),r(S,null,j(i.carrinho,(a,b)=>(t(),r("tr",{key:a.id,onDblclick:k=>V(b)},[e("td",Ue,x(a.nome),1),e("td",De,[p.value===b?I((t(),r("input",{key:0,type:"number","onUpdate:modelValue":k=>a.quantidade=k,class:"border border-gray-300 rounded px-2 py-1 w-16"},null,8,Ie)),[[E,a.quantidade,void 0,{number:!0}]]):(t(),r("span",Se,x(a.quantidade)+" "+x(a.unidadeDeMedida==="a_granel"?"KG":"UN"),1))]),e("td",Re,[a.unidadeDeMedida==="a_granel"?(t(),r("span",Ee," R$ "+x(P(a).toFixed(2)),1)):p.value===b?I((t(),r("input",{key:1,type:"text","onUpdate:modelValue":k=>a.valor=k,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,Me)),[[E,a.valor]]):(t(),r("span",Fe,x(a.valor),1))]),e("td",Le,[p.value===b&&a.unidadeDeMedida==="a_granel"?I((t(),r("input",{key:0,type:"number","onUpdate:modelValue":k=>a.valorTotal=k,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,je)),[[E,a.valorTotal,void 0,{number:!0}]]):(t(),r("span",Ae,x(q(a).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1))]),e("td",Ne,[e("button",{onClick:k=>g(b),class:"w-[16] h-[16]"},o[1]||(o[1]=[e("img",{src:"/storage/images/delete.svg",alt:"icone de excluir",class:"w-[16px] h-[16px]"},null,-1)]),8,Te)])],40,Pe))),128))])]),l.value?y("",!0):(t(),r("div",Be,[$(W,{text:"Voltar",onClick:U}),$(K,{text:"Confirmar",onClick:D})]))])]))}},Qe=R(ze,[["__scopeId","data-v-2191093f"]]),Oe={key:0},Ke={key:0,class:"sidebar-container"},Ge={key:0,class:"loading-overlay"},Je={key:1,class:"flex"},Xe={class:"flex-1 p-4"},Ze={class:"relative flex items-center w-full mb-4"},He={class:"space-y-4"},We=["onClick"],Ye={class:"flex-shrink-0"},et=["src"],tt={class:"ml-4 flex-1"},ot={class:"text-lg font-semibold flex items-center"},st={key:0,class:"ml-5 text-xs bg-green-100 text-green-600 font-bold rounded-full px-2 py-1"},at={key:1,class:"mr-2 ml-5 text-yellow-500",title:"Essa estrela sigifinica que esse insumo e um produto princial"},rt={class:"absolute bottom-4 right-4 mt-5 botao-container"},nt={class:"flex-1 p-4"},lt={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},setup(i){const n=u([]),d=u(""),h=u(!1),_=u(null),c=u([]),l=u(!1),p=()=>{console.log("Entrada confirmada",c.value),mostrarModalRevisao.value=!1,c.value=[]},g=async()=>{h.value=!0;try{const s=await N.get("/api/produtos/lista");n.value=s.data}catch(s){console.error("Erro ao carregar os produtos:",s)}finally{h.value=!1}},V=s=>s?new URL(s,window.location.origin).href:"/storage/images/no_imagem.svg",P=s=>{_.value=s},q=s=>c.value.filter(o=>o.id===s).length,D=s=>{c.value.push(s),_.value=null},U=J(()=>n.value.filter(s=>s.nome.toLowerCase().includes(d.value.toLowerCase())));return oe(g),(s,o)=>(t(),r(S,null,[$(X,{name:"fade"},{default:A(()=>[l.value?y("",!0):(t(),r("div",Oe,[i.isVisible?(t(),r("div",Ke,[h.value?(t(),r("div",Ge,o[3]||(o[3]=[e("div",{class:"spinner"},null,-1)]))):(t(),r("div",Je,[e("div",Xe,[o[5]||(o[5]=e("div",{class:"painel-title"},"Nova entrada",-1)),o[6]||(o[6]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",Ze,[o[4]||(o[4]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),I(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>d.value=a),placeholder:"Buscar um produto",class:"pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[E,d.value]])]),e("div",He,[(t(!0),r(S,null,j(U.value,a=>(t(),r("div",{key:a.id,class:"flex items-center p-4 bg-white rounded-lg cursor-pointer",onClick:b=>P(a)},[e("div",Ye,[e("img",{src:V(a.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,et)]),e("div",tt,[e("div",ot,[M(x(a.nome)+" ",1),q(a.id)>0?(t(),r("span",st,x(q(a.id)),1)):y("",!0),a.estrela?(t(),r("span",at," ★ ")):y("",!0)])])],8,We))),128))])]),e("div",rt,[$(K,{text:"Finalizar",onClick:o[1]||(o[1]=a=>l.value=!0),iconPath:"/storage/images/arrow_left_alt.svg"})]),e("div",nt,[$(we,{produtoSelecionado:_.value,onAdicionarAoCarrinho:D},null,8,["produtoSelecionado"])])]))])):y("",!0)]))]),_:1}),l.value?(t(),F(Qe,{key:0,carrinho:c.value,onConfirmar:p,onCancelar:o[2]||(o[2]=a=>l.value=!1)},null,8,["carrinho"])):y("",!0)],64))}},it=R(lt,[["__scopeId","data-v-4deae6b8"]]),dt={key:0,class:"sidebar-container"},ut={key:0,class:"loading-overlay"},ct={key:1,class:"w-full h-[80%] bg-white rounded-[20px] p-12"},pt={class:"flex justify-center mb-6 relative group"},vt=["src"],ft={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},mt={key:0,class:"error-message"},gt={class:"flex items-center space-x-4 mt-2"},_t={class:"flex items-center space-x-2 cursor-pointer"},xt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},yt={key:0,class:"w-3 h-3 rounded-full bg-green-500"},ht={class:"flex items-center space-x-2 cursor-pointer"},bt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},$t={key:0,class:"w-3 h-3 rounded-full bg-green-500"},wt={class:"flex items-center space-x-4 mt-2"},kt={class:"flex items-center space-x-2 cursor-pointer"},Ct={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},qt={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Vt={class:"flex items-center space-x-2 cursor-pointer"},Pt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Ut={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Dt={class:"flex justify-start space-x-1 mt-[15%]"},It={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(i,{emit:n}){const d=O(),h=i,_=n,c=u(""),l=u(""),p=u(""),g=u(""),V=u(null),P=u(""),q=u(null),D=u(!1),U=u(!1),s=u("");se(()=>h.produto,f=>{f&&(c.value=f.nome||"",l.value=f.categoria||"",p.value=f.unidadeDeMedida||"",g.value=f.profile_photo||"")},{immediate:!0});const o=f=>f?new URL(f,window.location.origin).href:"/storage/images/no_imagem.svg",a=async()=>{var f,v;if(!c.value){d.error("O campo nome é obrigatório.");return}try{D.value=!0;const m=new FormData;if(m.append("id",h.produto.id),m.append("nome",c.value),m.append("categoria",l.value),m.append("unidadeDeMedida",p.value),V.value){const ee=`${Date.now()}_${V.value.name}`;m.append("profile_photo_name",ee),m.append("profile_photo",V.value)}const Y=await N.post("/api/produtos/atualizar",m,{headers:{"Content-Type":"multipart/form-data"}});Z.Inertia.replace(route("franqueadora.insumos"),{produto:Y.data.produto,preserveState:!0}),d.success("Produto atualizado com sucesso!")}catch(m){d.error("Erro ao atualizar o produto."),P.value=((v=(f=m.response)==null?void 0:f.data)==null?void 0:v.message)||"Erro inesperado."}finally{D.value=!1}},b=f=>{s.value=f,U.value=!0},k=()=>{a(),U.value=!1},G=()=>{U.value=!1},T=()=>{var f;(f=q.value)==null||f.click()},B=()=>{g.value="",d.info("Imagem removida.")},C=f=>{const v=f.target.files[0];if(v){if(v.size>5*1024*1024){d.error("A imagem não pode exceder 5 MB.");return}V.value=v;const m=new FileReader;m.onload=()=>{g.value=m.result,d.success("Imagem carregada com sucesso!")},m.readAsDataURL(v)}},w=()=>{_("cancelar")};return(f,v)=>(t(),F(X,{name:"fade"},{default:A(()=>[i.isVisible?(t(),r("div",dt,[D.value?(t(),r("div",ut,v[7]||(v[7]=[e("div",{class:"spinner"},null,-1)]))):(t(),r("div",ct,[e("form",{onSubmit:Q(a,["prevent"])},[e("div",pt,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:T},[g.value?(t(),r(S,{key:0},[e("img",{src:o(g.value),alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,vt),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:v[0]||(v[0]=Q(()=>{},["stop"]))},[e("button",{onClick:Q(B,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(t(),r("img",ft))]),e("input",{type:"file",ref_key:"fileInput",ref:q,accept:"image/*",class:"hidden",onChange:C},null,544)]),$(L,{text:"Nome"}),$(H,{modelValue:c.value,"onUpdate:modelValue":v[1]||(v[1]=m=>c.value=m),placeholder:""},null,8,["modelValue"]),P.value?(t(),r("div",mt,x(P.value),1)):y("",!0),$(L,{class:"font-semibold text-gray-800 mt-8",text:"Prioridade"}),e("div",gt,[e("label",_t,[I(e("input",{type:"radio","onUpdate:modelValue":v[2]||(v[2]=m=>l.value=m),value:"principal",class:"hidden"},null,512),[[z,l.value]]),e("div",xt,[l.value==="principal"?(t(),r("div",yt)):y("",!0)]),v[8]||(v[8]=e("span",null,"Principal",-1))]),e("label",ht,[I(e("input",{type:"radio","onUpdate:modelValue":v[3]||(v[3]=m=>l.value=m),value:"secundario",class:"hidden"},null,512),[[z,l.value]]),e("div",bt,[l.value==="secundario"?(t(),r("div",$t)):y("",!0)]),v[9]||(v[9]=e("span",null,"Secundário",-1))])]),$(L,{class:"font-semibold text-gray-800 mt-8",text:"Unidade de medida"}),e("div",wt,[e("label",kt,[I(e("input",{type:"radio","onUpdate:modelValue":v[4]||(v[4]=m=>p.value=m),value:"a_granel",class:"hidden"},null,512),[[z,p.value]]),e("div",Ct,[p.value==="a_granel"?(t(),r("div",qt)):y("",!0)]),v[10]||(v[10]=e("span",null,"A granel",-1))]),e("label",Vt,[I(e("input",{type:"radio","onUpdate:modelValue":v[5]||(v[5]=m=>p.value=m),value:"unitario",class:"hidden"},null,512),[[z,p.value]]),e("div",Pt,[p.value==="unitario"?(t(),r("div",Ut)):y("",!0)]),v[11]||(v[11]=e("span",null,"Unitário",-1))])]),e("div",Dt,[$(W,{text:"Cancelar",onClick:w}),$(K,{text:"Atualizar",onClick:v[6]||(v[6]=m=>b("Atualizar esse Produto?"))})])],32),$(ne,{isVisible:U.value,motivo:s.value,onConfirm:k,onCancel:G},null,8,["isVisible","motivo"])]))])):y("",!0)]),_:1}))}},St=R(It,[["__scopeId","data-v-f1b871f9"]]),Rt={props:{isVisible:{type:Boolean,default:!1},motivo:{type:String,required:!0}},methods:{confirm(){this.$emit("confirm")},cancel(){this.$emit("cancel")}}},Et={key:0,class:"confirm-dialog-overlay"},Mt={class:"confirm-dialog"},Ft={class:"confirm-dialog-content"},Lt={class:"confirm-dialog-actions"};function jt(i,n,d,h,_,c){return t(),F(X,{name:"fade"},{default:A(()=>[d.isVisible?(t(),r("div",Et,[e("div",Mt,[n[4]||(n[4]=e("div",{class:"alert-icon"},[e("img",{src:"/storage/images/warning.svg",alt:"Ícone de alerta"})],-1)),e("div",Ft,[e("p",null,"Você tem certeza que deseja "+x(d.motivo),1),e("div",Lt,[e("button",{onClick:n[0]||(n[0]=(...l)=>c.cancel&&c.cancel(...l)),class:"btn-cancel"},n[2]||(n[2]=[e("span",null,"CANCELAR",-1)])),e("button",{onClick:n[1]||(n[1]=(...l)=>c.confirm&&c.confirm(...l)),class:"btn-confirm"},n[3]||(n[3]=[e("span",null,"CONFIRMAR",-1)]))])])])])):y("",!0)]),_:1})}const At=R(Rt,[["render",jt],["__scopeId","data-v-f1cbb43c"]]),Nt={class:"elemento-fixo"},Tt={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Bt={class:"relative w-full h-full"},zt={class:"flex items-center"},Qt={class:"w-1/1 flex justify-center"},Ot=["src"],Kt={class:"w-2/3 pl-5"},Gt={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Jt={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},Xt={class:"w-1/1"},Zt={class:"mt-8"},Ht={class:"min-w-full table-auto"},Wt={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Yt={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},eo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},to={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},oo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},so={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},ao={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},setup(i){const n=O(),d=i,h=u(!1),_=u(""),c=u(!1),l=u(!1),p=u(!1),g=()=>{u.dadosProduto.fetchProduto()},V=s=>s?new URL(s,window.location.origin).href:"/storage/images/no_imagem.svg",P=async()=>{var s,o,a,b;try{p.value=!0;const k=await N.delete(`/api/produtos/excluir/${d.produto.id}`);console.log(k.data.message),n.success("Produto deletado com sucesso!"),Z.Inertia.visit(route("franqueadora.insumos"))}catch(k){n.error("Erro ao deletar o produto:",((o=(s=k.response)==null?void 0:s.data)==null?void 0:o.error)||k.message),console.error("Erro ao deletar o produto:",((b=(a=k.response)==null?void 0:a.data)==null?void 0:b.error)||k.message)}finally{p.value=!1}},q=()=>{P(),h.value=!1},D=()=>{h.value=!1},U=()=>{l.value=!1,c.value=!0};return(s,o)=>(t(),r("div",Nt,[l.value?y("",!0):(t(),r("div",Tt,[e("div",Bt,[e("div",zt,[e("div",Qt,[e("img",{src:V(i.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Ot)]),e("div",Kt,[e("div",Gt,[M(x(i.produto.nome||"N/A")+" ",1),e("div",Jt,x(i.produto.valor_total_lote),1)])]),e("div",Xt,[$(At,{isVisible:h.value,motivo:_.value,onConfirm:q,onCancel:D},null,8,["isVisible","motivo"])])])])])),e("div",Zt,[e("table",Ht,[e("thead",null,[e("tr",null,[o[0]||(o[0]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),o[1]||(o[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),o[2]||(o[2]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),e("th",Wt,x(i.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),o[3]||(o[3]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),e("tbody",null,[(t(!0),r(S,null,j(i.produto.lotes,(a,b)=>(t(),r("tr",{key:b,class:"text-center"},[e("td",Yt,x(a.data),1),e("td",eo,x(a.fornecedor),1),e("td",to,x(a.quantidade),1),e("td",oo,x(a.valor_pago_por_quilo?a.valor_pago_por_quilo:a.preco_unitario),1),e("td",so,x(a.valor_total),1)]))),128))])])]),l.value?(t(),F(St,{key:1,ref:"dadosProduto",isVisible:l.value,produto:i.produto,onDadosProduto:g,onCancelar:U},null,8,["isVisible","produto"])):y("",!0)]))}},ro=R(ao,[["__scopeId","data-v-53835f58"]]),no={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const i=await N.get("/api/estoque/lista");console.log("Produtos carregados:",i.data),this.produtos=Object.values(i.data)}catch(i){console.error("Erro ao carregar os produtos:",i)}},getProfilePhotoUrl(i){return i?new URL(i,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(i){this.$emit("produto-selecionado",i)},getQuantidadeTotal(i){return i.reduce((n,d)=>n+d.quantidade,0)}},computed:{filteredProdutos(){const i=this.searchQuery.toLowerCase();return this.produtos.filter(n=>n.nome.toLowerCase().includes(i))}}},lo={class:"search-container relative flex items-center w-full mb-4"},io={class:"card-container"},uo=["onClick"],co={class:"card-inner"},po={class:"icon-container"},vo={class:"icon-leaf"},fo=["src"],mo={class:"text-container flex justify-between items-center p-2"},go={class:"city"},_o={class:"quantidade text-gray-600 font-semibold"},xo={class:"text-gray-600 font-semibold"};function yo(i,n,d,h,_,c){return t(),r("div",null,[n[3]||(n[3]=e("div",{class:"painel-title"},"Inventário da loja",-1)),n[4]||(n[4]=e("div",{class:"painel-subtitle"},[e("p",null,"Verifique a quantidade de cada item")],-1)),e("div",lo,[n[1]||(n[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),I(e("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=l=>_.searchQuery=l),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[E,_.searchQuery]])]),e("div",io,[(t(!0),r(S,null,j(c.filteredProdutos,l=>(t(),r("div",{key:l.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:p=>c.selecionarProduto(l)},[e("div",co,[e("div",po,[n[2]||(n[2]=e("div",{class:"icon-bg"},null,-1)),e("div",vo,[e("img",{src:c.getProfilePhotoUrl(l.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,fo)])]),e("div",mo,[e("div",go,x(l.nome),1),e("div",_o,[e("div",xo,x(c.getQuantidadeTotal(l.lotes)),1)])])])],8,uo))),128))])])}const ho=R(no,[["render",yo],["__scopeId","data-v-003fe9d6"]]),bo={key:0,class:"mt-6"},$o={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},wo={key:0},ko={class:"flex flex-col gap-4"},Co={class:"absolute bottom-4 right-4 botao-container"},qo={__name:"Index",setup(i){const n=u(null),d=u(!1),h=()=>{d.value=!d.value},_=()=>{c(),d.value=!1},c=()=>{var g;(g=u("listarUnidades").value)==null||g.fetchUnidades()},l=p=>{p&&typeof p=="object"?n.value=p:console.warn("Dados inválidos recebidos no evento produto-selecionado:",p)};return(p,g)=>(t(),F(ie,null,{default:A(()=>[$(ae(re),{title:"Insumos"}),d.value?(t(),r("div",bo,[$(it,{isVisible:d.value,onUnidadeCadastrada:_,onCancelar:h},null,8,["isVisible"])])):y("",!0),e("div",$o,[d.value?y("",!0):(t(),r("div",wo,[$(ho,{ref:"listarUnidades",onUnidadeCadastrada:c,onProdutoSelecionado:l},null,512)])),e("div",ko,[d.value?y("",!0):(t(),r(S,{key:0},[n.value?(t(),F(ro,{key:0,produto:n.value},null,8,["produto"])):y("",!0),e("div",Co,[$(K,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:h})])],64))])])]),_:1}))}},Eo=R(qo,[["__scopeId","data-v-d55cd220"]]);export{Eo as default};
