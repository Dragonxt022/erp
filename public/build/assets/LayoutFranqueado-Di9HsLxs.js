import{d as _,i as g,j as A,a6 as V,e as v,o as r,a as e,af as G,c as T,f as P,b as E,w as j,t as $,n as M,u as x,a2 as F,ag as W,s as U,a5 as z,ah as H,q as Z,F as N,h as B,a7 as J,ai as D,k as R,a1 as K,Z as Q,r as X,ae as Y}from"./app-DAiSBrZd.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee=["href"],te=["src"],se={__name:"iconeNotificacao",setup(f){const t=_(null),a=_(null),i=_(!1),k=_(!0),S=g(()=>a.value?`https://alertas.taiksu.com.br/callback?token=${a.value}`:"https://alertas.taiksu.com.br"),y=g(()=>k.value?"https://login.taiksu.com.br/frontend/img/sinale0.png":i.value?"https://login.taiksu.com.br/frontend/img/sino-alerta-com-mensagem.png":"https://login.taiksu.com.br/frontend/img/sinale0.png"),b=async()=>{try{const d=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!d.ok)throw new Error("Erro ao carregar perfil do usuário");const p=await d.json();p.status==="success"&&p.data&&(t.value=p.data.id,a.value=p.data.rh_token||p.data.id,await s())}catch(d){console.error("Erro ao buscar dados do usuário:",d)}finally{k.value=!1}},s=async()=>{if(t.value)try{const d=`https://alertas.taiksu.com.br/api/status/${t.value}`,p=await fetch(d,{method:"GET",headers:{Accept:"application/json"}});if(!p.ok)throw new Error("Erro ao verificar status das notificações");const I=await p.json();i.value=I.status===!0}catch(d){console.error("Erro ao consultar status das notificações:",d),i.value=!1}};let n;return A(async()=>{await b(),n=setInterval(()=>{s()},3e5)}),V(()=>{n&&clearInterval(n)}),(d,p)=>(r(),v("a",{class:"notification-link",href:S.value,target:"_blank",rel:"noopener noreferrer"},[e("img",{src:y.value,alt:"Notificações",class:"notification-icon"},null,8,te)],8,ee))}},ae=q(se,[["__scopeId","data-v-81702bd5"]]),O=G("sidebar",{state:()=>({isOpen:!1}),actions:{toggle(){this.isOpen=!this.isOpen},open(){this.isOpen=!0},close(){this.isOpen=!1}}}),ne={class:"navbar"},oe={class:"navbar-content"},re={class:"navbar-left"},ie={class:"navbar-logo items-center flex flex-row gap-2"},le=["href"],ce={class:"navbar-right"},ue={class:"mr-4"},de={key:0,href:"https://login.taiksu.com.br/perfil",class:"user-info"},ve=["src"],me={class:"user-details"},fe={class:"user-name"},pe={class:"user-location"},he={key:1,class:"user-info loading"},ge={__name:"Navbar",setup(f){const t=O(),a=()=>{t.toggle()},i=_(null),k=g(()=>{var s;return(s=i.value)==null?void 0:s.unidade}),S=g(()=>{var s,n;return((s=i.value)==null?void 0:s.profile_photo_url)||`https://ui-avatars.com/api/?name=${y((n=i.value)==null?void 0:n.name)}&color=7F9CF5&background=EBF4FF`}),y=s=>s?s.split(" ").map(d=>d.charAt(0).toUpperCase()).join(""):"*",b=async()=>{try{const s=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar perfil do usuário");const n=await s.json();i.value=n.data}catch(s){console.error("Erro ao buscar perfil:",s),i.value=null}};return A(()=>{b()}),(s,n)=>(r(),v("div",ne,[n[4]||(n[4]=e("div",{class:"navbar-background"},null,-1)),e("div",oe,[e("div",re,[e("div",ie,[n[1]||(n[1]=e("div",{class:"hide-mobile"},[e("a",{href:"https://login.taiksu.com.br/"},[e("img",{src:"https://login.taiksu.com.br/frontend/img/menu_service.png",alt:"Menu",class:"w-7 h-7"})])],-1)),e("div",null,[e("a",{href:s.route("franqueado.painel")},n[0]||(n[0]=[e("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,le)])])]),e("div",ce,[e("div",ue,[E(ae)]),e("div",{class:"view-mobile"},[e("button",{onClick:a},n[2]||(n[2]=[e("img",{src:"/storage/images/bx-menuv.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),i.value?(r(),T(x(F),{key:0,href:"https://login.taiksu.com.br/perfil",class:M(["user-info hide-mobile",{loading:!i.value}])},{default:j(()=>{var d;return[i.value?(r(),v("a",de,[e("img",{src:S.value,alt:"Avatar",class:"avatar"},null,8,ve),e("div",me,[e("div",fe,$(i.value.name),1),e("div",pe,$(((d=k.value)==null?void 0:d.cidade)||"Taiksu Franchising"),1)])])):(r(),v("div",he,n[3]||(n[3]=[e("div",{class:"avatar-skeleton"},null,-1),e("div",{class:"user-details-skeleton"},[e("div",{class:"name-skeleton"}),e("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["class"])):P("",!0)])])]))}},be=q(ge,[["__scopeId","data-v-5a62d7d0"]]),_e={class:"icon"},ke=["src"],we={class:"label"},Se={type:"submit",class:"w-full h-full flex items-center"},ye={class:"icon"},Ie=["src"],Le={class:"label"},xe={key:2,class:"submenu"},$e={class:"label"},Pe={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(f){const t=f,a=W("openSubmenuLink",_(null)),i=g(()=>a.value===t.link),k=g(()=>i.value),S=g(()=>t.link&&/^https?:\/\//.test(t.link)),y=g(()=>S.value?t.link:t.link?route(t.link):"#"),b=g(()=>!0),s=g(()=>t.submenuItems),n=u=>{s.value.length>0&&(u.preventDefault(),d())},d=()=>{a.value===t.link?a.value=null:a.value=t.link,I()},p=()=>{const u=localStorage.getItem("openSubmenuLink");u!==null&&(a.value=u)},I=()=>{a.value?localStorage.setItem("openSubmenuLink",a.value):localStorage.removeItem("openSubmenuLink")},m=g(()=>o.value||t.isActive?"submenu-active":""),l=u=>{const h=window.location.pathname,L=new URL(route(u),window.location.origin).pathname;return h===L},o=g(()=>s.value.some(u=>l(u.link))),c=()=>{t.isLogout&&J.post(route("logout.sair"))};return p(),U(o,()=>{!o.value&&a.value===t.link&&z(()=>{a.value=null,I()})}),U(a,()=>{z(()=>I())}),(u,h)=>(r(),v("div",null,[!f.isLogout&&f.link&&b.value?(r(),T(H(S.value?"a":x(F)),{key:0,class:M(["menu-item",[m.value,{active:f.isActive||o.value}]]),href:y.value,target:S.value?"_blank":null,onClick:n},{default:j(()=>[e("div",_e,[e("img",{src:f.icon,alt:"icon"},null,8,ke)]),e("div",we,$(f.label),1),s.value.length>0?(r(),v("div",{key:0,class:M(["right-icon",{"rotate-icon":k.value}])},h[0]||(h[0]=[e("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):P("",!0)]),_:1},8,["class","href","target"])):f.isLogout&&b.value?(r(),v("form",{key:1,onSubmit:Z(c,["prevent"]),class:"menu-item"},[e("button",Se,[e("div",ye,[e("img",{src:f.icon,alt:"icon"},null,8,Ie)]),e("div",Le,$(f.label),1)])],32)):P("",!0),s.value.length>0&&(i.value||o.value)?(r(),v("div",xe,[(r(!0),v(N,null,B(s.value,(L,C)=>(r(),v("div",{key:C},[E(x(F),{class:M(["submenu-item",{active:l(L.link)}]),href:u.route(L.link)},{default:j(()=>[e("div",$e,$(L.label),1)]),_:2},1032,["href","class"])]))),128))])):P("",!0)]))}},Ee=q(Pe,[["__scopeId","data-v-53add217"]]),Me={key:0,class:"loader-container"},qe={key:0,class:"category-title menu-categorias text-sm sm:text-base font-medium text-[#87ba73] mb-3 pl-4"},Ae={__name:"Slidebar",setup(f){const t=_(null),a=_([]),i=O(),k=_(!0),S=_(null),y=_({}),b=_({}),s=async()=>{try{const l=(await R.get("/api/navbar-profile")).data.data;y.value={franqueado:l.franqueado,colaborador:l.colaborador},b.value=l.permissions||{}}catch(m){console.error("Erro ao carregar permissões:",m),y.value={},b.value={}}},n=async()=>{var m;console.log("[Menu] Buscando menu...");try{const l=await R.get(`/api/menu?t=${Date.now()}`);console.log("[Menu] Resposta bruta da API:",l),console.log("[Menu] Data:",l.data);const o=((m=l.data)==null?void 0:m.data)||[];console.log("[Menu] Categorias recebidas:",o),a.value=o.map(c=>{console.log("[Menu] Categoria antes do sort:",c);const w=(c.items||[]).slice().sort((u,h)=>u.order-h.order).map(u=>{console.log("[Menu] Item antes do sort:",u);const h=u.children?u.children.slice().sort((L,C)=>L.order-C.order):[];return console.log("[Menu] Filhos ordenados:",h),{...u,children:h}});return console.log("[Menu] Itens ordenados:",w),{...c,items:w}}).sort((c,w)=>c.order-w.order),console.log("[Menu] Menu final normalizado:",a.value)}catch(l){console.error("[Menu] Erro ao carregar menu:",l),a.value=[]}};D("userPermissions",b),D("openSubmenuLink",S);const d=g(()=>{const{franqueado:m,colaborador:l}=y.value;return a.value.map(o=>{const c=o.items.map(w=>{if(w.required_permission==="dre"&&!(m===!0&&l===!1)||w.required_permission&&b.value[w.required_permission]!==!0)return null;const u=(w.children||[]).filter(h=>h.required_permission?b.value[h.required_permission]===!0:!0);return{...w,children:u}}).filter(Boolean);return{...o,items:c}}).filter(o=>o.items.length>0)});A(async()=>{k.value=!0,await s(),await n();const m=localStorage.getItem("sidebarScrollPosition");m&&t.value&&(t.value.scrollTop=m),k.value=!1});const p=()=>{t.value&&localStorage.setItem("sidebarScrollPosition",t.value.scrollTop)},I=m=>{const l=window.location.pathname,o=new URL(m,window.location.origin).pathname;return l===o||l.startsWith(o)};return(m,l)=>(r(),v("div",null,[k.value?(r(),v("div",Me,l[0]||(l[0]=[e("div",{class:"spinner"},null,-1)]))):(r(),v("div",{key:1,class:M(["sidebar z-50 bg-[#164110] text-white flex flex-col p-3 transition-transform duration-300 ease-in-out","fixed inset-y-0 left-0 transform",x(i).isOpen?"translate-x-0":"-translate-x-full","md:relative md:translate-x-0 md:h-screen md:sticky md:top-0"]),ref_key:"sidebar",ref:t,onScroll:p},[(r(!0),v(N,null,B(d.value,o=>(r(),v("div",{key:o.name,class:"menu-category mb-6"},[o.items.length>0?(r(),v("div",qe,$(o.name),1)):P("",!0),(r(!0),v(N,null,B(o.items,c=>(r(),T(Ee,{key:c.link||"no-link",label:c.label,icon:c.icon,link:c.link,submenuItems:c.children,isActive:c.link?I(c.link):!1,isLogout:c.isLogout,requiredPermission:c.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],34))]))}},Ce=q(Ae,[["__scopeId","data-v-a71b1fd9"]]),je={__name:"LayoutFranqueado",props:{title:String},setup(f){const t=O();function a(){window.innerWidth<768?t.close():t.open()}return A(()=>{window.addEventListener("resize",a),a()}),K(()=>{window.removeEventListener("resize",a)}),(i,k)=>(r(),v("div",null,[E(x(Q),{title:f.title},null,8,["title"]),E(be),E(Ce),e("main",{class:"content",style:Y({left:x(t).isOpen?"252px":"0",width:x(t).isOpen?"calc(100vw - 250px)":"100vw"})},[X(i.$slots,"default",{},void 0,!0)],4)]))}},Be=q(je,[["__scopeId","data-v-d63d761a"]]);export{Be as L};
