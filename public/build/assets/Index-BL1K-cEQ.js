import{d as o,i as L,c as N,o as d,w as T,b as D,a as t,u as z,Z as O,e as u,F as Z,h as W,t as i,f as G,g as c}from"./app-C-8nNpTH.js";import{d as H}from"./index-CEob1Fvd.js";import{C as I,r as J}from"./chart-C7aurQ-a.js";import{L as K}from"./LayoutFranqueado-DN1nNV2R.js";import{_ as Q}from"./CalendarSimples-CzcCEBUs.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-BwPLxi6g.js";import"./dayjs.min-BHG7_xfA.js";import"./pt-br-DCs3bbSA.js";const X={class:"flex justify-between items-center mb-4"},Y={class:"text-[#262a27] text-[15px] font-semibold font-['Figtree'] leading-tight"},tt={class:"flex items-center space-x-2"},et={class:"text-gray-900 text-[17px] font-semibold"},st={class:"mt-5"},at={class:"grid grid-cols-3 grid-rows-1 gap-4"},ot={class:"row-span-3"},lt={class:"bg-white rounded-lg p-5 h-full w-full"},nt={class:"compromissos-container flex flex-col gap-2 overflow-hidden"},it={class:"flex flex-col"},rt={class:"text-[14px] font-medium text-gray-900"},dt={class:"text-sm text-gray-600"},ct=["src","alt"],ut={class:"bg-white rounded-lg p-7"},pt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},mt={class:"bg-white rounded-lg p-7"},gt={class:"flex items-center mb-4"},ft={xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 24 24",style:{fill:"rgba(0, 0, 0, 1)",transform:"msfilter"}},xt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},vt={key:0,class:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50"},bt={class:"bg-white rounded-lg p-7 w-[350px] shadow-lg"},_t={class:"text-sm text-gray-600 space-y-2"},ht={class:"text-lg font-bold text-gray-900 mt-3"},yt={class:"bg-white rounded-lg p-7"},wt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},Ft={class:"bg-white rounded-lg p-4"},kt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},Ct={class:"bg-white rounded-lg p-4 col-span-3"},$t={class:"w-full h-[220px]"},jt={__name:"Index",setup(Dt){I.register(...J);const f=o(null),p=o(null),x=o([]),v=o([]),b=o([]),_=o("0,00"),h=o("0,00"),y=o("0,00"),w=o("0,00"),F=o("0,00"),m=o("0,00"),k=o("0,00"),C=o(0),$=o("0,00"),g=o(!1),M=()=>{H.Inertia.replace(route("franqueado.contasApagar"))},V=()=>{g.value=!0},E=()=>{g.value=!1},A=async(s=null,e=null)=>{try{let a="/api/painel-analitycos/calcular-cmv";const n=[];s&&n.push(`start_date=${s}`),e&&n.push(`end_date=${e}`),n.length>0&&(a+=`?${n.join("&")}`);const l=(await axios.get(a)).data;l.saldo_estoque_inicial?(_.value=l.start_date||"não informado",h.value=l.end_date||"não informado",y.value=l.saldo_estoque_inicial||"0,00",w.value=l.entradas_durante_periodo||"0,00",F.value=l.saldo_estoque_final||"0,00",m.value=l.cmv||"0,00"):console.warn("Dados analíticos não encontrados.")}catch(a){console.error("Erro ao buscar dados analíticos:",a)}},q=async(s=null,e=null)=>{try{let a="/api/painel-analitycos/calcular-fluxo-caixa";const n=[];s&&n.push(`start_date=${s}`),e&&n.push(`end_date=${e}`),n.length>0&&(a+=`?${n.join("&")}`);const l=(await axios.get(a)).data;k.value=l.total_caixas||"0,00",C.value=l.quantidade_pedidos||0,$.value=l.ticket_medio||"0,00"}catch(a){console.error("Erro ao buscar dados analíticos:",a)}};L(()=>{A(),q(),R(),S(),j()});const R=async()=>{try{const s=await axios.get("/api/cursto/listar-contas-a-pagar");b.value=s.data.data}catch(s){console.error("Erro ao carregar os dados:",s)}},S=async()=>{try{const e=(await axios.get("/api/painel-analitycos/faturamento-por-dia-mes")).data,a=new Date().getMonth()+1,n=Object.values(e.faturamento).filter(r=>(parseInt(r.dia)<=new Date().getDate()?a:a-1)===a).sort((r,l)=>r.dia-l.dia);Array.isArray(n)?(v.value=n.map(r=>r.dia),x.value=n.map(r=>parseFloat(r.total)),j()):console.error("Erro: Os dados recebidos não estão no formato esperado.",e)}catch(s){console.error("Erro ao buscar dados:",s)}},j=()=>{p.value&&p.value.destroy(),p.value=new I(f.value.getContext("2d"),{type:"bar",data:{labels:v.value,datasets:[{label:"Faturamento Diário",data:x.value,backgroundColor:"rgba(75, 192, 75, 0.6)",borderColor:"rgba(75, 192, 75, 1)",borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{callback:function(s){return s>=1e3?`${s/1e3} mil`:s}}}}}})},P=s=>{const e=s.split("-");return`${e[2]}/${e[1]}/${e[0]}`},B=s=>s==="pendente"?"/storage/images/check_circle_laranja.svg":"/storage/images/check_circle_verde.svg";return(s,e)=>(d(),N(K,null,{default:T(()=>[D(z(O),{title:"Painel"}),t("div",X,[e[1]||(e[1]=t("div",null,[t("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Visão geral da loja "),t("div",{class:"painel-subtitle"},[t("p",{class:"text-sm sm:text-base md:text-lg"}," Acompanhe o desempenho geral ")])],-1)),t("div",Y,[t("div",tt,[e[0]||(e[0]=t("img",{src:"/storage/images/calendar_month.svg",alt:"Filtro",class:"w-5 h-5"},null,-1)),t("span",et,[D(Q)])])])]),t("div",st,[t("div",at,[t("div",ot,[t("div",lt,[e[2]||(e[2]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-2"}," Compromissos ",-1)),t("div",nt,[(d(!0),u(Z,null,W(b.value,a=>(d(),u("div",{key:a.id,onClick:M,class:"flex justify-between items-center bg-[#F5FAF4] p-3 rounded-lg cursor-pointer hover:bg-gray-100 transition-all ease-in-out duration-300"},[t("div",it,[t("p",rt,i(a.nome),1),t("p",dt,i(a.valor_formatado)+" - Vencimento "+i(P(a.vencimento)),1)]),t("div",null,[t("img",{src:B(a.status),alt:"Status: "+a.status,class:"w-6 h-6 object-contain transition-transform transform hover:scale-105"},null,8,ct)])]))),128))])])]),t("div",ut,[e[3]||(e[3]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Faturamento",-1)),t("div",pt," R$ "+i(k.value),1),e[4]||(e[4]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",mt,[t("div",gt,[e[6]||(e[6]=t("h3",{class:"text-lg font-semibold text-gray-700"},"CMV",-1)),t("button",{onClick:V,class:"ml-2"},[(d(),u("svg",ft,e[5]||(e[5]=[t("path",{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"},null,-1)])))])]),t("div",xt," R$ "+i(m.value),1),e[14]||(e[14]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1)),g.value?(d(),u("div",vt,[t("div",bt,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"}," Detalhes do CMV ",-1)),t("div",_t,[t("p",null,[e[7]||(e[7]=t("span",{class:"font-semibold text-gray-800"},"Período:",-1)),c(" "+i(_.value)+" - "+i(h.value),1)]),t("p",null,[e[8]||(e[8]=t("span",{class:"font-semibold text-gray-800"}," Saldo Inicial: ",-1)),c(" R$ "+i(y.value),1)]),t("p",null,[e[9]||(e[9]=t("span",{class:"font-semibold text-gray-800"},"Entradas:",-1)),c(" R$ "+i(w.value),1)]),t("p",null,[e[10]||(e[10]=t("span",{class:"font-semibold text-gray-800"},"Saldo Final:",-1)),c(" R$ "+i(F.value),1)]),t("p",ht,[e[11]||(e[11]=t("span",{class:"font-semibold"},"CMV:",-1)),c(" R$ "+i(m.value),1)]),e[12]||(e[12]=t("p",null," Parametros: Saldo Inicial + Entradas nesse periodo - Saldo Final = Total CMV ",-1))]),t("button",{onClick:E,class:"mt-4 text-red-800 rounded-md transition"}," Fechar ")])])):G("",!0)]),t("div",yt,[e[15]||(e[15]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Ticket médio",-1)),t("div",wt," R$ "+i($.value),1),e[16]||(e[16]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",Ft,[e[17]||(e[17]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Pedidos",-1)),t("div",kt,i(C.value),1),e[18]||(e[18]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",Ct,[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold text-gray-700"}," Faturamento diário ",-1)),t("div",$t,[t("canvas",{ref_key:"barChart",ref:f},null,512)])])])])]),_:1}))}},Bt=U(jt,[["__scopeId","data-v-0e77f44b"]]);export{Bt as default};
