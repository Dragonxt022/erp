import{A as Y}from"./LayoutFranqueadora-C-FwN8c8.js";import{k as q,o as a,e as n,a as e,j as $,v as ee,F as A,g as oe,f as G,t as j,h as f,l as z,d as i,m as se,c as S,w as T,p as F,b as v,x as U,q as H,u as te,Z as ae}from"./app-F30cMb71.js";import{_ as E,I as J,B as K,a as Q,C as O,d as X}from"./ConfirmDialog-fPHnpwpk.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as le}from"./ButtonEditeMedio-DyaiXKSP.js";const re={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const d=await q.get("/api/produtos/lista");console.log("Produtos carregados:",d.data),this.produtos=d.data}catch(d){console.error("Erro ao carregar os produtos:",d)}},getProfilePhotoUrl(d){return d?new URL(d,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(d){this.$emit("produto-selecionado",d)}},computed:{filteredProdutos(){const d=this.searchQuery.toLowerCase();return this.produtos.filter(u=>u.nome.toLowerCase().includes(d))}}},ne={class:"search-container relative flex items-center w-full mb-4"},ie={class:"card-container"},de=["onClick"],ue={class:"card-inner"},ce={class:"icon-container"},pe={class:"icon-leaf"},ve=["src"],me={class:"text-container"},fe={class:"city"},ge={key:0,class:"estrela"};function he(d,u,c,_,g,p){return a(),n("div",null,[u[4]||(u[4]=e("div",{class:"painel-title"},"Insumos",-1)),u[5]||(u[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",ne,[u[1]||(u[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),$(e("input",{type:"text","onUpdate:modelValue":u[0]||(u[0]=t=>g.searchQuery=t),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[ee,g.searchQuery]])]),e("div",ie,[(a(!0),n(A,null,oe(p.filteredProdutos,t=>(a(),n("div",{key:t.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:r=>p.selecionarProduto(t)},[e("div",ue,[e("div",ce,[u[2]||(u[2]=e("div",{class:"icon-bg"},null,-1)),e("div",pe,[e("img",{src:p.getProfilePhotoUrl(t.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,ve)])]),e("div",me,[e("div",fe,[G(j(t.nome)+" ",1),t.estrela?(a(),n("span",ge,"★")):f("",!0)])]),u[3]||(u[3]=e("div",{class:"action-icon"},null,-1))])],8,de))),128))])])}const _e=N(re,[["render",he],["__scopeId","data-v-036bce99"]]),ye={key:0,class:"sidebar-container"},xe={key:0,class:"loading-overlay"},be={key:1,class:"w-full h-[80%] bg-white rounded-[20px] p-12"},we={class:"flex justify-center mb-6 relative group"},Ce=["src"],$e={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},ke={key:0,class:"error-message"},Pe={class:"flex items-center space-x-4 mt-2"},Ue={class:"flex items-center space-x-2 cursor-pointer"},Ve={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Ie={key:0,class:"w-3 h-3 rounded-full bg-green-500"},De={class:"flex items-center space-x-2 cursor-pointer"},je={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Fe={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Ee={class:"flex items-center space-x-4 mt-2"},Me={class:"flex items-center space-x-2 cursor-pointer"},Se={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Be={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Le={class:"flex items-center space-x-2 cursor-pointer"},qe={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Ae={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Ne={class:"flex justify-start space-x-1 mt-[15%]"},Re={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(d,{emit:u}){const c=z(),_=d,g=u,p=i(""),t=i(""),r=i(""),m=i(""),y=i(null),k=i(""),P=i(null),b=i(!1),C=i(!1),I=i("");se(()=>_.produto,l=>{l&&(p.value=l.nome||"",t.value=l.categoria||"",r.value=l.unidadeDeMedida||"",m.value=l.profile_photo||"")},{immediate:!0});const M=l=>l?new URL(l,window.location.origin).href:"/storage/images/no_imagem.svg",h=async()=>{var l,o;if(!p.value){c.error("O campo nome é obrigatório.");return}try{b.value=!0;const s=new FormData;if(s.append("id",_.produto.id),s.append("nome",p.value),s.append("categoria",t.value),s.append("unidadeDeMedida",r.value),y.value){const W=`${Date.now()}_${y.value.name}`;s.append("profile_photo_name",W),s.append("profile_photo",y.value)}const Z=await q.post("/api/produtos/atualizar",s,{headers:{"Content-Type":"multipart/form-data"}});X.Inertia.replace(route("franqueadora.insumos"),{produto:Z.data.produto,preserveState:!0}),c.success("Produto atualizado com sucesso!")}catch(s){c.error("Erro ao atualizar o produto."),k.value=((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.message)||"Erro inesperado."}finally{b.value=!1}},x=l=>{I.value=l,C.value=!0},V=()=>{h(),C.value=!1},D=()=>{C.value=!1},w=()=>{var l;(l=P.value)==null||l.click()},B=()=>{m.value="",c.info("Imagem removida.")},R=l=>{const o=l.target.files[0];if(o){if(o.size>5*1024*1024){c.error("A imagem não pode exceder 5 MB.");return}y.value=o;const s=new FileReader;s.onload=()=>{m.value=s.result,c.success("Imagem carregada com sucesso!")},s.readAsDataURL(o)}},L=()=>{g("cancelar")};return(l,o)=>(a(),S(H,{name:"fade"},{default:T(()=>[d.isVisible?(a(),n("div",ye,[b.value?(a(),n("div",xe,o[7]||(o[7]=[e("div",{class:"spinner"},null,-1)]))):(a(),n("div",be,[e("form",{onSubmit:F(h,["prevent"])},[e("div",we,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:w},[m.value?(a(),n(A,{key:0},[e("img",{src:M(m.value),alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,Ce),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:o[0]||(o[0]=F(()=>{},["stop"]))},[e("button",{onClick:F(B,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(a(),n("img",$e))]),e("input",{type:"file",ref_key:"fileInput",ref:P,accept:"image/*",class:"hidden",onChange:R},null,544)]),v(E,{text:"Nome"}),v(J,{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=s=>p.value=s),placeholder:""},null,8,["modelValue"]),k.value?(a(),n("div",ke,j(k.value),1)):f("",!0),v(E,{class:"font-semibold text-gray-800 mt-8",text:"Prioridade"}),e("div",Pe,[e("label",Ue,[$(e("input",{type:"radio","onUpdate:modelValue":o[2]||(o[2]=s=>t.value=s),value:"principal",class:"hidden"},null,512),[[U,t.value]]),e("div",Ve,[t.value==="principal"?(a(),n("div",Ie)):f("",!0)]),o[8]||(o[8]=e("span",null,"Principal",-1))]),e("label",De,[$(e("input",{type:"radio","onUpdate:modelValue":o[3]||(o[3]=s=>t.value=s),value:"secundario",class:"hidden"},null,512),[[U,t.value]]),e("div",je,[t.value==="secundario"?(a(),n("div",Fe)):f("",!0)]),o[9]||(o[9]=e("span",null,"Secundário",-1))])]),v(E,{class:"font-semibold text-gray-800 mt-8",text:"Unidade de medida"}),e("div",Ee,[e("label",Me,[$(e("input",{type:"radio","onUpdate:modelValue":o[4]||(o[4]=s=>r.value=s),value:"a_granel",class:"hidden"},null,512),[[U,r.value]]),e("div",Se,[r.value==="a_granel"?(a(),n("div",Be)):f("",!0)]),o[10]||(o[10]=e("span",null,"A granel",-1))]),e("label",Le,[$(e("input",{type:"radio","onUpdate:modelValue":o[5]||(o[5]=s=>r.value=s),value:"unitario",class:"hidden"},null,512),[[U,r.value]]),e("div",qe,[r.value==="unitario"?(a(),n("div",Ae)):f("",!0)]),o[11]||(o[11]=e("span",null,"Unitário",-1))])]),e("div",Ne,[v(K,{text:"Cancelar",onClick:L}),v(Q,{text:"Atualizar",onClick:o[6]||(o[6]=s=>x("Atualizar esse Produto?"))})])],32),v(O,{isVisible:C.value,motivo:I.value,onConfirm:V,onCancel:D},null,8,["isVisible","motivo"])]))])):f("",!0)]),_:1}))}},ze=N(Re,[["__scopeId","data-v-0a699497"]]),Te={class:"elemento-fixo"},Qe={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Oe={class:"relative w-full h-full"},Xe={class:"flex items-center"},Ze={class:"w-1/1 flex justify-center"},Ge=["src"],He={class:"w-2/3 pl-5"},Je={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Ke={class:"owner"},We={class:"w-1/1"},Ye={key:1,class:"mt-4"},eo={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},setup(d){const u=z(),c=d,_=i(!1),g=i(""),p=i(!1),t=i(!1),r=i(!1),m=()=>{i.dadosProduto.fetchProduto()},y=h=>h?new URL(h,window.location.origin).href:"/storage/images/no_imagem.svg",k=async()=>{var h,x,V,D;try{r.value=!0;const w=await q.delete(`/api/produtos/excluir/${c.produto.id}`);console.log(w.data.message),u.success("Produto deletado com sucesso!"),X.Inertia.visit(route("franqueadora.insumos"))}catch(w){u.error("Erro ao deletar o produto:",((x=(h=w.response)==null?void 0:h.data)==null?void 0:x.error)||w.message),console.error("Erro ao deletar o produto:",((D=(V=w.response)==null?void 0:V.data)==null?void 0:D.error)||w.message)}finally{r.value=!1}},P=()=>{t.value=!t.value,p.value=!1},b=h=>{g.value=h,_.value=!0},C=()=>{k(),_.value=!1},I=()=>{_.value=!1},M=()=>{t.value=!1,p.value=!0};return(h,x)=>(a(),n("div",Te,[t.value?f("",!0):(a(),n("div",Qe,[e("div",Oe,[e("div",Xe,[e("div",Ze,[e("img",{src:y(d.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Ge)]),e("div",He,[e("div",Je,[G(j(d.produto.nome||"N/A")+" ",1),e("div",Ke,j(d.produto.categoria)+" / "+j(d.produto.unidadeDeMedida),1)])]),e("div",We,[v(O,{isVisible:_.value,motivo:g.value,onConfirm:C,onCancel:I},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-4 right-4 cursor-pointer",onClick:x[0]||(x[0]=V=>b("Excluir esse produto?"))},x[1]||(x[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))])])])])),d.produto.id&&!t.value?(a(),n("div",Ye,[v(le,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:P,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):f("",!0),t.value?(a(),S(ze,{key:2,ref:"dadosProduto",isVisible:t.value,produto:d.produto,onDadosProduto:m,onCancelar:M},null,8,["isVisible","produto"])):f("",!0)]))}},oo=N(eo,[["__scopeId","data-v-76107c05"]]),so={key:0,class:"sidebar-container"},to={key:0,class:"loading-overlay"},ao={key:1,class:"w-full h-[80%] bg-white rounded-[20px] p-12"},lo={class:"flex justify-center mb-6 relative group"},ro=["src"],no={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},io={key:0,class:"error-message"},uo={class:"flex items-center space-x-4 mt-2"},co={class:"flex items-center space-x-2 cursor-pointer"},po={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},vo={key:0,class:"w-3 h-3 rounded-full bg-green-500"},mo={class:"flex items-center space-x-2 cursor-pointer"},fo={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},go={key:0,class:"w-3 h-3 rounded-full bg-green-500"},ho={class:"flex items-center space-x-4 mt-2"},_o={class:"flex items-center space-x-2 cursor-pointer"},yo={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},xo={key:0,class:"w-3 h-3 rounded-full bg-green-500"},bo={class:"flex items-center space-x-2 cursor-pointer"},wo={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Co={key:0,class:"w-3 h-3 rounded-full bg-green-500"},$o={class:"flex justify-start space-x-1 mt-[15%]"},ko={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(d,{emit:u}){const c=z(),_=u,g=i(""),p=i(""),t=i(""),r=i(""),m=i(null),y=i(""),k=i(null),P=i(!1),b=i(!1),C=i(""),I=()=>{var l;(l=k.value)==null||l.click()},M=l=>{C.value=l,b.value=!0},h=()=>{L(),b.value=!1},x=()=>{b.value=!1},V=()=>{p.value="",c.info("Imagem removida.")},D=l=>{const o=l.target.files[0];if(o){m.value=o;const s=new FileReader;s.onload=()=>{p.value=s.result,c.success("Imagem carregada com sucesso!")},s.readAsDataURL(o)}},w=()=>{B(),_("cancelar")},B=()=>{g.value="",t.value="",r.value="",p.value="",m.value=null,y.value=""},R=()=>!g.value||!m.value||!r||!t?(c.error("Por favor, preencha todos os campos obrigatórios."),y.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,L=async()=>{var l,o;if(R())try{P.value=!0;const s=new FormData;s.append("nome",g.value),s.append("categoria",t.value),s.append("unidadeDeMedida",r.value),s.append("profile_photo",m.value);const Z=await q.post("/api/produtos/cadastrar",s,{headers:{"Content-Type":"multipart/form-data"}});c.success("Produto cadastrado com sucesso!"),X.Inertia.visit(route("franqueadora.insumos")),B()}catch(s){c.error("Erro ao cadastrar o produto."),y.value=((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.message)||"Erro inesperado."}finally{P.value=!1}};return(l,o)=>(a(),S(H,{name:"fade"},{default:T(()=>[d.isVisible?(a(),n("div",so,[P.value?(a(),n("div",to,o[7]||(o[7]=[e("div",{class:"spinner"},null,-1)]))):(a(),n("div",ao,[e("form",{onSubmit:F(L,["prevent"])},[e("div",lo,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:I},[p.value?(a(),n(A,{key:0},[e("img",{src:p.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,ro),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:o[0]||(o[0]=F(()=>{},["stop"]))},[e("button",{onClick:F(V,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(a(),n("img",no))]),e("input",{type:"file",ref_key:"fileInput",ref:k,accept:"image/*",class:"hidden",onChange:D},null,544)]),v(E,{text:"Nome"}),v(J,{modelValue:g.value,"onUpdate:modelValue":o[1]||(o[1]=s=>g.value=s),placeholder:"Shoyu Premium Sakaki"},null,8,["modelValue"]),y.value?(a(),n("div",io,j(y.value),1)):f("",!0),v(E,{class:"font-semibold text-gray-800 mt-8",text:"Prioridade"}),e("div",uo,[e("label",co,[$(e("input",{type:"radio","onUpdate:modelValue":o[2]||(o[2]=s=>t.value=s),value:"principal",class:"hidden"},null,512),[[U,t.value]]),e("div",po,[t.value==="principal"?(a(),n("div",vo)):f("",!0)]),o[8]||(o[8]=e("span",null,"Principal",-1))]),e("label",mo,[$(e("input",{type:"radio","onUpdate:modelValue":o[3]||(o[3]=s=>t.value=s),value:"secundario",class:"hidden"},null,512),[[U,t.value]]),e("div",fo,[t.value==="secundario"?(a(),n("div",go)):f("",!0)]),o[9]||(o[9]=e("span",null,"Secundário",-1))])]),v(E,{class:"font-semibold text-gray-800 mt-8",text:"Unidade de medida"}),e("div",ho,[e("label",_o,[$(e("input",{type:"radio","onUpdate:modelValue":o[4]||(o[4]=s=>r.value=s),value:"a_granel",class:"hidden"},null,512),[[U,r.value]]),e("div",yo,[r.value==="a_granel"?(a(),n("div",xo)):f("",!0)]),o[10]||(o[10]=e("span",null,"A granel",-1))]),e("label",bo,[$(e("input",{type:"radio","onUpdate:modelValue":o[5]||(o[5]=s=>r.value=s),value:"unitario",class:"hidden"},null,512),[[U,r.value]]),e("div",wo,[r.value==="unitario"?(a(),n("div",Co)):f("",!0)]),o[11]||(o[11]=e("span",null,"Unitário",-1))])]),e("div",$o,[v(K,{text:"Cancelar",onClick:w}),v(Q,{text:"Cadastrar",onClick:o[6]||(o[6]=s=>M("Criar novo Produto?"))})])],32)])),v(O,{isVisible:b.value,motivo:C.value,onConfirm:h,onCancel:x},null,8,["isVisible","motivo"])])):f("",!0)]),_:1}))}},Po=N(ko,[["__scopeId","data-v-ed100e81"]]),Uo={class:"flex flex-col gap-4"},Vo={class:"absolute bottom-4 right-4"},Io={key:1,class:"mt-4"},So={__name:"Index",setup(d){const u=i(null),c=i(!1),_=()=>{c.value=!c.value},g=()=>{p(),c.value=!1},p=()=>{var m;(m=i("listarUnidades").value)==null||m.fetchUnidades()},t=r=>{r&&typeof r=="object"?u.value=r:console.warn("Dados inválidos recebidos no evento produto-selecionado:",r)};return(r,m)=>(a(),S(Y,null,{default:T(()=>[v(te(ae),{title:"Insumos"}),e("div",{class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2 overflow-hidden card-container h-full overflow-y-scroll",onScrollPassive:m[0]||(m[0]=()=>{})},[e("div",null,[v(_e,{ref:"listarUnidades",onUnidadeCadastrada:p,onProdutoSelecionado:t},null,512)]),e("div",Uo,[c.value?(a(),n("div",Io,[v(Po,{isVisible:c.value,onUnidadeCadastrada:g,onCancelar:_},null,8,["isVisible"])])):(a(),n(A,{key:0},[u.value?(a(),S(oo,{key:0,produto:u.value},null,8,["produto"])):f("",!0),e("div",Vo,[v(Q,{text:"Cadastrar insumo",iconPath:"/storage/images/arrow_left_alt.svg",onClick:_})])],64))])],32)]),_:1}))}};export{So as default};
