import{d as n,i as E,j as I,c as M,o as r,w as V,b as A,a as e,u as U,Z as q,e as l,F as u,h as m,t as i,k as z}from"./app-DtYnN9d5.js";import{L as J}from"./LayoutFranqueado-YCBd5PsI.js";import{p as O}from"./chartjs-plugin-datalabels.esm-BFtiKef5.js";import{C as B,A as T,p as Y,a as G,D as H,P as W,b as Q,i as X}from"./chart-CX66tr7T.js";import{_ as Z}from"./CalendarFilterDre-CQItUor0.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./dayjs.min-CP20iRgF.js";import"./pt-br-BwjgrFzS.js";const ee={class:"flex justify-end mb-4"},te={class:"text-[#262a27] text-[15px] font-semibold font-['Figtree'] leading-tight"},oe={class:"flex items-center space-x-2 justify-end"},se={class:"text-gray-900 text-[17px] font-semibold"},ae={class:"mt-5"},re={class:"grid grid-cols-2 grid-rows-1 gap-4"},le={class:"rounded-lg"},ne={class:"w-full text-left text-[14px] border-collapse font-['Figtree']"},de={key:0},ie={key:1},ue={class:"px-5 py-2 text-right valores"},ce={class:"bg-[#174111] text-white"},pe={colspan:"2",class:"p-1 px-5"},me={key:0},ge={key:1},_e={class:"p-1 px-5 categorias align-middle"},fe={class:"px-5 py-1 text-right valores"},he={class:"bg-[#174111] text-white"},xe={colspan:"1",class:"p-2 text-right font-bold"},ve={class:"mt-5"},ye={class:"bg-white rounded-lg shadow"},be={ref:"scrollContainer",class:"overflow-y-auto max-h-96 scroll-hidden"},we={class:"space-y-2"},Fe={key:0},$e={class:"text-center text-gray-600 font-semibold"},Re={class:"text-center text-gray-600 font-medium"},Ce={class:"text-center text-gray-600 font-semibold"},De={__name:"Index",setup(ke){const y=n("0,00"),C=n("0,00"),b=n("0,00"),w=n([]),h=n([]),L=n(""),g=n(!0),S=n("pie");let c=null;const F=n([]),$=n([]),x=n([]);n(!1),E(()=>j(h.value));const P=s=>{console.log("Filtros atualizados:",s),D(s.startDate,s.endDate)},D=async(s,o)=>{g.value=!0;try{const t=(await z.get("/api/painel-dre/analitycs-dre",{params:{start_date:s,end_date:o}})).data;console.log("DRE API Response:",t),console.log("Total Salarios from API:",t.total_salarios),y.value=t.total_caixas||"0,00",C.value=t.total_salarios||"0,00",b.value=t.resultado_do_periodo||"0,00",w.value=t.grupos||[],h.value=t.calendario||[],L.value=t.explicacao_dre||[],$.value=t.grafico_data.labels||[],F.value=t.grafico_data.data||[],x.value=t.grafico_data.porcentagens||[],N()}catch(a){console.error("Erro ao buscar os dados do DRE:",a),y.value="0,00",C.value="0,00",b.value="0,00",w.value=[],h.value=[],$.value=[],F.value=[],x.value=[],c&&(c.destroy(),c=null)}finally{g.value=!1}};B.register(T,Y,G,H,W,Q,X,O);const N=()=>{const s=document.getElementById("myChart");if(!s)return;const o=s.getContext("2d");c&&c.destroy();const a={type:S.value,data:{labels:$.value,datasets:[{data:F.value,backgroundColor:["#6DB631","#FF9500","#FF2D55","#5856D6","#F7464A","#FF7F50"],borderColor:void 0,borderWidth:0,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function(t){const d=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t.raw),p=x.value[t.dataIndex];return`${t.label}: ${d} (${p})`}}},legend:{position:"bottom",labels:{usePointStyle:!0,padding:15,boxWidth:10}},datalabels:{display:!0,color:"#fff",formatter:(t,d)=>{const p=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),v=x.value[d.dataIndex];return`${p}
(${v})`},font:{weight:"bold",size:10},anchor:"end",align:"start",offset:10}},scales:{}}};c=new B(o,a)};I(()=>{const s=new Date,o=new Date(s.getFullYear(),s.getMonth(),1).toLocaleDateString("pt-BR").split("/").join("-"),a=new Date(s.getFullYear(),s.getMonth()+1,0).toLocaleDateString("pt-BR").split("/").join("-");D(o,a)});const j=s=>{if(!s||s.length===0)return"";const o=new Date,a=o.getMonth()+1;o.getFullYear();const t=s.find(f=>f.nome_mes.toLowerCase()===k(a).toLowerCase()),d=s.find(f=>f.nome_mes.toLowerCase()===k(a-1).toLowerCase());if(!t)return"";const p=f=>Number(f.replace(/\./g,"").replace(",",".")),v=t?p(t.resultado_do_periodo):0,R=d?p(d.resultado_do_periodo):null;let _="";return R===null?_=`OlÃ¡! No mÃªs de ${t.nome_mes}, seu resultado foi de R$ ${t.resultado_do_periodo}. Vamos continuar assim! ðŸš€`:v>R?_=`Boa notÃ­cia! Seu resultado em ${t.nome_mes} (R$ ${t.resultado_do_periodo}) melhorou em relaÃ§Ã£o a ${d.nome_mes} (R$ ${d.resultado_do_periodo}). Continue assim! ðŸŽ‰`:v<R?_=`AtenÃ§Ã£o: o resultado em ${t.nome_mes} (R$ ${t.resultado_do_periodo}) estÃ¡ abaixo do mÃªs anterior (${d.nome_mes} - R$ ${d.resultado_do_periodo}). Vamos analisar juntos para melhorar`:_=`Seu resultado em ${t.nome_mes} (R$ ${t.resultado_do_periodo}) estÃ¡ estÃ¡vel em relaÃ§Ã£o a ${d.nome_mes}. Seguimos firmes! ðŸ‘`,_},k=s=>{const o=["Janeiro","Fevereiro","MarÃ§o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];return s<1&&(s=12+s),s>12&&(s=s%12),o[s-1]};return(s,o)=>(r(),M(J,null,{default:V(()=>[A(U(q),{title:"Painel"}),o[9]||(o[9]=e("a",{href:"https://forms.gle/8nkNhrqCG5UHXLAQ9",target:"_blank",class:"w-full rounded-md"},[e("img",{src:"/storage/images/finoo.png",alt:"Banner Estoque",class:"w-full mb-5 h-auto rounded-xl shadow-xl hover:shadow-none transition-all duration-300"})],-1)),e("div",ee,[e("div",te,[e("div",oe,[e("span",se,[A(Z,{onUpdateFilters:P})])])])]),e("div",ae,[e("div",re,[e("div",le,[e("table",ne,[o[4]||(o[4]=e("thead",null,[e("tr",{class:"bg-[#174111] text-white"},[e("th",{colspan:"2",class:"p-1 px-5"},"Faturamento do PerÃ­odo")])],-1)),g.value?(r(),l("tbody",de,[(r(),l(u,null,m(1,a=>e("tr",{key:a},o[0]||(o[0]=[e("td",{class:"p-1 px-5 shimmer h-6 w-1/2 rounded"},null,-1),e("td",{class:"p-1 px-5 shimmer h-6 w-1/4 rounded text-right"},null,-1)]))),64))])):(r(),l("tbody",ie,[e("tr",null,[o[1]||(o[1]=e("td",{class:"p-1 px-5 categorias"},"Faturamento do PerÃ­odo",-1)),e("td",ue," R$ "+i(y.value),1)])])),(r(!0),l(u,null,m(w.value,a=>(r(),l(u,{key:a.nome_grupo},[e("thead",null,[e("tr",ce,[e("th",pe,i(a.nome_grupo),1)])]),g.value?(r(),l("tbody",me,[(r(!0),l(u,null,m(a.categorias.length||3,t=>(r(),l("tr",{key:t},o[2]||(o[2]=[e("td",{class:"p-1 px-5 shimmer h-6 w-1/2 rounded"},null,-1),e("td",{class:"p-1 px-5 shimmer h-6 w-1/4 rounded text-right"},null,-1)])))),128))])):(r(),l("tbody",ge,[(r(!0),l(u,null,m(a.categorias,t=>(r(),l("tr",{key:t.categoria,class:"odd:bg-gray-100 even:bg-white p-1 px-5"},[e("td",_e,i(t.categoria),1),e("td",fe," R$ "+i(t.total),1)]))),128))]))],64))),128)),e("thead",null,[e("tr",he,[o[3]||(o[3]=e("th",{colspan:"1",class:"p-2"},"Resultado do PerÃ­odo",-1)),e("th",xe," R$ "+i(b.value),1)])])])]),e("div",null,[o[8]||(o[8]=e("div",{class:"bg-white rounded-lg p-5 flex justify-center w-full h-[480px]"},[e("canvas",{id:"myChart"})],-1)),e("div",ve,[o[7]||(o[7]=e("div",{class:"flex items-center justify-between"},[e("h3",{class:"text-[#262a27] text-[17px] font-semibold font-['Figtree'] leading-snug"}," HistÃ³rico de Resultados ")],-1)),e("div",ye,[o[6]||(o[6]=e("div",{class:"bg-[#164110] grid grid-cols-3 gap-4 py-2 px-6 text-xs font-semibold text-[#FFFFFF] uppercase tracking-wider rounded-tl-2xl rounded-tr-2xl"},[e("span",{class:"text-center px-5"},"MÃŠS"),e("span",{class:"text-center"},"CMV"),e("span",{class:"text-center"},"RESULTADO")],-1)),e("div",be,[e("ul",we,[g.value?(r(),l("li",Fe,[(r(),l(u,null,m(5,a=>e("div",{key:a,class:"grid grid-cols-3 gap-4 px-6 py-2"},o[5]||(o[5]=[e("span",{class:"shimmer h-5 w-3/4 rounded"},null,-1),e("span",{class:"shimmer h-5 w-1/2 rounded"},null,-1),e("span",{class:"shimmer h-5 w-1/2 rounded"},null,-1)]))),64))])):(r(!0),l(u,{key:1},m(h.value,a=>(r(),l("li",{key:a.nome_mes,class:"hover:bg-gray-200 grid grid-cols-3 text-[15px] p-1"},[e("span",$e,i(a.nome_mes),1),e("span",Re," R$ "+i(a.valor_cmv),1),e("span",Ce," R$ "+i(a.resultado_do_periodo),1)]))),128))])],512)])])])])])]),_:1}))}},Ie=K(De,[["__scopeId","data-v-fed507d4"]]);export{Ie as default};
