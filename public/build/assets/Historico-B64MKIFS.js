import{d as l,i as O,j as A,e as m,o as c,a as e,f as q,t as x,q as I,p as z,y as B,F as V,h as F,b as h,v as P,n as U,k as Y,m as N,s as J,c as L,w as G,u as T,Z as K}from"./app-BBDN-jzy.js";import{L as Q}from"./LayoutFranqueado-MsoK8sHh.js";import{d as k}from"./dayjs.min-CGm5tRO5.js";import"./pt-br-BlmfhYw_.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as j}from"./LabelModel-POvTFL6C.js";import{B as R}from"./ButtonClaroMedio-BUOlBn4Q.js";import{C as S}from"./ConfirmDialog-CbULZQl9.js";const Z={class:"relative flex items-center space-x-2"},W={class:"relative"},X={class:"space-y-3"},ee=["value"],te=["value"],ae={__name:"CalendarFilterHistorico",emits:["update-filters"],setup(b,{emit:y}){k.locale("pt-br");const d=y,s=l(k().subtract(1,"month")),i=l(!1),g=l(s.value.month()),p=l(s.value.year()),_=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],f=O(()=>{const t=k().year(),a=[];for(let o=t-10;o<=t;o++)a.push(o);return a}),v=()=>{s.value=s.value.subtract(1,"month"),w()},C=()=>{s.value.add(1,"month").isBefore(k().startOf("month"))&&(s.value=s.value.add(1,"month"),w())},$=()=>{i.value=!i.value,i.value&&(g.value=s.value.month(),p.value=s.value.year())},D=()=>{i.value=!1},M=()=>{const t=k().year(p.value).month(g.value);t.isBefore(k().startOf("month"))&&(s.value=t,w()),i.value=!1},w=()=>{const t=s.value.startOf("month").format("DD-MM-YYYY"),a=s.value.endOf("month").format("DD-MM-YYYY");d("update-filters",{startDate:t,endDate:a})};A(()=>{w()});const r=t=>{i.value&&!t.target.closest(".relative")&&(i.value=!1)};return A(()=>{document.addEventListener("click",r)}),(t,a)=>(c(),m("div",Z,[e("button",{onClick:v,class:"text-indigo-600 hover:underline"},a[3]||(a[3]=[e("img",{src:"/storage/images/arrow_drop_down_circle.svg",alt:"icone drop",class:"w-5 h-5"},null,-1)])),e("div",W,[e("span",{onClick:$,class:"font-semibold text-gray-900 text-[17px] cursor-pointer hover:text-[#6db631] transition-colors"},x(s.value.format("MMMM YYYY")),1),i.value?(c(),m("div",{key:0,class:"absolute right-[-33%] z-50 bg-white border rounded-lg shadow-lg p-4 mt-2 min-w-[250px]",onClick:a[2]||(a[2]=I(()=>{},["stop"]))},[e("div",X,[e("div",null,[a[4]||(a[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Mês",-1)),z(e("select",{"onUpdate:modelValue":a[0]||(a[0]=o=>g.value=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#6db631]"},[(c(),m(V,null,F(_,(o,E)=>e("option",{key:E,value:E},x(o),9,ee)),64))],512),[[B,g.value]])]),e("div",null,[a[5]||(a[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Ano",-1)),z(e("select",{"onUpdate:modelValue":a[1]||(a[1]=o=>p.value=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#6db631]"},[(c(!0),m(V,null,F(f.value,o=>(c(),m("option",{key:o,value:o},x(o),9,te))),128))],512),[[B,p.value]])]),e("div",{class:"flex justify-end gap-2 pt-2"},[e("button",{onClick:D,class:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 font-medium"}," Cancelar "),e("button",{onClick:M,class:"px-4 py-2 text-sm bg-[#6db631] text-white rounded-md hover:bg-[#5a9929] font-medium"}," Aplicar ")])])])):q("",!0)]),e("button",{onClick:C,class:"text-indigo-600 hover:underline"},a[6]||(a[6]=[e("img",{src:"/storage/images/arrow_drop_direita_circle.svg",alt:"icone drop",class:"w-5 h-5"},null,-1)]))]))}},se={class:"painel-subtitle"},oe={class:"absolute end-4 top-1 justify-end items-center"},ne={class:"text-[#262a27] text-[15px] font-semibold"},re={class:"flex items-center space-x-2 justify-end"},le={class:"search-container relative flex items-center w-full mb-4"},ie={class:"text-lg font-semibold text-gray-800 mb-2"},de=["onClick"],ce={class:"text-lg font-medium text-gray-900"},ue={class:"text-sm text-gray-600"},me={class:"flex items-center gap-2"},ve=["src","alt"],ge={__name:"ListarContasApagarHistorico",emits:["dado-selecionado"],setup(b,{emit:y}){const d=y,s=l([]),i=l(""),g=l(!1),p=r=>{_(r.startDate,r.endDate)},_=async(r=null,t=null)=>{try{const a=await Y.get("/api/cursto/contas-a-pagar/historico",{params:{start_date:r,end_date:t}});s.value=a.data.data}catch(a){console.error("Erro ao carregar os dados:",a)}};A(_);const f=r=>{d("dado-selecionado",r)},v=O(()=>{const r=i.value.toLowerCase();return s.value.map(t=>{const a=t.contas.filter(o=>o.nome.toLowerCase().includes(r)||String(o.valor).includes(r));return{...t,contas:a}}).filter(t=>t.contas.length>0)}),C=r=>{const t=r.split("-");return`${t[2]}/${t[1]}/${t[0]}`},$={pendente:"/storage/images/check_circle_laranja.svg",pago:"/storage/images/check_circle_verde.svg",agendada:"/storage/images/agendada.svg",atrasado:"/storage/images/atrasada.svg"},D=r=>$[r]||"/storage/images/check_circle_laranja.svg",M={pendente:"bg-orange-100 text-orange-700",pago:"bg-green-100 text-green-700",agendada:"bg-blue-100 text-blue-700",atrasado:"bg-red-100 text-red-700"},w=r=>M[r.toLowerCase()]||"bg-gray-100 text-gray-700";return(r,t)=>(c(),m("div",null,[t[4]||(t[4]=e("div",{class:"painel-title"},"Histórico pagamentos",-1)),e("div",se,[t[2]||(t[2]=e("p",null,"Relatório de contas a pagar",-1)),e("div",oe,[e("button",{onClick:t[0]||(t[0]=a=>g.value=!0),class:"mr-2"}),e("div",ne,[e("div",re,[h(ae,{onUpdateFilters:p})])])])]),e("div",le,[t[3]||(t[3]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),z(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>i.value=a),placeholder:"Buscar contas",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[P,i.value]])]),(c(!0),m(V,null,F(v.value,a=>(c(),m("div",{key:a.label,class:"mb-6"},[e("div",ie,x(a.label),1),(c(!0),m(V,null,F(a.contas,o=>(c(),m("div",{key:o.id,onClick:E=>f(o),class:"flex justify-between items-center bg-white p-4 rounded-lg cursor-pointer hover:bg-gray-100 transition mt-3"},[e("div",null,[e("p",ce,x(o.nome),1),e("p",ue,x(o.valor_formatado)+" - Vence em "+x(C(o.vencimento)),1)]),e("div",me,[e("span",{class:U(["px-2 py-1 text-xs font-semibold rounded-full capitalize",w(o.status)])},x(o.status),3),e("img",{src:D(o.status),alt:o.status,class:"w-8 h-8"},null,8,ve)])],8,de))),128))]))),128))]))}},pe=H(ge,[["__scopeId","data-v-aeb38fc0"]]),fe={class:"elemento-fixo"},xe={key:0},be={class:"mt-8"},_e={class:"w-full h-[555px] bg-white rounded-[20px] p-7 relative"},he={class:"flex justify-between items-center"},ye={class:"text-[25px] font-bold font-['Figtree'] leading-8 tracking-tight"},we={class:"text-[#6db631] text-xl font-normal font-['Figtree'] leading-[25px] tracking-tight"},Ce={class:"col-span-1 row-span-2 mt-8"},ke={class:"col-span-1 row-span-2 mt-8"},$e={class:"text-[#262a27] text-[12px] font-bold leading-[48px] tracking-wide"},De=["value"],Me=["value"],Ee={class:"w-full h-[100px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] px-2 py-1 text-[14px] outline-none resize-none focus:ring-2 focus:ring-green-500"},Ve={class:"flex space-x-4 mt-5"},Ye={__name:"DetalhesContasApagarHistorico",props:{dados:{type:Object,required:!0}},emits:["voltar","atualiza"],setup(b,{emit:y}){const d=N(),s=b,i=y,g=l([]),p=l(s.dados.status),_=l(!1);l(null);const f=l(!1),v=l(!1),C=l(""),$=n=>{C.value=n,v.value=!0};J(()=>s.dados.status,n=>{p.value=n});const D=()=>{f.value=!1,t()},M=()=>{f.value=!1},w=()=>{v.value=!1,a()},r=()=>{v.value=!1},t=async()=>{if(!s.dados||!s.dados.id){d.error("Erro: Dados da conta não encontrados.");return}try{const n=await Y.post(`/api/cursto/contas-a-pagar/${s.dados.id}/pagar`);d.success(n.data.message),s.dados.status="pago",i("atualiza")}catch(n){console.error("Erro ao pagar a conta:",n),d.error("Erro ao pagar a conta")}},a=async n=>{if(!s.dados||!s.dados.id){d.error("Erro: Dados da conta não encontrados.");return}try{const u=await Y.delete(`/api/cursto/contas-a-pagar/${s.dados.id}`);d.success("Conta excluída com sucesso"),i("voltar")}catch(u){console.error("Erro ao excluir a conta:",u)}},o=n=>{if(!n)return"";const u=n.split("-");return`${u[2]}/${u[1]}/${u[0]}`},E=()=>{if(s.dados.arquivo){const n=document.createElement("a");n.href=`/${s.dados.arquivo}`,n.download=s.dados.arquivo.split("/").pop(),n.target="_blank",n.click(),d.info("Arquivo baixado com sucesso")}else d.warning("Arquivo não encontrado"),console.error("Arquivo não encontrado")};return A(async()=>{try{const n=await Y.get("/api/cursto/contas-a-pagar/status-options");g.value=n.data.data,g.value.includes(p.value)||g.value.push(p.value)}catch(n){console.error("Erro ao carregar opções de status:",n)}}),(n,u)=>(c(),m(V,null,[e("div",fe,[_.value?q("",!0):(c(),m("div",xe,[e("div",be,[e("div",_e,[e("div",he,[e("p",ye,x(b.dados.nome),1),e("button",{class:"text-gray-500 hover:text-red-600",onClick:u[0]||(u[0]=je=>$("Excluir essa conta?"))},u[1]||(u[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Excluir",class:"w-6 h-6"},null,-1)]))]),e("p",we,x(b.dados.valor_formatado),1),u[3]||(u[3]=e("p",{class:"text-[#6d6d6d] text-[15px] font-medium font-['Figtree'] leading-[20px]"},null,-1)),e("div",Ce,[e("div",ke,[e("div",$e,[h(j,{text:"Data emitida"}),e("input",{type:"text",id:"emitida_em",value:o(b.dados.emitida_em),name:"emitida_em",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500",readonly:""},null,8,De),u[2]||(u[2]=e("div",{class:"mt-12"},null,-1)),h(j,{text:"Data de vencimento"}),e("input",{type:"text",id:"vencimento",name:"vencimento",value:o(b.dados.vencimento),class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500",readonly:""},null,8,Me)])]),h(j,{text:"Informações adicionais"}),e("p",Ee,x(b.dados.descricao),1)]),e("div",Ve,[h(R,{text:"Baixar boleto",class:"text-[#6db631] bg-[#f4faf4] hover:bg-[#c1fab6] transition duration-200 ease-in-out",onClick:E})])])])]))]),h(S,{isVisible:f.value,motivo:C.value,onConfirm:D,onCancel:M},null,8,["isVisible","motivo"]),h(S,{isVisible:v.value,motivo:C.value,onConfirm:w,onCancel:r},null,8,["isVisible","motivo"])],64))}},Ae=H(Ye,[["__scopeId","data-v-148ef78d"]]),qe={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mt-3 h-full"},Fe={key:0},Ue={__name:"Historico",setup(b){const y=l(0),d=l(null),s=l(!1),i=l([]),g=f=>{i.value=f.map(v=>({categoria:v.label,valor:v.total,valor_formatado:v.total_formatado}))},p=f=>{d.value=f},_=()=>{d.value=null,y.value+=1};return(f,v)=>(c(),L(Q,null,{default:G(()=>[h(T(K),{title:"Pagamentos"}),s.value?q("",!0):(c(),m("div",qe,[(c(),L(pe,{key:y.value,ref:"listaDados",onDadoSelecionado:p,onDadosCarregados:g})),d.value?(c(),m("div",Fe,[h(Ae,{dados:d.value,onVoltar:_,onAtualiza:_},null,8,["dados"])])):q("",!0)]))]),_:1}))}};export{Ue as default};
