import{d as _,j as g,i as H,D as R,e as n,o as t,a as e,c as z,f as k,A as T,F as A,h as L,n as x,t as h,w as N,u as E,z as F,k as M,O as G,q as B,C as D,P as O,p as U,b as I,N as Z,R as J,Z as K,r as Q}from"./app-D8B-quTi.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"navbar"},X={class:"navbar-content"},Y={class:"navbar-left"},ee={class:"navbar-logo"},se=["href"],ae={class:"navbar-right"},ie={class:"notification-container"},oe={key:0,class:"notification-badge"},te={key:0,class:"notification-tray"},ne={class:"notification-header"},le={class:"notification-list"},re={key:0,class:"notification-loading"},ue={key:1,class:"no-notifications"},ce=["onClick"],de={class:"notification-icon-type"},me={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},fe={key:2,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ge={class:"notification-content"},he={class:"notification-title"},pe={class:"notification-message"},_e={class:"notification-time"},ke={key:0,class:"user-info"},be=["src"],qe={class:"user-details"},we={class:"user-name"},Pe={class:"user-location"},ye={key:1,class:"user-info loading"},Ce={__name:"Navbar",setup(c){const o=_(null),f=g(()=>{var a;return(a=o.value)==null?void 0:a.unidade}),r=_([]),b=_(!1),m=_(!1),P=g(()=>r.value.filter(a=>a.lida===0).length),w=g(()=>{var a,s;return((a=o.value)==null?void 0:a.profile_photo_url)||`https://ui-avatars.com/api/?name=${l((s=o.value)==null?void 0:s.name)}&color=7F9CF5&background=EBF4FF`}),l=a=>a?a.split(" ").map(i=>i.charAt(0).toUpperCase()).join(""):"*",v=async()=>{try{const a=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok)throw new Error("Erro ao carregar perfil do usuário");const s=await a.json();o.value=s.data}catch(a){console.error("Erro ao buscar perfil:",a),o.value=null}},u=async()=>{b.value=!0;try{const a=await fetch("/api/notificacoes",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok)throw new Error("Erro ao carregar notificações");const s=await a.json();r.value=s.data}catch(a){console.error("Erro ao buscar notificações:",a),r.value=[]}finally{b.value=!1}},d=async a=>{try{if((await M.post(`/api/notificacoes/${a}/ler`)).status===200){const i=r.value.findIndex(q=>q.id===a);i!==-1&&(r.value[i].lida=1,r.value[i].lida_em=new Date().toISOString())}}catch(s){console.error("Erro ao marcar notificação como lida:",s)}},y=async()=>{try{(await M.post("/api/notificacoes/ler-todas")).status===200&&r.value.forEach(s=>{s.lida=1,s.lida_em=new Date().toISOString()})}catch(a){console.error("Erro ao marcar todas notificações como lidas:",a)}},V=a=>{a.stopPropagation(),m.value=!m.value,m.value&&u()},C=a=>{const s=document.querySelector(".notification-container");s&&!s.contains(a.target)&&(m.value=!1)};let p;return H(()=>{v(),u(),document.addEventListener("click",C),p=setInterval(()=>{m.value||u()},3e5)}),R(()=>{document.removeEventListener("click",C),clearInterval(p)}),(a,s)=>(t(),n("div",W,[s[9]||(s[9]=e("div",{class:"navbar-background"},null,-1)),e("div",X,[e("div",Y,[e("div",ee,[s[1]||(s[1]=e("div",{class:"mr-4"},[e("a",{href:"https://www.taiksu.com.br/office/",target:"_blank"},[e("img",{src:"/storage/images/quadrados_verdes.svg",alt:"Quadrados verdes",class:"w-full h-full"})])],-1)),e("div",null,[e("a",{href:a.route("franqueado.painel")},s[0]||(s[0]=[e("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,se)])])]),e("div",ae,[e("div",ie,[e("div",{class:"notification-icon",onClick:V},[s[2]||(s[2]=T('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-00f1460d><mask id="mask0_4631_13059" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24" data-v-00f1460d><rect width="24" height="24" fill="#D9D9D9" data-v-00f1460d></rect></mask><g mask="url(#mask0_4631_13059)" data-v-00f1460d><path d="M2.40039 20.4V18H4.80039V9.6C4.80039 7.94 5.30039 6.465 6.30039 5.175C7.30039 3.885 8.60039 3.04 10.2004 2.64V1.8C10.2004 1.3 10.3754 0.875 10.7254 0.525C11.0754 0.175 11.5004 0 12.0004 0C12.5004 0 12.9254 0.175 13.2754 0.525C13.6254 0.875 13.8004 1.3 13.8004 1.8V2.64C15.4004 3.04 16.7004 3.885 17.7004 5.175C18.7004 6.465 19.2004 7.94 19.2004 9.6V18H21.6004V20.4H2.40039ZM12.0004 24C11.3404 24 10.7754 23.765 10.3054 23.295C9.83539 22.825 9.60039 22.26 9.60039 21.6H14.4004C14.4004 22.26 14.1654 22.825 13.6954 23.295C13.2254 23.765 12.6604 24 12.0004 24ZM7.20039 18H16.8004V9.6C16.8004 8.28 16.3304 7.15 15.3904 6.21C14.4504 5.27 13.3204 4.8 12.0004 4.8C10.6804 4.8 9.55039 5.27 8.61039 6.21C7.67039 7.15 7.20039 8.28 7.20039 9.6V18Z" fill="#6DB631" data-v-00f1460d></path></g></svg>',1)),P.value>0?(t(),n("div",oe)):k("",!0)]),m.value?(t(),n("div",te,[e("div",ne,[s[3]||(s[3]=e("h3",null,"Notificações",-1)),r.value.length>0?(t(),n("span",{key:0,onClick:y,class:"mark-all-read"},"Marcar todas como lidas")):k("",!0)]),e("div",le,[b.value?(t(),n("div",re,s[4]||(s[4]=[e("div",{class:"notification-skeleton"},null,-1),e("div",{class:"notification-skeleton"},null,-1)]))):r.value.length===0?(t(),n("div",ue," Nenhuma notificação no momento ")):(t(!0),n(A,{key:2},L(r.value,i=>(t(),n("div",{key:i.id,class:x(["notification-item",{unread:i.lida===0}]),onClick:q=>d(i.id)},[e("div",de,[i.tipo==="info"?(t(),n("svg",me,s[5]||(s[5]=[e("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 100-16 8 8 0 000 16zM11 7h2v2h-2V7zm0 4h2v6h-2v-6z",fill:"#6DB631"},null,-1)]))):i.tipo==="alerta"?(t(),n("svg",ve,s[6]||(s[6]=[e("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-1-7v2h2v-2h-2zm0-8v6h2V7h-2z",fill:"#FF9800"},null,-1)]))):(t(),n("svg",fe,s[7]||(s[7]=[e("path",{d:"M4 19h16v2H4v-2zm5-4h11v2H9v-2zm-5-4h16v2H4v-2zm5-4h11v2H9V7zM4 3h16v2H4V3z",fill:"#6DB631"},null,-1)])))]),e("div",ge,[e("div",he,h(i.titulo),1),e("div",pe,h(i.mensagem),1),e("div",_e,h(i.tempo),1)])],10,ce))),128))])])):k("",!0)]),o.value?(t(),z(E(F),{key:0,href:a.route("franqueado.perfil"),class:x(["user-info",{loading:!o.value}])},{default:N(()=>{var i;return[o.value?(t(),n("div",ke,[e("img",{src:w.value,alt:"Avatar",class:"avatar"},null,8,be),e("div",qe,[e("div",we,h(o.value.name),1),e("div",Pe,h(((i=f.value)==null?void 0:i.cidade)||"Taiksu Franchising"),1)])])):(t(),n("div",ye,s[8]||(s[8]=[e("div",{class:"avatar-skeleton"},null,-1),e("div",{class:"user-details-skeleton"},[e("div",{class:"name-skeleton"}),e("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["href","class"])):k("",!0)])])]))}},Se=$(Ce,[["__scopeId","data-v-00f1460d"]]),xe={class:"icon"},Ie=["src"],Ae={class:"label"},Le={type:"submit",class:"w-full h-full flex items-center"},Ee={class:"icon"},$e=["src"],Ve={class:"label"},Ne={key:2,class:"submenu"},Fe={class:"label"},Me={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(c){const o=c,f=G("userPermissions",_({})),r=_(!1),b=g(()=>r.value),m=g(()=>o.link&&/^https?:\/\//.test(o.link)),P=g(()=>m.value?o.link:o.link?route(o.link):"#"),w=g(()=>!o.requiredPermission||f.value[o.requiredPermission]),l=g(()=>o.submenuItems.filter(i=>!i.requiredPermission||f.value[i.requiredPermission])),v=i=>{l.value.length>0&&(i.preventDefault(),u())},u=()=>{r.value=!r.value,y()},d=()=>{const i=localStorage.getItem(`submenu-${o.link}`);i!==null&&(r.value=JSON.parse(i))},y=()=>{localStorage.setItem(`submenu-${o.link}`,JSON.stringify(r.value))},V=g(()=>p.value||o.isActive?"submenu-active":""),C=i=>{const q=window.location.pathname,S=new URL(route(i),window.location.origin).pathname;return q===S},p=g(()=>l.value.some(i=>C(i.link))),a=()=>{o.isLogout&&Z.post(route("logout"))};return d(),B(p,()=>{p.value||D(()=>{r.value=!1,y()})}),B(r,()=>{D(()=>y())}),(i,q)=>(t(),n("div",null,[!c.isLogout&&c.link&&w.value?(t(),z(O(m.value?"a":E(F)),{key:0,class:x(["menu-item",[V.value,{active:c.isActive||p.value}]]),href:P.value,target:m.value?"_blank":null,onClick:v},{default:N(()=>[e("div",xe,[e("img",{src:c.icon,alt:"icon"},null,8,Ie)]),e("div",Ae,h(c.label),1),l.value.length>0?(t(),n("div",{key:0,class:x(["right-icon",{"rotate-icon":b.value}])},q[0]||(q[0]=[e("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):k("",!0)]),_:1},8,["class","href","target"])):c.isLogout&&w.value?(t(),n("form",{key:1,onSubmit:U(a,["prevent"]),class:"menu-item"},[e("button",Le,[e("div",Ee,[e("img",{src:c.icon,alt:"icon"},null,8,$e)]),e("div",Ve,h(c.label),1)])],32)):k("",!0),l.value.length>0&&(r.value||p.value)?(t(),n("div",Ne,[(t(!0),n(A,null,L(l.value,(S,j)=>(t(),n("div",{key:j},[I(E(F),{class:x(["submenu-item",{active:C(S.link)}]),href:i.route(S.link)},{default:N(()=>[e("div",Fe,h(S.label),1)]),_:2},1032,["href","class"])]))),128))])):k("",!0)]))}},ze=$(Me,[["__scopeId","data-v-bed64f61"]]),Be={key:0,class:"category-title menu-categorias text-sm sm:text-base font-medium text-[#87ba73] mb-3 pl-4"},De={__name:"Slidebar",setup(c){const o=_(null),f=_({}),r=async()=>{try{const l=await M.get("/api/navbar-profile");f.value=l.data.data.permissions||{}}catch(l){console.error("Erro ao carregar permissões:",l),f.value={}}};J("userPermissions",f);const b=[{name:"",items:[{label:"Inicio",icon:"/storage/images/inicio.svg",link:"franqueado.painel",isLogout:!1,isActive:!1,requiredPermission:null}]},{name:"Ferramentas",items:[{label:"E-mail",icon:"/storage/images/email.svg",link:"https://arquivos.taiksu.com.br/apps/mail/box/1",isLogout:!1,isActive:!1,requiredPermission:null},{label:"Comunidade",icon:"/storage/images/diversity_4.svg",link:"https://arquivos.taiksu.com.br/call/wprjfww7",isLogout:!1,isActive:!1,requiredPermission:null},{label:"Treinamento",icon:"/storage/images/treinamento.svg",link:"https://treinamento.taiksu.com.br/",isLogout:!1,isActive:!1,requiredPermission:null},{label:"Mídias",icon:"/storage/images/perm_media.svg",link:"https://arquivos.taiksu.com.br/s/P5nypCADKccgcib",isLogout:!1,isActive:!1,requiredPermission:null}]},{name:"Gestão da loja",items:[{label:"Gestão de estoque",icon:"/storage/images/estoque.svg",link:"franqueado.estoque",isLogout:!1,requiredPermission:"controle_estoque",submenuItems:[{label:"Inventário",link:"franqueado.inventario",requiredPermission:"controle_estoque"},{label:"Saida de estoque",link:"franqueado.controleEstoque",requiredPermission:"controle_saida_estoque"},{label:"Fornecedores",link:"franqueado.fornecedores",requiredPermission:"controle_estoque"},{label:"Novo Pedidos",link:"franqueado.pedidos",requiredPermission:"controle_estoque"},{label:"Histórico de Pedidos",link:"franqueado.historicoPedidos",requiredPermission:"controle_estoque"}],isActive:!1},{label:"Gestão de resíduos",icon:"/storage/images/delete_branco.svg",link:"franqueado.supervisaoResidos",isLogout:!1,requiredPermission:"gestao_salmao",submenuItems:[{label:"Limpeza de salmão",link:"franqueado.limpesaSalmoes",requiredPermission:"gestao_salmao"}],isActive:!1},{label:"Gestão de equipe",icon:"/storage/images/gestao_servisos.svg",link:"franqueado.gestaoEquipe",isLogout:!1,requiredPermission:"gestao_equipe",submenuItems:[{label:"Controle de ponto",icon:"/storage/images/add_product.svg",link:"franqueado.controlePonto",requiredPermission:"gestao_equipe"},{label:"Folha de pagamento",link:"franqueado.folhaPagamento",requiredPermission:"gestao_equipe"}],isActive:!1}]},{name:"Financeiro",items:[{label:"Fluxo de caixa",icon:"/storage/images/fluxo_caixa.svg",link:"franqueado.abrirCaixa",isLogout:!1,requiredPermission:"fluxo_caixa",submenuItems:[{label:"Métodos de pagamento",link:"franqueado.metodosPagamentos",requiredPermission:"fluxo_caixa"},{label:"Canais de Vendas",link:"franqueado.canaisVendas",requiredPermission:"fluxo_caixa"},{label:"Histórico de Caixa",link:"franqueado.historicoCaixa",requiredPermission:"fluxo_caixa"},{label:"Caixa Retroativo",link:"franqueado.caixaRetroativo",requiredPermission:"fluxo_caixa"}],isActive:!1},{label:"Contas a pagar",icon:"/storage/images/attach_money.svg",link:"franqueado.contasApagar",isLogout:!1,requiredPermission:"contas_pagar",submenuItems:[{label:"Histórico de Despesas",link:"franqueado.historicoContas",requiredPermission:"contas_pagar"}],isActive:!1},{label:"DRE Gerencial",icon:"/storage/images/analitic.svg",link:"franqueado.dreGerencial",isLogout:!1,requiredPermission:"dre",isActive:!1}]},{name:"",items:[{label:"Sair",icon:"/storage/images/log-out.png",link:"logout",isLogout:!0}]}],m=g(()=>b.map(l=>({...l,items:l.items.filter(v=>!v.requiredPermission||f.value[v.requiredPermission]||v.submenuItems&&v.submenuItems.some(u=>!u.requiredPermission||f.value[u.requiredPermission]))})).filter(l=>l.items.length>0));H(async()=>{await r();const l=localStorage.getItem("sidebarScrollPosition");l&&o.value&&(o.value.scrollTop=l)});const P=()=>{o.value&&localStorage.setItem("sidebarScrollPosition",o.value.scrollTop)},w=l=>{const v=window.location.pathname,u=new URL(l,window.location.origin).pathname;return v===u||v.startsWith(u)};return(l,v)=>(t(),n("div",null,[e("div",{class:"sidebar fixed top-16 left-0 bg-[#164110] text-white flex flex-col p-3 overflow-y-auto h-full sm:w-64 md:w-72 lg:w-80 xl:w-80",ref_key:"sidebar",ref:o,onScroll:P},[(t(!0),n(A,null,L(m.value,u=>(t(),n("div",{key:u.name,class:"menu-category mb-6"},[u.items.length>0?(t(),n("div",Be,h(u.name),1)):k("",!0),(t(!0),n(A,null,L(u.items,d=>(t(),z(ze,{key:d.link||"no-link",label:d.label,icon:d.icon,link:d.link,submenuItems:d.submenuItems,isActive:d.link?w(d.link):!1,isLogout:d.isLogout,requiredPermission:d.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],544)]))}},He=$(De,[["__scopeId","data-v-e3fe6b6a"]]),je={class:"content"},Re={__name:"LayoutFranqueado",props:{title:String},setup(c){return(o,f)=>(t(),n("div",null,[I(E(K),{title:c.title},null,8,["title"]),I(Se),I(He),e("main",je,[Q(o.$slots,"default",{},void 0,!0)])]))}},Oe=$(Re,[["__scopeId","data-v-d4397c97"]]);export{Oe as L};
