import{s as M,d as o,o as n,e as p,a as e,i as D,b as s,t as k,h as w,y as q,j as S,v as L,F,g as z,f as j,x as G,c as B,w as H,u as K,Z as W,n as X}from"./app-D-CG014l.js";import{_ as U,I as C,C as Y,B as A,a as P,d as J}from"./ConfirmDialog-Dt6kxCar.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as ee}from"./ButtonEditeMedio-BnfuASEo.js";import{A as ae}from"./AppLayout-3AvPu0VX.js";const se={key:0,class:"sidebar-container"},te={key:0,class:"loading-overlay"},de={key:1,class:"painel-title"},le={class:"w-full h-[525px] bg-white rounded-[20px] p-12"},oe={class:"flex space-x-4"},ie={class:"flex flex-col w-1/2"},ne={class:"flex flex-col w-1/2"},re={key:0,class:"error-message"},ue={class:"form-buttons"},ce={__name:"CadastroUnidade",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(t,{emit:d}){const r=M(),V=d,m=o(""),u=o(""),i=o(""),l=o(""),h=o(""),b=o(""),x=o(""),_=o(!1),y=o(!1),E=o(""),N=()=>{g(),V("cancelar")},g=()=>{m.value="",u.value="",i.value="",l.value="",h.value="",b.value="",x.value=""},c=()=>!m.value||!u.value||!l.value?(r.error("Por favor, preencha todos os campos obrigatórios."),x.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,v=async()=>{var $,a;if(c())try{_.value=!0;const f=await q.post("/api/unidades",{cnpj:m.value,cep:u.value,cidade:i.value,bairro:l.value,rua:h.value,numero:b.value});console.log("Unidade cadastrada com sucesso:",f.data),r.success("Unidade cadastrada com sucesso!"),J.Inertia.visit("/unidades"),g()}catch(f){r.error("Erro ao cadastrar unidade."),x.value=((a=($=f.response)==null?void 0:$.data)==null?void 0:a.message)||"Erro ao cadastrar unidade."}finally{_.value=!1}},Q=$=>{let a=$.target.value.replace(/\D/g,"");a.length>14&&(a=a.slice(0,14)),a=a.replace(/^(\d{2})(\d)/,"$1.$2"),a=a.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),a=a.replace(/\.(\d{3})(\d)/,".$1/$2"),a=a.replace(/(\d{4})(\d)/,"$1-$2"),m.value=a},R=$=>{let a=$.target.value.replace(/\D/g,"");a.length>8&&(a=a.slice(0,8)),a=a.replace(/(\d{5})(\d)/,"$1-$2"),u.value=a},T=$=>{E.value=$,y.value=!0},O=()=>{v(),y.value=!1},Z=()=>{y.value=!1};return($,a)=>t.isVisible?(n(),p("div",se,[_.value?(n(),p("div",te,a[7]||(a[7]=[e("div",{class:"spinner"},null,-1)]))):(n(),p("div",de,"Dados da nova unidade")),a[8]||(a[8]=e("div",{class:"painel-subtitle"},[e("p",null,"Informações básicas sobre a operação")],-1)),e("div",le,[e("form",{onSubmit:D(v,["prevent"])},[s(U,{text:"CNPJ"}),s(C,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=f=>m.value=f),onInput:Q,placeholder:"CNPJ"},null,8,["modelValue"]),s(U,{text:"Cidade"}),s(C,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=f=>i.value=f),placeholder:"Cidade"},null,8,["modelValue"]),s(U,{text:"CEP"}),s(C,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=f=>u.value=f),onInput:R,placeholder:"CEP"},null,8,["modelValue"]),e("div",oe,[e("div",ie,[s(U,{text:"Rua"}),s(C,{modelValue:h.value,"onUpdate:modelValue":a[3]||(a[3]=f=>h.value=f),placeholder:"Rua"},null,8,["modelValue"])]),e("div",ne,[s(U,{text:"Número"}),s(C,{modelValue:b.value,"onUpdate:modelValue":a[4]||(a[4]=f=>b.value=f),placeholder:"Número"},null,8,["modelValue"])])]),s(U,{text:"Bairro"}),s(C,{modelValue:l.value,"onUpdate:modelValue":a[5]||(a[5]=f=>l.value=f),placeholder:"Bairro"},null,8,["modelValue"]),x.value?(n(),p("div",re,k(x.value),1)):w("",!0),s(Y,{isVisible:y.value,motivo:E.value,onConfirm:O,onCancel:Z},null,8,["isVisible","motivo"]),e("div",ue,[s(A,{text:"Cancelar",onClick:N}),s(P,{text:"Cadastrar",onClick:a[6]||(a[6]=f=>T("Criar nova unidade?"))})])],32)])])):w("",!0)}},ve=I(ce,[["__scopeId","data-v-2e163658"]]);o([]);const pe={data(){return{unidades:[],searchQuery:""}},mounted(){this.fetchUnidades()},methods:{async fetchUnidades(){try{const t=await q.get("/api/unidades");this.unidades=t.data}catch(t){console.error("Erro ao carregar unidades:",t)}},selecionarUnidade(t){this.$emit("unidade-selecionada",{unidade:t.unidade,usuarios:t.usuarios,cidade:t.cidade})}},computed:{filteredUnidades(){return this.unidades.filter(t=>{const d=t.unidade.cidade||t.cidade;return d&&d.toLowerCase().includes(this.searchQuery.toLowerCase())})}}},me={class:"search-container relative flex items-center w-full mb-4"},fe={class:"card-container"},ge=["onClick"],xe={class:"card-inner"},he={class:"text-container"},be={class:"city"},_e={class:"owner"};function ye(t,d,r,V,m,u){return n(),p("div",null,[d[4]||(d[4]=e("div",{class:"painel-title"},"Nossas Unidades",-1)),d[5]||(d[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Listagem de todas as unidades da franquia")],-1)),e("div",me,[d[1]||(d[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),S(e("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=i=>m.searchQuery=i),placeholder:"Pesquisar unidades",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[L,m.searchQuery]])]),e("div",fe,[(n(!0),p(F,null,z(u.filteredUnidades,i=>(n(),p("div",{key:i.unidade.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:l=>u.selecionarUnidade(i)},[e("div",xe,[d[2]||(d[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/storefront-verde.svg",alt:"Ícone da Unidade"})])],-1)),e("div",he,[e("div",be,k(i.unidade.cidade||i.cidade),1),e("div",_e,[i.usuarios.length>0?(n(),p(F,{key:0},[j(k(i.usuarios.map(l=>l.name).join(", ")),1)],64)):(n(),p(F,{key:1},[j("Unidade sem Franqueado")],64))])]),d[3]||(d[3]=e("div",{class:"action-icon"},null,-1))])],8,ge))),128))])])}const Ue=I(pe,[["render",ye],["__scopeId","data-v-d2a9f774"]]),Ce={key:0,class:"sidebar-container"},Ve={class:"w-full h-[680px] bg-white rounded-[20px] p-12"},$e={class:"flex space-x-4"},ke={class:"flex flex-col w-1/2"},we={class:"flex flex-col w-1/2"},Ee={key:0,class:"error-message"},Fe={class:"form-buttons"},Ne={__name:"EditarUnidade",props:{isVisible:{type:Boolean,required:!0},unidade:{type:Object,required:!0}},emits:["cancelar"],setup(t,{emit:d}){const r=M(),V=t,m=d,u=o(""),i=o(""),l=o(""),h=o(""),b=o(""),x=o(""),_=o(""),y=o("");G(()=>V.unidade.unidade,g=>{g&&(u.value=g.id||"",l.value=g.cidade||"",i.value=g.cep||"",h.value=g.bairro||"",b.value=g.rua||"",x.value=g.numero||"",_.value=g.cnpj||"")},{immediate:!0});const E=()=>{m("cancelar")},N=async()=>{var g,c;if(!u.value||!_.value||!i.value||!b.value||!x.value){y.value="Por favor, preencha todos os campos obrigatórios.";return}try{await J.Inertia.put(route("unidades.update",V.unidade.unidade.id),{id:u.value,cep:i.value,cidade:l.value,bairro:h.value,rua:b.value,numero:x.value,cnpj:_.value}),r.success("Unidade atualizada com sucesso!"),m("cancelar")}catch(v){r.error("Erro ao atualizar a unidade."),y.value=((c=(g=v.response)==null?void 0:g.data)==null?void 0:c.message)||"Erro ao atualizar a unidade.",console.error("Erro na atualização:",v)}};return(g,c)=>t.isVisible?(n(),p("div",Ce,[e("div",Ve,[e("form",{onSubmit:D(N,["prevent"])},[S(e("input",{type:"hidden","onUpdate:modelValue":c[0]||(c[0]=v=>u.value=v)},null,512),[[L,u.value]]),s(U,{text:"CNPJ"}),s(C,{modelValue:_.value,"onUpdate:modelValue":c[1]||(c[1]=v=>_.value=v),placeholder:"CNPJ"},null,8,["modelValue"]),s(U,{text:"Cidade"}),s(C,{modelValue:l.value,"onUpdate:modelValue":c[2]||(c[2]=v=>l.value=v),placeholder:"Cidade"},null,8,["modelValue"]),s(U,{text:"CEP"}),s(C,{modelValue:i.value,"onUpdate:modelValue":c[3]||(c[3]=v=>i.value=v),placeholder:"CEP"},null,8,["modelValue"]),e("div",$e,[e("div",ke,[s(U,{text:"Rua"}),s(C,{modelValue:b.value,"onUpdate:modelValue":c[4]||(c[4]=v=>b.value=v),placeholder:"Rua"},null,8,["modelValue"])]),e("div",we,[s(U,{text:"Número"}),s(C,{modelValue:x.value,"onUpdate:modelValue":c[5]||(c[5]=v=>x.value=v),placeholder:"Número"},null,8,["modelValue"])])]),s(U,{text:"Bairro"}),s(C,{modelValue:h.value,"onUpdate:modelValue":c[6]||(c[6]=v=>h.value=v),placeholder:"Bairro"},null,8,["modelValue"]),y.value?(n(),p("div",Ee,k(y.value),1)):w("",!0),e("div",Fe,[s(A,{text:"Cancelar",onClick:E}),s(P,{text:"Atualizar",onClick:N})])],32)])])):w("",!0)}},je=I(Ne,[["__scopeId","data-v-3b2eac9f"]]),Be={key:0,class:"w-full h-[350px] bg-white rounded-[20px] p-12"},Pe={class:"relative w-full h-full"},Ie={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},Me={class:"w-[135px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},De={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},qe={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Se={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Le={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[34px] tracking-tight"},ze={class:"absolute bottom-0 left-0 w-full h-[100px] flex flex-col gap-1"},Ae={class:"h-[43px] pl-4 pr-3 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Je={class:"text-[#6db631] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Qe={key:1,class:"mt-4"},Re={__name:"DetalhesUnidade",props:{unidade:{type:Object,required:!0}},setup(t){const d=o(!1),r=o(!1),V=()=>{o.dadosUnidade.fetchUnidades()},m=()=>{r.value=!r.value,d.value=!1},u=()=>{r.value=!1,d.value=!0};return(i,l)=>{var h,b,x,_,y;return n(),p(F,null,[r.value?w("",!0):(n(),p("div",Be,[e("div",Pe,[e("div",Ie,[e("div",Me,[l[0]||(l[0]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",De," ID# "+k((((h=t.unidade.unidade)==null?void 0:h.id)??0).toString().padStart(4,"0")),1)]),e("div",qe,[l[1]||(l[1]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",Se,k(((b=t.unidade.unidade)==null?void 0:b.cnpj)||"N/A"),1)])]),e("div",Le,k(((x=t.unidade.unidade)==null?void 0:x.cidade)||t.unidade.cidade||"N/A"),1),e("div",ze,[l[2]||(l[2]=e("div",{class:"text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight"}," Esta unidade pertence a ",-1)),e("div",Ae,[e("div",Je,[(y=(_=t.unidade)==null?void 0:_.usuarios)!=null&&y.length?(n(!0),p(F,{key:0},z(t.unidade.usuarios,E=>(n(),p("div",{key:E.id},k(E.name),1))),128)):(n(),p(F,{key:1},[j("Sem informações")],64))])])])])])),t.unidade.unidade.id&&!r.value?(n(),p("div",Qe,[s(ee,{text:"Editar Unidade","icon-path":"/storage/images/border_color.svg",onClick:m,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):w("",!0),r.value?(n(),B(je,{key:2,ref:"dadosUnidade",isVisible:r.value,unidade:t.unidade,onDadosUnidade:V,onCancelar:u},null,8,["isVisible","unidade"])):w("",!0)],64)}}},Te={class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2"},Oe={class:"flex flex-col gap-4"},Ze={class:"absolute bottom-4 right-4"},Ge={key:1,class:"mt-4"},ea={__name:"Index",setup(t){const d=o(null),r=o(!1),V=()=>{r.value=!r.value},m=()=>{u(),r.value=!1},u=()=>{o.listarUnidades.fetchUnidades()},i=l=>{d.value=l};return(l,h)=>(n(),B(ae,null,{default:H(()=>[s(K(W),{title:"Unidades"}),e("div",Te,[e("div",null,[s(Ue,{ref:"listarUnidades",onUnidadeCadastrada:u,onUnidadeSelecionada:i},null,512)]),e("div",Oe,[r.value?(n(),p("div",Ge,[s(ve,{isVisible:r.value,onUnidadeCadastrada:m,onCancelar:V},null,8,["isVisible"])])):(n(),p(F,{key:0},[d.value?(n(),B(Re,{key:0,unidade:d.value},null,8,["unidade"])):w("",!0),e("div",Ze,[s(P,{text:"Nova Unidade",iconPath:"/storage/images/arrow_left_alt.svg",onClick:V,class:X({hidden:l.isEditMode})},null,8,["class"])])],64))])])]),_:1}))}};export{ea as default};
