import{A as re}from"./LayoutFranqueadora-DiH6JeKK.js";import{k as q,o as s,e as l,a as e,j as U,v as K,F as A,g as W,f as Y,t as E,h as _,l as X,d as n,m as le,c as R,w as Z,p as B,b as g,x as F,q as ee,y as ne,u as ie,Z as de}from"./app-itAU4ZWH.js";import{_ as L,I as te,B as oe,a as G,d as H}from"./ButtonCancelar-BybogMsa.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as ue}from"./ButtonEditeMedio-D98sA3y1.js";import{C as J}from"./ConfirmDialog-HmAOgdxe.js";import"./user-rGH4vatH.js";const ce={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const u=await q.get("/api/produtos/lista");console.log("Produtos carregados:",u.data),this.produtos=u.data}catch(u){console.error("Erro ao carregar os produtos:",u)}},getProfilePhotoUrl(u){return u?new URL(u,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(u){this.$emit("produto-selecionado",u)}},computed:{filteredProdutos(){const u=this.searchQuery.toLowerCase();return this.produtos.filter(c=>c.nome.toLowerCase().includes(u))}}},pe={class:"search-container relative flex items-center w-full mb-4"},me={class:"card-container"},ve=["onClick"],fe={class:"card-inner"},ge={class:"icon-container"},he={class:"icon-leaf"},_e=["src"],xe={class:"text-container"},ye={class:"city"},be={key:0,class:"estrela"};function we(u,c,p,b,x,v){return s(),l("div",null,[c[4]||(c[4]=e("div",{class:"painel-title"},"Insumos",-1)),c[5]||(c[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",pe,[c[1]||(c[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),U(e("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=o=>x.searchQuery=o),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[K,x.searchQuery]])]),e("div",me,[(s(!0),l(A,null,W(v.filteredProdutos,o=>(s(),l("div",{key:o.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:i=>v.selecionarProduto(o)},[e("div",fe,[e("div",ge,[c[2]||(c[2]=e("div",{class:"icon-bg"},null,-1)),e("div",he,[e("img",{src:v.getProfilePhotoUrl(o.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,_e)])]),e("div",xe,[e("div",ye,[Y(E(o.nome)+" ",1),o.estrela?(s(),l("span",be,"★")):_("",!0)])]),c[3]||(c[3]=e("div",{class:"action-icon"},null,-1))])],8,ve))),128))])])}const $e=N(ce,[["render",we],["__scopeId","data-v-036bce99"]]),ke={key:0,class:"sidebar-container"},Ce={key:0,class:"loading-overlay"},Pe={key:1,class:"w-full h-[560px] bg-white rounded-[20px] p-12"},Ue={class:"flex justify-center mb-6 relative group"},Ve=["src"],Ie={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},De={key:0,class:"error-message"},Fe={class:"flex items-center space-x-4 mt-2"},je={class:"flex items-center space-x-2 cursor-pointer"},Ee={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Me={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Se={class:"flex items-center space-x-2 cursor-pointer"},Be={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Le={key:0,class:"w-3 h-3 rounded-full bg-green-500"},qe={class:"flex items-center space-x-4 mt-2"},Ae={class:"flex items-center space-x-2 cursor-pointer"},Re={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Ne={key:0,class:"w-3 h-3 rounded-full bg-green-500"},ze={class:"flex items-center space-x-2 cursor-pointer"},Te={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Oe={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Qe={class:"flex justify-start space-x-1 mt-[15%]"},Xe={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(u,{emit:c}){const p=X(),b=u,x=c,v=n(""),o=n(""),i=n(""),h=n(""),w=n(null),I=n(""),D=n(null),$=n(!1),C=n(!1),V=n("");le(()=>b.produto,m=>{m&&(v.value=m.nome||"",o.value=m.categoria||"",i.value=m.unidadeDeMedida||"",h.value=m.profile_photo||"")},{immediate:!0});const M=m=>m?new URL(m,window.location.origin).href:"/storage/images/no_imagem.svg",y=async()=>{var m,a;if(!v.value){p.error("O campo nome é obrigatório.");return}try{$.value=!0;const d=new FormData;if(d.append("id",b.produto.id),d.append("nome",v.value),d.append("categoria",o.value),d.append("unidadeDeMedida",i.value),w.value){const t=`${Date.now()}_${w.value.name}`;d.append("profile_photo_name",t),d.append("profile_photo",w.value)}const f=await q.post("/api/produtos/atualizar",d,{headers:{"Content-Type":"multipart/form-data"}});H.Inertia.replace(route("franqueadora.insumos"),{produto:f.data.produto,preserveState:!0}),p.success("Produto atualizado com sucesso!")}catch(d){p.error("Erro ao atualizar o produto."),I.value=((a=(m=d.response)==null?void 0:m.data)==null?void 0:a.message)||"Erro inesperado."}finally{$.value=!1}},k=m=>{V.value=m,C.value=!0},j=()=>{y(),C.value=!1},S=()=>{C.value=!1},P=()=>{var m;(m=D.value)==null||m.click()},z=()=>{h.value="",p.info("Imagem removida.")},T=m=>{const a=m.target.files[0];if(a){if(a.size>5*1024*1024){p.error("A imagem não pode exceder 5 MB.");return}w.value=a;const d=new FileReader;d.onload=()=>{h.value=d.result,p.success("Imagem carregada com sucesso!")},d.readAsDataURL(a)}},O=()=>{x("cancelar")};return(m,a)=>(s(),R(ee,{name:"fade"},{default:Z(()=>[u.isVisible?(s(),l("div",ke,[$.value?(s(),l("div",Ce,a[7]||(a[7]=[e("div",{class:"spinner"},null,-1)]))):(s(),l("div",Pe,[e("form",{onSubmit:B(y,["prevent"])},[e("div",Ue,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:P},[h.value?(s(),l(A,{key:0},[e("img",{src:M(h.value),alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,Ve),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:a[0]||(a[0]=B(()=>{},["stop"]))},[e("button",{onClick:B(z,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(s(),l("img",Ie))]),e("input",{type:"file",ref_key:"fileInput",ref:D,accept:"image/*",class:"hidden",onChange:T},null,544)]),g(L,{text:"Nome"}),g(te,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=d=>v.value=d),placeholder:""},null,8,["modelValue"]),I.value?(s(),l("div",De,E(I.value),1)):_("",!0),g(L,{class:"font-semibold text-gray-800 mt-8",text:"Prioridade"}),e("div",Fe,[e("label",je,[U(e("input",{type:"radio","onUpdate:modelValue":a[2]||(a[2]=d=>o.value=d),value:"principal",class:"hidden"},null,512),[[F,o.value]]),e("div",Ee,[o.value==="principal"?(s(),l("div",Me)):_("",!0)]),a[8]||(a[8]=e("span",null,"Principal",-1))]),e("label",Se,[U(e("input",{type:"radio","onUpdate:modelValue":a[3]||(a[3]=d=>o.value=d),value:"secundario",class:"hidden"},null,512),[[F,o.value]]),e("div",Be,[o.value==="secundario"?(s(),l("div",Le)):_("",!0)]),a[9]||(a[9]=e("span",null,"Secundário",-1))])]),g(L,{class:"font-semibold text-gray-800 mt-8",text:"Unidade de medida"}),e("div",qe,[e("label",Ae,[U(e("input",{type:"radio","onUpdate:modelValue":a[4]||(a[4]=d=>i.value=d),value:"a_granel",class:"hidden"},null,512),[[F,i.value]]),e("div",Re,[i.value==="a_granel"?(s(),l("div",Ne)):_("",!0)]),a[10]||(a[10]=e("span",null,"A granel",-1))]),e("label",ze,[U(e("input",{type:"radio","onUpdate:modelValue":a[5]||(a[5]=d=>i.value=d),value:"unitario",class:"hidden"},null,512),[[F,i.value]]),e("div",Te,[i.value==="unitario"?(s(),l("div",Oe)):_("",!0)]),a[11]||(a[11]=e("span",null,"Unitário",-1))])]),e("div",Qe,[g(oe,{text:"Cancelar",onClick:O}),g(G,{text:"Atualizar",onClick:a[6]||(a[6]=d=>k("Atualizar esse Produto?"))})])],32),g(J,{isVisible:C.value,motivo:V.value,onConfirm:j,onCancel:S},null,8,["isVisible","motivo"])]))])):_("",!0)]),_:1}))}},Ze=N(Xe,[["__scopeId","data-v-c3350683"]]),Ge={class:"elemento-fixo"},He={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Je={class:"relative w-full h-full"},Ke={class:"flex items-center"},We={class:"w-1/1 flex justify-center"},Ye=["src"],et={class:"w-2/3 pl-5"},tt={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},ot={class:"owner"},st={class:"w-1/1"},at={key:1,class:"mt-4"},rt={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},setup(u){const c=X(),p=u,b=n(!1),x=n(""),v=n(!1),o=n(!1),i=n(!1),h=()=>{n.dadosProduto.fetchProduto()},w=y=>y?new URL(y,window.location.origin).href:"/storage/images/no_imagem.svg",I=async()=>{var y,k,j,S;try{i.value=!0;const P=await q.delete(`/api/produtos/excluir/${p.produto.id}`);console.log(P.data.message),c.success("Produto deletado com sucesso!"),H.Inertia.visit(route("franqueadora.insumos"))}catch(P){c.error("Erro ao deletar o produto:",((k=(y=P.response)==null?void 0:y.data)==null?void 0:k.error)||P.message),console.error("Erro ao deletar o produto:",((S=(j=P.response)==null?void 0:j.data)==null?void 0:S.error)||P.message)}finally{i.value=!1}},D=()=>{o.value=!o.value,v.value=!1},$=y=>{x.value=y,b.value=!0},C=()=>{I(),b.value=!1},V=()=>{b.value=!1},M=()=>{o.value=!1,v.value=!0};return(y,k)=>(s(),l("div",Ge,[o.value?_("",!0):(s(),l("div",He,[e("div",Je,[e("div",Ke,[e("div",We,[e("img",{src:w(u.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Ye)]),e("div",et,[e("div",tt,[Y(E(u.produto.nome||"N/A")+" ",1),e("div",ot,E(u.produto.categoria)+" / "+E(u.produto.unidadeDeMedida),1)])]),e("div",st,[g(J,{isVisible:b.value,motivo:x.value,onConfirm:C,onCancel:V},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-4 right-4 cursor-pointer",onClick:k[0]||(k[0]=j=>$("Excluir esse produto?"))},k[1]||(k[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))])])])])),u.produto.id&&!o.value?(s(),l("div",at,[g(ue,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:D,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):_("",!0),o.value?(s(),R(Ze,{key:2,ref:"dadosProduto",isVisible:o.value,produto:u.produto,onDadosProduto:h,onCancelar:M},null,8,["isVisible","produto"])):_("",!0)]))}},lt=N(rt,[["__scopeId","data-v-76107c05"]]),nt={key:0,class:"sidebar-container"},it={key:0,class:"loading-overlay"},dt={key:1,class:"w-full h-[80%] bg-white rounded-[20px] p-12"},ut={class:"flex justify-center mb-6 relative group"},ct=["src"],pt={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},mt={key:0,class:"error-message"},vt={class:"flex items-center space-x-4 mt-2"},ft={class:"flex items-center space-x-2 cursor-pointer"},gt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},ht={key:0,class:"w-3 h-3 rounded-full bg-green-500"},_t={class:"flex items-center space-x-2 cursor-pointer"},xt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},yt={key:0,class:"w-3 h-3 rounded-full bg-green-500"},bt={class:"flex items-center space-x-4 mt-2"},wt={class:"flex items-center space-x-2 cursor-pointer"},$t={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},kt={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Ct={class:"flex items-center space-x-2 cursor-pointer"},Pt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Ut={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Vt={class:"mt-12"},It={class:"min-w-full table-auto"},Dt={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-left"},Ft={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},jt=["onUpdate:modelValue","onInput"],Et={class:"flex justify-start space-x-1 mt-[15%]"},Mt={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(u,{emit:c}){const p=X(),b=c,x=n(""),v=n(""),o=n(""),i=n(""),h=n(null),w=n(""),I=n(null),D=n(!1),$=n({}),C=n([]),V=n(!1),M=n("");ne(async()=>{try{const f=await q.get("/api/fornecedores");C.value=f.data.data}catch{p.error("Erro ao carregar fornecedores.")}C.value.forEach(f=>{$.value[f.id]&&y(f.id)})});const y=f=>{let t=$.value[f]||"";t=t.toString().replace(/\D/g,""),t=(parseInt(t,10)/100).toFixed(2);const r=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t);$.value[f]=`R$ ${r}`},k=()=>{var f;(f=I.value)==null||f.click()},j=f=>{M.value=f,V.value=!0},S=()=>{d(),V.value=!1},P=()=>{V.value=!1},z=()=>{v.value="",p.info("Imagem removida.")},T=f=>{const t=f.target.files[0];if(t){h.value=t;const r=new FileReader;r.onload=()=>{v.value=r.result,p.success("Imagem carregada com sucesso!")},r.readAsDataURL(t)}},O=()=>{m(),b("cancelar")},m=()=>{x.value="",o.value="",i.value="",v.value="",h.value=null,w.value=""},a=()=>!x.value||!h.value||!i||!o?(p.error("Por favor, preencha todos os campos obrigatórios."),w.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,d=async()=>{var f,t;if(a())try{D.value=!0;const r=new FormData;r.append("nome",x.value),r.append("categoria",o.value),r.append("unidadeDeMedida",i.value),r.append("profile_photo",h.value),Object.entries($.value).forEach(([se,ae])=>{r.append(`precos[${se}]`,ae)});const Q=await q.post("/api/produtos/cadastrar",r,{headers:{"Content-Type":"multipart/form-data"}});p.success("Produto cadastrado com sucesso!"),H.Inertia.visit(route("franqueadora.insumos")),m()}catch(r){p.error("Erro ao cadastrar o produto."),w.value=((t=(f=r.response)==null?void 0:f.data)==null?void 0:t.message)||"Erro inesperado."}finally{D.value=!1}};return(f,t)=>(s(),R(ee,{name:"fade"},{default:Z(()=>[u.isVisible?(s(),l("div",nt,[D.value?(s(),l("div",it,t[7]||(t[7]=[e("div",{class:"spinner"},null,-1)]))):(s(),l("div",dt,[e("form",{onSubmit:B(d,["prevent"])},[e("div",ut,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:k},[v.value?(s(),l(A,{key:0},[e("img",{src:v.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,ct),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:t[0]||(t[0]=B(()=>{},["stop"]))},[e("button",{onClick:B(z,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(s(),l("img",pt))]),e("input",{type:"file",ref_key:"fileInput",ref:I,accept:"image/*",class:"hidden",onChange:T},null,544)]),g(L,{text:"Nome"}),g(te,{modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=r=>x.value=r),placeholder:"Shoyu Premium Sakaki"},null,8,["modelValue"]),w.value?(s(),l("div",mt,E(w.value),1)):_("",!0),g(L,{class:"font-semibold text-gray-800 mt-8",text:"Prioridade"}),e("div",vt,[e("label",ft,[U(e("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=r=>o.value=r),value:"principal",class:"hidden"},null,512),[[F,o.value]]),e("div",gt,[o.value==="principal"?(s(),l("div",ht)):_("",!0)]),t[8]||(t[8]=e("span",null,"Principal",-1))]),e("label",_t,[U(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=r=>o.value=r),value:"secundario",class:"hidden"},null,512),[[F,o.value]]),e("div",xt,[o.value==="secundario"?(s(),l("div",yt)):_("",!0)]),t[9]||(t[9]=e("span",null,"Secundário",-1))])]),g(L,{class:"font-semibold text-gray-800 mt-8",text:"Unidade de medida"}),e("div",bt,[e("label",wt,[U(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=r=>i.value=r),value:"a_granel",class:"hidden"},null,512),[[F,i.value]]),e("div",$t,[i.value==="a_granel"?(s(),l("div",kt)):_("",!0)]),t[10]||(t[10]=e("span",null,"A granel",-1))]),e("label",Ct,[U(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=r=>i.value=r),value:"unitario",class:"hidden"},null,512),[[F,i.value]]),e("div",Pt,[i.value==="unitario"?(s(),l("div",Ut)):_("",!0)]),t[11]||(t[11]=e("span",null,"Unitário",-1))])]),e("div",Vt,[e("table",It,[t[12]||(t[12]=e("thead",null,[e("tr",{class:"bg-[#d2fac3]"},[e("th",{class:"px-6 py-2 text-left text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider rounded-tl-2xl"}," Fornecedores "),e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider rounded-tr-2xl"}," Valor ")])],-1)),e("tbody",null,[(s(!0),l(A,null,W(C.value,r=>(s(),l("tr",{key:r.id},[e("td",Dt,E(r.razao_social),1),e("td",Ft,[U(e("input",{"onUpdate:modelValue":Q=>$.value[r.id]=Q,type:"text",placeholder:"R$ 0,00",onInput:Q=>y(r.id),class:"border rounded-lg px-2 py-1 w-[110px] h-[38px] text-center"},null,40,jt),[[K,$.value[r.id]]])])]))),128))])])]),e("div",Et,[g(oe,{text:"Cancelar",onClick:O}),g(G,{text:"Cadastrar",onClick:t[6]||(t[6]=r=>j("Criar novo Produto?"))})])],32)])),g(J,{isVisible:V.value,motivo:M.value,onConfirm:S,onCancel:P},null,8,["isVisible","motivo"])])):_("",!0)]),_:1}))}},St=N(Mt,[["__scopeId","data-v-cad912ad"]]),Bt={class:"flex flex-col gap-4"},Lt={class:"absolute bottom-4 right-4"},qt={key:1,class:"mt-4"},Xt={__name:"Index",setup(u){const c=n(null),p=n(!1),b=()=>{p.value=!p.value},x=()=>{v(),p.value=!1},v=()=>{var h;(h=n("listarUnidades").value)==null||h.fetchUnidades()},o=i=>{i&&typeof i=="object"?c.value=i:console.warn("Dados inválidos recebidos no evento produto-selecionado:",i)};return(i,h)=>(s(),R(re,null,{default:Z(()=>[g(ie(de),{title:"Insumos"}),e("div",{class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 overflow-hidden card-container h-full overflow-y-scroll",onScrollPassive:h[0]||(h[0]=()=>{})},[e("div",null,[g($e,{ref:"listarUnidades",onUnidadeCadastrada:v,onProdutoSelecionado:o},null,512)]),e("div",Bt,[p.value?(s(),l("div",qt,[g(St,{isVisible:p.value,onUnidadeCadastrada:x,onCancelar:b},null,8,["isVisible"])])):(s(),l(A,{key:0},[c.value?(s(),R(lt,{key:0,produto:c.value},null,8,["produto"])):_("",!0),e("div",Lt,[g(G,{text:"Cadastrar insumo",iconPath:"/storage/images/arrow_left_alt.svg",onClick:b})])],64))])],32)]),_:1}))}};export{Xt as default};
