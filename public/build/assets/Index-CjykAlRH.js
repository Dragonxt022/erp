import{s as P,d as l,x as J,o as c,e as m,a as e,b as o,t as x,h as $,i as T,y as M,c as S,F as I,w as R,z as O,m as G,j as H,v as Q,g as Z,u as K,Z as X}from"./app-B5EUV3OQ.js";import{_ as y,I as E,B as W,a as U,C as q,d as Y}from"./index-Ccd-9-jf.js";import{B as ee}from"./ButtonEditeMedio-ByBqaRNE.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as oe}from"./AppLayout-C-onHEWd.js";const se={key:0,class:"sidebar-container"},te={key:0,class:"loading-overlay"},ae={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},re={class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},le={key:0,class:"error-message"},ne={key:1,class:"error-message"},ie={key:2,class:"error-message"},de={key:3,class:"error-message"},ce={class:"flex justify-start space-x-1 mt-[50px]"},ue={__name:"EditarFornecedor",props:{isVisible:{type:Boolean,required:!0},fornecedor:{type:Object,required:!0}},emits:["cancelar"],setup(V,{emit:w}){const u=P(),h=V,v=w,n=l(""),g=l(""),i=l(""),s=l(""),t=l(""),p=l(!1),C=l(!1),j=l("");J(()=>h.fornecedor,f=>{f&&(n.value=f.razao_social||"",g.value=f.email||"",i.value=f.whatsapp||"",s.value=f.estado||"")},{immediate:!0});const D=async()=>{var f,d;if(!n.value||!g.value||!i.value||!s.value){u.error("Preencha todos os campos obrigatórios.");return}try{p.value=!0;const a=new FormData;a.append("id",h.fornecedor.id),a.append("cnpj",h.fornecedor.cnpj),a.append("razao_social",n.value),a.append("email",g.value),a.append("whatsapp",i.value),a.append("estado",s.value);const A=await M.post("/api/atualizar-fornecedores/",a,{headers:{"Content-Type":"multipart/form-data"}});Y.Inertia.replace(route("fornecedores"),{fornecedor:A.data.fornecedor,preserveState:!0}),u.success("Fornecedor atualizado com sucesso!")}catch(a){u.error("Erro ao atualizar o fornecedor."),t.value=((d=(f=a.response)==null?void 0:f.data)==null?void 0:d.message)||"Erro inesperado."}finally{p.value=!1}},z=f=>{j.value=f,C.value=!0},N=()=>{D(),C.value=!1},k=()=>{C.value=!1},b=()=>{v("cancelar")};return(f,d)=>V.isVisible?(c(),m("div",se,[p.value?(c(),m("div",te,d[5]||(d[5]=[e("div",{class:"spinner"},null,-1)]))):(c(),m("div",ae,[e("form",{onSubmit:T(D,["prevent"])},[o(y,{text:"CNPJ"}),e("div",re,x(V.fornecedor.cnpj||"N/A"),1),o(y,{text:"Razão Social"}),o(E,{modelValue:n.value,"onUpdate:modelValue":d[0]||(d[0]=a=>n.value=a),placeholder:""},null,8,["modelValue"]),t.value?(c(),m("div",le,x(t.value),1)):$("",!0),o(y,{text:"E-mail"}),o(E,{modelValue:g.value,"onUpdate:modelValue":d[1]||(d[1]=a=>g.value=a),placeholder:""},null,8,["modelValue"]),t.value?(c(),m("div",ne,x(t.value),1)):$("",!0),o(y,{text:"WhatsApp"}),o(E,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=a=>i.value=a),placeholder:""},null,8,["modelValue"]),t.value?(c(),m("div",ie,x(t.value),1)):$("",!0),o(y,{text:"Estado"}),o(E,{modelValue:s.value,"onUpdate:modelValue":d[3]||(d[3]=a=>s.value=a),placeholder:""},null,8,["modelValue"]),t.value?(c(),m("div",de,x(t.value),1)):$("",!0),e("div",ce,[o(W,{text:"Cancelar",onClick:b}),o(U,{text:"Atualizar",onClick:d[4]||(d[4]=a=>z("Atualizar esse Fornecedor?"))})])],32),o(q,{isVisible:C.value,motivo:j.value,onConfirm:N,onCancel:k},null,8,["isVisible","motivo"])]))])):$("",!0)}},ve=B(ue,[["__scopeId","data-v-5aea0ef2"]]),pe={key:0,class:"w-full h-[530px] bg-white rounded-[20px] p-7 relative"},fe={class:"relative w-full h-full"},me={class:"flex items-center"},ge={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[50px] tracking-tight"},_e={class:"w-1/1"},xe={class:"relative w-full h-full"},he={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},be={class:"w-[150px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},ye={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},we={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Ce={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Fe={class:"mt-[130px]"},Ve={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},ke={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},$e={class:"mt-4"},Ee={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},je={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},De={class:"mt-4"},ze={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Ne={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Ae={class:"mt-4"},Le={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Me={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Se={key:0,class:"mt-7"},Be={__name:"DetalhesFornecedor",props:{fornecedor:{type:Object,required:!0}},setup(V){const w=P(),u=l(!1),h=l(""),v=l(!1),n=l(!1),g=l(!1),i=V,s=l({...i.fornecedor}),t=async()=>{var k,b,f,d;try{g.value=!0;const a=await axios.delete(`/api/excluir-fornecedor/${i.fornecedor.id}`);console.log(a.data.message),w.success("fornecedor deletado com sucesso!"),Inertia.visit("/insumos")}catch(a){w.error("Erro ao deletar o fornecedor:",((b=(k=a.response)==null?void 0:k.data)==null?void 0:b.error)||a.message),console.error("Erro ao deletar o fornecedor:",((d=(f=a.response)==null?void 0:f.data)==null?void 0:d.error)||a.message)}finally{g.value=!1}},p=()=>{l.dadosfornecedor.fetchfornecedor()},C=()=>{n.value=!n.value,console.log("isEditMode:",n.value),v.value=!1},j=k=>{h.value=k,u.value=!0},D=()=>{t(),u.value=!1},z=()=>{u.value=!1},N=()=>{n.value=!1,v.value=!0};return(k,b)=>{var f,d,a;return c(),m(I,null,[n.value?$("",!0):(c(),m("div",pe,[e("div",fe,[e("div",me,[e("div",ge,x(((f=s.value)==null?void 0:f.estado)||s.value.estado||"N/A"),1),e("div",_e,[o(q,{isVisible:u.value,motivo:h.value,onConfirm:D,onCancel:z},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-3 right-4 cursor-pointer",onClick:b[0]||(b[0]=A=>j("Excluir esse Fornecedor?"))},b[1]||(b[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))]),e("div",xe,[e("div",he,[e("div",be,[b[2]||(b[2]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",ye," ID# "+x((((d=s.value)==null?void 0:d.id)??0).toString().padStart(4,"0")),1)]),e("div",we,[b[3]||(b[3]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",Ce,x(((a=s.value)==null?void 0:a.cnpj)||"N/A"),1)])])])]),e("div",Fe,[o(y,{text:"Razão Social"}),e("div",Ve,[e("div",ke,x(s.value.razao_social||"N/A"),1)])]),e("div",$e,[o(y,{text:"E-mail"}),e("div",Ee,[e("div",je,x(s.value.email||"N/A"),1)])]),e("div",De,[o(y,{text:"WhatsApp"}),e("div",ze,[e("div",Ne,x(s.value.whatsapp||"N/A"),1)])]),e("div",Ae,[o(y,{text:"Estado"}),e("div",Le,[e("div",Me,x(s.value.estado||"N/A"),1)])])]),V.fornecedor.id&&!n.value?(c(),m("div",Se,[o(ee,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:C,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):$("",!0)])),n.value?(c(),S(ve,{key:1,ref:"dadosfornecedor",isVisible:n.value,fornecedor:V.fornecedor,onDadosfornecedor:p,onCancelar:N},null,8,["isVisible","fornecedor"])):$("",!0)],64)}}},Pe=B(Be,[["__scopeId","data-v-fa8a39fb"]]),Ie={key:0,class:"sidebar-container"},Ue={key:0,class:"loading-overlay"},qe={key:1,class:"w-full h-[525px] bg-white rounded-[20px] p-12"},Je={key:0,class:"error-message"},Te={class:"form-buttons"},Re={__name:"CadastroFornecedor",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(V,{emit:w}){const u=P(),h=w,v=l(""),n=l(""),g=l(""),i=l(""),s=l(""),t=l(""),p=l(!1),C=l(!1),j=l("");J(v,async F=>{F.replace(/\D/g,"").length===14&&await f()});const D=()=>{z(),h("cancelar")},z=()=>{v.value="",n.value="",g.value="",i.value="",s.value="",t.value=""},N=()=>v.value?!0:(u.error("Por favor, preencha todos os campos obrigatórios."),t.value="Por favor, preencha todos os campos obrigatórios.",!1),k=async()=>{var F,r;if(N())try{p.value=!0;const _=await M.post("/api/fornecedores",{razao_social:n.value,cnpj:v.value,email:g.value,whatsapp:i.value,estado:s.value});console.log("Fornecedor cadastrado com sucesso:",_.data),u.success("Fornecedor cadastrado com sucesso!"),z(),h("cancelar")}catch(_){u.error("Erro ao realizar o cadastro."),t.value=((r=(F=_.response)==null?void 0:F.data)==null?void 0:r.message)||"Erro ao realizar o cadastro."}finally{p.value=!1}},b=F=>{let r=F.target.value.replace(/\D/g,"");r.length>14&&(r=r.slice(0,14)),r=r.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"),v.value=r},f=async()=>{var F,r;if(!v.value||v.value.length<14){u.error("Por favor, insira um CNPJ válido.");return}try{p.value=!0;const _=v.value.replace(/\D/g,""),L=(await M.get(`https://publica.cnpj.ws/cnpj/${_}`)).data;n.value=L.razao_social||"",s.value=L.estabelecimento.estado.nome||"",i.value=L.estabelecimento.telefone1||"",g.value=L.estabelecimento.email||""}catch(_){t.value=((r=(F=_.response)==null?void 0:F.data)==null?void 0:r.message)||"Erro ao consultar o CNPJ."}finally{p.value=!1}},d=F=>{j.value=F,C.value=!0},a=()=>{k(),C.value=!1},A=()=>{C.value=!1};return(F,r)=>(c(),S(O,{name:"fade"},{default:R(()=>[V.isVisible?(c(),m("div",Ie,[p.value?(c(),m("div",Ue,r[6]||(r[6]=[e("div",{class:"spinner"},null,-1)]))):(c(),m("div",qe,[r[7]||(r[7]=e("div",{class:"painel-title"},[e("p",null,"Novo fornecedor")],-1)),e("form",{onSubmit:T(k,["prevent"])},[o(y,{text:"CNPJ"}),o(E,{modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=_=>v.value=_),onInput:b,placeholder:"000.000.000/0000-00"},null,8,["modelValue"]),o(y,{text:"Razão Social"}),o(E,{modelValue:n.value,"onUpdate:modelValue":r[1]||(r[1]=_=>n.value=_),placeholder:"Silva Moura Pescados"},null,8,["modelValue"]),o(y,{text:"E-mail"}),o(E,{modelValue:g.value,"onUpdate:modelValue":r[2]||(r[2]=_=>g.value=_),placeholder:"contato@nobrezasdomar.com.br"},null,8,["modelValue"]),o(y,{text:"WhatsApp"}),o(E,{modelValue:i.value,"onUpdate:modelValue":r[3]||(r[3]=_=>i.value=_),placeholder:"(00) 00000-0000"},null,8,["modelValue"]),o(y,{text:"Estado"}),o(E,{modelValue:s.value,"onUpdate:modelValue":r[4]||(r[4]=_=>s.value=_),placeholder:"Mato Grosso"},null,8,["modelValue"]),t.value?(c(),m("div",Je,x(t.value),1)):$("",!0),o(q,{isVisible:C.value,motivo:j.value,onConfirm:a,onCancel:A},null,8,["isVisible","motivo"]),e("div",Te,[o(W,{text:"Cancelar",onClick:D}),o(U,{text:"Cadastrar",onClick:r[5]||(r[5]=_=>d("Criar novo Fornecedor?"))})])],32)]))])):$("",!0)]),_:1}))}},We=B(Re,[["__scopeId","data-v-22cedd6a"]]),Oe={class:"search-container relative flex items-center w-full mb-4"},Ge={class:"card-container"},He=["onClick"],Qe={class:"card-inner"},Ze={class:"text-container"},Ke={class:"city"},Xe={class:"owner"},Ye={__name:"ListarFornecedores",emits:["fornecedor-selecionado"],setup(V,{emit:w}){const u=w,h=l([]),v=l(""),n=async()=>{try{const s=await M.get("/api/fornecedores");h.value=s.data.data}catch(s){console.error("Erro ao carregar fornecedores:",s)}},g=s=>{u("fornecedor-selecionado",s)},i=G(()=>{const s=v.value.toLowerCase();return h.value.filter(t=>t.razao_social.toLowerCase().includes(s)||t.cnpj.toLowerCase().includes(s))});return n(),(s,t)=>(c(),m("div",null,[t[4]||(t[4]=e("div",{class:"painel-title"},"Fornecedores",-1)),t[5]||(t[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Fornecedores de insumos homologados")],-1)),e("div",Oe,[t[1]||(t[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),H(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=p=>v.value=p),placeholder:"Buscar um fornecedor",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[Q,v.value]])]),e("div",Ge,[(c(!0),m(I,null,Z(i.value,p=>(c(),m("div",{key:p.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:C=>g(p)},[e("div",Qe,[t[2]||(t[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/servicos_verde.svg",alt:"Ícone do fornecedor",class:"w-5 h-5 rounded-lg"})])],-1)),e("div",Ze,[e("div",Ke,x(p.razao_social),1),e("div",Xe,x(p.cnpj)+" / "+x(p.estado),1)]),t[3]||(t[3]=e("div",{class:"action-icon"},null,-1))])],8,He))),128))])]))}},eo=B(Ye,[["__scopeId","data-v-234b50cf"]]),oo={class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2"},so={class:"flex flex-col gap-4"},to={class:"absolute bottom-4 right-4"},ao={key:1,class:"mt-4"},vo={__name:"Index",setup(V){const w=l(null),u=l(!1),h=()=>{u.value=!u.value},v=()=>{n(),u.value=!1},n=()=>{var s;(s=l("listarFornecedores").value)==null||s.fetchFornecedores()},g=i=>{i&&typeof i=="object"?w.value=i:console.warn("Dados inválidos recebidos no evento fornecedor-selecionado:",i)};return(i,s)=>(c(),S(oe,null,{default:R(()=>[o(K(X),{title:"Fornecedores"}),e("div",oo,[e("div",null,[o(eo,{ref:"listarFornecedores",onFornecedorCadastrado:n,onFornecedorSelecionado:g},null,512)]),e("div",so,[u.value?(c(),m("div",ao,[o(We,{isVisible:u.value,onFornecedorCadastrado:v,onCancelar:h},null,8,["isVisible"])])):(c(),m(I,{key:0},[w.value?(c(),S(Pe,{key:0,fornecedor:w.value},null,8,["fornecedor"])):$("",!0),e("div",to,[o(U,{text:"Novo Fornecedor",iconPath:"/storage/images/arrow_left_alt.svg",onClick:h})])],64))])])]),_:1}))}};export{vo as default};
