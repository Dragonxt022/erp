import{ae as T,d as k,j as _,i as O,a3 as U,e as o,o as a,a as s,c as F,f as y,a0 as R,F as A,h as z,n as P,t as b,w as N,u as x,$ as B,k as M,af as Z,q as H,a2 as j,ag as G,p as J,b as q,a4 as W,ah as K,a6 as Q,Z as X,r as Y,ad as ee}from"./app-CW7pGYxa.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D=T("sidebar",{state:()=>({isOpen:!1}),actions:{toggle(){this.isOpen=!this.isOpen},open(){this.isOpen=!0},close(){this.isOpen=!1}}}),se={class:"navbar"},te={class:"navbar-content"},ae={class:"navbar-left"},oe={class:"navbar-logo"},ne=["href"],ie={class:"navbar-right"},le={class:"notification-container mr-4"},re={key:0,class:"notification-badge"},ce={key:0,class:"notification-tray"},ue={class:"notification-header"},de={class:"notification-list"},ve={key:0,class:"notification-loading"},me={key:1,class:"no-notifications"},fe=["onClick"],he={class:"notification-icon-type"},ge={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},pe={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_e={key:2,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ke={class:"notification-content"},we={class:"notification-title"},be={class:"notification-message"},ye={class:"notification-time"},Se={key:0,class:"user-info"},Ce=["src"],xe={class:"user-details"},Ie={class:"user-name"},Pe={class:"user-location"},Ee={key:1,class:"user-info loading"},$e={__name:"Navbar",setup(f){const n=D(),m=()=>{n.toggle()},i=k(null),I=_(()=>{var e;return(e=i.value)==null?void 0:e.unidade}),d=k([]),S=k(!1),g=k(!1),w=_(()=>d.value.filter(e=>e.lida===0).length),E=_(()=>{var e,t;return((e=i.value)==null?void 0:e.profile_photo_url)||`https://ui-avatars.com/api/?name=${$((t=i.value)==null?void 0:t.name)}&color=7F9CF5&background=EBF4FF`}),$=e=>e?e.split(" ").map(l=>l.charAt(0).toUpperCase()).join(""):"*",c=async()=>{try{const e=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok)throw new Error("Erro ao carregar perfil do usuário");const t=await e.json();i.value=t.data}catch(e){console.error("Erro ao buscar perfil:",e),i.value=null}},r=async()=>{S.value=!0;try{const e=await fetch("/api/notificacoes",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok)throw new Error("Erro ao carregar notificações");const t=await e.json();d.value=t.data}catch(e){console.error("Erro ao buscar notificações:",e),d.value=[]}finally{S.value=!1}},v=async e=>{try{if((await M.post(`/api/notificacoes/${e}/ler`)).status===200){const l=d.value.findIndex(L=>L.id===e);l!==-1&&(d.value[l].lida=1,d.value[l].lida_em=new Date().toISOString())}}catch(t){console.error("Erro ao marcar notificação como lida:",t)}},u=async()=>{try{(await M.post("/api/notificacoes/ler-todas")).status===200&&d.value.forEach(t=>{t.lida=1,t.lida_em=new Date().toISOString()})}catch(e){console.error("Erro ao marcar todas notificações como lidas:",e)}},h=e=>{e.stopPropagation(),g.value=!g.value,g.value&&r()},p=e=>{const t=document.querySelector(".notification-container");t&&!t.contains(e.target)&&(g.value=!1)};let C;return O(()=>{c(),r(),document.addEventListener("click",p),C=setInterval(()=>{g.value||r()},3e5)}),U(()=>{document.removeEventListener("click",p),clearInterval(C)}),(e,t)=>(a(),o("div",se,[t[10]||(t[10]=s("div",{class:"navbar-background"},null,-1)),s("div",te,[s("div",ae,[s("div",oe,[s("div",{class:"mr-4 mt-2 hide-mobile"},[s("button",{onClick:m},t[0]||(t[0]=[s("img",{src:"/storage/images/quadrados_verdes.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),s("div",null,[s("a",{href:e.route("franqueado.painel")},t[1]||(t[1]=[s("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,ne)])])]),s("div",ie,[s("div",le,[s("div",{class:"notification-icon",onClick:h},[t[2]||(t[2]=R('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-5138a807><mask id="mask0_4631_13059" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24" data-v-5138a807><rect width="24" height="24" fill="#D9D9D9" data-v-5138a807></rect></mask><g mask="url(#mask0_4631_13059)" data-v-5138a807><path d="M2.40039 20.4V18H4.80039V9.6C4.80039 7.94 5.30039 6.465 6.30039 5.175C7.30039 3.885 8.60039 3.04 10.2004 2.64V1.8C10.2004 1.3 10.3754 0.875 10.7254 0.525C11.0754 0.175 11.5004 0 12.0004 0C12.5004 0 12.9254 0.175 13.2754 0.525C13.6254 0.875 13.8004 1.3 13.8004 1.8V2.64C15.4004 3.04 16.7004 3.885 17.7004 5.175C18.7004 6.465 19.2004 7.94 19.2004 9.6V18H21.6004V20.4H2.40039ZM12.0004 24C11.3404 24 10.7754 23.765 10.3054 23.295C9.83539 22.825 9.60039 22.26 9.60039 21.6H14.4004C14.4004 22.26 14.1654 22.825 13.6954 23.295C13.2254 23.765 12.6604 24 12.0004 24ZM7.20039 18H16.8004V9.6C16.8004 8.28 16.3304 7.15 15.3904 6.21C14.4504 5.27 13.3204 4.8 12.0004 4.8C10.6804 4.8 9.55039 5.27 8.61039 6.21C7.67039 7.15 7.20039 8.28 7.20039 9.6V18Z" fill="#6DB631" data-v-5138a807></path></g></svg>',1)),w.value>0?(a(),o("div",re)):y("",!0)]),g.value?(a(),o("div",ce,[s("div",ue,[t[3]||(t[3]=s("h3",null,"Notificações",-1)),d.value.length>0?(a(),o("span",{key:0,onClick:u,class:"mark-all-read"},"Marcar todas como lidas")):y("",!0)]),s("div",de,[S.value?(a(),o("div",ve,t[4]||(t[4]=[s("div",{class:"notification-skeleton"},null,-1),s("div",{class:"notification-skeleton"},null,-1)]))):d.value.length===0?(a(),o("div",me," Nenhuma notificação no momento ")):(a(!0),o(A,{key:2},z(d.value,l=>(a(),o("div",{key:l.id,class:P(["notification-item",{unread:l.lida===0}]),onClick:L=>v(l.id)},[s("div",he,[l.tipo==="info"?(a(),o("svg",ge,t[5]||(t[5]=[s("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 100-16 8 8 0 000 16zM11 7h2v2h-2V7zm0 4h2v6h-2v-6z",fill:"#6DB631"},null,-1)]))):l.tipo==="alerta"?(a(),o("svg",pe,t[6]||(t[6]=[s("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-1-7v2h2v-2h-2zm0-8v6h2V7h-2z",fill:"#FF9800"},null,-1)]))):(a(),o("svg",_e,t[7]||(t[7]=[s("path",{d:"M4 19h16v2H4v-2zm5-4h11v2H9v-2zm-5-4h16v2H4v-2zm5-4h11v2H9V7zM4 3h16v2H4V3z",fill:"#6DB631"},null,-1)])))]),s("div",ke,[s("div",we,b(l.titulo),1),s("div",be,b(l.mensagem),1),s("div",ye,b(l.tempo),1)])],10,fe))),128))])])):y("",!0)]),s("div",{class:"view-mobile"},[s("button",{onClick:m},t[8]||(t[8]=[s("img",{src:"/storage/images/bx-menuv.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),i.value?(a(),F(x(B),{key:0,href:e.route("franqueado.perfil"),class:P(["user-info hide-mobile",{loading:!i.value}])},{default:N(()=>{var l;return[i.value?(a(),o("div",Se,[s("img",{src:E.value,alt:"Avatar",class:"avatar"},null,8,Ce),s("div",xe,[s("div",Ie,b(i.value.name),1),s("div",Pe,b(((l=I.value)==null?void 0:l.cidade)||"Taiksu Franchising"),1)])])):(a(),o("div",Ee,t[9]||(t[9]=[s("div",{class:"avatar-skeleton"},null,-1),s("div",{class:"user-details-skeleton"},[s("div",{class:"name-skeleton"}),s("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["href","class"])):y("",!0)])])]))}},Le=V($e,[["__scopeId","data-v-5138a807"]]),qe={class:"icon"},Ae=["src"],ze={class:"label"},Me={type:"submit",class:"w-full h-full flex items-center"},Ve={class:"icon"},Ne=["src"],Be={class:"label"},Oe={key:2,class:"submenu"},Fe={class:"label"},De={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(f){const n=f,m=Z("userPermissions",k({})),i=k(!1),I=_(()=>i.value),d=_(()=>n.link&&/^https?:\/\//.test(n.link)),S=_(()=>d.value?n.link:n.link?route(n.link):"#"),g=_(()=>!n.requiredPermission||m.value[n.requiredPermission]),w=_(()=>n.submenuItems.filter(e=>!e.requiredPermission||m.value[e.requiredPermission])),E=e=>{w.value.length>0&&(e.preventDefault(),$())},$=()=>{i.value=!i.value,r()},c=()=>{const e=localStorage.getItem(`submenu-${n.link}`);e!==null&&(i.value=JSON.parse(e))},r=()=>{localStorage.setItem(`submenu-${n.link}`,JSON.stringify(i.value))},v=_(()=>h.value||n.isActive?"submenu-active":""),u=e=>{const t=window.location.pathname,l=new URL(route(e),window.location.origin).pathname;return t===l},h=_(()=>w.value.some(e=>u(e.link))),p=()=>{n.isLogout&&W.post(route("logout"))};return c(),H(h,()=>{h.value||j(()=>{i.value=!1,r()})}),H(i,()=>{j(()=>r())}),(e,t)=>(a(),o("div",null,[!f.isLogout&&f.link&&g.value?(a(),F(G(d.value?"a":x(B)),{key:0,class:P(["menu-item",[v.value,{active:f.isActive||h.value}]]),href:S.value,target:d.value?"_blank":null,onClick:E},{default:N(()=>[s("div",qe,[s("img",{src:f.icon,alt:"icon"},null,8,Ae)]),s("div",ze,b(f.label),1),w.value.length>0?(a(),o("div",{key:0,class:P(["right-icon",{"rotate-icon":I.value}])},t[0]||(t[0]=[s("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):y("",!0)]),_:1},8,["class","href","target"])):f.isLogout&&g.value?(a(),o("form",{key:1,onSubmit:J(p,["prevent"]),class:"menu-item"},[s("button",Me,[s("div",Ve,[s("img",{src:f.icon,alt:"icon"},null,8,Ne)]),s("div",Be,b(f.label),1)])],32)):y("",!0),w.value.length>0&&(i.value||h.value)?(a(),o("div",Oe,[(a(!0),o(A,null,z(w.value,(l,L)=>(a(),o("div",{key:L},[q(x(B),{class:P(["submenu-item",{active:u(l.link)}]),href:e.route(l.link)},{default:N(()=>[s("div",Fe,b(l.label),1)]),_:2},1032,["href","class"])]))),128))])):y("",!0)]))}},He=V(De,[["__scopeId","data-v-bed64f61"]]),je={key:0,class:"loader-container"},Te={key:0,class:"category-title menu-categorias text-sm sm:text-base font-medium text-[#87ba73] mb-3 pl-4"},Ue={__name:"Slidebar",setup(f){const n=k(null),m=k({}),i=k([]),I=D(),d=k(!0),S=async()=>{try{const c=await M.get("/api/navbar-profile");m.value=c.data.data.permissions||{}}catch(c){console.error("Erro ao carregar permissões:",c),m.value={}}},g=async()=>{try{const v=((await M.get("/api/menu")).data.data||[]).map(u=>{const h=(u.items||[]).slice().sort((p,C)=>p.order-C.order);return h.forEach(p=>{p.children&&Array.isArray(p.children)&&(p.children=p.children.slice().sort((C,e)=>C.order-e.order))}),{...u,items:h}}).sort((u,h)=>u.order-h.order);i.value=v}catch(c){console.error("Erro ao carregar menu:",c),i.value=[]}};K("userPermissions",m);const w=_(()=>i.value.map(c=>({...c,items:c.items.filter(r=>!r.required_permission||m.value[r.required_permission]||r.children&&r.children.some(v=>!v.required_permission||m.value[v.required_permission])).map(r=>({...r,submenuItems:r.children||[]}))})).filter(c=>c.items.length>0));O(async()=>{d.value=!0,await S(),await g();const c=localStorage.getItem("sidebarScrollPosition");c&&n.value&&(n.value.scrollTop=c),d.value=!1});const E=()=>{n.value&&localStorage.setItem("sidebarScrollPosition",n.value.scrollTop)},$=c=>{const r=window.location.pathname,v=new URL(c,window.location.origin).pathname;return r===v||r.startsWith(v)};return(c,r)=>(a(),o("div",null,[d.value?(a(),o("div",je,r[0]||(r[0]=[s("div",{class:"spinner"},null,-1)]))):(a(),o("div",{key:1,class:P(["sidebar fixed top-16 left-0 bg-[#164110] text-white flex flex-col p-3 overflow-y-auto h-full transition-transform duration-300 ease-in-out",x(I).isOpen?"translate-x-0":"-translate-x-full","md:translate-x-0 md:relative  md:top-0 md:left-0"]),ref_key:"sidebar",ref:n,onScroll:E},[(a(!0),o(A,null,z(w.value,v=>(a(),o("div",{key:v.name,class:"menu-category mb-6"},[v.items.length>0?(a(),o("div",Te,b(v.name),1)):y("",!0),(a(!0),o(A,null,z(v.items,u=>(a(),F(He,{key:u.link||"no-link",label:u.label,icon:u.icon,link:u.link,submenuItems:u.submenuItems,isActive:u.link?$(u.link):!1,isLogout:u.isLogout,requiredPermission:u.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],34))]))}},Re=V(Ue,[["__scopeId","data-v-822ae540"]]),Ze={__name:"LayoutFranqueado",props:{title:String},setup(f){const n=D();function m(){window.innerWidth<768?n.close():n.open()}return O(()=>{window.addEventListener("resize",m),m()}),Q(()=>{window.removeEventListener("resize",m)}),(i,I)=>(a(),o("div",null,[q(x(X),{title:f.title},null,8,["title"]),q(Le),q(Re),s("main",{class:"content",style:ee({left:x(n).isOpen?"252px":"0",width:x(n).isOpen?"calc(100vw - 250px)":"100vw"})},[Y(i.$slots,"default",{},void 0,!0)],4)]))}},We=V(Ze,[["__scopeId","data-v-4eb0945b"]]);export{We as L};
