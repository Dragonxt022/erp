import{l as O,d as u,i as J,o as t,e as r,a as e,j as I,s as te,F as M,g as j,t as x,b as $,h as y,v as R,w as A,f as E,p as Q,k as N,y as oe,q as X,c as F,m as ae,x as z,u as se,Z as re}from"./app-DVYf2vUx.js";import{_ as L,I as H,B as W,a as K,d as Z,C as ne}from"./ConfirmDialog-2dSDnoTH.js";import{B as le}from"./ButtonPrimary-CU-xTW8Q.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                         */import{L as ie}from"./LayoutFranqueado-D2ZxIaes.js";import"./user-B4CgWdji.js";const de={key:0,class:"w-[100%] h-full flex flex-col p-4 bg-gray-50"},ue={class:"mb-6 relative"},ce={class:"relative"},pe=["value"],ve={class:"w-full bg-white rounded-lg p-6 mb-6"},fe={class:"flex items-center"},me={class:"flex-shrink-0"},ge=["src"],_e={class:"ml-6"},xe={class:"text-2xl font-semibold text-gray-800"},ye={key:0,class:"text-red-500 text-sm text-center"},he={class:"relative flex items-center w-full"},be={class:"flex justify-end space-x-4"},$e={__name:"CadastrarInsumoEstoque",props:{produtoSelecionado:{type:Object,required:!1}},setup(n,{emit:l}){var B;const d=O(),h=l,_=n,c=u([]),i=u(""),p=u(""),g=u(((B=_.produtoSelecionado)==null?void 0:B.valor)||""),V=u(!1);u(!1);const P=u(!1),q=u(""),U=J(()=>_.produtoSelecionado.unidadeDeMedida==="a_granel"?"Kg":"Quantidade"),D=J(()=>_.produtoSelecionado.unidadeDeMedida==="a_granel"?"Digite o peso (ex: 1.5)":"Digite a quantidade"),a=()=>{const C=_.produtoSelecionado.unidadeDeMedida==="a_granel"?/^[0-9]+(\.[0-9]+)?$/:/^[0-9]+$/;V.value=!C.test(p.value)},o=()=>{const C=g.value.replace(/\D/g,""),w=C.slice(0,-2)||"0",f=C.slice(-2).padStart(2,"0");g.value=`R$ ${Number(w).toLocaleString("pt-BR")},${f}`},s=()=>{p.value="",g.value=""};(async()=>{try{const C=await N.get("/api/estoque/fornecedores");c.value=C.data.data.map(w=>({id:w.id||"N/D",razao_social:w.razao_social||"N/D"}))}catch(C){console.error("Erro ao carregar fornecedores:",C)}})();const k=C=>C?new URL(C,window.location.origin).href:"/storage/images/no_imagem.svg",G=()=>(q.value="",i.value?!p.value||V.value?(d.error("Quantidade inválida."),q.value="Quantidade inválida.",!1):!g.value||P.value?(d.error("Valor inválido."),q.value="Valor inválido.",!1):!0:(d.error("Fornecedor não selecionado."),q.value="Fornecedor não selecionado.",!1)),T=()=>{if(!G())return;const C={..._.produtoSelecionado,fornecedor_id:i.value,quantidade:p.value,valor:g.value,unidade_de_medida:_.produtoSelecionado.unidadeDeMedida};d.success("Inusmo adicionado"),s(),h("adicionarAoCarrinho",C)};return(C,w)=>n.produtoSelecionado?(t(),r("div",de,[w[5]||(w[5]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",ue,[e("div",ce,[I(e("select",{"onUpdate:modelValue":w[0]||(w[0]=f=>i.value=f),id:"fornecedor",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-green-600 focus:ring-2 focus:ring-green-500 font-['Figtree']"},[w[3]||(w[3]=e("option",{value:"",disabled:""},"Selecione um fornecedor",-1)),(t(!0),r(M,null,j(c.value,f=>(t(),r("option",{key:f.id,value:f.id},x(f.razao_social),9,pe))),128))],512),[[te,i.value]])])]),e("div",ve,[e("div",fe,[e("div",me,[e("img",{src:k(n.produtoSelecionado.profile_photo),alt:"Foto do Produto",class:"w-24 h-24 rounded-lg"},null,8,ge)]),e("div",_e,[e("div",xe,x(n.produtoSelecionado.nome||"N/A"),1)])])]),e("form",{onSubmit:Q(T,["prevent"]),class:"space-y-4"},[e("div",null,[$(L,{text:U.value},null,8,["text"]),$(H,{modelValue:p.value,"onUpdate:modelValue":w[1]||(w[1]=f=>p.value=f),placeholder:D.value,onInput:a},null,8,["modelValue","placeholder"]),V.value?(t(),r("p",ye," Insira um valor válido. ")):y("",!0)]),e("div",null,[$(L,{text:"Valor"}),e("div",he,[I(e("input",{"onUpdate:modelValue":w[2]||(w[2]=f=>g.value=f),placeholder:"R$ 0,00",onInput:o,class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},null,544),[[R,g.value]])])]),e("div",be,[$(le,{onClick:T},{default:A(()=>w[4]||(w[4]=[E("Adicionar")])),_:1})])],32)])):y("",!0)}},we=S($e,[["__scopeId","data-v-1cab2bac"]]),ke={class:"flex gap-5"},Ce={key:0,class:"loading-overlay"},qe={class:"flex-1"},Ve={class:"min-w-full table-auto"},Pe=["onDblclick"],De={class:"px-6 py-4 text-[16px] text-left text-gray-900 font-semibold"},Ue={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-center"},Ie=["onUpdate:modelValue"],Me={key:1},Se={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-left"},Re={key:0},Ee=["onUpdate:modelValue"],Fe={key:2},Le={class:"px-6 py-4 text-[16px] text-gray-500 text-center"},je=["onUpdate:modelValue"],Ae={key:1},Ne={class:"px-6 py-4 text-center"},Te=["onClick"],Be={key:0,class:"botao-container"},ze={__name:"ResumoCarrinho",props:{carrinho:{type:Array,required:!0}},emits:["confirmar","cancelar"],setup(n,{emit:l}){const d=O(),h=n,_=l,c=u(!1),i=u(!1),p=u(null),g=a=>{h.carrinho.splice(a,1),d.info("Item removido com sucesso!")},V=a=>{p.value=a},P=a=>{const o=parseFloat((a.valor||"0").replace("R$","").replace(",","."));return a.quantidade>0?o/a.quantidade:0},q=a=>a.unidadeDeMedida==="a_granel"?P(a)*a.quantidade:a.quantidade*parseFloat(a.valor.replace("R$","").replace(",",".")),U=async()=>{var a;c.value=!0,i.value=!0;try{const o={fornecedor_id:((a=h.carrinho[0])==null?void 0:a.fornecedor_id)||null,itens:h.carrinho.map(b=>({id:b.id,nome:b.nome,quantidade:b.quantidade,unidadeDeMedida:b.unidadeDeMedida,valorUnitario:Math.round(parseFloat(b.valor.replace("R$","").replace(",","."))*100),total:Math.round(q(b)*100)}))};console.log("Dados enviados:",JSON.stringify(o,null,2));const s=await axios.post("/api/estoque/armazenar-entrada",o);s.status===201?(console.log("Resposta da API:",s.data),Z.Inertia.visit(route("franqueado.inventario")),d.success("Lista de insumos salvas em seu estoque.")):d.error("Erro ao salvar no estoque, tente novamente.")}catch(o){console.error("Erro ao enviar entrada:",o),d.error("Erro ao confirmar entrada. Tente novamente ou chame o suporte.")}finally{c.value=!1}},D=()=>{_("cancelar")};return(a,o)=>(t(),r("div",ke,[c.value?(t(),r("div",Ce,o[0]||(o[0]=[e("div",{class:"spinner"},null,-1)]))):y("",!0),o[3]||(o[3]=e("div",{class:"flex-1"},[e("div",{class:"painel-title"},"Confirmar entrada"),e("div",{class:"painel-subtitle"},[e("p",null,"Vamos conferir se está tudo certo")]),e("div",{class:"mt-[25%] text-[#6d6d6d] text-[18px] font-normal font-['Figtree'] leading-[23px] tracking-tight"},[E(" Você confirma que está "),e("br"),E(" realizando uma nova entrada "),e("br"),E(" com os seguintes itens? ")])],-1)),e("div",qe,[e("table",Ve,[o[2]||(o[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-xs text-left font-medium text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," Item "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," QTD. "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," V. UN/KG "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," TOTAL "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider TrRedonDireita"}," AÇÃO ")])],-1)),e("tbody",null,[(t(!0),r(M,null,j(n.carrinho,(s,b)=>(t(),r("tr",{key:s.id,onDblclick:k=>V(b)},[e("td",De,x(s.nome),1),e("td",Ue,[p.value===b?I((t(),r("input",{key:0,type:"number","onUpdate:modelValue":k=>s.quantidade=k,class:"border border-gray-300 rounded px-2 py-1 w-16"},null,8,Ie)),[[R,s.quantidade,void 0,{number:!0}]]):(t(),r("span",Me,x(s.quantidade)+" "+x(s.unidadeDeMedida==="a_granel"?"KG":"UN"),1))]),e("td",Se,[s.unidadeDeMedida==="a_granel"?(t(),r("span",Re," R$ "+x(P(s).toFixed(2)),1)):p.value===b?I((t(),r("input",{key:1,type:"text","onUpdate:modelValue":k=>s.valor=k,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,Ee)),[[R,s.valor]]):(t(),r("span",Fe,x(s.valor),1))]),e("td",Le,[p.value===b&&s.unidadeDeMedida==="a_granel"?I((t(),r("input",{key:0,type:"number","onUpdate:modelValue":k=>s.valorTotal=k,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,je)),[[R,s.valorTotal,void 0,{number:!0}]]):(t(),r("span",Ae,x(q(s).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1))]),e("td",Ne,[e("button",{onClick:k=>g(b),class:"w-[16] h-[16]"},o[1]||(o[1]=[e("img",{src:"/storage/images/delete.svg",alt:"icone de excluir",class:"w-[16px] h-[16px]"},null,-1)]),8,Te)])],40,Pe))),128))])]),i.value?y("",!0):(t(),r("div",Be,[$(W,{text:"Voltar",onClick:D}),$(K,{text:"Confirmar",onClick:U})]))])]))}},Qe=S(ze,[["__scopeId","data-v-2191093f"]]),Oe={key:0},Ke={key:0,class:"sidebar-container"},Ge={key:0,class:"loading-overlay"},Je={key:1,class:"flex"},Xe={class:"flex-1 p-4"},Ze={class:"relative flex items-center w-full mb-4"},He={class:"space-y-4"},We=["onClick"],Ye={class:"flex-shrink-0"},et=["src"],tt={class:"ml-4 flex-1"},ot={class:"text-lg font-semibold flex items-center"},at={key:0,class:"ml-5 text-xs bg-green-100 text-green-600 font-bold rounded-full px-2 py-1"},st={key:1,class:"mr-2 ml-5 text-yellow-500",title:"Essa estrela sigifinica que esse insumo e um produto princial"},rt={class:"absolute bottom-4 right-4 mt-5 botao-container"},nt={class:"flex-1 p-4"},lt={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},setup(n){const l=u([]),d=u(""),h=u(!1),_=u(null),c=u([]),i=u(!1),p=()=>{console.log("Entrada confirmada",c.value),mostrarModalRevisao.value=!1,c.value=[]},g=async()=>{h.value=!0;try{const a=await N.get("/api/produtos/lista");l.value=a.data}catch(a){console.error("Erro ao carregar os produtos:",a)}finally{h.value=!1}},V=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",P=a=>{_.value=a},q=a=>c.value.filter(o=>o.id===a).length,U=a=>{c.value.push(a),_.value=null},D=J(()=>l.value.filter(a=>a.nome.toLowerCase().includes(d.value.toLowerCase())));return oe(g),(a,o)=>(t(),r(M,null,[$(X,{name:"fade"},{default:A(()=>[i.value?y("",!0):(t(),r("div",Oe,[n.isVisible?(t(),r("div",Ke,[h.value?(t(),r("div",Ge,o[3]||(o[3]=[e("div",{class:"spinner"},null,-1)]))):(t(),r("div",Je,[e("div",Xe,[o[5]||(o[5]=e("div",{class:"painel-title"},"Nova entrada",-1)),o[6]||(o[6]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",Ze,[o[4]||(o[4]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),I(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=s=>d.value=s),placeholder:"Buscar um produto",class:"pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[R,d.value]])]),e("div",He,[(t(!0),r(M,null,j(D.value,s=>(t(),r("div",{key:s.id,class:"flex items-center p-4 bg-white rounded-lg cursor-pointer",onClick:b=>P(s)},[e("div",Ye,[e("img",{src:V(s.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,et)]),e("div",tt,[e("div",ot,[E(x(s.nome)+" ",1),q(s.id)>0?(t(),r("span",at,x(q(s.id)),1)):y("",!0),s.estrela?(t(),r("span",st," ★ ")):y("",!0)])])],8,We))),128))])]),e("div",rt,[$(K,{text:"Finalizar",onClick:o[1]||(o[1]=s=>i.value=!0),iconPath:"/storage/images/arrow_left_alt.svg"})]),e("div",nt,[$(we,{produtoSelecionado:_.value,onAdicionarAoCarrinho:U},null,8,["produtoSelecionado"])])]))])):y("",!0)]))]),_:1}),i.value?(t(),F(Qe,{key:0,carrinho:c.value,onConfirmar:p,onCancelar:o[2]||(o[2]=s=>i.value=!1)},null,8,["carrinho"])):y("",!0)],64))}},it=S(lt,[["__scopeId","data-v-4deae6b8"]]),dt={key:0,class:"sidebar-container"},ut={key:0,class:"loading-overlay"},ct={key:1,class:"w-full h-[80%] bg-white rounded-[20px] p-12"},pt={class:"flex justify-center mb-6 relative group"},vt=["src"],ft={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},mt={key:0,class:"error-message"},gt={class:"flex items-center space-x-4 mt-2"},_t={class:"flex items-center space-x-2 cursor-pointer"},xt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},yt={key:0,class:"w-3 h-3 rounded-full bg-green-500"},ht={class:"flex items-center space-x-2 cursor-pointer"},bt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},$t={key:0,class:"w-3 h-3 rounded-full bg-green-500"},wt={class:"flex items-center space-x-4 mt-2"},kt={class:"flex items-center space-x-2 cursor-pointer"},Ct={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},qt={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Vt={class:"flex items-center space-x-2 cursor-pointer"},Pt={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Dt={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Ut={class:"flex justify-start space-x-1 mt-[15%]"},It={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(n,{emit:l}){const d=O(),h=n,_=l,c=u(""),i=u(""),p=u(""),g=u(""),V=u(null),P=u(""),q=u(null),U=u(!1),D=u(!1),a=u("");ae(()=>h.produto,f=>{f&&(c.value=f.nome||"",i.value=f.categoria||"",p.value=f.unidadeDeMedida||"",g.value=f.profile_photo||"")},{immediate:!0});const o=f=>f?new URL(f,window.location.origin).href:"/storage/images/no_imagem.svg",s=async()=>{var f,v;if(!c.value){d.error("O campo nome é obrigatório.");return}try{U.value=!0;const m=new FormData;if(m.append("id",h.produto.id),m.append("nome",c.value),m.append("categoria",i.value),m.append("unidadeDeMedida",p.value),V.value){const ee=`${Date.now()}_${V.value.name}`;m.append("profile_photo_name",ee),m.append("profile_photo",V.value)}const Y=await N.post("/api/produtos/atualizar",m,{headers:{"Content-Type":"multipart/form-data"}});Z.Inertia.replace(route("franqueadora.insumos"),{produto:Y.data.produto,preserveState:!0}),d.success("Produto atualizado com sucesso!")}catch(m){d.error("Erro ao atualizar o produto."),P.value=((v=(f=m.response)==null?void 0:f.data)==null?void 0:v.message)||"Erro inesperado."}finally{U.value=!1}},b=f=>{a.value=f,D.value=!0},k=()=>{s(),D.value=!1},G=()=>{D.value=!1},T=()=>{var f;(f=q.value)==null||f.click()},B=()=>{g.value="",d.info("Imagem removida.")},C=f=>{const v=f.target.files[0];if(v){if(v.size>5*1024*1024){d.error("A imagem não pode exceder 5 MB.");return}V.value=v;const m=new FileReader;m.onload=()=>{g.value=m.result,d.success("Imagem carregada com sucesso!")},m.readAsDataURL(v)}},w=()=>{_("cancelar")};return(f,v)=>(t(),F(X,{name:"fade"},{default:A(()=>[n.isVisible?(t(),r("div",dt,[U.value?(t(),r("div",ut,v[7]||(v[7]=[e("div",{class:"spinner"},null,-1)]))):(t(),r("div",ct,[e("form",{onSubmit:Q(s,["prevent"])},[e("div",pt,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:T},[g.value?(t(),r(M,{key:0},[e("img",{src:o(g.value),alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,vt),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:v[0]||(v[0]=Q(()=>{},["stop"]))},[e("button",{onClick:Q(B,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(t(),r("img",ft))]),e("input",{type:"file",ref_key:"fileInput",ref:q,accept:"image/*",class:"hidden",onChange:C},null,544)]),$(L,{text:"Nome"}),$(H,{modelValue:c.value,"onUpdate:modelValue":v[1]||(v[1]=m=>c.value=m),placeholder:""},null,8,["modelValue"]),P.value?(t(),r("div",mt,x(P.value),1)):y("",!0),$(L,{class:"font-semibold text-gray-800 mt-8",text:"Prioridade"}),e("div",gt,[e("label",_t,[I(e("input",{type:"radio","onUpdate:modelValue":v[2]||(v[2]=m=>i.value=m),value:"principal",class:"hidden"},null,512),[[z,i.value]]),e("div",xt,[i.value==="principal"?(t(),r("div",yt)):y("",!0)]),v[8]||(v[8]=e("span",null,"Principal",-1))]),e("label",ht,[I(e("input",{type:"radio","onUpdate:modelValue":v[3]||(v[3]=m=>i.value=m),value:"secundario",class:"hidden"},null,512),[[z,i.value]]),e("div",bt,[i.value==="secundario"?(t(),r("div",$t)):y("",!0)]),v[9]||(v[9]=e("span",null,"Secundário",-1))])]),$(L,{class:"font-semibold text-gray-800 mt-8",text:"Unidade de medida"}),e("div",wt,[e("label",kt,[I(e("input",{type:"radio","onUpdate:modelValue":v[4]||(v[4]=m=>p.value=m),value:"a_granel",class:"hidden"},null,512),[[z,p.value]]),e("div",Ct,[p.value==="a_granel"?(t(),r("div",qt)):y("",!0)]),v[10]||(v[10]=e("span",null,"A granel",-1))]),e("label",Vt,[I(e("input",{type:"radio","onUpdate:modelValue":v[5]||(v[5]=m=>p.value=m),value:"unitario",class:"hidden"},null,512),[[z,p.value]]),e("div",Pt,[p.value==="unitario"?(t(),r("div",Dt)):y("",!0)]),v[11]||(v[11]=e("span",null,"Unitário",-1))])]),e("div",Ut,[$(W,{text:"Cancelar",onClick:w}),$(K,{text:"Atualizar",onClick:v[6]||(v[6]=m=>b("Atualizar esse Produto?"))})])],32),$(ne,{isVisible:D.value,motivo:a.value,onConfirm:k,onCancel:G},null,8,["isVisible","motivo"])]))])):y("",!0)]),_:1}))}},Mt=S(It,[["__scopeId","data-v-f1b871f9"]]),St={props:{isVisible:{type:Boolean,default:!1},motivo:{type:String,required:!0}},methods:{confirm(){this.$emit("confirm")},cancel(){this.$emit("cancel")}}},Rt={key:0,class:"confirm-dialog-overlay"},Et={class:"confirm-dialog"},Ft={class:"confirm-dialog-content"},Lt={class:"confirm-dialog-actions"};function jt(n,l,d,h,_,c){return t(),F(X,{name:"fade"},{default:A(()=>[d.isVisible?(t(),r("div",Rt,[e("div",Et,[l[4]||(l[4]=e("div",{class:"alert-icon"},[e("img",{src:"/storage/images/warning.svg",alt:"Ícone de alerta"})],-1)),e("div",Ft,[e("p",null,"Você tem certeza que deseja "+x(d.motivo),1),e("div",Lt,[e("button",{onClick:l[0]||(l[0]=(...i)=>c.cancel&&c.cancel(...i)),class:"btn-cancel"},l[2]||(l[2]=[e("span",null,"CANCELAR",-1)])),e("button",{onClick:l[1]||(l[1]=(...i)=>c.confirm&&c.confirm(...i)),class:"btn-confirm"},l[3]||(l[3]=[e("span",null,"CONFIRMAR",-1)]))])])])])):y("",!0)]),_:1})}const At=S(St,[["render",jt],["__scopeId","data-v-f1cbb43c"]]),Nt={class:"elemento-fixo"},Tt={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Bt={class:"relative w-full h-full"},zt={class:"flex items-center"},Qt={class:"w-1/1 flex justify-center"},Ot=["src"],Kt={class:"w-2/3 pl-5"},Gt={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Jt={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},Xt={class:"w-1/1"},Zt={class:"mt-8"},Ht={class:"min-w-full table-auto"},Wt={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Yt={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},eo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},to={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},oo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},ao={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},so={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},setup(n){const l=O(),d=n,h=u(!1),_=u(""),c=u(!1),i=u(!1),p=u(!1),g=()=>{u.dadosProduto.fetchProduto()},V=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",P=async()=>{var a,o,s,b;try{p.value=!0;const k=await N.delete(`/api/produtos/excluir/${d.produto.id}`);console.log(k.data.message),l.success("Produto deletado com sucesso!"),Z.Inertia.visit(route("franqueadora.insumos"))}catch(k){l.error("Erro ao deletar o produto:",((o=(a=k.response)==null?void 0:a.data)==null?void 0:o.error)||k.message),console.error("Erro ao deletar o produto:",((b=(s=k.response)==null?void 0:s.data)==null?void 0:b.error)||k.message)}finally{p.value=!1}},q=()=>{P(),h.value=!1},U=()=>{h.value=!1},D=()=>{i.value=!1,c.value=!0};return(a,o)=>(t(),r("div",Nt,[i.value?y("",!0):(t(),r("div",Tt,[e("div",Bt,[e("div",zt,[e("div",Qt,[e("img",{src:V(n.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Ot)]),e("div",Kt,[e("div",Gt,[E(x(n.produto.nome||"N/A")+" ",1),e("div",Jt,x(n.produto.unidadeDeMedida==="a_granel"&&n.produto.valor_pago_por_quilo_lote?n.produto.valor_pago_por_quilo_lote:n.produto.valor_total_lote),1)])]),e("div",Xt,[$(At,{isVisible:h.value,motivo:_.value,onConfirm:q,onCancel:U},null,8,["isVisible","motivo"])])])])])),e("div",Zt,[e("table",Ht,[e("thead",null,[e("tr",null,[o[0]||(o[0]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),o[1]||(o[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),o[2]||(o[2]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),e("th",Wt,x(n.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),o[3]||(o[3]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),e("tbody",null,[(t(!0),r(M,null,j(n.produto.lotes,(s,b)=>(t(),r("tr",{key:b,class:"text-center"},[e("td",Yt,x(s.data),1),e("td",eo,x(s.fornecedor),1),e("td",to,x(s.quantidade),1),e("td",oo,x(n.produto.unidadeDeMedida==="unitario"?s.preco_unitario:s.valor_pago_por_quilo),1),e("td",ao,x(n.produto.unidadeDeMedida==="unitario"?s.valor_total:s.preco_unitario),1)]))),128))])])]),i.value?(t(),F(Mt,{key:1,ref:"dadosProduto",isVisible:i.value,produto:n.produto,onDadosProduto:g,onCancelar:D},null,8,["isVisible","produto"])):y("",!0)]))}},ro=S(so,[["__scopeId","data-v-6c30f72a"]]),no={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const n=await N.get("/api/estoque/lista");console.log("Produtos carregados:",n.data),this.produtos=Object.values(n.data)}catch(n){console.error("Erro ao carregar os produtos:",n)}},getProfilePhotoUrl(n){return n?new URL(n,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(n){this.$emit("produto-selecionado",n)},getQuantidadeTotal(n){return n.reduce((l,d)=>l+d.quantidade,0)}},computed:{filteredProdutos(){const n=this.searchQuery.toLowerCase();return this.produtos.filter(l=>l.nome.toLowerCase().includes(n))}}},lo={class:"search-container relative flex items-center w-full mb-4"},io={class:"card-container"},uo=["onClick"],co={class:"card-inner"},po={class:"icon-container"},vo={class:"icon-leaf"},fo=["src"],mo={class:"text-container flex justify-between items-center p-2"},go={class:"city"},_o={class:"quantidade text-gray-600 font-semibold"},xo={class:"text-gray-600 font-semibold"};function yo(n,l,d,h,_,c){return t(),r("div",null,[l[3]||(l[3]=e("div",{class:"painel-title"},"Inventário da loja",-1)),l[4]||(l[4]=e("div",{class:"painel-subtitle"},[e("p",null,"Verifique a quantidade de cada item")],-1)),e("div",lo,[l[1]||(l[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),I(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=i=>_.searchQuery=i),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[R,_.searchQuery]])]),e("div",io,[(t(!0),r(M,null,j(c.filteredProdutos,i=>(t(),r("div",{key:i.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:p=>c.selecionarProduto(i)},[e("div",co,[e("div",po,[l[2]||(l[2]=e("div",{class:"icon-bg"},null,-1)),e("div",vo,[e("img",{src:c.getProfilePhotoUrl(i.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,fo)])]),e("div",mo,[e("div",go,x(i.nome),1),e("div",_o,[e("div",xo,x(c.getQuantidadeTotal(i.lotes)),1)])])])],8,uo))),128))])])}const ho=S(no,[["render",yo],["__scopeId","data-v-003fe9d6"]]),bo={key:0,class:"mt-6"},$o={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},wo={key:0},ko={class:"flex flex-col gap-4"},Co={class:"absolute bottom-4 right-4 botao-container"},qo={__name:"Index",setup(n){const l=u(null),d=u(!1),h=()=>{d.value=!d.value},_=()=>{c(),d.value=!1},c=()=>{var g;(g=u("listarUnidades").value)==null||g.fetchUnidades()},i=p=>{p&&typeof p=="object"?l.value=p:console.warn("Dados inválidos recebidos no evento produto-selecionado:",p)};return(p,g)=>(t(),F(ie,null,{default:A(()=>[$(se(re),{title:"Insumos"}),d.value?(t(),r("div",bo,[$(it,{isVisible:d.value,onUnidadeCadastrada:_,onCancelar:h},null,8,["isVisible"])])):y("",!0),e("div",$o,[d.value?y("",!0):(t(),r("div",wo,[$(ho,{ref:"listarUnidades",onUnidadeCadastrada:c,onProdutoSelecionado:i},null,512)])),e("div",ko,[d.value?y("",!0):(t(),r(M,{key:0},[l.value?(t(),F(ro,{key:0,produto:l.value},null,8,["produto"])):y("",!0),e("div",Co,[$(K,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:h})])],64))])])]),_:1}))}},Ro=S(qo,[["__scopeId","data-v-d55cd220"]]);export{Ro as default};
