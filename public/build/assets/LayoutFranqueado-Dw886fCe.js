import{d as b,i as h,j as C,a6 as V,e as c,o as i,a as e,af as G,c as D,f as x,b as $,w as O,t as A,n as P,u as L,a2 as T,ag as W,s as M,a5 as R,ah as H,q as Z,F as j,h as F,a7 as J,ai as B,k as U,a1 as K,Z as Q,r as X,ae as Y}from"./app-BpJtz6--.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee=["href"],te=["src"],se={__name:"iconeNotificacao",setup(v){const t=b(null),a=b(null),o=b(!1),_=b(!0),g=h(()=>a.value?`https://alertas.taiksu.com.br/callback?token=${a.value}`:"https://alertas.taiksu.com.br"),I=h(()=>_.value?"https://login.taiksu.com.br/frontend/img/sinale0.png":o.value?"https://login.taiksu.com.br/frontend/img/sino-alerta-com-mensagem.png":"https://login.taiksu.com.br/frontend/img/sinale0.png"),k=async()=>{try{const l=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!l.ok)throw new Error("Erro ao carregar perfil do usuÃ¡rio");const m=await l.json();m.status==="success"&&m.data&&(t.value=m.data.id,a.value=m.data.rh_token||m.data.id,await s())}catch(l){console.error("Erro ao buscar dados do usuÃ¡rio:",l)}finally{_.value=!1}},s=async()=>{if(t.value)try{const l=`https://alertas.taiksu.com.br/api/status/${t.value}`,m=await fetch(l,{method:"GET",headers:{Accept:"application/json"}});if(!m.ok)throw new Error("Erro ao verificar status das notificaÃ§Ãµes");const r=await m.json();o.value=r.status===!0}catch(l){console.error("Erro ao consultar status das notificaÃ§Ãµes:",l),o.value=!1}};let n;return C(async()=>{await k(),n=setInterval(()=>{s()},3e5)}),V(()=>{n&&clearInterval(n)}),(l,m)=>(i(),c("a",{class:"notification-link",href:g.value,target:"_blank",rel:"noopener noreferrer"},[e("img",{src:I.value,alt:"NotificaÃ§Ãµes",class:"notification-icon"},null,8,te)],8,ee))}},ae=N(se,[["__scopeId","data-v-81702bd5"]]),q=G("sidebar",{state:()=>({isOpen:!1}),actions:{toggle(){this.isOpen=!this.isOpen},open(){this.isOpen=!0},close(){this.isOpen=!1}}}),ne={class:"navbar"},oe={class:"navbar-content"},re={class:"navbar-left"},ie={class:"navbar-logo"},le=["href"],ce={class:"navbar-right"},ue={class:"mr-4"},de={key:0,class:"user-info"},ve=["src"],me={class:"user-details"},fe={class:"user-name"},pe={class:"user-location"},he={key:1,class:"user-info loading"},ge={__name:"Navbar",setup(v){const t=q(),a=()=>{t.toggle()},o=b(null),_=h(()=>{var s;return(s=o.value)==null?void 0:s.unidade}),g=h(()=>{var s,n;return((s=o.value)==null?void 0:s.profile_photo_url)||`https://ui-avatars.com/api/?name=${I((n=o.value)==null?void 0:n.name)}&color=7F9CF5&background=EBF4FF`}),I=s=>s?s.split(" ").map(l=>l.charAt(0).toUpperCase()).join(""):"*",k=async()=>{try{const s=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar perfil do usuÃ¡rio");const n=await s.json();o.value=n.data}catch(s){console.error("Erro ao buscar perfil:",s),o.value=null}};return C(()=>{k()}),(s,n)=>(i(),c("div",ne,[n[4]||(n[4]=e("div",{class:"navbar-background"},null,-1)),e("div",oe,[e("div",re,[e("div",ie,[e("div",{class:"mr-4 mt-2 hide-mobile"},[e("button",{onClick:a},n[0]||(n[0]=[e("img",{src:"/storage/images/quadrados_verdes.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),e("div",null,[e("a",{href:s.route("franqueado.painel")},n[1]||(n[1]=[e("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,le)])])]),e("div",ce,[e("div",ue,[$(ae)]),e("div",{class:"view-mobile"},[e("button",{onClick:a},n[2]||(n[2]=[e("img",{src:"/storage/images/bx-menuv.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),o.value?(i(),D(L(T),{key:0,href:"https://login.taiksu.com.br/perfil",class:P(["user-info hide-mobile",{loading:!o.value}])},{default:O(()=>{var l;return[o.value?(i(),c("div",de,[e("img",{src:g.value,alt:"Avatar",class:"avatar"},null,8,ve),e("div",me,[e("div",fe,A(o.value.name),1),e("div",pe,A(((l=_.value)==null?void 0:l.cidade)||"Taiksu Franchising"),1)])])):(i(),c("div",he,n[3]||(n[3]=[e("div",{class:"avatar-skeleton"},null,-1),e("div",{class:"user-details-skeleton"},[e("div",{class:"name-skeleton"}),e("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["class"])):x("",!0)])])]))}},be=N(ge,[["__scopeId","data-v-0c21c62b"]]),_e={class:"icon"},ke=["src"],Se={class:"label"},we={type:"submit",class:"w-full h-full flex items-center"},ye={class:"icon"},Ie=["src"],Ee={class:"label"},Le={key:2,class:"submenu"},Ae={class:"label"},xe={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(v){const t=v,a=W("openSubmenuLink",b(null)),o=h(()=>a.value===t.link),_=h(()=>o.value),g=h(()=>t.link&&/^https?:\/\//.test(t.link)),I=h(()=>g.value?t.link:t.link?route(t.link):"#"),k=h(()=>!0),s=h(()=>t.submenuItems),n=d=>{s.value.length>0&&(d.preventDefault(),l())},l=()=>{a.value===t.link?a.value=null:a.value=t.link,r()},m=()=>{const d=localStorage.getItem("openSubmenuLink");d!==null&&(a.value=d)},r=()=>{a.value?localStorage.setItem("openSubmenuLink",a.value):localStorage.removeItem("openSubmenuLink")},f=h(()=>u.value||t.isActive?"submenu-active":""),p=d=>{const y=window.location.pathname,E=new URL(route(d),window.location.origin).pathname;return y===E},u=h(()=>s.value.some(d=>p(d.link))),S=()=>{t.isLogout&&J.post(route("logout.sair"))};return m(),M(u,()=>{!u.value&&a.value===t.link&&R(()=>{a.value=null,r()})}),M(a,()=>{R(()=>r())}),(d,y)=>(i(),c("div",null,[!v.isLogout&&v.link&&k.value?(i(),D(H(g.value?"a":L(T)),{key:0,class:P(["menu-item",[f.value,{active:v.isActive||u.value}]]),href:I.value,target:g.value?"_blank":null,onClick:n},{default:O(()=>[e("div",_e,[e("img",{src:v.icon,alt:"icon"},null,8,ke)]),e("div",Se,A(v.label),1),s.value.length>0?(i(),c("div",{key:0,class:P(["right-icon",{"rotate-icon":_.value}])},y[0]||(y[0]=[e("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):x("",!0)]),_:1},8,["class","href","target"])):v.isLogout&&k.value?(i(),c("form",{key:1,onSubmit:Z(S,["prevent"]),class:"menu-item"},[e("button",we,[e("div",ye,[e("img",{src:v.icon,alt:"icon"},null,8,Ie)]),e("div",Ee,A(v.label),1)])],32)):x("",!0),s.value.length>0&&(o.value||u.value)?(i(),c("div",Le,[(i(!0),c(j,null,F(s.value,(E,z)=>(i(),c("div",{key:z},[$(L(T),{class:P(["submenu-item",{active:p(E.link)}]),href:d.route(E.link)},{default:O(()=>[e("div",Ae,A(E.label),1)]),_:2},1032,["href","class"])]))),128))])):x("",!0)]))}},$e=N(xe,[["__scopeId","data-v-5acecb50"]]),Pe={key:0,class:"loader-container"},Ne={key:0,class:"category-title menu-categorias text-sm sm:text-base font-medium text-[#87ba73] mb-3 pl-4"},Ce={__name:"Slidebar",setup(v){const t=b(null),a=b({}),o=b([]),_=q(),g=b(!0),I=b(null),k=async()=>{try{const r=await U.get("/api/navbar-profile");a.value=r.data.data.permissions||{}}catch(r){console.error("Erro ao carregar permissÃµes:",r),a.value={}}},s=async()=>{try{const f=(await U.get(`/api/menu?t=${Date.now()}`)).data.data||[];let p=!1;f.forEach(S=>{S.items.forEach(w=>{w.id===31&&(p=!0,console.log("ðŸ”´ ITEM 31 ENCONTRADO NO FRONTEND:",w))})}),p?console.error("âŒ Item 31 (DRE) AINDA ESTÃ NA RESPOSTA - filtro NÃƒO funcionando!"):console.log("âœ… Item 31 (DRE) NÃƒO estÃ¡ na resposta da API - filtro funcionando!");const u=f.map(S=>{const w=(S.items||[]).slice().sort((d,y)=>d.order-y.order);return w.forEach(d=>{d.children&&Array.isArray(d.children)&&(d.children=d.children.slice().sort((y,E)=>y.order-E.order))}),{...S,items:w}}).sort((S,w)=>S.order-w.order);o.value=u}catch(r){console.error("Erro ao carregar menu:",r),o.value=[]}};B("userPermissions",a),B("openSubmenuLink",I);const n=h(()=>o.value.map(r=>({...r,items:r.items.map(f=>({...f,submenuItems:f.children||[]}))})));C(async()=>{g.value=!0,await k(),await s();const r=localStorage.getItem("sidebarScrollPosition");r&&t.value&&(t.value.scrollTop=r),g.value=!1});const l=()=>{t.value&&localStorage.setItem("sidebarScrollPosition",t.value.scrollTop)},m=r=>{const f=window.location.pathname,p=new URL(r,window.location.origin).pathname;return f===p||f.startsWith(p)};return(r,f)=>(i(),c("div",null,[g.value?(i(),c("div",Pe,f[0]||(f[0]=[e("div",{class:"spinner"},null,-1)]))):(i(),c("div",{key:1,class:P(["sidebar fixed top-16 left-0 bg-[#164110] text-white flex flex-col p-3 overflow-y-auto h-full transition-transform duration-300 ease-in-out",L(_).isOpen?"translate-x-0":"-translate-x-full","md:translate-x-0 md:relative  md:top-0 md:left-0"]),ref_key:"sidebar",ref:t,onScroll:l},[(i(!0),c(j,null,F(n.value,p=>(i(),c("div",{key:p.name,class:"menu-category mb-6"},[p.items.length>0?(i(),c("div",Ne,A(p.name),1)):x("",!0),(i(!0),c(j,null,F(p.items,u=>(i(),D($e,{key:u.link||"no-link",label:u.label,icon:u.icon,link:u.link,submenuItems:u.submenuItems,isActive:u.link?m(u.link):!1,isLogout:u.isLogout,requiredPermission:u.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],34))]))}},Oe=N(Ce,[["__scopeId","data-v-93c5e883"]]),Te={__name:"LayoutFranqueado",props:{title:String},setup(v){const t=q();function a(){window.innerWidth<768?t.close():t.open()}return C(()=>{window.addEventListener("resize",a),a()}),K(()=>{window.removeEventListener("resize",a)}),(o,_)=>(i(),c("div",null,[$(L(Q),{title:v.title},null,8,["title"]),$(be),$(Oe),e("main",{class:"content",style:Y({left:L(t).isOpen?"252px":"0",width:L(t).isOpen?"calc(100vw - 250px)":"100vw"})},[X(o.$slots,"default",{},void 0,!0)],4)]))}},De=N(Te,[["__scopeId","data-v-d63d761a"]]);export{De as L};
