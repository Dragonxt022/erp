import{l as se,d as _,i as qe,o as i,e as c,a as e,j as D,s as Fe,F as E,g as O,t as h,b as C,h as w,v as F,w as A,f as U,p as Te,k as Q,y as Ue,q as Se,c as L,R as B,P as Ve,m as Me,u as Ie,Z as Le}from"./app-Dy2XxTUx.js";import{_ as ue}from"./LabelModel-Cqz_iB5b.js";import{I as Oe}from"./InputModel-BRoYUNEx.js";import{B as Ne}from"./ButtonPrimary-6TP3DG_6.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as ie}from"./ButtonPrimaryMedio-D7yjF21s.js";import{d as Be}from"./index-Bf1s80cy.js";import{B as Ce}from"./ButtonCancelar-nSAeq5dJ.js";import{B as Ae}from"./ButtonEditeMedio-CRbuc3G5.js";import{L as Qe}from"./LayoutFranqueado-Bzr09hzj.js";import"./user-BgrY-rsP.js";const Ge={key:0,class:"w-[100%] h-full flex flex-col p-4 bg-gray-50"},ze={class:"mb-6 relative"},Ke={class:"relative"},We=["value"],He={class:"w-full bg-white rounded-lg p-6 mb-6"},Je={class:"flex items-center"},Xe={class:"flex-shrink-0"},Ze=["src"],Ye={class:"ml-6"},et={class:"text-2xl font-semibold text-gray-800"},tt={key:0,class:"text-red-500 text-sm text-center"},ot={class:"relative flex items-center w-full"},at={class:"flex justify-end space-x-4"},rt={__name:"CadastrarInsumoEstoque",props:{produtoSelecionado:{type:Object,required:!1}},setup(t,{emit:o}){var P;const s=se(),d=o,l=t,g=_([]),f=_(""),v=_(""),x=_(((P=l.produtoSelecionado)==null?void 0:P.valor)||""),u=_(!1);_(!1);const p=_(!1),m=_(""),S=qe(()=>l.produtoSelecionado.unidadeDeMedida==="a_granel"?"Kg":"Quantidade"),I=()=>{if(!v.value.trim()){u.value=!1;return}let q=/^[0-9]+([.,][0-9]+)?$/;if(l.produtoSelecionado.unidadeDeMedida==="unidade"&&(q=/^[0-9]+$/),u.value=!q.test(v.value),["a_granel","quilo"].includes(l.produtoSelecionado.unidadeDeMedida)){let b=v.value.replace(/\D/g,""),T=b.slice(0,-3)||"0",M=b.slice(-3).padStart(3,"0");v.value=`${Number(T).toLocaleString("pt-BR")},${M}`}},a=()=>{const q=x.value.replace(/\D/g,""),b=q.slice(0,-2)||"0",T=q.slice(-2).padStart(2,"0");x.value=`R$ ${Number(b).toLocaleString("pt-BR")},${T}`},r=()=>{v.value="",x.value=""};(async()=>{try{const q=await Q.get("/api/estoque/fornecedores");g.value=q.data.data.map(b=>({id:b.id||"N/D",razao_social:b.razao_social||"N/D"}))}catch(q){console.error("Erro ao carregar fornecedores:",q)}})();const y=q=>q?new URL(q,window.location.origin).href:"/storage/images/no_imagem.svg",k=()=>(m.value="",f.value?!v.value||u.value?(s.error("Quantidade inválida."),m.value="Quantidade inválida.",!1):!x.value||p.value?(s.error("Valor inválido."),m.value="Valor inválido.",!1):!0:(s.error("Fornecedor não selecionado."),m.value="Fornecedor não selecionado.",!1)),R=()=>{if(!k())return;const q={...l.produtoSelecionado,fornecedor_id:f.value,quantidade:v.value,valor:x.value,unidade_de_medida:l.produtoSelecionado.unidadeDeMedida};s.success("Inusmo adicionado"),r(),d("adicionarAoCarrinho",q)};return(q,b)=>t.produtoSelecionado?(i(),c("div",Ge,[b[5]||(b[5]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",ze,[e("div",Ke,[D(e("select",{"onUpdate:modelValue":b[0]||(b[0]=T=>f.value=T),id:"fornecedor",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-green-600 focus:ring-2 focus:ring-green-500 font-['Figtree']"},[b[3]||(b[3]=e("option",{value:"",disabled:""},"Selecione um fornecedor",-1)),(i(!0),c(E,null,O(g.value,T=>(i(),c("option",{key:T.id,value:T.id},h(T.razao_social),9,We))),128))],512),[[Fe,f.value]])])]),e("div",He,[e("div",Je,[e("div",Xe,[e("img",{src:y(t.produtoSelecionado.profile_photo),alt:"Foto do Produto",class:"w-24 h-24 rounded-lg"},null,8,Ze)]),e("div",Ye,[e("div",et,h(t.produtoSelecionado.nome||"N/A"),1)])])]),e("form",{onSubmit:Te(R,["prevent"]),class:"space-y-4"},[e("div",null,[C(ue,{text:S.value},null,8,["text"]),C(Oe,{modelValue:v.value,"onUpdate:modelValue":b[1]||(b[1]=T=>v.value=T),placeholder:"0,000",onInput:I},null,8,["modelValue"]),u.value?(i(),c("p",tt," Insira um valor válido. ")):w("",!0)]),e("div",null,[C(ue,{text:"Valor"}),e("div",ot,[D(e("input",{"onUpdate:modelValue":b[2]||(b[2]=T=>x.value=T),placeholder:"R$ 0,00",onInput:a,class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},null,544),[[F,x.value]])])]),e("div",at,[C(Ne,{onClick:R},{default:A(()=>b[4]||(b[4]=[U("Adicionar")])),_:1})])],32)])):w("",!0)}},nt=V(rt,[["__scopeId","data-v-833469c3"]]),st={class:"flex gap-5"},it={key:0,class:"loading-overlay"},dt={class:"flex-1"},lt={class:"min-w-full table-auto"},ut=["onDblclick"],ct={class:"px-6 py-4 text-[16px] text-left text-gray-900 font-semibold"},ft={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-center"},pt=["onUpdate:modelValue"],vt={key:1},mt={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-left"},gt={key:0},xt=["onUpdate:modelValue"],_t={key:2},ht={class:"px-6 py-4 text-[16px] text-gray-500 text-center"},bt=["onUpdate:modelValue"],yt={key:1},$t={class:"px-6 py-4 text-center"},wt=["onClick"],kt={key:0,class:"botao-container"},qt={__name:"ResumoCarrinho",props:{carrinho:{type:Array,required:!0}},emits:["confirmar","cancelar"],setup(t,{emit:o}){const s=se(),d=t,l=o,g=_(!1),f=_(!1),v=_(null),x=a=>{d.carrinho.splice(a,1),s.info("Item removido com sucesso!")},u=a=>{v.value=a},p=a=>{const r=parseFloat(a.valor.replace("R$","").replace(/\./g,"").replace(",",".")),n=parseFloat(a.quantidade.replace(/\./g,"").replace(",","."));return n>0?r/n:0},m=a=>{const r=parseFloat(a.quantidade.replace(/\./g,"").replace(",","."));if(a.unidadeDeMedida==="a_granel"||a.unidadeDeMedida==="quilo")return p(a)*r||0;{const n=parseFloat(a.valor.replace("R$","").replace(/\./g,"").replace(",","."));return r*n}},S=async()=>{var a;g.value=!0,f.value=!0;try{const r={fornecedor_id:((a=d.carrinho[0])==null?void 0:a.fornecedor_id)||null,itens:d.carrinho.map(y=>{const k=parseFloat(y.quantidade.replace(/\./g,"").replace(",","."));let R=parseFloat(y.valor.replace("R$","").replace(/\./g,"").replace(",","."));R=R.toFixed(2);const P=parseFloat(m(y).toFixed(2));return console.log("Quantidade:",k),console.log("Valor Unitário:",R),console.log("Total:",P),{id:y.id,nome:y.nome,quantidade:k,unidadeDeMedida:y.unidadeDeMedida,valorUnitario:R,total:P}})};console.log("Dados enviados:",JSON.stringify(r,null,2));const n=await axios.post("/api/estoque/armazenar-entrada",r);n.status===201?(console.log("Resposta da API:",n.data),Be.Inertia.visit(route("franqueado.inventario")),s.success("Lista de insumos salvas em seu estoque.")):s.error("Erro ao salvar no estoque, tente novamente.")}catch(r){console.error("Erro ao enviar entrada:",r),s.error("Erro ao confirmar entrada. Tente novamente ou chame o suporte.")}finally{g.value=!1}},I=()=>{l("cancelar")};return(a,r)=>(i(),c("div",st,[g.value?(i(),c("div",it,r[0]||(r[0]=[e("div",{class:"spinner"},null,-1)]))):w("",!0),r[3]||(r[3]=e("div",{class:"flex-1"},[e("div",{class:"painel-title"},"Confirmar entrada"),e("div",{class:"painel-subtitle"},[e("p",null,"Vamos conferir se está tudo certo")]),e("div",{class:"mt-[25%] text-[#6d6d6d] text-[18px] font-normal font-['Figtree'] leading-[23px] tracking-tight"},[U(" Você confirma que está "),e("br"),U(" realizando uma nova entrada "),e("br"),U(" com os seguintes itens? ")])],-1)),e("div",dt,[e("table",lt,[r[2]||(r[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-xs text-left font-medium text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," Item "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," QTD. "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," V. UN/KG "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," TOTAL "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider TrRedonDireita"}," AÇÃO ")])],-1)),e("tbody",null,[(i(!0),c(E,null,O(t.carrinho,(n,y)=>(i(),c("tr",{key:n.id,onDblclick:k=>u(y)},[e("td",ct,h(n.nome),1),e("td",ft,[v.value===y?D((i(),c("input",{key:0,type:"number","onUpdate:modelValue":k=>n.quantidade=k,class:"border border-gray-300 rounded px-2 py-1 w-16"},null,8,pt)),[[F,n.quantidade,void 0,{number:!0}]]):(i(),c("span",vt,h(n.quantidade)+" "+h(n.unidadeDeMedida==="a_granel"?"KG":"UN"),1))]),e("td",mt,[n.unidadeDeMedida==="a_granel"?(i(),c("span",gt," R$ "+h(p(n).toFixed(2)),1)):v.value===y?D((i(),c("input",{key:1,type:"text","onUpdate:modelValue":k=>n.valor=k,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,xt)),[[F,n.valor]]):(i(),c("span",_t,h(n.valor),1))]),e("td",ht,[v.value===y&&n.unidadeDeMedida==="a_granel"?D((i(),c("input",{key:0,type:"number","onUpdate:modelValue":k=>n.valorTotal=k,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,bt)),[[F,n.valorTotal,void 0,{number:!0}]]):(i(),c("span",yt,h(m(n).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1))]),e("td",$t,[e("button",{onClick:k=>x(y),class:"w-[16] h-[16]"},r[1]||(r[1]=[e("img",{src:"/storage/images/delete.svg",alt:"icone de excluir",class:"w-[16px] h-[16px]"},null,-1)]),8,wt)])],40,ut))),128))])]),f.value?w("",!0):(i(),c("div",kt,[C(Ce,{text:"Voltar",onClick:I}),C(ie,{text:"Confirmar",onClick:S})]))])]))}},Tt=V(qt,[["__scopeId","data-v-9b3afc9f"]]),St={key:0},It={key:0,class:"sidebar-container"},Ct={key:0,class:"loading-overlay"},Rt={key:1,class:"flex"},Pt={class:"flex-1 p-4"},jt={class:"relative flex items-center w-full mb-4"},Dt={class:"space-y-4 compromissos-container overflow-hidden"},Et=["onClick"],Ft={class:"flex-shrink-0"},Ut=["src"],Vt={class:"ml-4 flex-1"},Mt={class:"text-lg font-semibold flex items-center"},Lt={key:0,class:"ml-5 text-xs bg-green-100 text-green-600 font-bold rounded-full px-2 py-1"},Ot={key:1,class:"mr-2 ml-5 text-yellow-500",title:"Essa estrela sigifinica que esse insumo e um produto princial"},Nt={class:"absolute bottom-4 right-4 mt-5 botao-container"},Bt={class:"flex-1 p-4"},At={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},setup(t){const o=_([]),s=_(""),d=_(!1),l=_(null),g=_([]),f=_(!1),v=()=>{console.log("Entrada confirmada",g.value),mostrarModalRevisao.value=!1,g.value=[]},x=async()=>{d.value=!0;try{const a=await Q.get("/api/produtos/lista");o.value=a.data}catch(a){console.error("Erro ao carregar os produtos:",a)}finally{d.value=!1}},u=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",p=a=>{l.value=a},m=a=>g.value.filter(r=>r.id===a).length,S=a=>{g.value.push(a),l.value=null},I=qe(()=>o.value.filter(a=>a.nome.toLowerCase().includes(s.value.toLowerCase())));return Ue(x),(a,r)=>(i(),c(E,null,[C(Se,{name:"fade"},{default:A(()=>[f.value?w("",!0):(i(),c("div",St,[t.isVisible?(i(),c("div",It,[d.value?(i(),c("div",Ct,r[3]||(r[3]=[e("div",{class:"spinner"},null,-1)]))):(i(),c("div",Rt,[e("div",Pt,[r[5]||(r[5]=e("div",{class:"painel-title"},"Nova entrada",-1)),r[6]||(r[6]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",jt,[r[4]||(r[4]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),D(e("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=n=>s.value=n),placeholder:"Buscar um produto",class:"pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[F,s.value]])]),e("div",Dt,[(i(!0),c(E,null,O(I.value,n=>(i(),c("div",{key:n.id,class:"flex items-center p-4 bg-white rounded-lg cursor-pointer",onClick:y=>p(n)},[e("div",Ft,[e("img",{src:u(n.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,Ut)]),e("div",Vt,[e("div",Mt,[U(h(n.nome)+" ",1),m(n.id)>0?(i(),c("span",Lt,h(m(n.id)),1)):w("",!0),n.estrela?(i(),c("span",Ot," ★ ")):w("",!0)])])],8,Et))),128))])]),e("div",Nt,[C(ie,{text:"Finalizar",onClick:r[1]||(r[1]=n=>f.value=!0),iconPath:"/storage/images/arrow_left_alt.svg"})]),e("div",Bt,[C(nt,{produtoSelecionado:l.value,onAdicionarAoCarrinho:S},null,8,["produtoSelecionado"])])]))])):w("",!0)]))]),_:1}),f.value?(i(),L(Tt,{key:0,carrinho:g.value,onConfirmar:v,onCancelar:r[2]||(r[2]=n=>f.value=!1)},null,8,["carrinho"])):w("",!0)],64))}},Qt=V(At,[["__scopeId","data-v-ded827eb"]]);var z,ce;function Re(){if(ce)return z;ce=1;function t(o){var s=typeof o;return o!=null&&(s=="object"||s=="function")}return z=t,z}var K,fe;function Gt(){if(fe)return K;fe=1;var t=typeof B=="object"&&B&&B.Object===Object&&B;return K=t,K}var W,pe;function Pe(){if(pe)return W;pe=1;var t=Gt(),o=typeof self=="object"&&self&&self.Object===Object&&self,s=t||o||Function("return this")();return W=s,W}var H,ve;function zt(){if(ve)return H;ve=1;var t=Pe(),o=function(){return t.Date.now()};return H=o,H}var J,me;function Kt(){if(me)return J;me=1;var t=/\s/;function o(s){for(var d=s.length;d--&&t.test(s.charAt(d)););return d}return J=o,J}var X,ge;function Wt(){if(ge)return X;ge=1;var t=Kt(),o=/^\s+/;function s(d){return d&&d.slice(0,t(d)+1).replace(o,"")}return X=s,X}var Z,xe;function je(){if(xe)return Z;xe=1;var t=Pe(),o=t.Symbol;return Z=o,Z}var Y,_e;function Ht(){if(_e)return Y;_e=1;var t=je(),o=Object.prototype,s=o.hasOwnProperty,d=o.toString,l=t?t.toStringTag:void 0;function g(f){var v=s.call(f,l),x=f[l];try{f[l]=void 0;var u=!0}catch{}var p=d.call(f);return u&&(v?f[l]=x:delete f[l]),p}return Y=g,Y}var ee,he;function Jt(){if(he)return ee;he=1;var t=Object.prototype,o=t.toString;function s(d){return o.call(d)}return ee=s,ee}var te,be;function Xt(){if(be)return te;be=1;var t=je(),o=Ht(),s=Jt(),d="[object Null]",l="[object Undefined]",g=t?t.toStringTag:void 0;function f(v){return v==null?v===void 0?l:d:g&&g in Object(v)?o(v):s(v)}return te=f,te}var oe,ye;function Zt(){if(ye)return oe;ye=1;function t(o){return o!=null&&typeof o=="object"}return oe=t,oe}var ae,$e;function Yt(){if($e)return ae;$e=1;var t=Xt(),o=Zt(),s="[object Symbol]";function d(l){return typeof l=="symbol"||o(l)&&t(l)==s}return ae=d,ae}var re,we;function eo(){if(we)return re;we=1;var t=Wt(),o=Re(),s=Yt(),d=NaN,l=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,f=/^0o[0-7]+$/i,v=parseInt;function x(u){if(typeof u=="number")return u;if(s(u))return d;if(o(u)){var p=typeof u.valueOf=="function"?u.valueOf():u;u=o(p)?p+"":p}if(typeof u!="string")return u===0?u:+u;u=t(u);var m=g.test(u);return m||f.test(u)?v(u.slice(2),m?2:8):l.test(u)?d:+u}return re=x,re}var ne,ke;function to(){if(ke)return ne;ke=1;var t=Re(),o=zt(),s=eo(),d="Expected a function",l=Math.max,g=Math.min;function f(v,x,u){var p,m,S,I,a,r,n=0,y=!1,k=!1,R=!0;if(typeof v!="function")throw new TypeError(d);x=s(x)||0,t(u)&&(y=!!u.leading,k="maxWait"in u,S=k?l(s(u.maxWait)||0,x):S,R="trailing"in u?!!u.trailing:R);function P($){var j=p,N=m;return p=m=void 0,n=$,I=v.apply(N,j),I}function q($){return n=$,a=setTimeout(M,x),y?P($):I}function b($){var j=$-r,N=$-n,le=x-j;return k?g(le,S-N):le}function T($){var j=$-r,N=$-n;return r===void 0||j>=x||j<0||k&&N>=S}function M(){var $=o();if(T($))return de($);a=setTimeout(M,b($))}function de($){return a=void 0,R&&p?P($):(p=m=void 0,I)}function De(){a!==void 0&&clearTimeout(a),n=0,p=r=m=a=void 0}function Ee(){return a===void 0?I:de(o())}function G(){var $=o(),j=T($);if(p=arguments,m=this,r=$,j){if(a===void 0)return q(r);if(k)return clearTimeout(a),a=setTimeout(M,x),P(r)}return a===void 0&&(a=setTimeout(M,x)),I}return G.cancel=De,G.flush=Ee,G}return ne=f,ne}var oo=to();const ao=Ve(oo),ro={key:0,class:"sidebar-container"},no={key:0,class:"loading-overlay"},so={key:1},io={class:"w-full h-[80%] bg-white rounded-[20px] p-12"},lo={class:"relative w-full h-full"},uo={class:"flex items-center"},co={class:"w-1/1 flex justify-center"},fo=["src"],po={class:"w-2/3 pl-5"},vo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},mo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},go={class:"mt-5"},xo={class:"min-w-full table-auto"},_o={class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonDireita"},ho={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},bo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},yo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},$o=["onUpdate:modelValue","onInput"],wo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},ko={class:"flex justify-left mt-12"},qo={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(t,{emit:o}){const s=se(),d=t,l=o,g=_(""),f=_(""),v=_(!1),x=_(!1),u=_("");Me(()=>d.produto,a=>{a&&(g.value=a.nome||"",f.value=a.categoria||"")},{immediate:!0});const p=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",m=ao(a=>{Q.put(`/api/estoque/estoque/lote/${a.id}`,{quantidade:a.quantidade}).then(r=>{s.success("Quantidade do lote atualizada!")}).catch(r=>{s.error("Erro ao atualizar o lote.")})},1e3),S=a=>{u.value=a,x.value=!0},I=()=>{l("cancelar")};return(a,r)=>(i(),L(Se,{name:"fade"},{default:A(()=>[t.isVisible?(i(),c("div",ro,[v.value?(i(),c("div",no,r[1]||(r[1]=[e("div",{class:"spinner"},null,-1)]))):(i(),c("div",so,[e("div",io,[e("div",lo,[e("div",uo,[e("div",co,[e("img",{src:p(t.produto.profile_photo),alt:"Foto do Produto",class:"w-20 h-20 rounded-md shadow-lg"},null,8,fo)]),e("div",po,[e("div",vo,[U(h(t.produto.nome||"N/A")+" ",1),e("div",mo,h(t.produto.unidadeDeMedida==="a_granel"&&t.produto.valor_pago_por_quilo_lote?t.produto.valor_pago_por_quilo_lote:t.produto.valor_total_lote),1)])])])])]),e("form",{onSubmit:r[0]||(r[0]=Te(n=>S("Atualizar este produto?"),["prevent"]))},[e("div",go,[e("table",xo,[e("thead",null,[e("tr",null,[r[2]||(r[2]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),r[3]||(r[3]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," Fornecedor ",-1)),r[4]||(r[4]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," qtd ",-1)),e("th",_o,h(t.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1)])]),e("tbody",null,[(i(!0),c(E,null,O(t.produto.lotes,n=>(i(),c("tr",{key:n.id},[e("td",ho,h(n.data),1),e("td",bo,h(n.fornecedor),1),e("td",yo,[D(e("input",{"onUpdate:modelValue":y=>n.quantidade=y,type:"number",min:"0",class:"border rounded-lg px-2 py-1 w-[75px] h-[32px] text-center",onInput:y=>Ie(m)(n)},null,40,$o),[[F,n.quantidade]])]),e("td",wo,h(n.preco_unitario),1)]))),128))])])]),e("div",ko,[C(Ce,{text:"Voltar",onClick:I})])],32)]))])):w("",!0)]),_:1}))}},To=V(qo,[["__scopeId","data-v-9ad6d994"]]),So={class:"elemento-fixo"},Io={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Co={class:"relative w-full h-full"},Ro={class:"flex items-center"},Po={class:"w-1/1 flex justify-center"},jo=["src"],Do={class:"w-2/3 pl-5"},Eo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Fo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},Uo={key:1,class:""},Vo={class:"mt-8"},Mo={class:"min-w-full table-auto"},Lo={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Oo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},No={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Bo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ao={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Qo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Go={key:0,class:"mt-4"},zo={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},emits:["atualizar"],setup(t,{emit:o}){const s=o,d=_(!1),l=_(!1),g=()=>{_.dadosProduto.fetchProduto()},f=u=>u?new URL(u,window.location.origin).href:"/storage/images/no_imagem.svg",v=()=>{l.value=!l.value,d.value=!1},x=()=>{s("atualizar"),l.value=!1,d.value=!0};return(u,p)=>(i(),c("div",So,[l.value?w("",!0):(i(),c("div",Io,[e("div",Co,[e("div",Ro,[e("div",Po,[e("img",{src:f(t.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,jo)]),e("div",Do,[e("div",Eo,[U(h(t.produto.nome||"N/A")+" ",1),e("div",Fo,h(t.produto.unidadeDeMedida==="a_granel"&&t.produto.valor_pago_por_quilo_lote?t.produto.valor_pago_por_quilo_lote:t.produto.valor_total_lote),1)])])])])])),l.value?w("",!0):(i(),c("div",Uo,[e("div",Vo,[e("table",Mo,[e("thead",null,[e("tr",null,[p[0]||(p[0]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),p[1]||(p[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),p[2]||(p[2]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),e("th",Lo,h(t.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),p[3]||(p[3]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),e("tbody",null,[(i(!0),c(E,null,O(t.produto.lotes,(m,S)=>(i(),c("tr",{key:S,class:"text-center"},[e("td",Oo,h(m.data),1),e("td",No,h(m.fornecedor),1),e("td",Bo,h(m.quantidade)+" "+h(t.produto.unidadeDeMedida==="unitario"?"uni":"kg"),1),e("td",Ao,h(t.produto.unidadeDeMedida==="unitario"?m.preco_unitario:m.valor_pago_por_quilo),1),e("td",Qo,h(t.produto.unidadeDeMedida==="unitario"?m.valor_total:m.preco_unitario),1)]))),128))])])]),t.produto.id&&!l.value?(i(),c("div",Go,[C(Ae,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:v,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):w("",!0)])),l.value?(i(),L(To,{key:2,ref:"dadosProduto",isVisible:l.value,produto:t.produto,onDadosProduto:g,onCancelar:x},null,8,["isVisible","produto"])):w("",!0)]))}},Ko=V(zo,[["__scopeId","data-v-1594529a"]]),Wo={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const t=await Q.get("/api/estoque/lista");console.log("Produtos carregados:",t.data),this.produtos=Object.values(t.data)}catch(t){console.error("Erro ao carregar os itens:",t)}},getProfilePhotoUrl(t){return t?new URL(t,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(t){this.$emit("produto-selecionado",t)},arredondarQuantidade(t,o){const s=o==="a_granel"?3:0;return parseFloat(t).toFixed(s)},getQuantidadeTotal(t){var s;if(!Array.isArray(t))return console.warn("getQuantidadeTotal recebeu um valor inválido:",t),0;const o=t.reduce((d,l)=>d+(l.quantidade||0),0);return this.arredondarQuantidade(o,((s=t[0])==null?void 0:s.unidadeDeMedida)||"unitario")}},computed:{filteredProdutos(){const t=this.searchQuery.toLowerCase();return this.produtos.filter(o=>o.nome.toLowerCase().includes(t))}}},Ho={class:"search-container relative flex items-center w-full mb-4"},Jo={class:"card-container compromissos-container overflow-hidden"},Xo=["onClick"],Zo={class:"card-inner"},Yo={class:"icon-container"},ea={class:"icon-leaf"},ta=["src"],oa={class:"text-container flex justify-between items-center p-2"},aa={class:"city"},ra={class:"quantidade text-gray-600 font-semibold"},na={class:"text-gray-600 font-semibold"};function sa(t,o,s,d,l,g){return i(),c("div",null,[o[3]||(o[3]=e("div",{class:"painel-title"},"Inventário da loja",-1)),o[4]||(o[4]=e("div",{class:"painel-subtitle"},[e("p",null,"Verifique a quantidade de cada item")],-1)),e("div",Ho,[o[1]||(o[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),D(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=f=>l.searchQuery=f),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[F,l.searchQuery]])]),e("div",Jo,[(i(!0),c(E,null,O(g.filteredProdutos,f=>(i(),c("div",{key:f.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:v=>g.selecionarProduto(f)},[e("div",Zo,[e("div",Yo,[o[2]||(o[2]=e("div",{class:"icon-bg"},null,-1)),e("div",ea,[e("img",{src:g.getProfilePhotoUrl(f.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,ta)])]),e("div",oa,[e("div",aa,h(f.nome),1),e("div",ra,[e("div",na,h(g.getQuantidadeTotal(f.lotes))+" "+h(f.unidadeDeMedida==="unitario"?"uni":"kg"),1)])])])],8,Xo))),128))])])}const ia=V(Wo,[["render",sa],["__scopeId","data-v-def1a5f5"]]),da={key:0,class:"mt-6"},la={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},ua={key:0},ca={class:"flex flex-col gap-4"},fa={key:1,class:"absolute bottom-4 right-4 botao-container"},pa={__name:"Index",setup(t){const o=_(null),s=_(0),d=_(!1),l=_(!1),g=()=>{d.value=!d.value},f=()=>{console.log("atualizando a lista"),o.value=null,s.value+=1},v=()=>{x(),d.value=!1},x=()=>{var m;(m=_("listarUnidades").value)==null||m.fetchUnidades()},u=p=>{p&&typeof p=="object"?o.value=p:console.warn("Dados inválidos recebidos no evento produto-selecionado:",p)};return(p,m)=>(i(),L(Qe,null,{default:A(()=>[C(Ie(Le),{title:"Insumos"}),d.value?(i(),c("div",da,[C(Qt,{isVisible:d.value,onUnidadeCadastrada:v,onCancelar:g},null,8,["isVisible"])])):w("",!0),e("div",la,[d.value?w("",!0):(i(),c("div",ua,[(i(),L(ia,{key:s.value,ref:"listarUnidades",onUnidadeCadastrada:x,onProdutoSelecionado:u}))])),e("div",ca,[d.value?w("",!0):(i(),c(E,{key:0},[o.value?(i(),L(Ko,{key:0,onAtualizar:f,produto:o.value},null,8,["produto"])):w("",!0),l.value?w("",!0):(i(),c("div",fa,[C(ie,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:g})]))],64))])])]),_:1}))}},qa=V(pa,[["__scopeId","data-v-65e679f0"]]);export{qa as default};
