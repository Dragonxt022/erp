import{d as o,i as E,o as f,e as g,a as t,t as d,h as S,F as j,g as O,n as R,y as V,c as B,w as L,b as q,u as P,Z as z}from"./app-B1Pp_VbU.js";import{d as N}from"./index-KqOtBGFk.js";import{C as A,r as T}from"./chart-C6b6o4TJ.js";import{L as Q}from"./LayoutFranqueado-Drzqp7ys.js";import{d as h}from"./dayjs.min-DnwOmqqd.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-BDVn5jSh.js";const W={class:"relative"},Z={key:0},K={key:0,class:"absolute z-10 bg-white border rounded-xl shadow-lg w-[300px] p-4 left-[68px] transform -translate-x-1/2"},G={class:"flex justify-between items-center mb-3"},H={class:"font-semibold flex items-center"},J={class:"ml-[90px]"},X={class:"grid grid-cols-7 gap-1 text-center text-sm"},tt=["onClick"],et={__name:"CalendarFilterDiaPainel",setup(I,{emit:_}){const v=_,p=o(!1),i=o(h().startOf("month")),r=o(h().endOf("month")),x=o(h()),M=["D","S","T","Q","Q","S","S"],Y=E(()=>{const s=[],c=x.value.startOf("month"),n=x.value.endOf("month");for(let u=0;u<c.day();u++)s.push({day:"",date:null});for(let u=1;u<=n.date();u++){const b=c.date(u);s.push({day:u,date:b})}return s}),y=s=>s&&(s.isSame(i.value)||s.isSame(r.value)),w=s=>!s||!i.value||!r.value?!1:s.isAfter(i.value,"day")&&s.isBefore(r.value,"day")||s.isSame(i.value,"day")||s.isSame(r.value,"day"),k=s=>{s&&(i.value.isAfter(r.value)?i.value=s.startOf("day"):r.value=s.endOf("day"))},D=()=>{C(),p.value=!1},$=()=>{p.value=!p.value},F=()=>{const s=i.value.format("DD-MM-YYYY"),c=r.value.format("DD-MM-YYYY");console.log("Data inicial:",s),console.log("Data final:",c),v("update-filters",{startDate:s,endDate:c}),p.value=!1},C=()=>{i.value=h().startOf(""),r.value=h().endOf("")};return(s,c)=>(f(),g("div",W,[t("div",{class:"flex items-center justify-between p-3 rounded-md cursor-pointer",onClick:$},[t("span",null,[i.value&&r.value?(f(),g("span",Z,d(i.value.format("DD/MM/YYYY"))+" - "+d(r.value.format("DD/MM/YYYY")),1)):S("",!0)])]),p.value?(f(),g("div",K,[t("div",G,[t("button",{onClick:c[0]||(c[0]=(...n)=>s.prevMonth&&s.prevMonth(...n)),class:"p-2 rounded hover:bg-gray-300"}," < "),t("span",H,[t("span",null,d(x.value.format("MMM")),1),t("span",J,d(x.value.format("YYYY")),1)]),t("button",{onClick:c[1]||(c[1]=(...n)=>s.nextMonth&&s.nextMonth(...n)),class:"p-2 rounded hover:bg-gray-300"}," > ")]),t("div",X,[(f(),g(j,null,O(M,n=>t("div",{class:"font-semibold text-gray-600",key:n},d(n),1)),64)),(f(!0),g(j,null,O(Y.value,(n,u)=>(f(),g("div",{key:u,onClick:b=>k(n.date),class:R(["p-2 rounded-full cursor-pointer",y(n.date)?"bg-[#6db631] text-white":w(n.date)?"bg-[#b3dca6]":"hover:bg-gray-200"])},d(n.day),11,tt))),128))]),t("div",{class:"w-full mt-4 flex justify-between items-center"},[t("div",{class:"h-10 rounded-full flex justify-center items-center px-3 py-2.5 cursor-pointer text-[#6db631] text-[15px] font-semibold font-['Figtree'] leading-tight",onClick:C}," Limpar "),t("div",{class:"flex gap-2"},[t("div",{class:"h-10 rounded-full flex justify-center items-center px-3 py-2.5 cursor-pointer text-[#6db631] text-[15px] font-semibold font-['Figtree'] leading-tight",onClick:D}," Cancelar "),t("div",{class:"h-10 rounded-full flex justify-center items-center px-3 py-2.5 cursor-pointer text-[#6db631] text-[15px] font-semibold font-['Figtree'] leading-tight",onClick:F}," OK ")])])])):S("",!0)]))}},st={class:"flex justify-between items-center mb-4"},at={class:"text-[#262a27] text-[15px] font-semibold font-['Figtree'] leading-tight"},ot={class:"flex items-center space-x-2"},nt={class:"text-gray-900 text-[17px] font-semibold"},lt={class:"mt-5"},it={class:"grid grid-cols-3 grid-rows-1 gap-4"},rt={class:"row-span-3"},dt={class:"bg-white rounded-lg p-5"},ct={class:"compromissos-container flex flex-col gap-2 overflow-hidden"},ut={class:"flex flex-col"},ft={class:"text-[14px] font-medium text-gray-900"},pt={class:"text-sm text-gray-600"},mt=["src","alt"],gt={class:"bg-white rounded-lg p-7"},xt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},vt={class:"bg-white rounded-lg p-7"},bt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},ht={class:"bg-white rounded-lg p-7"},_t={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},yt={class:"bg-white rounded-lg p-4"},wt={class:"text-[#262a27] text-[40px] font-bold font-['Figtree'] leading-[48px] tracking-wide"},kt={class:"bg-white rounded-lg p-4 col-span-3"},Dt={class:"w-full h-[220px]"},Ft={__name:"Index",setup(I){A.register(...T);const _=o(null),v=o(null),p=o([]),i=o([]),r=o([]),x=o("0,00"),M=o("0,00"),Y=o("0,00"),y=o("0,00"),w=o("0,00"),k=o(0),D=o("0,00"),$=()=>{N.Inertia.replace(route("franqueado.contasApagar"))},F=async(a="01-01-2025",e="31-01-2025")=>{try{const m=(await axios.get(`/api/painel-analitycos/calcular-cmv-caixas-tickets?start_date=${a}&end_date=${e}`)).data;m.saldo_estoque_inicial?(x.value=m.saldo_estoque_inicial||"0,00",M.value=m.entradas_durante_periodo||"0,00",Y.value=m.saldo_estoque_final||"0,00",y.value=m.cmv||"0,00",w.value=m.total_caixas||"0,00",k.value=m.quantidade_pedidos||0,D.value=m.ticket_medio||"0,00",b()):console.warn("Dados analíticos não encontrados.")}catch(l){console.error("Erro ao buscar dados analíticos:",l)}};V(()=>{F(),c(),s()});const C=a=>{console.log("Filtros atualizados:",a);const{startDate:e,endDate:l}=a;F(e,l)},s=async()=>{try{const a=await axios.get("/api/cursto/listar-contas-a-pagar");r.value=a.data.data}catch(a){console.error("Erro ao carregar os dados:",a)}},c=async()=>{try{const e=(await axios.get("/api/painel-analitycos/faturamento-por-semana")).data;e.faturamento&&(i.value=e.faturamento.map(l=>l.dia),p.value=e.faturamento.map(l=>l.total),b())}catch(a){console.error("Erro ao buscar dados:",a)}},n=a=>{const e=a.split("-");return`${e[2]}/${e[1]}/${e[0]}`},u=a=>a==="pendente"?"/storage/images/check_circle_laranja.svg":"/storage/images/check_circle_verde.svg",b=()=>{v.value&&v.value.destroy(),v.value=new A(_.value.getContext("2d"),{type:"bar",data:{labels:i.value,datasets:[{label:"Faturamento Diário",data:p.value,backgroundColor:"rgba(75, 192, 75, 0.6)",borderColor:"rgba(75, 192, 75, 1)",borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return a>=1e3?`${a/1e3}mil`:a}}}}}})};return(a,e)=>(f(),B(Q,null,{default:L(()=>[q(P(z),{title:"Painel"}),t("div",st,[e[1]||(e[1]=t("div",null,[t("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Visão geral da loja "),t("div",{class:"painel-subtitle"},[t("p",{class:"text-sm sm:text-base md:text-lg"}," Acompanhe o desempenho geral ")])],-1)),t("div",at,[t("div",ot,[e[0]||(e[0]=t("img",{src:"/storage/images/calendar_month.svg",alt:"Filtro",class:"w-5 h-5"},null,-1)),t("span",nt,[q(et,{onUpdateFilters:C})])])])]),t("div",lt,[t("div",it,[t("div",rt,[t("div",dt,[e[2]||(e[2]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-2"}," Compromissos ",-1)),t("div",ct,[(f(!0),g(j,null,O(r.value,l=>(f(),g("div",{key:l.id,onClick:$,class:"flex justify-between items-center bg-[#F5FAF4] p-3 rounded-lg cursor-pointer hover:bg-gray-100 transition-all ease-in-out duration-300"},[t("div",ut,[t("p",ft,d(l.nome),1),t("p",pt,d(l.valor_formatado)+" - Vencimento "+d(n(l.vencimento)),1)]),t("div",null,[t("img",{src:u(l.status),alt:"Status: "+l.status,class:"w-6 h-6 object-contain transition-transform transform hover:scale-105"},null,8,mt)])]))),128))])])]),t("div",gt,[e[3]||(e[3]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Faturamento",-1)),t("div",xt," R$ "+d(w.value),1),e[4]||(e[4]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",vt,[e[5]||(e[5]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"CMV",-1)),t("div",bt," R$ "+d(y.value),1),e[6]||(e[6]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",ht,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Ticket médio",-1)),t("div",_t," R$ "+d(D.value),1),e[8]||(e[8]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",yt,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Pedidos",-1)),t("div",wt,d(k.value),1),e[10]||(e[10]=t("div",{class:"flex items-center gap-2 mt-[35px]"},[t("div",{class:"w-6 h-6 rounded-full flex items-center justify-center"}),t("div",{class:"text-[#6d6d6d] text-[13px] font-semibold font-['Figtree'] leading-[18px]"}," 0% coletando dados ")],-1))]),t("div",kt,[e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-700"}," Faturamento diário ",-1)),t("div",Dt,[t("canvas",{ref_key:"barChart",ref:_},null,512)])])])])]),_:1}))}},qt=U(Ft,[["__scopeId","data-v-a31c83d1"]]);export{qt as default};
