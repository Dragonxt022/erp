import{d,i as F,e as x,o as u,a as t,t as h,j as I,b as f,m as O,v as N,F as q,h as A,n as U,k as w,l as G,q as T,f as Y,c as B,w as K,u as P,Z as Q}from"./app-CDrHeR1e.js";import{L as R}from"./LayoutFranqueado-zTVo2cjs.js";import{d as M}from"./dayjs.min-BJaMSz6C.js";import"./pt-br-BSScv65H.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as V}from"./LabelModel-D08k5p4W.js";import{B as z}from"./ButtonClaroMedio-BzL16fNP.js";import{C as L}from"./ConfirmDialog-BdhcLRJx.js";import"./chartjs-plugin-datalabels.esm-CN4o7d8M.js";import"./chart-BPiUEDub.js";const Z={class:"flex items-center space-x-2"},J={class:"font-semibold text-gray-900 text-[17px]"},W={__name:"CalendarFilterHistorico",emits:["update-filters"],setup(_,{emit:y}){M.locale("pt-br");const i=y,e=d(M().subtract(1,"month")),p=()=>{e.value=e.value.subtract(1,"month"),m()},b=()=>{e.value.add(1,"month").isBefore(M().startOf("month"))&&(e.value=e.value.add(1,"month"),m())},m=()=>{const v=e.value.startOf("month").format("DD-MM-YYYY"),n=e.value.endOf("month").format("DD-MM-YYYY");i("update-filters",{startDate:v,endDate:n})};return F(()=>{m()}),(v,n)=>(u(),x("div",Z,[t("button",{onClick:p,class:"text-indigo-600 hover:underline"},n[0]||(n[0]=[t("img",{src:"/storage/images/arrow_drop_down_circle.svg",alt:"icone drop",class:"w-5 h-5"},null,-1)])),t("span",J,h(e.value.format("MMMM YYYY")),1),t("button",{onClick:b,class:"text-indigo-600 hover:underline"},n[1]||(n[1]=[t("img",{src:"/storage/images/arrow_drop_direita_circle.svg",alt:"icone drop",class:"w-5 h-5"},null,-1)]))]))}},X={class:"painel-subtitle"},tt={class:"absolute end-4 top-1 justify-end items-center"},et={class:"text-[#262a27] text-[15px] font-semibold"},at={class:"flex items-center space-x-2 justify-end"},st={class:"search-container relative flex items-center w-full mb-4"},ot={class:"text-lg font-semibold text-gray-800 mb-2"},nt=["onClick"],rt={class:"text-lg font-medium text-gray-900"},it={class:"text-sm text-gray-600"},lt={class:"flex items-center gap-2"},dt=["src","alt"],ct={__name:"ListarContasApagarHistorico",emits:["dado-selecionado"],setup(_,{emit:y}){const i=y,e=d([]),p=d(""),b=d(!1),m=o=>{v(o.startDate,o.endDate)},v=async(o=null,a=null)=>{try{const c=await w.get("/api/cursto/contas-a-pagar/historico",{params:{start_date:o,end_date:a}});e.value=c.data.data}catch(c){console.error("Erro ao carregar os dados:",c)}};F(v);const n=o=>{i("dado-selecionado",o)},g=I(()=>{const o=p.value.toLowerCase();return e.value.map(a=>{const c=a.contas.filter(l=>l.nome.toLowerCase().includes(o)||String(l.valor).includes(o));return{...a,contas:c}}).filter(a=>a.contas.length>0)}),C=o=>{const a=o.split("-");return`${a[2]}/${a[1]}/${a[0]}`},$={pendente:"/storage/images/check_circle_laranja.svg",pago:"/storage/images/check_circle_verde.svg",agendada:"/storage/images/agendada.svg",atrasado:"/storage/images/atrasada.svg"},D=o=>$[o]||"/storage/images/check_circle_laranja.svg",k={pendente:"bg-orange-100 text-orange-700",pago:"bg-green-100 text-green-700",agendada:"bg-blue-100 text-blue-700",atrasado:"bg-red-100 text-red-700"},E=o=>k[o.toLowerCase()]||"bg-gray-100 text-gray-700";return(o,a)=>(u(),x("div",null,[a[4]||(a[4]=t("div",{class:"painel-title"},"Histórico contas",-1)),t("div",X,[a[2]||(a[2]=t("p",null,"Relatório de contas a pagar",-1)),t("div",tt,[t("button",{onClick:a[0]||(a[0]=c=>b.value=!0),class:"mr-2"}),t("div",et,[t("div",at,[f(W,{onUpdateFilters:m})])])])]),t("div",st,[a[3]||(a[3]=t("div",{class:"absolute left-3"},[t("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),O(t("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=c=>p.value=c),placeholder:"Buscar contas",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[N,p.value]])]),(u(!0),x(q,null,A(g.value,c=>(u(),x("div",{key:c.label,class:"mb-6"},[t("div",ot,h(c.label),1),(u(!0),x(q,null,A(c.contas,l=>(u(),x("div",{key:l.id,onClick:j=>n(l),class:"flex justify-between items-center bg-white p-4 rounded-lg cursor-pointer hover:bg-gray-100 transition mt-3"},[t("div",null,[t("p",rt,h(l.nome),1),t("p",it,h(l.valor_formatado)+" - Vence em "+h(C(l.vencimento)),1)]),t("div",lt,[t("span",{class:U(["px-2 py-1 text-xs font-semibold rounded-full capitalize",E(l.status)])},h(l.status),3),t("img",{src:D(l.status),alt:l.status,class:"w-8 h-8"},null,8,dt)])],8,nt))),128))]))),128))]))}},ut=S(ct,[["__scopeId","data-v-20d11faf"]]),mt={class:"elemento-fixo"},gt={key:0},pt={class:"mt-8"},vt={class:"w-full h-[555px] bg-white rounded-[20px] p-7 relative"},ft={class:"flex justify-between items-center"},xt={class:"text-[25px] font-bold font-['Figtree'] leading-8 tracking-tight"},_t={class:"text-[#6db631] text-xl font-normal font-['Figtree'] leading-[25px] tracking-tight"},bt={class:"col-span-1 row-span-2 mt-8"},ht={class:"col-span-1 row-span-2 mt-8"},yt={class:"text-[#262a27] text-[12px] font-bold leading-[48px] tracking-wide"},Ct=["value"],wt=["value"],$t={class:"w-full h-[100px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] px-2 py-1 text-[14px] outline-none resize-none focus:ring-2 focus:ring-green-500"},Dt={class:"flex space-x-4 mt-5"},kt={__name:"DetalhesContasApagarHistorico",props:{dados:{type:Object,required:!0}},emits:["voltar","atualiza"],setup(_,{emit:y}){const i=G(),e=_,p=y,b=d([]),m=d(e.dados.status),v=d(!1);d(null);const n=d(!1),g=d(!1),C=d(""),$=s=>{C.value=s,g.value=!0};T(()=>e.dados.status,s=>{m.value=s});const D=()=>{n.value=!1,a()},k=()=>{n.value=!1},E=()=>{g.value=!1,c()},o=()=>{g.value=!1},a=async()=>{if(!e.dados||!e.dados.id){i.error("Erro: Dados da conta não encontrados.");return}try{const s=await w.post(`/api/cursto/contas-a-pagar/${e.dados.id}/pagar`);i.success(s.data.message),e.dados.status="pago",p("atualiza")}catch(s){console.error("Erro ao pagar a conta:",s),i.error("Erro ao pagar a conta")}},c=async s=>{if(!e.dados||!e.dados.id){i.error("Erro: Dados da conta não encontrados.");return}try{const r=await w.delete(`/api/cursto/contas-a-pagar/${e.dados.id}`);i.success("Conta excluída com sucesso"),p("voltar")}catch(r){console.error("Erro ao excluir a conta:",r)}},l=s=>{if(!s)return"";const r=s.split("-");return`${r[2]}/${r[1]}/${r[0]}`},j=()=>{if(e.dados.arquivo){const s=document.createElement("a");s.href=`/${e.dados.arquivo}`,s.download=e.dados.arquivo.split("/").pop(),s.target="_blank",s.click(),i.info("Arquivo baixado com sucesso")}else i.warning("Arquivo não encontrado"),console.error("Arquivo não encontrado")};return F(async()=>{try{const s=await w.get("/api/cursto/contas-a-pagar/status-options");b.value=s.data.data,b.value.includes(m.value)||b.value.push(m.value)}catch(s){console.error("Erro ao carregar opções de status:",s)}}),(s,r)=>(u(),x(q,null,[t("div",mt,[v.value?Y("",!0):(u(),x("div",gt,[t("div",pt,[t("div",vt,[t("div",ft,[t("p",xt,h(_.dados.nome),1),t("button",{class:"text-gray-500 hover:text-red-600",onClick:r[0]||(r[0]=H=>$("Excluir essa conta?"))},r[2]||(r[2]=[t("img",{src:"/storage/images/delete.svg",alt:"Excluir",class:"w-6 h-6"},null,-1)]))]),t("p",_t,h(_.dados.valor_formatado),1),r[4]||(r[4]=t("p",{class:"text-[#6d6d6d] text-[15px] font-medium font-['Figtree'] leading-[20px]"},null,-1)),t("div",bt,[t("div",ht,[t("div",yt,[f(V,{text:"Data emitida"}),t("input",{type:"text",id:"emitida_em",value:l(_.dados.emitida_em),name:"emitida_em",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500",readonly:""},null,8,Ct),r[3]||(r[3]=t("div",{class:"mt-12"},null,-1)),f(V,{text:"Data de vencimento"}),t("input",{type:"text",id:"vencimento",name:"vencimento",value:l(_.dados.vencimento),class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500",readonly:""},null,8,wt)])]),f(V,{text:"Informações adicionais"}),t("p",$t,h(_.dados.descricao),1)]),t("div",Dt,[f(z,{text:"Voltar",onClick:r[1]||(r[1]=H=>s.$emit("voltar")),class:"text-[#6db631] bg-[#f4faf4] hover:bg-[#c1fab6] transition duration-200 ease-in-out"}),f(z,{text:"Baixar boleto",class:"text-[#6db631] bg-[#f4faf4] hover:bg-[#c1fab6] transition duration-200 ease-in-out",onClick:j})])])])]))]),f(L,{isVisible:n.value,motivo:C.value,onConfirm:D,onCancel:k},null,8,["isVisible","motivo"]),f(L,{isVisible:g.value,motivo:C.value,onConfirm:E,onCancel:o},null,8,["isVisible","motivo"])],64))}},Et=S(kt,[["__scopeId","data-v-33340737"]]),Mt={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mt-3 h-full"},Vt={key:0},It={__name:"Historico",setup(_){const y=d(0),i=d(null),e=d(!1),p=d([]),b=n=>{p.value=n.map(g=>({categoria:g.label,valor:g.total,valor_formatado:g.total_formatado}))},m=n=>{i.value=n},v=()=>{i.value=null,y.value+=1};return(n,g)=>(u(),B(R,null,{default:K(()=>[f(P(Q),{title:"Painel"}),e.value?Y("",!0):(u(),x("div",Mt,[(u(),B(ut,{key:y.value,ref:"listaDados",onDadoSelecionado:m,onDadosCarregados:b})),i.value?(u(),x("div",Vt,[f(Et,{dados:i.value,onVoltar:v,onAtualiza:v},null,8,["dados"])])):Y("",!0)]))]),_:1}))}};export{It as default};
