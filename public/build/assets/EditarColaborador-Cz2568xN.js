import{l as Y,d as s,i as K,k as E,e as i,o as u,a as o,f as w,b as p,m as y,F as S,p as N,x as A,h as M,t as C,v as V}from"./app-DFUFjTG9.js";import{_}from"./LabelModel-Bddtogai.js";import{B as Z}from"./ButtonPrimaryMedio-DRjdh_MQ.js";import{B as ee}from"./ButtonCancelar-CcmbECdj.js";import{C as ae}from"./ConfirmDialog-D1i30hcU.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={key:0,class:"loading-overlay"},re={class:"mt-5"},se={class:"bg-white rounded-lg p-12"},ne={class:"flex gap-8 mb-8"},ie={class:"flex flex-col items-center"},ue={class:"relative group"},de=["src"],ce={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},pe={class:"flex flex-col flex-1"},ve=["value"],fe={class:"flex flex-col flex-1"},me=["value"],ge={key:0,class:"text-red-500 text-sm"},be={key:1,class:"text-red-500 text-sm"},xe={key:2,class:"text-red-500 text-sm"},ye={key:3,class:"text-red-500 text-sm"},Ce={class:"form-buttons"},_e={__name:"CadastroColaborador",emits:["voltar"],setup(Q,{emit:T}){const v=Y(),B=T,k=s(""),I=s(""),f=s(""),m=s(""),g=s(null),b=s(null),x=s(""),$=s(null),F=s(null),h=s([]),O=s([]),d=s({}),U=s(!1),c=s(""),D=s(!1);K(async()=>{try{const t=await E.get("/api/usuarios/cargos");h.value=t.data}catch(t){console.error("Erro ao carregar cargos:",t)}}),K(async()=>{try{const t=await E.get("/api/usuarios/operacionais");O.value=t.data.data}catch(t){console.error("Erro ao carregar setores:",t)}});const P=t=>{let e=t.replace(/\D/g,"");return e=e.replace(/(\d{3})(\d)/,"$1.$2"),e=e.replace(/(\d{3})(\d)/,"$1.$2"),e=e.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),e},R=t=>{let e=t.replace(/\D/g,"");e||(e="0");const r=e.slice(0,-2)||"0",l=e.slice(-2);return`R$ ${Number(r).toLocaleString("pt-BR")},${l}`},W=t=>{let e=t.replace("R$","").trim();return e=e.replace(".","").replace(",","."),parseFloat(e)},j=async()=>{if(d.value={},k.value||(d.value.nome="O nome é obrigatório"),I.value||(d.value.email="O email é obrigatório"),f.value||(d.value.cpf="O CPF é obrigatório"),m.value||(d.value.salario="O salário é obrigatório"),g.value||(d.value.cargo="O cargo é obrigatório"),b.value||(d.value.setor="O setor operacional é obrigatório"),Object.keys(d.value).length===0)try{D.value=!0;const t=new FormData;t.append("name",k.value),t.append("email",I.value),t.append("cpf",f.value),t.append("salario",W(m.value)),t.append("cargo_id",g.value),t.append("setor_id",b.value),$.value&&t.append("profile_photo",$.value);const e=await E.post("/api/usuarios/cadastrar-colaborador",t,{headers:{"Content-Type":"multipart/form-data"}});v.success("Colaborador cadastrado com sucesso!"),console.log("Colaborador cadastrado:",e.data),L()}catch(t){v.error("Erro ao cadastrar colaborador"),console.error("Erro ao cadastrar colaborador:",t)}finally{D.value=!1}},z=t=>{c.value=t,U.value=!0},J=()=>{j(),U.value=!1},X=()=>{U.value=!1},q=()=>{var t;(t=F.value)==null||t.click()},G=()=>{x.value="",$.value=null,v.info("Imagem removida.")},H=t=>{const e=t.target.files[0];if(e){$.value=e;const r=new FileReader;r.onload=()=>{x.value=r.result,v.success("Imagem carregada com sucesso!")},r.readAsDataURL(e)}},L=()=>{k.value="",I.value="",f.value="",m.value="",g.value=null,x.value="",$.value=null,B("voltar")};return(t,e)=>(u(),i(S,null,[e[13]||(e[13]=o("div",{class:"painel-title"},"Cadastrar colaborador",-1)),e[14]||(e[14]=o("div",{class:"painel-subtitle"},[o("p",null,"Crie uma nova conta para acessar a sua loja")],-1)),D.value?(u(),i("div",te,e[10]||(e[10]=[o("div",{class:"spinner"},null,-1)]))):w("",!0),o("div",re,[o("div",se,[o("div",ne,[o("div",ie,[o("div",ue,[o("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden",onClick:q},[x.value?(u(),i(S,{key:0},[o("img",{src:x.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,de),o("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:e[0]||(e[0]=N(()=>{},["stop"]))},[o("button",{onClick:N(G,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(u(),i("img",ce))]),o("input",{type:"file",ref_key:"fileInput",ref:F,accept:"image/*",class:"hidden",onChange:H},null,544)])]),o("div",pe,[p(_,{text:"Cargo",class:"mb-2"}),y(o("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>g.value=r),class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[e[11]||(e[11]=o("option",{value:"",disabled:"",selected:""},"Selecione um cargo",-1)),(u(!0),i(S,null,M(h.value,r=>(u(),i("option",{key:r.id,value:r.id,class:"text-base font-semibold"},C(r.nome),9,ve))),128))],512),[[A,g.value]])]),o("div",fe,[p(_,{text:"Setor operacional",class:"mb-2"}),y(o("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>b.value=r),class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[e[12]||(e[12]=o("option",{value:"",disabled:"",selected:""},"Selecione um setor",-1)),(u(!0),i(S,null,M(O.value,r=>(u(),i("option",{key:r.id,value:r.id,class:"text-base font-semibold"},C(r.name),9,me))),128))],512),[[A,b.value]])])]),p(_,{text:"Nome Completo"}),y(o("input",{id:"nome","onUpdate:modelValue":e[3]||(e[3]=r=>k.value=r),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"João Silva Souza"},null,512),[[V,k.value]]),d.value.nome?(u(),i("span",ge,C(d.value.nome),1)):w("",!0),p(_,{text:"E-mail"}),y(o("input",{id:"email","onUpdate:modelValue":e[4]||(e[4]=r=>I.value=r),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:`usuario@email.com
`},null,512),[[V,I.value]]),d.value.email?(u(),i("span",be,C(d.value.email),1)):w("",!0),p(_,{text:"CPF"}),y(o("input",{id:"cpf","onUpdate:modelValue":e[5]||(e[5]=r=>f.value=r),onInput:e[6]||(e[6]=r=>f.value=P(f.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"000.000.000-00",maxlength:"14"},null,544),[[V,f.value]]),d.value.cpf?(u(),i("span",xe,C(d.value.cpf),1)):w("",!0),p(_,{text:"Salário"}),y(o("input",{id:"salario","onUpdate:modelValue":e[7]||(e[7]=r=>m.value=r),onInput:e[8]||(e[8]=r=>m.value=R(m.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"R$ 1.600,00"},null,544),[[V,m.value]]),d.value.salario?(u(),i("span",ye,C(d.value.salario),1)):w("",!0),o("div",Ce,[p(ee,{class:"w-full",text:"Cancelar",onClick:L}),p(Z,{text:"Cadastrar",class:"w-full",iconPath:"/storage/images/arrow_left_alt.svg",onClick:e[9]||(e[9]=r=>z("Cadastrar um novo colaborador?"))})])])]),p(ae,{isVisible:U.value,motivo:c.value,onConfirm:J,onCancel:X},null,8,["isVisible","motivo"])],64))}},qe=oe(_e,[["__scopeId","data-v-3205afb1"]]),$e={key:0,class:"loading-overlay"},we={class:"mt-5"},Fe={class:"bg-white rounded-lg p-12"},ke={class:"flex gap-8 mb-8"},he={class:"flex flex-col items-center"},De={class:"relative group"},Se=["src"],Ve={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},Ie={class:"flex flex-col flex-1"},Ue=["value"],Be={class:"flex flex-col flex-1"},Ee=["value"],Oe={key:0,class:"text-red-500 text-sm"},Re={key:1,class:"text-red-500 text-sm"},Pe={key:2,class:"text-red-500 text-sm"},je={key:3,class:"text-red-500 text-sm"},ze={class:"form-buttons"},Le={__name:"EditarColaborador",props:{user:{type:Object,default:null}},emits:["voltar"],setup(Q,{emit:T}){const v=Q,B=Y(),k=T,I=s(v.user?v.user.id:null),f=s(""),m=s(""),g=s(""),b=s(""),x=s(null),$=s(null),F=s(""),h=s(null),O=s(null),d=s([]),U=s([]),c=s({}),D=s(!1),P=s(""),R=s(!1);K(async()=>{try{const l=await E.get("/api/usuarios/cargos");d.value=l.data,v.user&&(f.value=v.user.name,m.value=v.user.email,g.value=j(v.user.cpf),b.value=z(v.user.salario.toString()),x.value=v.user.cargo_id,$.value=v.user.setor_id,F.value=v.user.profile_photo_url||"")}catch(l){console.error("Erro ao carregar dados:",l)}}),(async()=>{try{const l=await E.get("/api/usuarios/operacionais");U.value=l.data.data}catch(l){console.error("Erro ao carregar setores:",l)}})();const j=l=>{let a=l.replace(/\D/g,"");return a=a.replace(/(\d{3})(\d)/,"$1.$2"),a=a.replace(/(\d{3})(\d)/,"$1.$2"),a=a.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),a},z=l=>{let a=l.replace(/\D/g,"");a||(a="0");const n=a.slice(0,-2)||"0",le=a.slice(-2);return`R$ ${Number(n).toLocaleString("pt-BR")},${le}`},J=l=>{let a=l.replace("R$","").trim();return a=a.replace(".","").replace(",","."),parseFloat(a)},X=async()=>{if(c.value={},f.value||(c.value.nome="O nome é obrigatório"),m.value||(c.value.email="O email é obrigatório"),g.value||(c.value.cpf="O CPF é obrigatório"),b.value||(c.value.salario="O salário é obrigatório"),x.value||(c.value.cargo="O cargo é obrigatório"),$.value||(c.value.setor="O setor é obrigatório"),Object.keys(c.value).length===0)try{R.value=!0;const l=new FormData;l.append("user_id",I.value),l.append("name",f.value),l.append("email",m.value),l.append("cpf",g.value),l.append("salario",J(b.value)),l.append("cargo_id",x.value),l.append("setor_id",$.value),h.value&&l.append("profile_photo",h.value);const a=await E.post("/api/usuarios/atualiza-colaborador",l,{headers:{"Content-Type":"multipart/form-data"}});B.success("Colaborador atualizado com sucesso!"),console.log("Colaborador atualizado:",a.data),k("voltar"),r(),window.location.reload()}catch(l){B.error("Erro ao atualizar colaborador"),console.error("Erro ao atualizar colaborador:",l)}finally{R.value=!1}},q=l=>{P.value=l,D.value=!0},G=()=>{X(),D.value=!1},H=()=>{D.value=!1},L=()=>{var l;(l=O.value)==null||l.click()},t=()=>{F.value="",h.value=null,B.info("Imagem removida.")},e=l=>{const a=l.target.files[0];if(a){h.value=a;const n=new FileReader;n.onload=()=>{F.value=n.result,B.success("Imagem carregada com sucesso!")},n.readAsDataURL(a)}},r=()=>{f.value="",m.value="",g.value="",b.value="",x.value=null,F.value="",h.value=null,k("voltar")};return(l,a)=>(u(),i(S,null,[a[13]||(a[13]=o("div",{class:"painel-title"},"Editar colaborador",-1)),a[14]||(a[14]=o("div",{class:"painel-subtitle"},[o("p",null,"Atualize as informações do colaborador")],-1)),R.value?(u(),i("div",$e,a[10]||(a[10]=[o("div",{class:"spinner"},null,-1)]))):w("",!0),o("div",we,[o("div",Fe,[o("div",ke,[o("div",he,[o("div",De,[o("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden",onClick:L},[F.value?(u(),i(S,{key:0},[o("img",{src:F.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,Se),o("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:a[0]||(a[0]=N(()=>{},["stop"]))},[o("button",{onClick:N(t,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(u(),i("img",Ve))]),o("input",{type:"file",ref_key:"fileInput",ref:O,accept:"image/*",class:"hidden",onChange:e},null,544)])]),o("div",Ie,[p(_,{text:"Cargo",class:"mb-2"}),y(o("select",{"onUpdate:modelValue":a[1]||(a[1]=n=>x.value=n),class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[a[11]||(a[11]=o("option",{value:"",disabled:"",selected:""},"Selecione um cargo",-1)),(u(!0),i(S,null,M(d.value,n=>(u(),i("option",{key:n.id,value:n.id,class:"text-base font-semibold"},C(n.nome),9,Ue))),128))],512),[[A,x.value]])]),o("div",Be,[p(_,{text:"Setor operacional",class:"mb-2"}),y(o("select",{"onUpdate:modelValue":a[2]||(a[2]=n=>$.value=n),class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[a[12]||(a[12]=o("option",{value:"",disabled:"",selected:""},"Selecione um setor",-1)),(u(!0),i(S,null,M(U.value,n=>(u(),i("option",{key:n.id,value:n.id,class:"text-base font-semibold"},C(n.name),9,Ee))),128))],512),[[A,$.value]])])]),p(_,{text:"Nome Completo"}),y(o("input",{id:"nome","onUpdate:modelValue":a[3]||(a[3]=n=>f.value=n),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"João Silva Souza"},null,512),[[V,f.value]]),c.value.nome?(u(),i("span",Oe,C(c.value.nome),1)):w("",!0),p(_,{text:"E-mail"}),y(o("input",{id:"email","onUpdate:modelValue":a[4]||(a[4]=n=>m.value=n),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:`usuario@email.com
`},null,512),[[V,m.value]]),c.value.email?(u(),i("span",Re,C(c.value.email),1)):w("",!0),p(_,{text:"CPF"}),y(o("input",{id:"cpf","onUpdate:modelValue":a[5]||(a[5]=n=>g.value=n),onInput:a[6]||(a[6]=n=>g.value=j(g.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"000.000.000-00",maxlength:"14"},null,544),[[V,g.value]]),c.value.cpf?(u(),i("span",Pe,C(c.value.cpf),1)):w("",!0),p(_,{text:"Salário"}),y(o("input",{id:"salario","onUpdate:modelValue":a[7]||(a[7]=n=>b.value=n),onInput:a[8]||(a[8]=n=>b.value=z(b.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"R$ 1.600,00"},null,544),[[V,b.value]]),c.value.salario?(u(),i("span",je,C(c.value.salario),1)):w("",!0),o("div",ze,[p(ee,{class:"w-full",text:"Cancelar",onClick:r}),p(Z,{text:"Atualizar",class:"w-full",iconPath:"/storage/images/arrow_left_alt.svg",onClick:a[9]||(a[9]=n=>q("Atualizar colaborador?"))})])])]),p(ae,{isVisible:D.value,motivo:P.value,onConfirm:G,onCancel:H},null,8,["isVisible","motivo"])],64))}},Ge=oe(Le,[["__scopeId","data-v-e20857ba"]]);export{qe as C,Ge as E};
