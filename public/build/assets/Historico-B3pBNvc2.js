import{d,i as F,e as f,o as u,a as t,t as b,j as S,b as h,m as H,v as I,F as q,h as A,n as O,k as w,l as N,q as U,f as Y,c as B,w as G,u as T,Z as K}from"./app-eiwQENIW.js";import{L as P}from"./LayoutFranqueado-DmIUjQ66.js";import{d as M}from"./dayjs.min-Cjg-eHvc.js";import"./pt-br-Bk9-Ljux.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as V}from"./LabelModel-DtKeQfTo.js";import{B as Q}from"./ButtonClaroMedio-CQhmtkou.js";import{C as z}from"./ConfirmDialog-DioHYUrR.js";const R={class:"flex items-center space-x-2"},Z={class:"font-semibold text-gray-900 text-[17px]"},J={__name:"CalendarFilterHistorico",emits:["update-filters"],setup(x,{emit:y}){M.locale("pt-br");const r=y,e=d(M().subtract(1,"month")),p=()=>{e.value=e.value.subtract(1,"month"),m()},_=()=>{e.value.add(1,"month").isBefore(M().startOf("month"))&&(e.value=e.value.add(1,"month"),m())},m=()=>{const v=e.value.startOf("month").format("DD-MM-YYYY"),n=e.value.endOf("month").format("DD-MM-YYYY");r("update-filters",{startDate:v,endDate:n})};return F(()=>{m()}),(v,n)=>(u(),f("div",R,[t("button",{onClick:p,class:"text-indigo-600 hover:underline"},n[0]||(n[0]=[t("img",{src:"/storage/images/arrow_drop_down_circle.svg",alt:"icone drop",class:"w-5 h-5"},null,-1)])),t("span",Z,b(e.value.format("MMMM YYYY")),1),t("button",{onClick:_,class:"text-indigo-600 hover:underline"},n[1]||(n[1]=[t("img",{src:"/storage/images/arrow_drop_direita_circle.svg",alt:"icone drop",class:"w-5 h-5"},null,-1)]))]))}},W={class:"painel-subtitle"},X={class:"absolute end-4 top-1 justify-end items-center"},tt={class:"text-[#262a27] text-[15px] font-semibold"},et={class:"flex items-center space-x-2 justify-end"},at={class:"search-container relative flex items-center w-full mb-4"},st={class:"text-lg font-semibold text-gray-800 mb-2"},ot=["onClick"],nt={class:"text-lg font-medium text-gray-900"},rt={class:"text-sm text-gray-600"},it={class:"flex items-center gap-2"},lt=["src","alt"],dt={__name:"ListarContasApagarHistorico",emits:["dado-selecionado"],setup(x,{emit:y}){const r=y,e=d([]),p=d(""),_=d(!1),m=o=>{v(o.startDate,o.endDate)},v=async(o=null,a=null)=>{try{const c=await w.get("/api/cursto/contas-a-pagar/historico",{params:{start_date:o,end_date:a}});e.value=c.data.data}catch(c){console.error("Erro ao carregar os dados:",c)}};F(v);const n=o=>{r("dado-selecionado",o)},g=S(()=>{const o=p.value.toLowerCase();return e.value.map(a=>{const c=a.contas.filter(i=>i.nome.toLowerCase().includes(o)||String(i.valor).includes(o));return{...a,contas:c}}).filter(a=>a.contas.length>0)}),C=o=>{const a=o.split("-");return`${a[2]}/${a[1]}/${a[0]}`},$={pendente:"/storage/images/check_circle_laranja.svg",pago:"/storage/images/check_circle_verde.svg",agendada:"/storage/images/agendada.svg",atrasado:"/storage/images/atrasada.svg"},D=o=>$[o]||"/storage/images/check_circle_laranja.svg",k={pendente:"bg-orange-100 text-orange-700",pago:"bg-green-100 text-green-700",agendada:"bg-blue-100 text-blue-700",atrasado:"bg-red-100 text-red-700"},E=o=>k[o.toLowerCase()]||"bg-gray-100 text-gray-700";return(o,a)=>(u(),f("div",null,[a[4]||(a[4]=t("div",{class:"painel-title"},"Histórico contas",-1)),t("div",W,[a[2]||(a[2]=t("p",null,"Relatório de contas a pagar",-1)),t("div",X,[t("button",{onClick:a[0]||(a[0]=c=>_.value=!0),class:"mr-2"}),t("div",tt,[t("div",et,[h(J,{onUpdateFilters:m})])])])]),t("div",at,[a[3]||(a[3]=t("div",{class:"absolute left-3"},[t("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),H(t("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=c=>p.value=c),placeholder:"Buscar contas",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[I,p.value]])]),(u(!0),f(q,null,A(g.value,c=>(u(),f("div",{key:c.label,class:"mb-6"},[t("div",st,b(c.label),1),(u(!0),f(q,null,A(c.contas,i=>(u(),f("div",{key:i.id,onClick:j=>n(i),class:"flex justify-between items-center bg-white p-4 rounded-lg cursor-pointer hover:bg-gray-100 transition mt-3"},[t("div",null,[t("p",nt,b(i.nome),1),t("p",rt,b(i.valor_formatado)+" - Vence em "+b(C(i.vencimento)),1)]),t("div",it,[t("span",{class:O(["px-2 py-1 text-xs font-semibold rounded-full capitalize",E(i.status)])},b(i.status),3),t("img",{src:D(i.status),alt:i.status,class:"w-8 h-8"},null,8,lt)])],8,ot))),128))]))),128))]))}},ct=L(dt,[["__scopeId","data-v-20d11faf"]]),ut={class:"elemento-fixo"},mt={key:0},gt={class:"mt-8"},pt={class:"w-full h-[555px] bg-white rounded-[20px] p-7 relative"},vt={class:"flex justify-between items-center"},ft={class:"text-[25px] font-bold font-['Figtree'] leading-8 tracking-tight"},xt={class:"text-[#6db631] text-xl font-normal font-['Figtree'] leading-[25px] tracking-tight"},_t={class:"col-span-1 row-span-2 mt-8"},ht={class:"col-span-1 row-span-2 mt-8"},bt={class:"text-[#262a27] text-[12px] font-bold leading-[48px] tracking-wide"},yt=["value"],Ct=["value"],wt={class:"w-full h-[100px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] px-2 py-1 text-[14px] outline-none resize-none focus:ring-2 focus:ring-green-500"},$t={class:"flex space-x-4 mt-5"},Dt={__name:"DetalhesContasApagarHistorico",props:{dados:{type:Object,required:!0}},emits:["voltar","atualiza"],setup(x,{emit:y}){const r=N(),e=x,p=y,_=d([]),m=d(e.dados.status),v=d(!1);d(null);const n=d(!1),g=d(!1),C=d(""),$=s=>{C.value=s,g.value=!0};U(()=>e.dados.status,s=>{m.value=s});const D=()=>{n.value=!1,a()},k=()=>{n.value=!1},E=()=>{g.value=!1,c()},o=()=>{g.value=!1},a=async()=>{if(!e.dados||!e.dados.id){r.error("Erro: Dados da conta não encontrados.");return}try{const s=await w.post(`/api/cursto/contas-a-pagar/${e.dados.id}/pagar`);r.success(s.data.message),e.dados.status="pago",p("atualiza")}catch(s){console.error("Erro ao pagar a conta:",s),r.error("Erro ao pagar a conta")}},c=async s=>{if(!e.dados||!e.dados.id){r.error("Erro: Dados da conta não encontrados.");return}try{const l=await w.delete(`/api/cursto/contas-a-pagar/${e.dados.id}`);r.success("Conta excluída com sucesso"),p("voltar")}catch(l){console.error("Erro ao excluir a conta:",l)}},i=s=>{if(!s)return"";const l=s.split("-");return`${l[2]}/${l[1]}/${l[0]}`},j=()=>{if(e.dados.arquivo){const s=document.createElement("a");s.href=`/${e.dados.arquivo}`,s.download=e.dados.arquivo.split("/").pop(),s.target="_blank",s.click(),r.info("Arquivo baixado com sucesso")}else r.warning("Arquivo não encontrado"),console.error("Arquivo não encontrado")};return F(async()=>{try{const s=await w.get("/api/cursto/contas-a-pagar/status-options");_.value=s.data.data,_.value.includes(m.value)||_.value.push(m.value)}catch(s){console.error("Erro ao carregar opções de status:",s)}}),(s,l)=>(u(),f(q,null,[t("div",ut,[v.value?Y("",!0):(u(),f("div",mt,[t("div",gt,[t("div",pt,[t("div",vt,[t("p",ft,b(x.dados.nome),1),t("button",{class:"text-gray-500 hover:text-red-600",onClick:l[0]||(l[0]=Vt=>$("Excluir essa conta?"))},l[1]||(l[1]=[t("img",{src:"/storage/images/delete.svg",alt:"Excluir",class:"w-6 h-6"},null,-1)]))]),t("p",xt,b(x.dados.valor_formatado),1),l[3]||(l[3]=t("p",{class:"text-[#6d6d6d] text-[15px] font-medium font-['Figtree'] leading-[20px]"},null,-1)),t("div",_t,[t("div",ht,[t("div",bt,[h(V,{text:"Data emitida"}),t("input",{type:"text",id:"emitida_em",value:i(x.dados.emitida_em),name:"emitida_em",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500",readonly:""},null,8,yt),l[2]||(l[2]=t("div",{class:"mt-12"},null,-1)),h(V,{text:"Data de vencimento"}),t("input",{type:"text",id:"vencimento",name:"vencimento",value:i(x.dados.vencimento),class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500",readonly:""},null,8,Ct)])]),h(V,{text:"Informações adicionais"}),t("p",wt,b(x.dados.descricao),1)]),t("div",$t,[h(Q,{text:"Baixar boleto",class:"text-[#6db631] bg-[#f4faf4] hover:bg-[#c1fab6] transition duration-200 ease-in-out",onClick:j})])])])]))]),h(z,{isVisible:n.value,motivo:C.value,onConfirm:D,onCancel:k},null,8,["isVisible","motivo"]),h(z,{isVisible:g.value,motivo:C.value,onConfirm:E,onCancel:o},null,8,["isVisible","motivo"])],64))}},kt=L(Dt,[["__scopeId","data-v-148ef78d"]]),Et={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mt-3 h-full"},Mt={key:0},St={__name:"Historico",setup(x){const y=d(0),r=d(null),e=d(!1),p=d([]),_=n=>{p.value=n.map(g=>({categoria:g.label,valor:g.total,valor_formatado:g.total_formatado}))},m=n=>{r.value=n},v=()=>{r.value=null,y.value+=1};return(n,g)=>(u(),B(P,null,{default:G(()=>[h(T(K),{title:"Painel"}),e.value?Y("",!0):(u(),f("div",Et,[(u(),B(ct,{key:y.value,ref:"listaDados",onDadoSelecionado:m,onDadosCarregados:_})),r.value?(u(),f("div",Mt,[h(kt,{dados:r.value,onVoltar:v,onAtualiza:v},null,8,["dados"])])):Y("",!0)]))]),_:1}))}};export{St as default};
