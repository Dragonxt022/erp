import{l as j,d as i,i as A,k as V,c as M,o as n,w as O,b as a,a as e,u as U,Z as z,e as u,f as E,m as c,F as $,h as P,t as g,x as S,n as T,v as b,p as K,g as B}from"./app-BOSTKaPX.js";import{L as Z}from"./LayoutFranqueado-CiJjH80z.js";import{_ as p}from"./LabelModel-DQDv0g6O.js";import{B as C}from"./ButtonPrimaryMedio-CYMoCpYK.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-DTJvqj8N.js";const H={class:"mt-5"},J={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4"},Q={class:"bg-white rounded-lg px-12 py-5"},W={class:"flex flex-col flex-1"},X=["value"],Y=["value"],ee={class:"bg-white rounded-lg px-12 py-5"},te={class:"flex items-center -mt-9"},oe={class:"w-[40px] h-[40px] ml-2",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},se=["points","fill"],le={class:"bg-white rounded-lg px-12 py-5"},ae={class:"mt-4 flex flex-col gap-3"},re={class:"flex justify-between items-center px-4 py-2 rounded-lg"},ie={class:"relative flex items-center w-full"},ne={class:"flex justify-between items-center px-4 py-2 rounded-lg"},pe={class:"flex justify-between items-center px-4 py-2 rounded-lg"},de={class:"rounded-lg px-12 py-5"},ue={class:"flex items-center -mt-5"},ce={class:"font-bold text-[63.36px] text-[#424242] tracking-wider"},ve={class:"flex items-center gap-2 text-[#6d6d6d] text-[15px] font-semibold -mt-4"},xe={class:"absolute bottom-4 right-4 botao-container"},me={class:"w-[267px] h-[124.72px] relative"},ge={class:"w-[267px] h-[43.91px] left-0 top-[80.80px] absolute"},fe={class:"w-full h-[42.16px] left-0 top-[30px] absolute opacity-80 bg-white rounded-lg border-2 border-[#d7d7db] justify-start items-center inline-flex overflow-hidden"},_e={__name:"LimpesaSalmao",setup(be){const v=j(),h=i([]),R=i([]),r=i(0),d=i(0),f=i("R$ 0,00"),x=i(""),_=i(!1),L=()=>{_.value=!0},N=()=>{_.value=!1},l=i({responsavel_id:"",calibre_id:"",valor_pago:"R$ 0,00",peso_bruto:"0,000",peso_limpo:"0,000"});A(async()=>{try{const s=await V.get("/api/gestao-residuos/limpeza");h.value=s.data.colaboradores,R.value=s.data.calibres}catch(s){console.error("Erro ao carregar dados:",s)}});const q=()=>{let s=l.value.valor_pago.replace(/\D/g,"");if(!s)l.value.valor_pago="R$ 0,00";else{let t=s.slice(0,-2)||"0",o=s.slice(-2).padStart(2,"0");l.value.valor_pago=`R$ ${Number(t).toLocaleString("pt-BR")},${o}`}F()},k=(s,t)=>{let o=t.replace(/\D/g,"");if(!o)l.value[s]="0,000";else{let w=o.slice(0,-3)||"0",y=o.slice(-3).padStart(3,"0");l.value[s]=`${Number(w).toLocaleString("pt-BR")},${y}`}I()},m=s=>parseFloat(s.replace(",",".")||"0"),I=()=>{const s=m(l.value.peso_bruto),t=m(l.value.peso_limpo);s>0?(r.value=(t/s*100).toFixed(2),d.value=(s-t).toFixed(3)):(r.value=0,d.value=0),F()},F=()=>{const s=parseFloat(l.value.valor_pago.replace(/[^\d,]/g,"").replace(",",".")||"0"),t=m(l.value.peso_bruto);if(t>0){const o=s/t,w=parseFloat(d.value),y=(o*w).toFixed(2);f.value=`R$ ${y.replace(".",",")}`}else f.value="R$ 0,00"},D=async()=>{if(!x.value){v.info("Por favor, insira seu PIN.");return}try{console.log("PIN:",x.value);const s=await V.post("/api/gestao-residuos/adicionar",{pin:x.value,responsavel_id:l.value.responsavel_id,calibre_id:l.value.calibre_id,valor_pago:parseFloat(l.value.valor_pago.replace(/[^\d,]/g,"").replace(",",".")),peso_bruto:m(l.value.peso_bruto),peso_limpo:m(l.value.peso_limpo),aproveitamento:parseFloat(r.value),desperdicio:parseFloat(d.value)});v.success("Operação realizada com sucesso!"),console.log("Registro salvo:",s.data),l.value={responsavel_id:"",calibre_id:"",valor_pago:"R$ 0,00",peso_bruto:"0,000",peso_limpo:"0,000"},r.value=0,d.value=0,f.value="R$ 0,00",_.value=!1}catch(s){if(s.response){const{status:t,data:o}=s.response;t===403?v.error("PIN incorreto. Verifique e tente novamente."):t===400?v.error(o.error||"ERRO: Ops! Chame o suporte se o erro continuar."):console.error("Erro:",s)}else v.error("Ops! Ouve um erro.")}};return(s,t)=>(n(),M(Z,null,{default:O(()=>[a(U(z),{title:"Limpeza de Salmão"}),t[13]||(t[13]=e("div",{class:"flex justify-between items-center mb-4"},[e("div",null,[e("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Limpeza de Salmão "),e("div",{class:"painel-subtitle"},[e("p",{class:"text-sm sm:text-base md:text-lg"}," Registre o aproveitamento de salmão ")])])],-1)),e("div",H,[e("div",J,[e("div",Q,[e("div",W,[a(p,{text:"Responsável",class:"mb-2"}),c(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.responsavel_id=o),class:"input-select",required:""},[t[9]||(t[9]=e("option",{value:"",disabled:"",selected:""}," Selecione um Responsável ",-1)),(n(!0),u($,null,P(h.value,o=>(n(),u("option",{key:o.id,value:o.id},g(o.name),9,X))),128))],512),[[S,l.value.responsavel_id]]),a(p,{text:"Calibre do Salmão",class:"mb-2"}),c(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.calibre_id=o),class:"input-select",required:""},[t[10]||(t[10]=e("option",{value:"",disabled:"",selected:""},"Selecione um calibre",-1)),(n(!0),u($,null,P(R.value,o=>(n(),u("option",{key:o.id,value:o.id},g(o.nome),9,Y))),128))],512),[[S,l.value.calibre_id]])])]),e("div",ee,[a(p,{text:"Aproveitamento"}),e("div",te,[e("span",{class:T({"font-bold text-[120.01px] tracking-wider":!0,"text-[#1d5915]":r.value>=70,"text-red-600":r.value<70})},g(r.value)+"% ",3),(n(),u("svg",oe,[e("polygon",{points:r.value>=70?"12,2 22,20 2,20":"12,22 22,2 2,2",fill:r.value>=70?"#6DB631":"#DC2626"},null,8,se)]))])]),e("div",le,[e("div",ae,[e("div",re,[a(p,{text:"Valor Pago",class:"text-gray-800"}),e("div",ie,[c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.valor_pago=o),onInput:q,class:"input-text",placeholder:"R$ 0,00",required:""},null,544),[[b,l.value.valor_pago]])])]),e("div",ne,[a(p,{text:"Peso Bruto",class:"text-gray-800"}),c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.peso_bruto=o),onInput:t[4]||(t[4]=o=>k("peso_bruto",o.target.value)),class:"input-text",placeholder:"0,000",required:""},null,544),[[b,l.value.peso_bruto]])]),e("div",pe,[a(p,{text:"Peso Limpo",class:"text-gray-800"}),c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.peso_limpo=o),onInput:t[6]||(t[6]=o=>k("peso_limpo",o.target.value)),class:"input-text",placeholder:"0,000",required:""},null,544),[[b,l.value.peso_limpo]])])])]),e("div",de,[a(p,{text:"Desperdício"}),e("div",ue,[e("span",ce,g(d.value)+" kg ",1)]),e("div",ve,[e("p",null,"Equivalente a "+g(f.value),1)])])]),e("div",xe,[a(C,{text:"Concluir",iconPath:"/storage/images/arrow_left_alt.svg",onClick:L})]),_.value?(n(),u("div",{key:0,onClick:N,class:"fixed top-0 left-0 right-0 bottom-0 bg-opacity-50 bg-gray-900 flex justify-center items-center"},[e("div",{onClick:t[8]||(t[8]=K(()=>{},["stop"])),class:"w-[405px] h-[523px] px-[23px] py-[33px] bg-white rounded-[20px] flex-col justify-center items-center gap-[68px] inline-flex"},[t[12]||(t[12]=e("div",{class:"w-[267px] h-[229.61px] relative"},[e("div",{class:"left-[-0px] top-[93.84px] absolute text-center text-[#262a27] text-[42.18px] font-bold font-['Figtree'] leading-[50.61px] tracking-wide"},[B(" Autenticação "),e("br"),B(" Obrigatória ")]),e("div",{class:"left-[20.03px] top-[205.61px] absolute text-center text-[#6d6d6d] text-lg font-normal font-['Figtree'] leading-[23.20px]"}," Identifique-se para prosseguir "),e("div",{class:"w-[83.46px] h-[83.46px] left-[91.74px] top-0 absolute"},[e("div",{class:"w-[83.46px] h-[83.46px] left-0 top-0 absolute"},[e("img",{src:"/storage/images/security.svg",alt:""})])])],-1)),e("div",me,[e("div",ge,[a(C,{onClick:D,text:"Autenticar",class:"w-full"})]),e("div",fe,[c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>x.value=o),type:"password",class:"w-full h-full text-xs font-normal tracking-widest border-none outline-none",placeholder:"●●●●",autocomplete:"off"},null,512),[[b,x.value]])]),t[11]||(t[11]=e("div",{class:"w-[68.51px] left-0 top-0 absolute text-[#262a27] text-[14.93px] font-semibold font-['Figtree'] leading-tight"}," Seu PIN ",-1))])])])):E("",!0)])]),_:1}))}},Ve=G(_e,[["__scopeId","data-v-e363abe8"]]);export{Ve as default};
