import{L as I}from"./LayoutFranqueado-CKQva7SL.js";import{k as D,o as a,e as d,a as e,j as M,v as N,F as E,g as j,t as b,l as F,d as l,f as q,b as g,h as x,c as k,p as S,w as z,u as Q,Z as A}from"./app-C7pfRHd-.js";import{B}from"./ButtonPrimaryMedio-eF0Yx_0N.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as T}from"./index-IxNF2Cze.js";import{B as R}from"./ButtonEditeMedio-D1EGId8z.js";import{C as G}from"./ConfirmDialog-DajlWrXK.js";import{E as K}from"./EditarProduto-DL6IWzuw.js";import{I as O}from"./InputModel-ChG7CwFh.js";import{_ as Z}from"./LabelModel-BK7m8BKl.js";import{B as H}from"./ButtonCancelar-CExHJCf0.js";import"./user-hZinRfO8.js";const J={data(){return{dados:[],searchQuery:""}},mounted(){this.fetchDados()},methods:{async fetchDados(){try{const o=await D.get("/api/categorias/lista-categoria-custo");console.log("Dados carregados:",o.data),this.dados=o.data}catch(o){console.error("Erro ao carregar os dados:",o)}},getProfilePhotoUrl(o){return o?new URL(o,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarItem(o){this.$emit("item-selecionado",o)}},computed:{filteredDados(){const o=this.searchQuery.toLowerCase();return this.dados.filter(s=>s.nome.toLowerCase().includes(o))}}},W={class:"search-container relative flex items-center w-full mb-4"},X={class:"card-container"},Y=["onClick"],ee={class:"card-inner"},oe={class:"text-container"},se={class:"city"};function te(o,s,n,c,i,r){return a(),d("div",null,[s[3]||(s[3]=e("div",{class:"painel-title"},"Categorias de Custos",-1)),s[4]||(s[4]=e("div",{class:"painel-subtitle"},[e("p",null,"Controle de categorias de curstos.")],-1)),e("div",W,[s[1]||(s[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),M(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>i.searchQuery=t),placeholder:"Buscar um item",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[N,i.searchQuery]])]),e("div",X,[(a(!0),d(E,null,j(r.filteredDados,t=>(a(),d("div",{key:t.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:p=>r.selecionarItem(t)},[e("div",ee,[s[2]||(s[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/categoria.svg",alt:"Imagem do item",class:"w-10 h-10 rounded-lg"})])],-1)),e("div",oe,[e("div",se,b(t.nome),1)])])],8,Y))),128))])])}const ae=P(J,[["render",te],["__scopeId","data-v-692260e2"]]),re={class:"elemento-fixo"},ie={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},le={class:"relative w-full h-full"},ne={class:"flex items-center"},de={class:"w-1/1 flex justify-center"},ce=["src"],ue={class:"w-2/3 pl-5"},me={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},ve={class:"owner"},fe={class:"w-1/1"},ge={key:1,class:"mt-4"},pe={__name:"DetalhesCategoriaDeCusto",props:{produto:{type:Object,required:!0}},setup(o){const s=F(),n=o,c=l(!1),i=l(""),r=l(!1),t=l(!1),p=l(!1),C=()=>{l.dadosProduto.fetchProduto()},m=f=>f?new URL(f,window.location.origin).href:"/storage/images/no_imagem.svg",v=async()=>{var f,_,$,V;try{p.value=!0;const w=await D.delete(`/api/produtos/excluir/${n.produto.id}`);console.log(w.data.message),s.success("Produto deletado com sucesso!"),T.Inertia.visit(route("franqueadora.insumos"))}catch(w){s.error("Erro ao deletar o produto:",((_=(f=w.response)==null?void 0:f.data)==null?void 0:_.error)||w.message),console.error("Erro ao deletar o produto:",((V=($=w.response)==null?void 0:$.data)==null?void 0:V.error)||w.message)}finally{p.value=!1}},y=()=>{t.value=!t.value,r.value=!1},u=f=>{i.value=f,c.value=!0},h=()=>{v(),c.value=!1},U=()=>{c.value=!1},L=()=>{t.value=!1,r.value=!0};return(f,_)=>(a(),d("div",re,[t.value?x("",!0):(a(),d("div",ie,[e("div",le,[e("div",ne,[e("div",de,[e("img",{src:m(o.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,ce)]),e("div",ue,[e("div",me,[q(b(o.produto.nome||"N/A")+" ",1),e("div",ve,b(o.produto.categoria)+" / "+b(o.produto.unidadeDeMedida),1)])]),e("div",fe,[g(G,{isVisible:c.value,motivo:i.value,onConfirm:h,onCancel:U},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-4 right-4 cursor-pointer",onClick:_[0]||(_[0]=$=>u("Excluir esse produto?"))},_[1]||(_[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))])])])])),o.produto.id&&!t.value?(a(),d("div",ge,[g(R,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:y,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):x("",!0),t.value?(a(),k(K,{key:2,ref:"dadosProduto",isVisible:t.value,produto:o.produto,onDadosProduto:C,onCancelar:L},null,8,["isVisible","produto"])):x("",!0)]))}},he=P(pe,[["__scopeId","data-v-e3af4a8f"]]),_e={key:0,class:"sidebar-container elemento-fixo"},Ce={key:0,class:"loading-overlay"},we={key:1,class:"w-full h-[80%] bg-white rounded-[20px] p-12"},xe={key:0,class:"error-message"},ye={class:"flex justify-start space-x-1 mt-[15%]"},be={__name:"CadastroCategoriaCusto",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar","atualizar"],setup(o,{emit:s}){const n=F(),c=s,i=l(""),r=l(""),t=l(!1),p=()=>{C(),c("cancelar")},C=()=>{i.value="",r.value=""},m=()=>i.value?!0:(n.error("Por favor, preencha todos os campos obrigatórios."),r.value="Por favor, preencha todos os campos obrigatórios.",!1),v=async()=>{var y,u;if(m())try{t.value=!0;const h=new FormData;h.append("nome",i.value);const U=await D.post("/api/categorias/cadastrar-categoria-custo",h);n.success("Categoria cadastrada com sucesso!"),c("atualizar"),C()}catch(h){n.error("Erro ao cadastrar a categoria."),r.value=((u=(y=h.response)==null?void 0:y.data)==null?void 0:u.message)||"Erro inesperado."}finally{t.value=!1}};return(y,u)=>o.isVisible?(a(),d("div",_e,[t.value?(a(),d("div",Ce,u[1]||(u[1]=[e("div",{class:"spinner"},null,-1)]))):(a(),d("div",we,[e("form",{onSubmit:S(v,["prevent"])},[u[2]||(u[2]=e("div",{class:"flex justify-center mb-6 relative group"},[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center overflow-hidden relative"},[e("img",{src:"/storage/images/categoria.svg",alt:"Ícone de upload"})])],-1)),g(Z,{text:"Nome"}),g(O,{modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=h=>i.value=h),placeholder:"ex. Gás, Energia, Aluguel..."},null,8,["modelValue"]),r.value?(a(),d("div",xe,b(r.value),1)):x("",!0),e("div",ye,[g(H,{text:"Cancelar",onClick:p,class:"w-full"}),g(B,{text:"Cadastrar",class:"w-full",onClick:v})])],32)]))])):x("",!0)}},ke=P(be,[["__scopeId","data-v-d2a25838"]]),$e={class:"flex flex-col gap-4"},De={class:"absolute bottom-4 right-4"},Pe={key:1,class:"mt-4"},ze={__name:"Categorias",setup(o){const s=l(null),n=l(!1),c=l(0),i=()=>{c.value+=1},r=()=>{n.value=!n.value},t=()=>{p(),n.value=!1},p=()=>{var v;(v=l("listarUnidades").value)==null||v.fetchUnidades()},C=m=>{m&&typeof m=="object"?s.value=m:console.warn("Dados inválidos recebidos no evento produto-selecionado:",m)};return(m,v)=>(a(),k(I,null,{default:z(()=>[g(Q(A),{title:"Nova Categoria"}),e("div",{class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 overflow-hidden card-container h-full overflow-y-scroll",onScrollPassive:v[0]||(v[0]=()=>{})},[e("div",null,[(a(),k(ae,{key:c.value,ref:"listarUnidades",onUnidadeCadastrada:p,onProdutoSelecionado:C}))]),e("div",$e,[n.value?(a(),d("div",Pe,[g(ke,{isVisible:n.value,onUnidadeCadastrada:t,onCancelar:r,onAtualizar:i},null,8,["isVisible"])])):(a(),d(E,{key:0},[s.value?(a(),k(he,{key:0,produto:s.value},null,8,["produto"])):x("",!0),e("div",De,[g(B,{text:"Nova Categoria",iconPath:"/storage/images/arrow_left_alt.svg",onClick:r})])],64))])],32)]),_:1}))}};export{ze as default};
