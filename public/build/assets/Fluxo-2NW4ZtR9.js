import{L as $}from"./LayoutFranqueado-CFvpTxGh.js";import{o as d,e as r,a as e,t as p,h as V,l as B,d as x,i as h,y as E,c as q,w as S,b as i,u as M,Z as j,g as b,F as y,k as g}from"./app-BBWCde8d.js";import{I as f}from"./InputModel-DtgrntEf.js";import{B as A}from"./ButtonPrimaryMedio-Led888JQ.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as w}from"./index-DDHvRdFE.js";import"./user-Dy1XBobA.js";const L=["type"],U={class:"text-center uppercase text-[#5a9f28] upp text-[15px] font-semibold font-['Figtree'] leading-tight"},T=["src"],N={__name:"ButtonSuave",props:{text:{type:String,required:!0,default:"Nome do Botão"},type:{type:String,default:"button"},iconPath:{type:String,required:!1}},emits:["click"],setup(u,{emit:n}){const o=n,c=()=>{o("click")};return(m,_)=>(d(),r("button",{type:u.type,onClick:c,class:"h-[46px] px-[38px] py-3 bg-white rounded-[133.33px] flex justify-center items-center gap-2.5"},[e("span",U,p(u.text),1),u.iconPath?(d(),r("img",{key:0,src:u.iconPath,alt:"icon",class:"h-6 w-6"},null,8,T)):V("",!0)],8,L))}},F=C(N,[["__scopeId","data-v-0a3ca3a8"]]),z={key:0,class:"loading-overlay"},O={class:"mt-5"},R={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-6"},D={class:"bg-white rounded-lg px-12 py-8"},Z={class:"w-full"},G={class:"py-3 flex items-center gap-5"},H=["src","alt"],J={class:"w-fill text-[#262a27] text-[17px] font-semibold font-['Figtree'] leading-snug"},K={class:"py-2 w-ful"},Q={class:"w-full h-[60px] bg-[#d2fac3] rounded-bl-[10px] rounded-br-[10px] px-12 flex justify-between items-center"},W={class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"},X={class:"bg-white rounded-lg px-12 py-8"},Y={class:"w-full"},ee={class:"w-[85px]"},te=["src","alt"],ae={class:"py-4 px-3 flex items-center gap-5"},se={class:"w-fill text-[#262a27] text-[17px] font-semibold font-['Figtree'] leading-snug w-[170px]"},oe={class:"py-2"},ne={class:"py-2"},le={class:"w-full h-[60px] bg-[#d2fac3] rounded-bl-[10px] rounded-br-[10px] px-12 flex justify-between items-center"},de={class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"},ie={class:"mt-5 bottom-0 left-[250px] w-full max-w-screen-xl mx-auto"},re={class:"w-full h-[85px] p-5 flex justify-between items-center"},ce={class:"flex gap-[13px]"},ue={class:"flex justify-center items-center gap-2.5"},me={__name:"Fluxo",setup(u){const n=B(),o=x(!1),c=x([]),m=x([]),_=h(()=>c.value.reduce((t,a)=>t+parseFloat(a.total_vendas_metodos_pagamento||0),0)),v=h(()=>m.value.reduce((t,a)=>t+parseFloat(a.total_vendas_canais_vendas||0),0)),k=async()=>{o.value=!0;try{const t=await g.get("/api/caixas/metodos-canais-ativos");t.data.status==="success"?(c.value=t.data.metodosPagamento.map(a=>({...a,total_vendas_metodos_pagamento:0})),m.value=t.data.canaisVendas.map(a=>({...a,total_vendas_canais_vendas:0,quantidade_vendas_canais_vendas:0}))):n.error("Erro ao carregar os dados")}catch(t){console.error("Erro ao buscar métodos e canais ativos:",t),n.error("Erro ao carregar os dados")}finally{o.value=!1}},I=async()=>{o.value=!0;try{(await g.post("/api/caixas/fechar",{metodos:c.value,canais:m.value,total_metodos_pagamento:_.value,total_canais_vendas:v.value})).data.status==="success"?(n.success("Fechamento realizado com sucesso!"),w.Inertia.visit("/fechamentos")):n.error("Erro ao realizar o fechamento")}catch(t){console.error("Erro ao enviar fechamento de caixa:",t),n.error("Erro ao realizar o fechamento")}finally{o.value=!1}},P=async()=>{o.value=!0;try{const t=await g.get("/api/caixas/abertos");t.data&&t.data.aberto?console.log("caixa aberto, permanecendo na pagina"):(n.warning("Abra o caixa primeiro!"),w.Inertia.visit(route("franqueado.abrirCaixa")))}catch(t){console.error("Erro ao verificar caixa aberto:",t)}finally{o.value=!1}};return E(()=>{P(),k()}),(t,a)=>(d(),q($,null,{default:S(()=>[i(M(j),{title:"Fluxo do Caixa"}),o.value?(d(),r("div",z,a[1]||(a[1]=[e("div",{class:"spinner"},null,-1)]))):V("",!0),a[6]||(a[6]=e("div",{class:"flex justify-between items-center mb-4"},[e("div",null,[e("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Fluxo do caixa "),e("div",{class:"painel-subtitle"},[e("p",{class:"text-sm sm:text-base md:text-lg"}," Acompanhe seu negócio em tempo real ")])])],-1)),e("div",O,[e("div",R,[e("div",null,[e("div",D,[e("table",Z,[a[2]||(a[2]=e("thead",null,[e("tr",null,[e("th",{class:"text-gray-500 text-left text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Método de pagamento ")])],-1)),e("tbody",null,[(d(!0),r(y,null,b(c.value,s=>(d(),r("tr",{key:s.id},[e("td",G,[e("img",{src:`/${s.default_payment_method.img_icon}`,alt:s.default_payment_method.nome,class:"w-8 h-8"},null,8,H),e("div",J,p(s.default_payment_method.nome),1)]),e("td",K,[i(f,{modelValue:s.total_vendas_metodos_pagamento,"onUpdate:modelValue":l=>s.total_vendas_metodos_pagamento=l,onInput:l=>t.adicionarMetodoPagamento(s,s.total_vendas_metodos_pagamento),placeholder:"R$ 0,00"},null,8,["modelValue","onUpdate:modelValue","onInput"])])]))),128))])])]),e("div",Q,[a[3]||(a[3]=e("div",{class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"}," TOTAL ",-1)),e("div",W,p(_.value),1)])]),e("div",null,[e("div",X,[e("table",Y,[a[4]||(a[4]=e("thead",null,[e("tr",null,[e("th"),e("th",{class:"px-2 text-left text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Canais de venda "),e("th",{class:"text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Valor vendido "),e("th",{class:"text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Pedidos ")])],-1)),e("tbody",null,[(d(!0),r(y,null,b(m.value,s=>(d(),r("tr",{key:s.id},[e("td",ee,[e("img",{src:`/${s.canal_de_vendas.img_icon}`,alt:s.canal_de_vendas.nome,class:"h-7 w-17 fill-stone-950"},null,8,te)]),e("td",ae,[e("div",se,p(s.canal_de_vendas.nome),1)]),e("td",oe,[i(f,{modelValue:s.total_vendas_cainais_vendas,"onUpdate:modelValue":l=>s.total_vendas_cainais_vendas=l,onInput:a[0]||(a[0]=l=>t.adicionarCanalVenda(t.metodo,t.metodo.total_vendas_cainais_vendas)),placeholder:"R$ 0,00",class:"w-[130px]"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ne,[i(f,{modelValue:s.quantidade_vendas_cainais_vendas,"onUpdate:modelValue":l=>s.quantidade_vendas_cainais_vendas=l,onInput:l=>t.onInputChange(s,"quantidade"),placeholder:"0",class:"w-[120px]"},null,8,["modelValue","onUpdate:modelValue","onInput"])])]))),128))])])]),e("div",le,[a[5]||(a[5]=e("div",{class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"}," TOTAL ",-1)),e("div",de,p(v.value),1)])])])]),e("div",ie,[e("div",re,[e("div",ce,[i(F,{class:"w-full",text:"Suprimento",iconPath:""}),i(F,{class:"w-full",text:"Sangria",iconPath:""})]),e("div",ue,[i(A,{class:"w-full max-w-[200px]",text:"Fechar caixa",iconPath:"/storage/images/arrow_left_alt.svg",onClick:I})])])])]),_:1}))}},be=C(me,[["__scopeId","data-v-6095bb54"]]);export{be as default};
