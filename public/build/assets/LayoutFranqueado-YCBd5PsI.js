import{d as k,i as h,j as C,a6 as R,e as v,o as r,a as t,af as G,a3 as W,c as M,f as A,b as $,w as j,t as P,n as E,u as I,a2 as F,ag as H,s as U,a5 as z,ah as Z,q as J,F as T,h as B,a7 as K,ai as V,k as D,a1 as Q,Z as X,r as Y,ae as ee}from"./app-DtYnN9d5.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te=["href"],se=["src"],ae={__name:"iconeNotificacao",setup(m){const e=k(null),a=k(null),o=k(!1),_=k(!0),S=h(()=>a.value?`https://alertas.taiksu.com.br/callback?token=${a.value}`:"https://alertas.taiksu.com.br"),y=h(()=>_.value?"https://login.taiksu.com.br/frontend/img/sinale0.png":o.value?"https://login.taiksu.com.br/frontend/img/sino-alerta-com-mensagem.png":"https://login.taiksu.com.br/frontend/img/sinale0.png"),g=async()=>{try{const l=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!l.ok)throw new Error("Erro ao carregar perfil do usuário");const p=await l.json();p.status==="success"&&p.data&&(e.value=p.data.id,a.value=p.data.rh_token||p.data.id,await s())}catch(l){console.error("Erro ao buscar dados do usuário:",l)}finally{_.value=!1}},s=async()=>{if(e.value)try{const l=`https://alertas.taiksu.com.br/api/status/${e.value}`,p=await fetch(l,{method:"GET",headers:{Accept:"application/json"}});if(!p.ok)throw new Error("Erro ao verificar status das notificações");const x=await p.json();o.value=x.status===!0}catch(l){console.error("Erro ao consultar status das notificações:",l),o.value=!1}};let n;return C(async()=>{await g(),n=setInterval(()=>{s()},3e5)}),R(()=>{n&&clearInterval(n)}),(l,p)=>(r(),v("a",{class:"notification-link",href:S.value,target:"_blank",rel:"noopener noreferrer"},[t("img",{src:y.value,alt:"Notificações",class:"notification-icon"},null,8,se)],8,te))}},ne=q(ae,[["__scopeId","data-v-81702bd5"]]),O=G("sidebar",{state:()=>({isOpen:!1}),actions:{toggle(){this.isOpen=!this.isOpen},open(){this.isOpen=!0},close(){this.isOpen=!1}}}),oe={class:"navbar"},re={class:"navbar-content"},ie={class:"navbar-right"},le={class:"mr-4"},ce={key:0,href:"https://login.taiksu.com.br/perfil",class:"user-info"},ue=["src"],de={class:"user-details"},ve={class:"user-name"},fe={class:"user-location"},me={key:1,class:"user-info loading"},pe={__name:"Navbar",setup(m){const e=O(),a=()=>{e.toggle()},o=k(null),_=h(()=>{var s;return(s=o.value)==null?void 0:s.unidade}),S=h(()=>{var s,n;return((s=o.value)==null?void 0:s.profile_photo_url)||`https://ui-avatars.com/api/?name=${y((n=o.value)==null?void 0:n.name)}&color=7F9CF5&background=EBF4FF`}),y=s=>s?s.split(" ").map(l=>l.charAt(0).toUpperCase()).join(""):"*",g=async()=>{try{const s=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar perfil do usuário");const n=await s.json();o.value=n.data}catch(s){console.error("Erro ao buscar perfil:",s),o.value=null}};return C(()=>{g()}),(s,n)=>(r(),v("div",oe,[n[3]||(n[3]=t("div",{class:"navbar-background"},null,-1)),t("div",re,[n[2]||(n[2]=W('<div class="navbar-left" data-v-d188ccff><a href="https://login.taiksu.com.br/" class="flex flex-row gap-2 px-3 py-1 rounded-full bg-green-100 shadow-md hover:shadow-xl transition-all duration-300" data-v-d188ccff><img src="https://login.taiksu.com.br/frontend/img/seta.png" alt="Menu" class="w-5 h-5 rotate-180" data-v-d188ccff><h2 class="group text-md font-semibold text-green-700" data-v-d188ccff>Voltar para o <span class="text-green-500 font-bold" data-v-d188ccff>Office</span></h2></a></div>',1)),t("div",ie,[t("div",le,[$(ne)]),t("div",{class:"view-mobile"},[t("button",{onClick:a},n[0]||(n[0]=[t("img",{src:"/storage/images/bx-menuv.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),o.value?(r(),M(I(F),{key:0,href:"https://login.taiksu.com.br/perfil",class:E(["user-info hide-mobile",{loading:!o.value}])},{default:j(()=>{var l;return[o.value?(r(),v("a",ce,[t("img",{src:S.value,alt:"Avatar",class:"avatar"},null,8,ue),t("div",de,[t("div",ve,P(o.value.name),1),t("div",fe,P(((l=_.value)==null?void 0:l.cidade)||"Taiksu Franchising"),1)])])):(r(),v("div",me,n[1]||(n[1]=[t("div",{class:"avatar-skeleton"},null,-1),t("div",{class:"user-details-skeleton"},[t("div",{class:"name-skeleton"}),t("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["class"])):A("",!0)])])]))}},he=q(pe,[["__scopeId","data-v-d188ccff"]]),ge={class:"icon"},be=["src"],ke={class:"label"},_e={type:"submit",class:"w-full h-full flex items-center"},we={class:"icon"},Se=["src"],ye={class:"label"},xe={key:2,class:"submenu"},Le={class:"label"},Ie={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(m){const e=m,a=H("openSubmenuLink",k(null)),o=h(()=>a.value===e.link),_=h(()=>o.value),S=h(()=>e.link&&/^https?:\/\//.test(e.link)),y=h(()=>S.value?e.link:e.link?route(e.link):"#"),g=h(()=>!0),s=h(()=>e.submenuItems),n=u=>{s.value.length>0&&(u.preventDefault(),l())},l=()=>{a.value===e.link?a.value=null:a.value=e.link,x()},p=()=>{const u=localStorage.getItem("openSubmenuLink");u!==null&&(a.value=u)},x=()=>{a.value?localStorage.setItem("openSubmenuLink",a.value):localStorage.removeItem("openSubmenuLink")},f=h(()=>c.value||e.isActive?"submenu-active":""),d=u=>{const b=window.location.pathname,L=new URL(route(u),window.location.origin).pathname;return b===L},c=h(()=>s.value.some(u=>d(u.link))),i=()=>{e.isLogout&&K.post(route("logout.sair"))};return p(),U(c,()=>{!c.value&&a.value===e.link&&z(()=>{a.value=null,x()})}),U(a,()=>{z(()=>x())}),(u,b)=>(r(),v("div",null,[!m.isLogout&&m.link&&g.value?(r(),M(Z(S.value?"a":I(F)),{key:0,class:E(["menu-item",[f.value,{active:m.isActive||c.value}]]),href:y.value,target:S.value?"_blank":null,onClick:n},{default:j(()=>[t("div",ge,[t("img",{src:m.icon,alt:"icon"},null,8,be)]),t("div",ke,P(m.label),1),s.value.length>0?(r(),v("div",{key:0,class:E(["right-icon",{"rotate-icon":_.value}])},b[0]||(b[0]=[t("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):A("",!0)]),_:1},8,["class","href","target"])):m.isLogout&&g.value?(r(),v("form",{key:1,onSubmit:J(i,["prevent"]),class:"menu-item"},[t("button",_e,[t("div",we,[t("img",{src:m.icon,alt:"icon"},null,8,Se)]),t("div",ye,P(m.label),1)])],32)):A("",!0),s.value.length>0&&(o.value||c.value)?(r(),v("div",xe,[(r(!0),v(T,null,B(s.value,(L,N)=>(r(),v("div",{key:N},[$(I(F),{class:E(["submenu-item",{active:d(L.link)}]),href:u.route(L.link)},{default:j(()=>[t("div",Le,P(L.label),1)]),_:2},1032,["href","class"])]))),128))])):A("",!0)]))}},$e=q(Ie,[["__scopeId","data-v-53add217"]]),Pe={key:0,class:"loader-container"},Ee={__name:"Slidebar",setup(m){const e=k(null),a=k([]),o=O(),_=k(!0),S=k(null),y=k({}),g=k({}),s=async()=>{try{const d=(await D.get("/api/navbar-profile")).data.data;y.value={franqueado:d.franqueado,colaborador:d.colaborador},g.value=d.permissions||{}}catch(f){console.error("Erro ao carregar permissões:",f),y.value={},g.value={}}},n=async()=>{var f;try{const c=((f=(await D.get(`/api/menu?t=${Date.now()}`)).data)==null?void 0:f.data)||[];a.value=c.map(i=>{const w=(i.items||[]).slice().sort((u,b)=>u.order-b.order).map(u=>{const b=u.children?u.children.slice().sort((L,N)=>L.order-N.order):[];return{...u,children:b}});return{...i,items:w}}).sort((i,w)=>i.order-w.order)}catch(d){console.error("[Menu] Erro ao carregar menu:",d),a.value=[]}};V("userPermissions",g),V("openSubmenuLink",S);const l=h(()=>{const{franqueado:f,colaborador:d}=y.value;return a.value.map(c=>{const i=c.items.map(w=>{if(w.required_permission==="dre"&&!(f===!0&&d===!1)||w.required_permission&&g.value[w.required_permission]!==!0)return null;const u=(w.children||[]).filter(b=>b.required_permission?g.value[b.required_permission]===!0:!0);return{...w,children:u}}).filter(Boolean);return{...c,items:i}}).filter(c=>c.items.length>0)});C(async()=>{_.value=!0,await s(),await n();const f=localStorage.getItem("sidebarScrollPosition");f&&e.value&&(e.value.scrollTop=f),_.value=!1});const p=()=>{e.value&&localStorage.setItem("sidebarScrollPosition",e.value.scrollTop)},x=f=>{const d=window.location.pathname,c=new URL(f,window.location.origin).pathname;return d===c||d.startsWith(c)};return(f,d)=>(r(),v("div",null,[_.value?(r(),v("div",Pe,d[0]||(d[0]=[t("div",{class:"spinner"},null,-1)]))):(r(),v("div",{key:1,class:E(["sidebar z-50 bg-[#164110] text-white flex flex-col p-3 transition-transform duration-300 ease-in-out","fixed inset-y-0 left-0 transform",I(o).isOpen?"translate-x-0":"-translate-x-full","md:relative md:translate-x-0 md:h-screen md:sticky md:top-0"]),ref_key:"sidebar",ref:e,onScroll:p},[(r(!0),v(T,null,B(l.value,c=>(r(),v("div",{key:c.name,class:"menu-category mb-6"},[(r(!0),v(T,null,B(c.items,i=>(r(),M($e,{key:i.link||"no-link",label:i.label,icon:i.icon,link:i.link,submenuItems:i.children,isActive:i.link?x(i.link):!1,isLogout:i.isLogout,requiredPermission:i.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],34))]))}},qe=q(Ee,[["__scopeId","data-v-e1e73347"]]),Ae={__name:"LayoutFranqueado",props:{title:String},setup(m){const e=O();function a(){window.innerWidth<768?e.close():e.open()}return C(()=>{window.addEventListener("resize",a),a()}),Q(()=>{window.removeEventListener("resize",a)}),(o,_)=>(r(),v("div",null,[$(I(X),{title:m.title},null,8,["title"]),$(he),$(qe),t("main",{class:"content",style:ee({left:I(e).isOpen?"252px":"0",width:I(e).isOpen?"calc(100vw - 250px)":"100vw"})},[Y(o.$slots,"default",{},void 0,!0)],4)]))}},je=q(Ae,[["__scopeId","data-v-d63d761a"]]);export{je as L};
