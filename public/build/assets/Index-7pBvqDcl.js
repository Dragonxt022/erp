import{l as se,d as y,j as ie,e as l,f as S,o as n,a as e,m as P,x as Ue,F as E,h as D,t as $,b as C,v as U,w as N,g as V,p as Te,k as G,i as Se,c as M,s as je,R as A,O as Ve,q as Oe,u as Ie,Z as Le}from"./app-6ALQyFZF.js";import{_ as ce}from"./LabelModel-Q3jYn2D9.js";import{I as Me}from"./InputModel-098JuleM.js";import{B as Be}from"./ButtonPrimary-BTqQIh6p.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as de}from"./ButtonPrimaryMedio-CEYzZz4t.js";import{d as Ae}from"./index-JFsPzvDJ.js";import{B as Ce}from"./ButtonCancelar-DOAsalqt.js";import{B as Ne}from"./ButtonEditeMedio-iHiu71_3.js";import{L as Ge}from"./LayoutFranqueado-BdGRoPWh.js";import"./user-D97Xh9Q9.js";const ze={key:0,class:"w-[100%] h-full flex flex-col p-4 bg-gray-50"},Qe={class:"mb-6 relative"},Ke={class:"relative"},We=["value"],He={class:"w-full bg-white rounded-lg p-6 mb-6"},Je={class:"flex items-center"},Xe={class:"flex-shrink-0"},Ze=["src"],Ye={class:"ml-6"},et={class:"text-2xl font-semibold text-gray-800"},tt={key:0,class:"text-red-500 text-sm text-center"},ot={class:"relative flex items-center w-full"},at={class:"flex justify-end space-x-4"},rt={__name:"CadastrarInsumoEstoque",props:{produtoSelecionado:{type:Object,required:!1}},setup(a,{emit:s}){var R;const u=se(),d=s,c=a,h=y([]),x=y(""),f=y(""),b=y(((R=c.produtoSelecionado)==null?void 0:R.valor)||""),i=y(!1);y(!1);const v=y(!1),m=y(""),p=ie(()=>c.produtoSelecionado.unidadeDeMedida==="a_granel"?"Kg":"Quantidade"),g=()=>{if(!f.value.trim()){i.value=!1;return}let j=/^[0-9]+([.,][0-9]+)?$/;if(c.produtoSelecionado.unidadeDeMedida==="unidade"&&(j=/^[0-9]+$/),i.value=!j.test(f.value),["a_granel","quilo"].includes(c.produtoSelecionado.unidadeDeMedida)){let k=f.value.replace(/\D/g,""),I=k.slice(0,-3)||"0",L=k.slice(-3).padStart(3,"0");f.value=`${Number(I).toLocaleString("pt-BR")},${L}`}},r=()=>{const j=b.value.replace(/\D/g,""),k=j.slice(0,-2)||"0",I=j.slice(-2).padStart(2,"0");b.value=`R$ ${Number(k).toLocaleString("pt-BR")},${I}`},t=()=>{f.value="",b.value=""};(async()=>{try{const j=await G.get("/api/estoque/fornecedores");h.value=j.data.data.map(k=>({id:k.id||"N/D",razao_social:k.razao_social||"N/D"}))}catch(j){console.error("Erro ao carregar fornecedores:",j)}})();const _=j=>j?new URL(j,window.location.origin).href:"/storage/images/no_imagem.svg",w=()=>(m.value="",x.value?!f.value||i.value?(u.error("Quantidade inválida."),m.value="Quantidade inválida.",!1):!b.value||v.value?(u.error("Valor inválido."),m.value="Valor inválido.",!1):!0:(u.error("Fornecedor não selecionado."),m.value="Fornecedor não selecionado.",!1)),q=()=>{if(!w())return;const j={...c.produtoSelecionado,fornecedor_id:x.value,quantidade:f.value,valor:b.value,unidade_de_medida:c.produtoSelecionado.unidadeDeMedida};u.success("Inusmo adicionado"),t(),d("adicionarAoCarrinho",j)};return(j,k)=>a.produtoSelecionado?(n(),l("div",ze,[k[5]||(k[5]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",Qe,[e("div",Ke,[P(e("select",{"onUpdate:modelValue":k[0]||(k[0]=I=>x.value=I),id:"fornecedor",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-green-600 focus:ring-2 focus:ring-green-500 font-['Figtree']"},[k[3]||(k[3]=e("option",{value:"",disabled:""},"Selecione um fornecedor",-1)),(n(!0),l(E,null,D(h.value,I=>(n(),l("option",{key:I.id,value:I.id},$(I.razao_social),9,We))),128))],512),[[Ue,x.value]])])]),e("div",He,[e("div",Je,[e("div",Xe,[e("img",{src:_(a.produtoSelecionado.profile_photo),alt:"Foto do Produto",class:"w-24 h-24 rounded-lg"},null,8,Ze)]),e("div",Ye,[e("div",et,$(a.produtoSelecionado.nome||"N/A"),1)])])]),e("form",{onSubmit:Te(q,["prevent"]),class:"space-y-4"},[e("div",null,[C(ce,{text:p.value},null,8,["text"]),C(Me,{modelValue:f.value,"onUpdate:modelValue":k[1]||(k[1]=I=>f.value=I),placeholder:"0,000",onInput:g},null,8,["modelValue"]),i.value?(n(),l("p",tt," Insira um valor válido. ")):S("",!0)]),e("div",null,[C(ce,{text:"Valor"}),e("div",ot,[P(e("input",{"onUpdate:modelValue":k[2]||(k[2]=I=>b.value=I),placeholder:"R$ 0,00",onInput:r,class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},null,544),[[U,b.value]])])]),e("div",at,[C(Be,{onClick:q},{default:N(()=>k[4]||(k[4]=[V("Adicionar")])),_:1})])],32)])):S("",!0)}},nt=O(rt,[["__scopeId","data-v-833469c3"]]),st={class:"flex gap-5"},it={key:0,class:"loading-overlay"},dt={class:"flex-1"},lt={class:"min-w-full table-auto"},ut=["onDblclick"],ct={class:"px-6 py-4 text-[16px] text-left text-gray-900 font-semibold"},pt={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-center"},ft=["onUpdate:modelValue"],vt={key:1},gt={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-left"},mt={key:0},_t=["onUpdate:modelValue"],xt={key:2},bt={class:"px-6 py-4 text-[16px] text-gray-500 text-center"},yt=["onUpdate:modelValue"],ht={key:1},$t={class:"px-6 py-4 text-center"},wt=["onClick"],kt={key:0,class:"botao-container"},qt={__name:"ResumoCarrinho",props:{carrinho:{type:Array,required:!0}},emits:["confirmar","cancelar"],setup(a,{emit:s}){const u=se(),d=a,c=s,h=y(!1),x=y(!1),f=y(null),b=r=>{d.carrinho.splice(r,1),u.info("Item removido com sucesso!")},i=r=>{f.value=r},v=r=>{const t=parseFloat(r.valor.replace("R$","").replace(/\./g,"").replace(",",".")),o=parseFloat(r.quantidade.replace(/\./g,"").replace(",","."));return o>0?t/o:0},m=r=>{const t=parseFloat(r.quantidade.replace(/\./g,"").replace(",","."));if(r.unidadeDeMedida==="a_granel"||r.unidadeDeMedida==="quilo")return v(r)*t||0;{const o=parseFloat(r.valor.replace("R$","").replace(/\./g,"").replace(",","."));return t*o}},p=async()=>{var r;h.value=!0,x.value=!0;try{const t={fornecedor_id:((r=d.carrinho[0])==null?void 0:r.fornecedor_id)||null,itens:d.carrinho.map(_=>{const w=parseFloat(_.quantidade.replace(/\./g,"").replace(",","."));let q=parseFloat(_.valor.replace("R$","").replace(/\./g,"").replace(",","."));q=q.toFixed(2);const R=parseFloat(m(_).toFixed(2));return console.log("Quantidade:",w),console.log("Valor Unitário:",q),console.log("Total:",R),{id:_.id,nome:_.nome,categoria_id:_.categoria_id,quantidade:w,unidadeDeMedida:_.unidadeDeMedida,valorUnitario:q,total:R}})};console.log("Dados enviados:",JSON.stringify(t,null,2));const o=await axios.post("/api/estoque/armazenar-entrada",t);o.status===201?(console.log("Resposta da API:",o.data),Ae.Inertia.visit(route("franqueado.inventario")),u.success("Lista de insumos salvas em seu estoque.")):u.error("Erro ao salvar no estoque, tente novamente.")}catch(t){console.error("Erro ao enviar entrada:",t),u.error("Erro ao confirmar entrada. Tente novamente ou chame o suporte.")}finally{h.value=!1}},g=()=>{c("cancelar")};return(r,t)=>(n(),l("div",st,[h.value?(n(),l("div",it,t[0]||(t[0]=[e("div",{class:"spinner"},null,-1)]))):S("",!0),t[3]||(t[3]=e("div",{class:"flex-1"},[e("div",{class:"painel-title"},"Confirmar entrada"),e("div",{class:"painel-subtitle"},[e("p",null,"Vamos conferir se está tudo certo")]),e("div",{class:"mt-[25%] text-[#6d6d6d] text-[18px] font-normal font-['Figtree'] leading-[23px] tracking-tight"},[V(" Você confirma que está "),e("br"),V(" realizando uma nova entrada "),e("br"),V(" com os seguintes itens? ")])],-1)),e("div",dt,[e("table",lt,[t[2]||(t[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-xs text-left font-medium text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," Item "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," QTD. "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," V. UN/KG "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," TOTAL "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider TrRedonDireita"}," AÇÃO ")])],-1)),e("tbody",null,[(n(!0),l(E,null,D(a.carrinho,(o,_)=>(n(),l("tr",{key:o.id,onDblclick:w=>i(_)},[e("td",ct,$(o.nome),1),e("td",pt,[f.value===_?P((n(),l("input",{key:0,type:"number","onUpdate:modelValue":w=>o.quantidade=w,class:"border border-gray-300 rounded px-2 py-1 w-16"},null,8,ft)),[[U,o.quantidade,void 0,{number:!0}]]):(n(),l("span",vt,$(o.quantidade)+" "+$(o.unidadeDeMedida==="a_granel"?"KG":"UN"),1))]),e("td",gt,[o.unidadeDeMedida==="a_granel"?(n(),l("span",mt," R$ "+$(v(o).toFixed(2)),1)):f.value===_?P((n(),l("input",{key:1,type:"text","onUpdate:modelValue":w=>o.valor=w,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,_t)),[[U,o.valor]]):(n(),l("span",xt,$(o.valor),1))]),e("td",bt,[f.value===_&&o.unidadeDeMedida==="a_granel"?P((n(),l("input",{key:0,type:"number","onUpdate:modelValue":w=>o.valorTotal=w,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,yt)),[[U,o.valorTotal,void 0,{number:!0}]]):(n(),l("span",ht,$(m(o).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1))]),e("td",$t,[e("button",{onClick:w=>b(_),class:"w-[16] h-[16]"},t[1]||(t[1]=[e("img",{src:"/storage/images/delete.svg",alt:"icone de excluir",class:"w-[16px] h-[16px]"},null,-1)]),8,wt)])],40,ut))),128))])]),x.value?S("",!0):(n(),l("div",kt,[C(Ce,{text:"Voltar",onClick:g}),C(de,{text:"Confirmar",onClick:p})]))])]))}},Tt=O(qt,[["__scopeId","data-v-43226af9"]]),St={key:0},jt={key:0,class:"sidebar-container"},It={key:0,class:"loading-overlay"},Ct={key:1,class:"flex"},Rt={class:"flex-1 p-4"},Et={class:"relative flex items-center w-full mb-4"},Ft={class:"category-container"},Pt={class:"w-full h-[18.63px] text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight mt-8 mb-1"},Dt={class:"card-container"},Ut=["onClick"],Vt={class:"card-inner"},Ot={class:"icon-container"},Lt={class:"icon-leaf"},Mt=["src"],Bt={class:"text-container"},At={class:"city"},Nt={key:0,class:"estrela"},Gt={key:1,class:"ml-5 text-xs bg-green-100 text-green-600 font-bold rounded-full px-2 py-1"},zt={class:"absolute bottom-4 right-4 mt-5 botao-container"},Qt={class:"flex-1 p-4"},Kt={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},setup(a){const s=y([]),u=y(""),d=y(!1),c=y(null),h=y([]),x=y(!1),f=()=>{console.log("Entrada confirmada",h.value),mostrarModalRevisao.value=!1,h.value=[]},b=async()=>{try{const t=await G.get("/api/produtos/lista");console.log("Produtos carregados:",t.data),typeof t.data=="object"&&t.data!==null?s.value=i(t.data):console.error("Esperava um objeto de categorias de produtos, mas recebi:",t.data)}catch(t){console.error("Erro ao carregar os produtos:",t)}};function i(t){const o=Object.keys(t),_={};return o.forEach(w=>{_[w]={categoria_nome:t[w].categoria_nome,produtos:t[w].produtos||[]}}),_}function v(t){return t?new URL(t,window.location.origin).href:"/storage/images/no_imagem.svg"}const m=t=>{c.value=t},p=t=>h.value.filter(o=>o.id===t).length,g=t=>{h.value.push(t),c.value=null},r=ie(()=>{const t=u.value.toLowerCase(),o={};return Object.keys(s.value).forEach(_=>{const w=s.value[_].produtos.filter(q=>q.nome.toLowerCase().includes(t));w.length>0&&(o[_]={categoria_nome:s.value[_].categoria_nome,produtos:w})}),o});return Se(b),(t,o)=>(n(),l(E,null,[C(je,{name:"fade"},{default:N(()=>[x.value?S("",!0):(n(),l("div",St,[a.isVisible?(n(),l("div",jt,[d.value?(n(),l("div",It,o[3]||(o[3]=[e("div",{class:"spinner"},null,-1)]))):(n(),l("div",Ct,[e("div",Rt,[o[7]||(o[7]=e("div",{class:"painel-title"},"Nova entrada",-1)),o[8]||(o[8]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",Et,[o[4]||(o[4]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),P(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=_=>u.value=_),placeholder:"Buscar um produto",class:"pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[U,u.value]])]),e("div",Ft,[(n(!0),l(E,null,D(r.value,(_,w)=>(n(),l("div",{key:w,class:"categoria-group"},[e("div",Pt,$(w),1),e("div",Dt,[(n(!0),l(E,null,D(_.produtos,q=>(n(),l("div",{key:q.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:R=>m(q)},[e("div",Vt,[e("div",Ot,[o[5]||(o[5]=e("div",{class:"icon-bg"},null,-1)),e("div",Lt,[e("img",{src:v(q.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,Mt)])]),e("div",Bt,[e("div",At,[V($(q.nome)+" ",1),q.estrela?(n(),l("span",Nt,"★")):S("",!0),p(q.id)>0?(n(),l("span",Gt,$(p(q.id)),1)):S("",!0)])]),o[6]||(o[6]=e("div",{class:"action-icon"},null,-1))])],8,Ut))),128))])]))),128))])]),e("div",zt,[C(de,{text:"Finalizar",onClick:o[1]||(o[1]=_=>x.value=!0),iconPath:"/storage/images/arrow_left_alt.svg"})]),e("div",Qt,[C(nt,{produtoSelecionado:c.value,onAdicionarAoCarrinho:g},null,8,["produtoSelecionado"])])]))])):S("",!0)]))]),_:1}),x.value?(n(),M(Tt,{key:0,carrinho:h.value,onConfirmar:f,onCancelar:o[2]||(o[2]=_=>x.value=!1)},null,8,["carrinho"])):S("",!0)],64))}},Wt=O(Kt,[["__scopeId","data-v-ad18a692"]]);var Q,pe;function Re(){if(pe)return Q;pe=1;function a(s){var u=typeof s;return s!=null&&(u=="object"||u=="function")}return Q=a,Q}var K,fe;function Ht(){if(fe)return K;fe=1;var a=typeof A=="object"&&A&&A.Object===Object&&A;return K=a,K}var W,ve;function Ee(){if(ve)return W;ve=1;var a=Ht(),s=typeof self=="object"&&self&&self.Object===Object&&self,u=a||s||Function("return this")();return W=u,W}var H,ge;function Jt(){if(ge)return H;ge=1;var a=Ee(),s=function(){return a.Date.now()};return H=s,H}var J,me;function Xt(){if(me)return J;me=1;var a=/\s/;function s(u){for(var d=u.length;d--&&a.test(u.charAt(d)););return d}return J=s,J}var X,_e;function Zt(){if(_e)return X;_e=1;var a=Xt(),s=/^\s+/;function u(d){return d&&d.slice(0,a(d)+1).replace(s,"")}return X=u,X}var Z,xe;function Fe(){if(xe)return Z;xe=1;var a=Ee(),s=a.Symbol;return Z=s,Z}var Y,be;function Yt(){if(be)return Y;be=1;var a=Fe(),s=Object.prototype,u=s.hasOwnProperty,d=s.toString,c=a?a.toStringTag:void 0;function h(x){var f=u.call(x,c),b=x[c];try{x[c]=void 0;var i=!0}catch{}var v=d.call(x);return i&&(f?x[c]=b:delete x[c]),v}return Y=h,Y}var ee,ye;function eo(){if(ye)return ee;ye=1;var a=Object.prototype,s=a.toString;function u(d){return s.call(d)}return ee=u,ee}var te,he;function to(){if(he)return te;he=1;var a=Fe(),s=Yt(),u=eo(),d="[object Null]",c="[object Undefined]",h=a?a.toStringTag:void 0;function x(f){return f==null?f===void 0?c:d:h&&h in Object(f)?s(f):u(f)}return te=x,te}var oe,$e;function oo(){if($e)return oe;$e=1;function a(s){return s!=null&&typeof s=="object"}return oe=a,oe}var ae,we;function ao(){if(we)return ae;we=1;var a=to(),s=oo(),u="[object Symbol]";function d(c){return typeof c=="symbol"||s(c)&&a(c)==u}return ae=d,ae}var re,ke;function ro(){if(ke)return re;ke=1;var a=Zt(),s=Re(),u=ao(),d=NaN,c=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,x=/^0o[0-7]+$/i,f=parseInt;function b(i){if(typeof i=="number")return i;if(u(i))return d;if(s(i)){var v=typeof i.valueOf=="function"?i.valueOf():i;i=s(v)?v+"":v}if(typeof i!="string")return i===0?i:+i;i=a(i);var m=h.test(i);return m||x.test(i)?f(i.slice(2),m?2:8):c.test(i)?d:+i}return re=b,re}var ne,qe;function no(){if(qe)return ne;qe=1;var a=Re(),s=Jt(),u=ro(),d="Expected a function",c=Math.max,h=Math.min;function x(f,b,i){var v,m,p,g,r,t,o=0,_=!1,w=!1,q=!0;if(typeof f!="function")throw new TypeError(d);b=u(b)||0,a(i)&&(_=!!i.leading,w="maxWait"in i,p=w?c(u(i.maxWait)||0,b):p,q="trailing"in i?!!i.trailing:q);function R(T){var F=v,B=m;return v=m=void 0,o=T,g=f.apply(B,F),g}function j(T){return o=T,r=setTimeout(L,b),_?R(T):g}function k(T){var F=T-t,B=T-o,ue=b-F;return w?h(ue,p-B):ue}function I(T){var F=T-t,B=T-o;return t===void 0||F>=b||F<0||w&&B>=p}function L(){var T=s();if(I(T))return le(T);r=setTimeout(L,k(T))}function le(T){return r=void 0,q&&v?R(T):(v=m=void 0,g)}function Pe(){r!==void 0&&clearTimeout(r),o=0,v=t=m=r=void 0}function De(){return r===void 0?g:le(s())}function z(){var T=s(),F=I(T);if(v=arguments,m=this,t=T,F){if(r===void 0)return j(t);if(w)return clearTimeout(r),r=setTimeout(L,b),R(t)}return r===void 0&&(r=setTimeout(L,b)),g}return z.cancel=Pe,z.flush=De,z}return ne=x,ne}var so=no();const io=Ve(so),lo={key:0,class:"sidebar-container"},uo={key:0,class:"loading-overlay"},co={key:1},po={class:"w-full h-[80%] bg-white rounded-[20px] p-12"},fo={class:"relative w-full h-full"},vo={class:"flex items-center"},go={class:"w-1/1 flex justify-center"},mo=["src"],_o={class:"w-2/3 pl-5"},xo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},bo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},yo={class:"mt-5"},ho={class:"min-w-full table-auto"},$o={class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonDireita"},wo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},ko={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},qo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},To=["onUpdate:modelValue","onInput"],So={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},jo={class:"flex justify-left mt-12"},Io={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(a,{emit:s}){const u=se(),d=a,c=s,h=y(""),x=y(""),f=y(!1),b=y(!1),i=y("");Oe(()=>d.produto,r=>{r&&(h.value=r.nome||"",x.value=r.categoria||"")},{immediate:!0});const v=r=>r?new URL(r,window.location.origin).href:"/storage/images/no_imagem.svg",m=io(r=>{G.put(`/api/estoque/estoque/lote/${r.id}`,{quantidade:r.quantidade}).then(t=>{u.success("Quantidade do lote atualizada!")}).catch(t=>{u.error("Erro ao atualizar o lote.")})},1e3),p=r=>{i.value=r,b.value=!0},g=()=>{c("cancelar")};return(r,t)=>(n(),M(je,{name:"fade"},{default:N(()=>[a.isVisible?(n(),l("div",lo,[f.value?(n(),l("div",uo,t[1]||(t[1]=[e("div",{class:"spinner"},null,-1)]))):(n(),l("div",co,[e("div",po,[e("div",fo,[e("div",vo,[e("div",go,[e("img",{src:v(a.produto.profile_photo),alt:"Foto do Produto",class:"w-20 h-20 rounded-md shadow-lg"},null,8,mo)]),e("div",_o,[e("div",xo,[V($(a.produto.nome||"N/A")+" ",1),e("div",bo,$(a.produto.unidadeDeMedida==="a_granel"&&a.produto.valor_pago_por_quilo_lote?a.produto.valor_pago_por_quilo_lote:a.produto.valor_total_lote),1)])])])])]),e("form",{onSubmit:t[0]||(t[0]=Te(o=>p("Atualizar este produto?"),["prevent"]))},[e("div",yo,[e("table",ho,[e("thead",null,[e("tr",null,[t[2]||(t[2]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),t[3]||(t[3]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," Fornecedor ",-1)),t[4]||(t[4]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," qtd ",-1)),e("th",$o,$(a.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1)])]),e("tbody",null,[(n(!0),l(E,null,D(a.produto.lotes,o=>(n(),l("tr",{key:o.id},[e("td",wo,$(o.data),1),e("td",ko,$(o.fornecedor),1),e("td",qo,[P(e("input",{"onUpdate:modelValue":_=>o.quantidade=_,type:"number",min:"0",class:"border rounded-lg px-2 py-1 w-[75px] h-[32px] text-center",onInput:_=>Ie(m)(o)},null,40,To),[[U,o.quantidade]])]),e("td",So,$(o.preco_unitario),1)]))),128))])])]),e("div",jo,[C(Ce,{text:"Voltar",onClick:g})])],32)]))])):S("",!0)]),_:1}))}},Co=O(Io,[["__scopeId","data-v-9ad6d994"]]),Ro={class:"elemento-fixo"},Eo={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Fo={class:"relative w-full h-full"},Po={class:"flex items-center"},Do={class:"w-1/1 flex justify-center"},Uo=["src"],Vo={class:"w-2/3 pl-5"},Oo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Lo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},Mo={key:1,class:""},Bo={class:"mt-8"},Ao={class:"min-w-full table-auto"},No={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Go={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},zo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Qo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ko={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Wo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ho={key:0,class:"mt-4"},Jo={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},emits:["atualizar"],setup(a,{emit:s}){const u=s,d=y(!1),c=y(!1),h=()=>{y.dadosProduto.fetchProduto()},x=i=>i?new URL(i,window.location.origin).href:"/storage/images/no_imagem.svg",f=()=>{c.value=!c.value,d.value=!1},b=()=>{u("atualizar"),c.value=!1,d.value=!0};return(i,v)=>(n(),l("div",Ro,[c.value?S("",!0):(n(),l("div",Eo,[e("div",Fo,[e("div",Po,[e("div",Do,[e("img",{src:x(a.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Uo)]),e("div",Vo,[e("div",Oo,[V($(a.produto.nome||"N/A")+" ",1),e("div",Lo,$(a.produto.unidadeDeMedida==="a_granel"&&a.produto.valor_pago_por_quilo_lote?a.produto.valor_pago_por_quilo_lote:a.produto.valor_total_lote),1)])])])])])),c.value?S("",!0):(n(),l("div",Mo,[e("div",Bo,[e("table",Ao,[e("thead",null,[e("tr",null,[v[0]||(v[0]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),v[1]||(v[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),v[2]||(v[2]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),e("th",No,$(a.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),v[3]||(v[3]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),e("tbody",null,[(n(!0),l(E,null,D(a.produto.lotes,(m,p)=>(n(),l("tr",{key:p,class:"text-center"},[e("td",Go,$(m.data),1),e("td",zo,$(m.fornecedor),1),e("td",Qo,$(m.quantidade)+" "+$(a.produto.unidadeDeMedida==="unitario"?"uni":"kg"),1),e("td",Ko,$(a.produto.unidadeDeMedida==="unitario"?m.preco_unitario:m.valor_pago_por_quilo),1),e("td",Wo,$(a.produto.unidadeDeMedida==="unitario"?m.valor_total:m.preco_unitario),1)]))),128))])])]),a.produto.id&&!c.value?(n(),l("div",Ho,[C(Ne,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:f,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):S("",!0)])),c.value?(n(),M(Co,{key:2,ref:"dadosProduto",isVisible:c.value,produto:a.produto,onDadosProduto:h,onCancelar:b},null,8,["isVisible","produto"])):S("",!0)]))}},Xo=O(Jo,[["__scopeId","data-v-1594529a"]]),Zo={class:"search-container relative flex items-center w-full mb-4"},Yo={class:"card-container compromissos-container overflow-hidden"},ea={class:"w-full h-[18.63px] text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight mt-8 mb-1"},ta={class:"card-container"},oa=["onClick"],aa={class:"card-inner"},ra={class:"icon-container"},na={class:"icon-leaf"},sa=["src"],ia={class:"text-container flex justify-between items-center"},da={class:"city"},la={class:"quantidade text-gray-600 font-semibold"},ua={class:"text-gray-600 font-semibold"},ca={__name:"ListarInsumos",emits:["produto-selecionado"],setup(a,{emit:s}){const u=s,d=y([]),c=y(""),h=async()=>{try{const p=await G.get("/api/estoque/lista");console.log("Produtos carregados:",p.data),typeof p.data=="object"&&p.data!==null?d.value=x(p.data):console.error("Esperava um objeto de categorias de produtos, mas recebi:",p.data)}catch(p){console.error("Erro ao carregar os produtos:",p)}};function x(p){const g=Object.keys(p),r={};return g.forEach(t=>{r[t]={categoria_nome:p[t].categoria_nome,produtos:p[t].produtos||[]}}),r}function f(p){return p?new URL(p,window.location.origin).href:"/storage/images/no_imagem.svg"}const b=p=>{u("produto-selecionado",p)},i=(p,g)=>{const r=g==="a_granel"?3:0;return parseFloat(p).toFixed(r)},v=p=>{var r;if(!Array.isArray(p))return console.warn("getQuantidadeTotal recebeu um valor inválido:",p),0;const g=p.reduce((t,o)=>t+(o.quantidade||0),0);return i(g,((r=p[0])==null?void 0:r.unidadeDeMedida)||"unitario")},m=ie(()=>{const p=c.value.toLowerCase(),g={};return Object.keys(d.value).forEach(r=>{const t=d.value[r].produtos.filter(o=>o.nome.toLowerCase().includes(p));t.length>0&&(g[r]={categoria_nome:d.value[r].categoria_nome,produtos:t})}),g});return Se(()=>{h()}),(p,g)=>(n(),l("div",null,[g[4]||(g[4]=e("div",{class:"painel-title"},"Inventário da loja",-1)),g[5]||(g[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Verifique a quantidade de cada item")],-1)),e("div",Zo,[g[1]||(g[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),P(e("input",{type:"text","onUpdate:modelValue":g[0]||(g[0]=r=>c.value=r),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[U,c.value]])]),e("div",Yo,[(n(!0),l(E,null,D(m.value,(r,t)=>(n(),l("div",{key:t,class:"categoria-group"},[e("div",ea,$(t),1),e("div",ta,[(n(!0),l(E,null,D(r.produtos,o=>(n(),l("div",{key:o.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:_=>b(o)},[e("div",aa,[e("div",ra,[g[2]||(g[2]=e("div",{class:"icon-bg"},null,-1)),e("div",na,[e("img",{src:f(o.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,sa)])]),e("div",ia,[e("div",da,$(o.nome),1),e("div",la,[e("div",ua,$(v(o.lotes))+" "+$(o.unidadeDeMedida==="unitario"?"uni":"kg"),1)])]),g[3]||(g[3]=e("div",{class:"action-icon"},null,-1))])],8,oa))),128))])]))),128))])]))}},pa=O(ca,[["__scopeId","data-v-bbc43271"]]),fa={key:0,class:"mt-6"},va={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},ga={key:0},ma={class:"flex flex-col gap-4"},_a={key:1,class:"absolute bottom-4 right-4 botao-container"},xa={__name:"Index",setup(a){const s=y(null),u=y(0),d=y(!1),c=y(!1),h=()=>{d.value=!d.value},x=()=>{console.log("atualizando a lista"),s.value=null,u.value+=1},f=()=>{b(),d.value=!1},b=()=>{var m;(m=y("listarUnidades").value)==null||m.fetchUnidades()},i=v=>{s.value=v,console.info("Dados recebidos no evento produto-selecionado:",v)};return(v,m)=>(n(),M(Ge,null,{default:N(()=>[C(Ie(Le),{title:"Insumos"}),d.value?(n(),l("div",fa,[C(Wt,{isVisible:d.value,onUnidadeCadastrada:f,onCancelar:h},null,8,["isVisible"])])):S("",!0),e("div",va,[d.value?S("",!0):(n(),l("div",ga,[(n(),M(pa,{key:u.value,ref:"listarUnidades",onUnidadeCadastrada:b,onProdutoSelecionado:i}))])),e("div",ma,[d.value?S("",!0):(n(),l(E,{key:0},[s.value?(n(),M(Xo,{key:0,onAtualizar:x,produto:s.value},null,8,["produto"])):S("",!0),c.value?S("",!0):(n(),l("div",_a,[C(de,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:h})]))],64))])])]),_:1}))}},Ca=O(xa,[["__scopeId","data-v-dc8d0ba3"]]);export{Ca as default};
