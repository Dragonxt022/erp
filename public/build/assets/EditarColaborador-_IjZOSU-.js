import{l as W,d as r,i as Y,k as S,e as s,o as n,a as l,f as C,b as u,m as g,F as h,p as P,x as R,h as j,t as b,v as k}from"./app-DYh8EFuX.js";import{_ as x}from"./LabelModel-oqMHav-v.js";import{B as Z}from"./ButtonPrimaryMedio-ZcIUmY9P.js";import{B as ee}from"./ButtonCancelar-BxH7Rdk7.js";import{C as oe}from"./ConfirmDialog-UINhhakX.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={key:0,class:"loading-overlay"},te={class:"mt-5"},re={class:"bg-white rounded-lg p-12"},se={class:"flex gap-8 mb-8"},ne={class:"flex flex-col items-center"},ie={class:"relative group"},ue=["src"],de={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},ce={class:"flex flex-col flex-1"},pe=["value"],ve={class:"flex flex-col flex-1"},fe=["value"],me={key:0,class:"text-red-500 text-sm"},ge={key:1,class:"text-red-500 text-sm"},be={key:2,class:"text-red-500 text-sm"},xe={key:3,class:"text-red-500 text-sm"},ye={class:"form-buttons"},_e={__name:"EditarColaborador",props:{user:{type:Object,default:null}},emits:["voltar"],setup(M,{emit:N}){const i=M,w=W(),D=N,A=r(i.user?i.user.id:null),p=r(""),v=r(""),d=r(""),c=r(""),f=r(null),y=r(null),m=r(""),_=r(null),V=r(null),B=r([]),E=r([]),t=r({}),F=r(!1),I=r(""),$=r(!1);Y(async()=>{try{const o=await S.get("/api/usuarios/cargos");B.value=o.data,i.user&&(p.value=i.user.name,v.value=i.user.email,d.value=z(i.user.cpf),c.value=U(i.user.salario.toString()),f.value=i.user.cargo_id,y.value=i.user.setor_id,m.value=i.user.profile_photo_url||"")}catch(o){console.error("Erro ao carregar dados:",o)}}),(async()=>{try{const o=await S.get("/api/usuarios/operacionais");E.value=o.data.data}catch(o){console.error("Erro ao carregar setores:",o)}})();const z=o=>{let e=o.replace(/\D/g,"");return e=e.replace(/(\d{3})(\d)/,"$1.$2"),e=e.replace(/(\d{3})(\d)/,"$1.$2"),e=e.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),e},U=o=>{let e=o.replace(/\D/g,"");e||(e="0");const a=e.slice(0,-2)||"0",Q=e.slice(-2);return`R$ ${Number(a).toLocaleString("pt-BR")},${Q}`},L=o=>{let e=o.replace("R$","").trim();return e=e.replace(".","").replace(",","."),parseFloat(e)},T=async()=>{if(t.value={},p.value||(t.value.nome="O nome é obrigatório"),v.value||(t.value.email="O email é obrigatório"),d.value||(t.value.cpf="O CPF é obrigatório"),c.value||(t.value.salario="O salário é obrigatório"),f.value||(t.value.cargo="O cargo é obrigatório"),y.value||(t.value.setor="O setor é obrigatório"),Object.keys(t.value).length===0)try{$.value=!0;const o=new FormData;o.append("user_id",A.value),o.append("name",p.value),o.append("email",v.value),o.append("cpf",d.value),o.append("salario",L(c.value)),o.append("cargo_id",f.value),o.append("setor_id",y.value),_.value&&o.append("profile_photo",_.value);const e=await S.post("/api/usuarios/atualiza-colaborador",o,{headers:{"Content-Type":"multipart/form-data"}});w.success("Colaborador atualizado com sucesso!"),console.log("Colaborador atualizado:",e.data),D("voltar"),O(),window.location.reload()}catch(o){w.error("Erro ao atualizar colaborador"),console.error("Erro ao atualizar colaborador:",o)}finally{$.value=!1}},J=o=>{I.value=o,F.value=!0},X=()=>{T(),F.value=!1},q=()=>{F.value=!1},G=()=>{var o;(o=V.value)==null||o.click()},H=()=>{m.value="",_.value=null,w.info("Imagem removida.")},K=o=>{const e=o.target.files[0];if(e){_.value=e;const a=new FileReader;a.onload=()=>{m.value=a.result,w.success("Imagem carregada com sucesso!")},a.readAsDataURL(e)}},O=()=>{p.value="",v.value="",d.value="",c.value="",f.value=null,m.value="",_.value=null,D("voltar")};return(o,e)=>(n(),s(h,null,[e[13]||(e[13]=l("div",{class:"painel-title"},"Editar colaborador",-1)),e[14]||(e[14]=l("div",{class:"painel-subtitle"},[l("p",null,"Atualize as informações do colaborador")],-1)),$.value?(n(),s("div",le,e[10]||(e[10]=[l("div",{class:"spinner"},null,-1)]))):C("",!0),l("div",te,[l("div",re,[l("div",se,[l("div",ne,[l("div",ie,[l("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden",onClick:G},[m.value?(n(),s(h,{key:0},[l("img",{src:m.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,ue),l("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:e[0]||(e[0]=P(()=>{},["stop"]))},[l("button",{onClick:P(H,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(n(),s("img",de))]),l("input",{type:"file",ref_key:"fileInput",ref:V,accept:"image/*",class:"hidden",onChange:K},null,544)])]),l("div",ce,[u(x,{text:"Cargo",class:"mb-2"}),g(l("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>f.value=a),class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[e[11]||(e[11]=l("option",{value:"",disabled:"",selected:""},"Selecione um cargo",-1)),(n(!0),s(h,null,j(B.value,a=>(n(),s("option",{key:a.id,value:a.id,class:"text-base font-semibold"},b(a.nome),9,pe))),128))],512),[[R,f.value]])]),l("div",ve,[u(x,{text:"Setor operacional",class:"mb-2"}),g(l("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>y.value=a),class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[e[12]||(e[12]=l("option",{value:"",disabled:"",selected:""},"Selecione um setor",-1)),(n(!0),s(h,null,j(E.value,a=>(n(),s("option",{key:a.id,value:a.id,class:"text-base font-semibold"},b(a.name),9,fe))),128))],512),[[R,y.value]])])]),u(x,{text:"Nome Completo"}),g(l("input",{id:"nome","onUpdate:modelValue":e[3]||(e[3]=a=>p.value=a),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"João Silva Souza"},null,512),[[k,p.value]]),t.value.nome?(n(),s("span",me,b(t.value.nome),1)):C("",!0),u(x,{text:"E-mail"}),g(l("input",{id:"email","onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:`usuario@email.com
`},null,512),[[k,v.value]]),t.value.email?(n(),s("span",ge,b(t.value.email),1)):C("",!0),u(x,{text:"CPF"}),g(l("input",{id:"cpf","onUpdate:modelValue":e[5]||(e[5]=a=>d.value=a),onInput:e[6]||(e[6]=a=>d.value=z(d.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"000.000.000-00",maxlength:"14"},null,544),[[k,d.value]]),t.value.cpf?(n(),s("span",be,b(t.value.cpf),1)):C("",!0),u(x,{text:"Salário"}),g(l("input",{id:"salario","onUpdate:modelValue":e[7]||(e[7]=a=>c.value=a),onInput:e[8]||(e[8]=a=>c.value=U(c.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"R$ 1.600,00"},null,544),[[k,c.value]]),t.value.salario?(n(),s("span",xe,b(t.value.salario),1)):C("",!0),l("div",ye,[u(ee,{class:"w-full",text:"Cancelar",onClick:O}),u(Z,{text:"Atualizar",class:"w-full",iconPath:"/storage/images/arrow_left_alt.svg",onClick:e[9]||(e[9]=a=>J("Atualizar colaborador?"))})])])]),u(oe,{isVisible:F.value,motivo:I.value,onConfirm:X,onCancel:q},null,8,["isVisible","motivo"])],64))}},De=ae(_e,[["__scopeId","data-v-e20857ba"]]);export{De as E};
