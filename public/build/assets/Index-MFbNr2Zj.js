import{s as M,d as l,o as i,e as c,a as e,i as D,b as t,t as k,h as w,y as S,j as q,v as L,F,g as z,f as j,x as G,c as B,w as H,u as K,Z as W,n as X}from"./app-DnQVHGg4.js";import{d as A}from"./index-DdsEiTwp.js";import{_ as C,I as $,C as Y,a as J,B as I}from"./ConfirmDialog-DW2kaX9X.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as ee}from"./AppLayout-BreoiuAe.js";const ae={key:0,class:"sidebar-container"},te={key:0,class:"loading-overlay"},se={key:1,class:"painel-title"},de={class:"w-full h-[525px] bg-white rounded-[20px] p-12"},oe={class:"flex space-x-4"},le={class:"flex flex-col w-1/2"},ie={class:"flex flex-col w-1/2"},ne={key:0,class:"error-message"},re={class:"form-buttons"},ue={__name:"CadastroUnidade",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(s,{emit:d}){const r=M(),_=d,m=l(""),u=l(""),n=l(""),o=l(""),h=l(""),b=l(""),x=l(""),y=l(!1),U=l(!1),E=l(""),N=()=>{g(),_("cancelar")},g=()=>{m.value="",u.value="",n.value="",o.value="",h.value="",b.value="",x.value=""},v=()=>!m.value||!u.value||!o.value?(r.error("Por favor, preencha todos os campos obrigatórios."),x.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,p=async()=>{var V,a;if(v())try{y.value=!0;const f=await S.post("/api/unidades",{cnpj:m.value,cep:u.value,cidade:n.value,bairro:o.value,rua:h.value,numero:b.value});console.log("Unidade cadastrada com sucesso:",f.data),r.success("Unidade cadastrada com sucesso!"),A.Inertia.visit("/unidades"),g()}catch(f){r.error("Erro ao cadastrar unidade."),x.value=((a=(V=f.response)==null?void 0:V.data)==null?void 0:a.message)||"Erro ao cadastrar unidade."}finally{y.value=!1}},Q=V=>{let a=V.target.value.replace(/\D/g,"");a.length>14&&(a=a.slice(0,14)),a=a.replace(/^(\d{2})(\d)/,"$1.$2"),a=a.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),a=a.replace(/\.(\d{3})(\d)/,".$1/$2"),a=a.replace(/(\d{4})(\d)/,"$1-$2"),m.value=a},R=V=>{let a=V.target.value.replace(/\D/g,"");a.length>8&&(a=a.slice(0,8)),a=a.replace(/(\d{5})(\d)/,"$1-$2"),u.value=a},T=V=>{E.value=V,U.value=!0},O=()=>{p(),U.value=!1},Z=()=>{U.value=!1};return(V,a)=>s.isVisible?(i(),c("div",ae,[y.value?(i(),c("div",te,a[7]||(a[7]=[e("div",{class:"spinner"},null,-1)]))):(i(),c("div",se,"Dados da nova unidade")),a[8]||(a[8]=e("div",{class:"painel-subtitle"},[e("p",null,"Informações básicas sobre a operação")],-1)),e("div",de,[e("form",{onSubmit:D(p,["prevent"])},[t(C,{text:"CNPJ"}),t($,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=f=>m.value=f),onInput:Q,placeholder:"CNPJ"},null,8,["modelValue"]),t(C,{text:"Cidade"}),t($,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=f=>n.value=f),placeholder:"Cidade"},null,8,["modelValue"]),t(C,{text:"CEP"}),t($,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=f=>u.value=f),onInput:R,placeholder:"CEP"},null,8,["modelValue"]),e("div",oe,[e("div",le,[t(C,{text:"Rua"}),t($,{modelValue:h.value,"onUpdate:modelValue":a[3]||(a[3]=f=>h.value=f),placeholder:"Rua"},null,8,["modelValue"])]),e("div",ie,[t(C,{text:"Número"}),t($,{modelValue:b.value,"onUpdate:modelValue":a[4]||(a[4]=f=>b.value=f),placeholder:"Número"},null,8,["modelValue"])])]),t(C,{text:"Bairro"}),t($,{modelValue:o.value,"onUpdate:modelValue":a[5]||(a[5]=f=>o.value=f),placeholder:"Bairro"},null,8,["modelValue"]),x.value?(i(),c("div",ne,k(x.value),1)):w("",!0),t(Y,{isVisible:U.value,motivo:E.value,onConfirm:O,onCancel:Z},null,8,["isVisible","motivo"]),e("div",re,[t(J,{text:"Cancelar",onClick:N}),t(I,{text:"Cadastrar",onClick:a[6]||(a[6]=f=>T("Criar nova unidade?"))})])],32)])])):w("",!0)}},ce=P(ue,[["__scopeId","data-v-2e163658"]]);l([]);const ve={data(){return{unidades:[],searchQuery:""}},mounted(){this.fetchUnidades()},methods:{async fetchUnidades(){try{const s=await S.get("/api/unidades");this.unidades=s.data}catch(s){console.error("Erro ao carregar unidades:",s)}},selecionarUnidade(s){this.$emit("unidade-selecionada",{unidade:s.unidade,usuarios:s.usuarios,cidade:s.cidade})}},computed:{filteredUnidades(){return this.unidades.filter(s=>{const d=s.unidade.cidade||s.cidade;return d&&d.toLowerCase().includes(this.searchQuery.toLowerCase())})}}},pe={class:"search-container relative flex items-center w-full mb-4"},me={class:"card-container"},fe=["onClick"],ge={class:"card-inner"},xe={class:"text-container"},he={class:"city"},be={class:"owner"};function _e(s,d,r,_,m,u){return i(),c("div",null,[d[4]||(d[4]=e("div",{class:"painel-title"},"Nossas Unidades",-1)),d[5]||(d[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Listagem de todas as unidades da franquia")],-1)),e("div",pe,[d[1]||(d[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),q(e("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=n=>m.searchQuery=n),placeholder:"Pesquisar unidades",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[L,m.searchQuery]])]),e("div",me,[(i(!0),c(F,null,z(u.filteredUnidades,n=>(i(),c("div",{key:n.unidade.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:o=>u.selecionarUnidade(n)},[e("div",ge,[d[2]||(d[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/storefront-verde.svg",alt:"Ícone da Unidade"})])],-1)),e("div",xe,[e("div",he,k(n.unidade.cidade||n.cidade),1),e("div",be,[n.usuarios.length>0?(i(),c(F,{key:0},[j(k(n.usuarios.map(o=>o.name).join(", ")),1)],64)):(i(),c(F,{key:1},[j("Unidade sem Franqueado")],64))])]),d[3]||(d[3]=e("div",{class:"action-icon"},null,-1))])],8,fe))),128))])])}const ye=P(ve,[["render",_e],["__scopeId","data-v-d2a9f774"]]),Ue={key:0,class:"sidebar-container"},Ce={class:"w-full h-[680px] bg-white rounded-[20px] p-12"},$e={class:"flex space-x-4"},Ve={class:"flex flex-col w-1/2"},ke={class:"flex flex-col w-1/2"},we={key:0,class:"error-message"},Ee={class:"form-buttons"},Fe={__name:"EditarUnidade",props:{isVisible:{type:Boolean,required:!0},unidade:{type:Object,required:!0}},emits:["cancelar"],setup(s,{emit:d}){const r=M(),_=s,m=d,u=l(""),n=l(""),o=l(""),h=l(""),b=l(""),x=l(""),y=l(""),U=l("");G(()=>_.unidade.unidade,g=>{g&&(u.value=g.id||"",o.value=g.cidade||"",n.value=g.cep||"",h.value=g.bairro||"",b.value=g.rua||"",x.value=g.numero||"",y.value=g.cnpj||"")},{immediate:!0});const E=()=>{m("cancelar")},N=async()=>{var g,v;if(!u.value||!y.value||!n.value||!b.value||!x.value){U.value="Por favor, preencha todos os campos obrigatórios.";return}try{await A.Inertia.put(route("unidades.update",_.unidade.unidade.id),{id:u.value,cep:n.value,cidade:o.value,bairro:h.value,rua:b.value,numero:x.value,cnpj:y.value}),r.success("Unidade atualizada com sucesso!"),m("cancelar")}catch(p){r.error("Erro ao atualizar a unidade."),U.value=((v=(g=p.response)==null?void 0:g.data)==null?void 0:v.message)||"Erro ao atualizar a unidade.",console.error("Erro na atualização:",p)}};return(g,v)=>s.isVisible?(i(),c("div",Ue,[e("div",Ce,[e("form",{onSubmit:D(N,["prevent"])},[q(e("input",{type:"hidden","onUpdate:modelValue":v[0]||(v[0]=p=>u.value=p)},null,512),[[L,u.value]]),t(C,{text:"CNPJ"}),t($,{modelValue:y.value,"onUpdate:modelValue":v[1]||(v[1]=p=>y.value=p),placeholder:"CNPJ"},null,8,["modelValue"]),t(C,{text:"Cidade"}),t($,{modelValue:o.value,"onUpdate:modelValue":v[2]||(v[2]=p=>o.value=p),placeholder:"Cidade"},null,8,["modelValue"]),t(C,{text:"CEP"}),t($,{modelValue:n.value,"onUpdate:modelValue":v[3]||(v[3]=p=>n.value=p),placeholder:"CEP"},null,8,["modelValue"]),e("div",$e,[e("div",Ve,[t(C,{text:"Rua"}),t($,{modelValue:b.value,"onUpdate:modelValue":v[4]||(v[4]=p=>b.value=p),placeholder:"Rua"},null,8,["modelValue"])]),e("div",ke,[t(C,{text:"Número"}),t($,{modelValue:x.value,"onUpdate:modelValue":v[5]||(v[5]=p=>x.value=p),placeholder:"Número"},null,8,["modelValue"])])]),t(C,{text:"Bairro"}),t($,{modelValue:h.value,"onUpdate:modelValue":v[6]||(v[6]=p=>h.value=p),placeholder:"Bairro"},null,8,["modelValue"]),U.value?(i(),c("div",we,k(U.value),1)):w("",!0),e("div",Ee,[t(J,{text:"Cancelar",onClick:E}),t(I,{text:"Atualizar",onClick:N})])],32)])])):w("",!0)}},Ne=P(Fe,[["__scopeId","data-v-3b2eac9f"]]),Pe=["type"],je=["src"],Be={class:"text-center text-[#262a27] text-[15px] font-semibold font-['Figtree'] leading-tight"},Ie={__name:"ButtonEditeMedio",props:{text:{type:String,required:!0,default:"Nome do Botão"},type:{type:String,default:"button"},iconPath:{type:String,required:!1}},emits:["click"],setup(s,{emit:d}){const r=d,_=()=>{r("click")};return(m,u)=>(i(),c("button",{type:s.type,onClick:_,class:"h-[46px] px-[38px] py-3 bg-[#F3F8F3] rounded-[10px] flex justify-center items-center gap-2.5"},[s.iconPath?(i(),c("img",{key:0,src:s.iconPath,alt:"icon",class:"h-6 w-6"},null,8,je)):w("",!0),e("span",Be,k(s.text),1)],8,Pe))}},Me=P(Ie,[["__scopeId","data-v-c0180952"]]),De={key:0,class:"w-full h-[350px] bg-white rounded-[20px] p-12"},Se={class:"relative w-full h-full"},qe={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},Le={class:"w-[135px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},ze={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Ae={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Je={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Qe={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[34px] tracking-tight"},Re={class:"absolute bottom-0 left-0 w-full h-[100px] flex flex-col gap-1"},Te={class:"h-[43px] pl-4 pr-3 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Oe={class:"text-[#6db631] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Ze={key:0,class:"mt-4"},Ge={__name:"DetalhesUnidade",props:{unidade:{type:Object,required:!0}},setup(s){const d=l(!1),r=l(!1),_=()=>{l.dadosUnidade.fetchUnidades()},m=()=>{r.value=!r.value,d.value=!1},u=()=>{r.value=!1,d.value=!0};return(n,o)=>{var h,b,x,y,U;return i(),c(F,null,[r.value?w("",!0):(i(),c("div",De,[e("div",Se,[e("div",qe,[e("div",Le,[o[0]||(o[0]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",ze," ID# "+k((((h=s.unidade.unidade)==null?void 0:h.id)??0).toString().padStart(4,"0")),1)]),e("div",Ae,[o[1]||(o[1]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",Je,k(((b=s.unidade.unidade)==null?void 0:b.cnpj)||"N/A"),1)])]),e("div",Qe,k(((x=s.unidade.unidade)==null?void 0:x.cidade)||s.unidade.cidade||"N/A"),1),e("div",Re,[o[2]||(o[2]=e("div",{class:"text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight"}," Esta unidade pertence a ",-1)),e("div",Te,[e("div",Oe,[(U=(y=s.unidade)==null?void 0:y.usuarios)!=null&&U.length?(i(!0),c(F,{key:0},z(s.unidade.usuarios,E=>(i(),c("div",{key:E.id},k(E.name),1))),128)):(i(),c(F,{key:1},[j("Sem informações")],64))])]),s.unidade.unidade.id?(i(),c("div",Ze,[t(Me,{text:"Editar Unidade","icon-path":"/storage/images/border_color.svg",onClick:m,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):w("",!0)])])])),r.value?(i(),B(Ne,{key:1,ref:"dadosUnidade",isVisible:r.value,unidade:s.unidade,onDadosUnidade:_,onCancelar:u},null,8,["isVisible","unidade"])):w("",!0)],64)}}},He={class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2"},Ke={class:"flex flex-col gap-4"},We={class:"absolute bottom-4 right-4"},Xe={key:1,class:"mt-4"},da={__name:"Index",setup(s){const d=l(null),r=l(!1),_=()=>{r.value=!r.value},m=()=>{u(),r.value=!1},u=()=>{l.listarUnidades.fetchUnidades()},n=o=>{d.value=o};return(o,h)=>(i(),B(ee,null,{default:H(()=>[t(K(W),{title:"Unidades"}),e("div",He,[e("div",null,[t(ye,{ref:"listarUnidades",onUnidadeCadastrada:u,onUnidadeSelecionada:n},null,512)]),e("div",Ke,[r.value?(i(),c("div",Xe,[t(ce,{isVisible:r.value,onUnidadeCadastrada:m,onCancelar:_},null,8,["isVisible"])])):(i(),c(F,{key:0},[d.value?(i(),B(Ge,{key:0,unidade:d.value},null,8,["unidade"])):w("",!0),e("div",We,[t(I,{text:"Nova Unidade",iconPath:"/storage/images/arrow_left_alt.svg",onClick:_,class:X({hidden:o.isEditMode})},null,8,["class"])])],64))])])]),_:1}))}};export{da as default};
