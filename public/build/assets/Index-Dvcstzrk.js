import{A as Z}from"./AppLayout-BVoSnRw1.js";import{y as j,o as l,e as u,a as e,j as G,v as H,F as E,g as J,t as B,s as M,d as r,c as U,w as q,i as F,b as p,h as k,z as Q,x as K,u as W,Z as Y}from"./app-9tAvmM-o.js";import{_ as R,I as O,a as X,B as A,C as N}from"./ConfirmDialog-C2Sc8nRL.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as z}from"./index-BX_v8uS5.js";import{B as ee}from"./ButtonEditeMedio-Cf58RrYk.js";const oe={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const n=await j.get("/api/lista-produtos");this.produtos=n.data}catch(n){console.error("Erro ao carregar os produtos:",n)}},selecionarProduto(n){this.$emit("produto-selecionado",n)}},computed:{filteredProdutos(){const n=this.searchQuery.toLowerCase();return this.produtos.filter(a=>a.nome.toLowerCase().includes(n))}}},se={class:"search-container relative flex items-center w-full mb-4"},te={class:"card-container"},ae=["onClick"],re={class:"card-inner"},le={class:"icon-container"},ie={class:"icon-leaf"},ne=["src"],de={class:"text-container"},ce={class:"city"};function ue(n,a,d,h,v,c){return l(),u("div",null,[a[4]||(a[4]=e("div",{class:"painel-title"},"Insumos",-1)),a[5]||(a[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",se,[a[1]||(a[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),G(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=t=>v.searchQuery=t),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[H,v.searchQuery]])]),e("div",te,[(l(!0),u(E,null,J(c.filteredProdutos,t=>(l(),u("div",{key:t.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:i=>c.selecionarProduto(t)},[e("div",re,[e("div",le,[a[2]||(a[2]=e("div",{class:"icon-bg"},null,-1)),e("div",ie,[e("img",{src:t.profile_photo||"/storage/images/no_imagem.svg",alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,ne)])]),e("div",de,[e("div",ce,B(t.nome),1)]),a[3]||(a[3]=e("div",{class:"action-icon"},null,-1))])],8,ae))),128))])])}const me=S(oe,[["render",ue],["__scopeId","data-v-07f3cea0"]]),pe={key:0,class:"sidebar-container"},ve={key:0,class:"loading-overlay"},fe={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},ge={class:"flex justify-center mb-6 relative group"},he=["src"],_e={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},ye={key:0,class:"error-message"},be={class:"flex justify-start space-x-1 mt-5"},xe={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(n,{emit:a}){const d=M(),h=a,v=r(""),c=r(""),t=r(null),i=r(""),f=r(null),w=r(!1),b=r(!1),C=r(""),P=()=>{var s;(s=f.value)==null||s.click()},I=s=>{C.value=s,b.value=!0},V=()=>{m(),b.value=!1},x=()=>{b.value=!1},_=()=>{c.value="",d.info("Imagem removida.")},$=s=>{const o=s.target.files[0];if(o){t.value=o;const g=new FileReader;g.onload=()=>{c.value=g.result,d.success("Imagem carregada com sucesso!")},g.readAsDataURL(o)}},D=()=>{y(),h("cancelar")},y=()=>{v.value="",c.value="",t.value=null,i.value=""},L=()=>!v.value||!t.value?(d.error("Por favor, preencha todos os campos obrigatórios."),i.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,m=async()=>{var s,o;if(L())try{w.value=!0;const g=new FormData;g.append("nome",v.value),g.append("profile_photo",t.value);const T=await j.post("/api/cadastar-produtos",g,{headers:{"Content-Type":"multipart/form-data"}});d.success("Produto cadastrado com sucesso!"),z.Inertia.visit("/insumos"),y()}catch(g){d.error("Erro ao cadastrar o produto."),i.value=((o=(s=g.response)==null?void 0:s.data)==null?void 0:o.message)||"Erro inesperado."}finally{w.value=!1}};return(s,o)=>(l(),U(Q,{name:"fade"},{default:q(()=>[n.isVisible?(l(),u("div",pe,[w.value?(l(),u("div",ve,o[3]||(o[3]=[e("div",{class:"spinner"},null,-1)]))):(l(),u("div",fe,[e("form",{onSubmit:F(m,["prevent"])},[e("div",ge,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:P},[c.value?(l(),u(E,{key:0},[e("img",{src:c.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,he),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:o[0]||(o[0]=F(()=>{},["stop"]))},[e("button",{onClick:F(_,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(l(),u("img",_e))]),e("input",{type:"file",ref_key:"fileInput",ref:f,accept:"image/*",class:"hidden",onChange:$},null,544)]),p(R,{text:"Nome"}),p(O,{modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=g=>v.value=g),placeholder:"Shoyu Premium Sakaki"},null,8,["modelValue"]),i.value?(l(),u("div",ye,B(i.value),1)):k("",!0),e("div",be,[p(X,{text:"Cancelar",onClick:D}),p(A,{text:"Cadastrar",onClick:o[2]||(o[2]=g=>I("Criar novo Produto?"))})])],32)])),p(N,{isVisible:b.value,motivo:C.value,onConfirm:V,onCancel:x},null,8,["isVisible","motivo"])])):k("",!0)]),_:1}))}},Ce=S(xe,[["__scopeId","data-v-5d14becd"]]),we={key:0,class:"sidebar-container"},ke={key:0,class:"loading-overlay"},$e={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},Pe={class:"flex justify-center mb-6 relative group"},Ie=["src"],Ve={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},De={key:0,class:"error-message"},Fe={class:"flex justify-start space-x-1 mt-5"},Ue={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(n,{emit:a}){const d=M(),h=n,v=a,c=r(""),t=r(""),i=r(null),f=r(""),w=r(null),b=r(!1),C=r(!1),P=r("");K(()=>h.produto,m=>{m&&(c.value=m.nome||"",t.value=m.profile_photo||"")},{immediate:!0});const I=async()=>{var m,s;if(!c.value){d.error("O campo nome é obrigatório.");return}try{b.value=!0;const o=new FormData;if(o.append("id",h.produto.id),o.append("nome",c.value),i.value){const T=`${Date.now()}_${i.value.name}`;o.append("profile_photo_name",T),o.append("profile_photo",i.value)}const g=await j.post("/api/atualizar-produtos",o,{headers:{"Content-Type":"multipart/form-data"}});z.Inertia.replace(route("insumos"),{produto:g.data.produto,preserveState:!0}),d.success("Produto atualizado com sucesso!")}catch(o){d.error("Erro ao atualizar o produto."),f.value=((s=(m=o.response)==null?void 0:m.data)==null?void 0:s.message)||"Erro inesperado."}finally{b.value=!1}},V=m=>{P.value=m,C.value=!0},x=()=>{I(),C.value=!1},_=()=>{C.value=!1},$=()=>{var m;(m=w.value)==null||m.click()},D=()=>{t.value="",d.info("Imagem removida.")},y=m=>{const s=m.target.files[0];if(s){i.value=s;const o=new FileReader;o.onload=()=>{t.value=o.result,d.success("Imagem carregada com sucesso!")},o.readAsDataURL(s)}},L=()=>{v("cancelar")};return(m,s)=>(l(),U(Q,{name:"fade"},{default:q(()=>[n.isVisible?(l(),u("div",we,[b.value?(l(),u("div",ke,s[4]||(s[4]=[e("div",{class:"spinner"},null,-1)]))):(l(),u("div",$e,[e("form",{onSubmit:F(I,["prevent"])},[e("div",Pe,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:$},[t.value?(l(),u(E,{key:0},[e("img",{src:t.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,Ie),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:s[0]||(s[0]=F(()=>{},["stop"]))},[e("button",{onClick:F(D,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(l(),u("img",Ve))]),e("input",{type:"file",ref_key:"fileInput",ref:w,accept:"image/*",class:"hidden",onChange:y},null,544)]),p(R,{text:"Nome"}),p(O,{modelValue:c.value,"onUpdate:modelValue":s[1]||(s[1]=o=>c.value=o),placeholder:""},null,8,["modelValue"]),f.value?(l(),u("div",De,B(f.value),1)):k("",!0),e("div",Fe,[p(X,{text:"Cancelar",onClick:L}),p(A,{text:"Atualizar",onClick:s[2]||(s[2]=o=>V("Atualizar esse Produto?"))})])],32),p(N,{isVisible:C.value,motivo:P.value,onConfirm:x,onCancel:_},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-4 right-4 cursor-pointer",onClick:s[3]||(s[3]=o=>V("Excluir esse produto?"))},s[5]||(s[5]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))]))])):k("",!0)]),_:1}))}},Ee=S(Ue,[["__scopeId","data-v-b70a770e"]]),je={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12 relative overflow-y-auto scrollbar-hidden"},Be={class:"relative w-full h-full"},Se={class:"flex items-center"},Le={class:"w-1/1 flex justify-center"},Me=["src"],qe={class:"w-2/3 pl-5"},Ae={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Ne={class:"w-1/1"},ze={key:1,class:"mt-4"},Te={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},setup(n){const a=M(),d=n,h=r(!1),v=r(""),c=r(!1),t=r(!1),i=r(!1),f=()=>{r.dadosProduto.fetchProduto()},w=async()=>{var x,_,$,D;try{i.value=!0;const y=await j.delete(`/api/excluir-produto/${d.produto.id}`);console.log(y.data.message),a.success("Produto deletado com sucesso!"),z.Inertia.visit("/insumos")}catch(y){a.error("Erro ao deletar o produto:",((_=(x=y.response)==null?void 0:x.data)==null?void 0:_.error)||y.message),console.error("Erro ao deletar o produto:",((D=($=y.response)==null?void 0:$.data)==null?void 0:D.error)||y.message)}finally{i.value=!1}},b=()=>{t.value=!t.value,c.value=!1},C=x=>{v.value=x,h.value=!0},P=()=>{w(),h.value=!1},I=()=>{h.value=!1},V=()=>{t.value=!1,c.value=!0};return(x,_)=>(l(),u(E,null,[t.value?k("",!0):(l(),u("div",je,[e("div",Be,[e("div",Se,[e("div",Le,[e("img",{src:n.produto.profile_photo||"/storage/images/no_imagem.svg",alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Me)]),e("div",qe,[e("div",Ae,B(n.produto.nome||"N/A"),1)]),e("div",Ne,[p(N,{isVisible:h.value,motivo:v.value,onConfirm:P,onCancel:I},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-4 right-4 cursor-pointer",onClick:_[0]||(_[0]=$=>C("Excluir esse produto?"))},_[1]||(_[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))])])])])),n.produto.id&&!t.value?(l(),u("div",ze,[p(ee,{text:"Editar Unidade","icon-path":"/storage/images/border_color.svg",onClick:b,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):k("",!0),t.value?(l(),U(Ee,{key:2,ref:"dadosProduto",isVisible:t.value,produto:n.produto,onDadosProduto:f,onCancelar:V},null,8,["isVisible","produto"])):k("",!0)],64))}},Qe=S(Te,[["__scopeId","data-v-f4ae7564"]]),Re={class:"flex flex-col gap-4"},Oe={class:"absolute bottom-4 right-4"},Xe={key:1,class:"mt-4"},Ye={__name:"Index",setup(n){const a=r(null),d=r(!1),h=()=>{d.value=!d.value},v=()=>{c(),d.value=!1},c=()=>{var f;(f=r("listarUnidades").value)==null||f.fetchUnidades()},t=i=>{i&&typeof i=="object"?a.value=i:console.warn("Dados inválidos recebidos no evento produto-selecionado:",i)};return(i,f)=>(l(),U(Z,null,{default:q(()=>[p(W(Y),{title:"Insumos"}),e("div",{class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2 overflow-hidden card-container h-full overflow-y-scroll",onScrollPassive:f[0]||(f[0]=()=>{})},[e("div",null,[p(me,{ref:"listarUnidades",onUnidadeCadastrada:c,onProdutoSelecionado:t},null,512)]),e("div",Re,[d.value?(l(),u("div",Xe,[p(Ce,{isVisible:d.value,onUnidadeCadastrada:v,onCancelar:h},null,8,["isVisible"])])):(l(),u(E,{key:0},[a.value?(l(),U(Qe,{key:0,produto:a.value},null,8,["produto"])):k("",!0),e("div",Oe,[p(A,{text:"Cadastrar insumo",iconPath:"/storage/images/arrow_left_alt.svg",onClick:h})])],64))])],32)]),_:1}))}};export{Ye as default};
