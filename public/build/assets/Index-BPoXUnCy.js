import{C as k}from"./CadastroProduto-DTBwDxMU.js";import{L as $}from"./LayoutFranqueado-C2yN6MR5.js";import{d as p,m as C,o as s,e as a,a as e,t as _,h as f,b as g,F as y,g as w,k as P,j as U,v as L,c as x,w as B,u as D,Z as q}from"./app-nikgK0qS.js";import{_ as E,a as I}from"./ButtonCancelar-BTyy3aOP.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ButtonPrimary-Cfkpbydk.js";import"./user-Cep6zz7g.js";const N={class:"elemento-fixo"},V={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},j={class:"relative w-full h-full"},F={class:"flex items-center"},Q={class:"w-1/1 flex justify-center"},M=["src"],R={class:"w-2/3 pl-5"},S={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},z={key:1,class:"mt-8"},A={class:"min-w-full table-auto"},T={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider rounded-tr-2xl"},O={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},G={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},K={key:1,class:"text-center"},Z={__name:"DetalhesProdutoPedidos",props:{produto:{type:Object,required:!0}},setup(o){const t=o,l=p({precos:[]}),d=p(!1),m=i=>(i/100).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),c=async()=>{try{if(t.produto&&t.produto.id){const n=(await P.get("/api/produtos/lista")).data;l.value=n.find(v=>v.id===t.produto.id)||{}}}catch(i){console.error("Erro ao buscar o produto:",i)}},r=i=>i?new URL(i,window.location.origin).href:"/storage/images/no_imagem.svg";return C(()=>t.produto,()=>{c()},{immediate:!0}),(i,n)=>(s(),a("div",N,[d.value?f("",!0):(s(),a("div",V,[n[0]||(n[0]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",j,[e("div",F,[e("div",Q,[e("img",{src:r(o.produto.profile_photo),alt:"Foto do Produto",class:"w-20 h-20 rounded-md shadow-lg"},null,8,M)]),e("div",R,[e("div",S,_(o.produto.nome||"N/A"),1)])])])])),d.value?f("",!0):(s(),a("div",z,[g(E,{text:"valor por fornecedor",class:"tracking-wider uppercase"}),e("table",A,[e("thead",null,[e("tr",null,[n[1]||(n[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider rounded-tl-2xl"}," Fornecedor ",-1)),e("th",T," Preço "+_(o.produto.unidadeDeMedida==="unitario"?"Unitario":"A Granel"),1)])]),e("tbody",null,[l.value.precos&&l.value.precos.length>0?(s(!0),a(y,{key:0},w(l.value.precos,(v,u)=>(s(),a("tr",{key:u,class:"text-center"},[e("td",O,_(v.fornecedor),1),e("td",G,_(m(v.preco_unitario)),1)]))),128)):(s(),a("tr",K,n[2]||(n[2]=[e("td",{colspan:"2",class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"}," Nenhum preço disponível para este produto. ",-1)])))])])]))]))}},H=b(Z,[["__scopeId","data-v-4f81c98e"]]),J={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const o=await P.get("/api/estoque/lista");console.log("Produtos carregados:",o.data),this.produtos=Object.values(o.data)}catch(o){console.error("Erro ao carregar os produtos:",o)}},getProfilePhotoUrl(o){return o?new URL(o,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(o){this.$emit("produto-selecionado",o)},getQuantidadeTotal(o){return o.reduce((t,l)=>t+l.quantidade,0)}},computed:{filteredProdutos(){const o=this.searchQuery.toLowerCase();return this.produtos.filter(t=>t.nome.toLowerCase().includes(o))}}},W={class:"search-container relative flex items-center w-full mb-4"},X={class:"card-container"},Y=["onClick"],ee={class:"card-inner"},te={class:"icon-container"},oe={class:"icon-leaf"},se=["src"],ae={class:"text-container flex justify-between items-center p-2"},re={class:"city"},de={class:"quantidade text-gray-600 font-semibold"},ie={class:"text-gray-600 font-semibold"};function ne(o,t,l,d,m,c){return s(),a("div",null,[t[3]||(t[3]=e("div",{class:"painel-title"},"Novo pedido",-1)),t[4]||(t[4]=e("div",{class:"painel-subtitle"},[e("p",null,"Efetuar novo pedido de insumos com fornecedor")],-1)),e("div",W,[t[1]||(t[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),U(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>m.searchQuery=r),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[L,m.searchQuery]])]),e("div",X,[(s(!0),a(y,null,w(c.filteredProdutos,r=>(s(),a("div",{key:r.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:i=>c.selecionarProduto(r)},[e("div",ee,[e("div",te,[t[2]||(t[2]=e("div",{class:"icon-bg"},null,-1)),e("div",oe,[e("img",{src:c.getProfilePhotoUrl(r.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,se)])]),e("div",ae,[e("div",re,_(r.nome),1),e("div",de,[e("div",ie,_(c.getQuantidadeTotal(r.lotes))+" "+_(r.unidadeDeMedida==="unitario"?"uni":"kg"),1)])])])],8,Y))),128))])])}const le=b(J,[["render",ne],["__scopeId","data-v-bce6f987"]]),ce={key:0,class:"mt-6"},ue={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},pe={key:0},fe={class:"flex flex-col gap-4"},_e={key:1,class:"absolute bottom-4 right-4 botao-container"},me={__name:"Index",setup(o){const t=p(null),l=p(0),d=p(!1),m=p(!1),c=()=>{d.value=!d.value},r=()=>{console.log("atualizando a lista"),t.value=null,l.value+=1},i=()=>{n(),d.value=!1},n=()=>{var h;(h=p("listarUnidades").value)==null||h.fetchUnidades()},v=u=>{u&&typeof u=="object"?t.value=u:console.warn("Dados inválidos recebidos no evento produto-selecionado:",u)};return(u,h)=>(s(),x($,null,{default:B(()=>[g(D(q),{title:"Novo Pedido"}),d.value?(s(),a("div",ce,[g(k,{isVisible:d.value,onUnidadeCadastrada:i,onCancelar:c},null,8,["isVisible"])])):f("",!0),e("div",ue,[d.value?f("",!0):(s(),a("div",pe,[(s(),x(le,{key:l.value,ref:"listarUnidades",onUnidadeCadastrada:n,onProdutoSelecionado:v}))])),e("div",fe,[d.value?f("",!0):(s(),a(y,{key:0},[t.value?(s(),x(H,{key:0,onAtualizar:r,produto:t.value},null,8,["produto"])):f("",!0),m.value?f("",!0):(s(),a("div",_e,[g(I,{text:"Efetuar Pedido",iconPath:"/storage/images/arrow_left_alt.svg",onClick:c})]))],64))])])]),_:1}))}},Pe=b(me,[["__scopeId","data-v-d2d5f224"]]);export{Pe as default};
