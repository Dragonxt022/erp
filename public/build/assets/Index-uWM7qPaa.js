import{A as H}from"./AppLayout-BnXik7ow.js";import{y as L,o as s,e as i,a as e,j as q,v as J,F as B,g as K,t as j,s as A,d as t,c as E,w as N,i as F,b as g,h as C,B as Q,z as O,x as W,u as Y,Z as ee}from"./app-BtLXV0vF.js";import{_ as X,I as Z,B as G,a as z,C as R,d as T}from"./ConfirmDialog-Cih5dzUr.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as oe}from"./ButtonEditeMedio-D6W-B_qZ.js";const se={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const n=await L.get("/api/lista-produtos");this.produtos=n.data}catch(n){console.error("Erro ao carregar os produtos:",n)}},selecionarProduto(n){this.$emit("produto-selecionado",n)}},computed:{filteredProdutos(){const n=this.searchQuery.toLowerCase();return this.produtos.filter(a=>a.nome.toLowerCase().includes(n))}}},te={class:"search-container relative flex items-center w-full mb-4"},ae={class:"card-container"},re=["onClick"],le={class:"card-inner"},ie={class:"icon-container"},ne={class:"icon-leaf"},de=["src"],ue={class:"text-container"},ce={class:"city"},pe={class:"owner"};function ve(n,a,d,_,h,u){return s(),i("div",null,[a[4]||(a[4]=e("div",{class:"painel-title"},"Insumos",-1)),a[5]||(a[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",te,[a[1]||(a[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),q(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>h.searchQuery=o),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[J,h.searchQuery]])]),e("div",ae,[(s(!0),i(B,null,K(u.filteredProdutos,o=>(s(),i("div",{key:o.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:c=>u.selecionarProduto(o)},[e("div",le,[e("div",ie,[a[2]||(a[2]=e("div",{class:"icon-bg"},null,-1)),e("div",ne,[e("img",{src:o.profile_photo||"/storage/images/no_imagem.svg",alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,de)])]),e("div",ue,[e("div",ce,j(o.nome),1),e("div",pe,j(o.categoria),1)]),a[3]||(a[3]=e("div",{class:"action-icon"},null,-1))])],8,re))),128))])])}const me=M(se,[["render",ve],["__scopeId","data-v-8553e81c"]]),fe={key:0,class:"sidebar-container"},ge={key:0,class:"loading-overlay"},he={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},_e={class:"flex justify-center mb-6 relative group"},ye=["src"],be={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},xe={key:0,class:"error-message"},we={class:"flex items-center space-x-4 mt-5"},Ce={class:"flex items-center space-x-2 cursor-pointer"},ke={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},$e={key:0,class:"w-3 h-3 rounded-full bg-green-500"},Pe={class:"flex items-center space-x-2 cursor-pointer"},Ve={class:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center"},Ie={key:0,class:"w-3 h-3 rounded-full bg-green-500"},De={class:"flex justify-start space-x-1 mt-5"},Fe={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(n,{emit:a}){const d=A(),_=a,h=t(""),u=t(""),o=t("secundario"),c=t(null),m=t(""),$=t(null),k=t(!1),y=t(!1),P=t(""),I=()=>{var r;(r=$.value)==null||r.click()},U=r=>{P.value=r,y.value=!0},x=()=>{v(),y.value=!1},b=()=>{y.value=!1},V=()=>{u.value="",d.info("Imagem removida.")},D=r=>{const l=r.target.files[0];if(l){c.value=l;const p=new FileReader;p.onload=()=>{u.value=p.result,d.success("Imagem carregada com sucesso!")},p.readAsDataURL(l)}},w=()=>{S(),_("cancelar")},S=()=>{h.value="",o.value="",u.value="",c.value=null,m.value=""},f=()=>!h.value||!c.value?(d.error("Por favor, preencha todos os campos obrigatórios."),m.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,v=async()=>{var r,l;if(f())try{k.value=!0;const p=new FormData;p.append("nome",h.value),p.append("categoria",o.value),p.append("profile_photo",c.value);const so=await L.post("/api/cadastar-produtos",p,{headers:{"Content-Type":"multipart/form-data"}});d.success("Produto cadastrado com sucesso!"),T.Inertia.visit("/insumos"),S()}catch(p){d.error("Erro ao cadastrar o produto."),m.value=((l=(r=p.response)==null?void 0:r.data)==null?void 0:l.message)||"Erro inesperado."}finally{k.value=!1}};return(r,l)=>(s(),E(O,{name:"fade"},{default:N(()=>[n.isVisible?(s(),i("div",fe,[k.value?(s(),i("div",ge,l[5]||(l[5]=[e("div",{class:"spinner"},null,-1)]))):(s(),i("div",he,[e("form",{onSubmit:F(v,["prevent"])},[e("div",_e,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:I},[u.value?(s(),i(B,{key:0},[e("img",{src:u.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,ye),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:l[0]||(l[0]=F(()=>{},["stop"]))},[e("button",{onClick:F(V,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(s(),i("img",be))]),e("input",{type:"file",ref_key:"fileInput",ref:$,accept:"image/*",class:"hidden",onChange:D},null,544)]),g(X,{text:"Nome"}),g(Z,{modelValue:h.value,"onUpdate:modelValue":l[1]||(l[1]=p=>h.value=p),placeholder:"Shoyu Premium Sakaki"},null,8,["modelValue"]),m.value?(s(),i("div",xe,j(m.value),1)):C("",!0),e("div",we,[e("label",Ce,[q(e("input",{type:"radio","onUpdate:modelValue":l[2]||(l[2]=p=>o.value=p),value:"principal",class:"hidden"},null,512),[[Q,o.value]]),e("div",ke,[o.value==="principal"?(s(),i("div",$e)):C("",!0)]),l[6]||(l[6]=e("span",null,"Principal",-1))]),e("label",Pe,[q(e("input",{type:"radio","onUpdate:modelValue":l[3]||(l[3]=p=>o.value=p),value:"secundario",class:"hidden"},null,512),[[Q,o.value]]),e("div",Ve,[o.value==="secundario"?(s(),i("div",Ie)):C("",!0)]),l[7]||(l[7]=e("span",null,"Secundário",-1))])]),e("div",De,[g(G,{text:"Cancelar",onClick:w}),g(z,{text:"Cadastrar",onClick:l[4]||(l[4]=p=>U("Criar novo Produto?"))})])],32)])),g(R,{isVisible:y.value,motivo:P.value,onConfirm:x,onCancel:b},null,8,["isVisible","motivo"])])):C("",!0)]),_:1}))}},Ue=M(Fe,[["__scopeId","data-v-452453f6"]]),je={key:0,class:"sidebar-container"},Ee={key:0,class:"loading-overlay"},Be={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},Se={class:"flex justify-center mb-6 relative group"},Le=["src"],Me={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},qe={key:0,class:"error-message"},Ae={class:"flex justify-start space-x-1 mt-5"},Ne={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(n,{emit:a}){const d=A(),_=n,h=a,u=t(""),o=t(""),c=t(null),m=t(""),$=t(null),k=t(!1),y=t(!1),P=t("");W(()=>_.produto,f=>{f&&(u.value=f.nome||"",o.value=f.profile_photo||"")},{immediate:!0});const I=async()=>{var f,v;if(!u.value){d.error("O campo nome é obrigatório.");return}try{k.value=!0;const r=new FormData;if(r.append("id",_.produto.id),r.append("nome",u.value),c.value){const p=`${Date.now()}_${c.value.name}`;r.append("profile_photo_name",p),r.append("profile_photo",c.value)}const l=await L.post("/api/atualizar-produtos",r,{headers:{"Content-Type":"multipart/form-data"}});T.Inertia.replace(route("insumos"),{produto:l.data.produto,preserveState:!0}),d.success("Produto atualizado com sucesso!")}catch(r){d.error("Erro ao atualizar o produto."),m.value=((v=(f=r.response)==null?void 0:f.data)==null?void 0:v.message)||"Erro inesperado."}finally{k.value=!1}},U=f=>{P.value=f,y.value=!0},x=()=>{I(),y.value=!1},b=()=>{y.value=!1},V=()=>{var f;(f=$.value)==null||f.click()},D=()=>{o.value="",d.info("Imagem removida.")},w=f=>{const v=f.target.files[0];if(v){c.value=v;const r=new FileReader;r.onload=()=>{o.value=r.result,d.success("Imagem carregada com sucesso!")},r.readAsDataURL(v)}},S=()=>{h("cancelar")};return(f,v)=>(s(),E(O,{name:"fade"},{default:N(()=>[n.isVisible?(s(),i("div",je,[k.value?(s(),i("div",Ee,v[3]||(v[3]=[e("div",{class:"spinner"},null,-1)]))):(s(),i("div",Be,[e("form",{onSubmit:F(I,["prevent"])},[e("div",Se,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:V},[o.value?(s(),i(B,{key:0},[e("img",{src:o.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,Le),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:v[0]||(v[0]=F(()=>{},["stop"]))},[e("button",{onClick:F(D,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(s(),i("img",Me))]),e("input",{type:"file",ref_key:"fileInput",ref:$,accept:"image/*",class:"hidden",onChange:w},null,544)]),g(X,{text:"Nome"}),g(Z,{modelValue:u.value,"onUpdate:modelValue":v[1]||(v[1]=r=>u.value=r),placeholder:""},null,8,["modelValue"]),m.value?(s(),i("div",qe,j(m.value),1)):C("",!0),e("div",Ae,[g(G,{text:"Cancelar",onClick:S}),g(z,{text:"Atualizar",onClick:v[2]||(v[2]=r=>U("Atualizar esse Produto?"))})])],32),g(R,{isVisible:y.value,motivo:P.value,onConfirm:x,onCancel:b},null,8,["isVisible","motivo"])]))])):C("",!0)]),_:1}))}},ze=M(Ne,[["__scopeId","data-v-13c9c638"]]),Re={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12 relative overflow-y-auto scrollbar-hidden"},Te={class:"relative w-full h-full"},Qe={class:"flex items-center"},Oe={class:"w-1/1 flex justify-center"},Xe=["src"],Ze={class:"w-2/3 pl-5"},Ge={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},He={class:"w-1/1"},Je={key:1,class:"mt-4"},Ke={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},setup(n){const a=A(),d=n,_=t(!1),h=t(""),u=t(!1),o=t(!1),c=t(!1),m=()=>{t.dadosProduto.fetchProduto()},$=async()=>{var x,b,V,D;try{c.value=!0;const w=await L.delete(`/api/excluir-produto/${d.produto.id}`);console.log(w.data.message),a.success("Produto deletado com sucesso!"),T.Inertia.visit("/insumos")}catch(w){a.error("Erro ao deletar o produto:",((b=(x=w.response)==null?void 0:x.data)==null?void 0:b.error)||w.message),console.error("Erro ao deletar o produto:",((D=(V=w.response)==null?void 0:V.data)==null?void 0:D.error)||w.message)}finally{c.value=!1}},k=()=>{o.value=!o.value,u.value=!1},y=x=>{h.value=x,_.value=!0},P=()=>{$(),_.value=!1},I=()=>{_.value=!1},U=()=>{o.value=!1,u.value=!0};return(x,b)=>(s(),i(B,null,[o.value?C("",!0):(s(),i("div",Re,[e("div",Te,[e("div",Qe,[e("div",Oe,[e("img",{src:n.produto.profile_photo||"/storage/images/no_imagem.svg",alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Xe)]),e("div",Ze,[e("div",Ge,j(n.produto.nome||"N/A"),1)]),e("div",He,[g(R,{isVisible:_.value,motivo:h.value,onConfirm:P,onCancel:I},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-4 right-4 cursor-pointer",onClick:b[0]||(b[0]=V=>y("Excluir esse produto?"))},b[1]||(b[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))])])])])),n.produto.id&&!o.value?(s(),i("div",Je,[g(oe,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:k,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):C("",!0),o.value?(s(),E(ze,{key:2,ref:"dadosProduto",isVisible:o.value,produto:n.produto,onDadosProduto:m,onCancelar:U},null,8,["isVisible","produto"])):C("",!0)],64))}},We=M(Ke,[["__scopeId","data-v-237de369"]]),Ye={class:"flex flex-col gap-4"},eo={class:"absolute bottom-4 right-4"},oo={key:1,class:"mt-4"},no={__name:"Index",setup(n){const a=t(null),d=t(!1),_=()=>{d.value=!d.value},h=()=>{u(),d.value=!1},u=()=>{var m;(m=t("listarUnidades").value)==null||m.fetchUnidades()},o=c=>{c&&typeof c=="object"?a.value=c:console.warn("Dados inválidos recebidos no evento produto-selecionado:",c)};return(c,m)=>(s(),E(H,null,{default:N(()=>[g(Y(ee),{title:"Insumos"}),e("div",{class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2 overflow-hidden card-container h-full overflow-y-scroll",onScrollPassive:m[0]||(m[0]=()=>{})},[e("div",null,[g(me,{ref:"listarUnidades",onUnidadeCadastrada:u,onProdutoSelecionado:o},null,512)]),e("div",Ye,[d.value?(s(),i("div",oo,[g(Ue,{isVisible:d.value,onUnidadeCadastrada:h,onCancelar:_},null,8,["isVisible"])])):(s(),i(B,{key:0},[a.value?(s(),E(We,{key:0,produto:a.value},null,8,["produto"])):C("",!0),e("div",eo,[g(z,{text:"Cadastrar insumo",iconPath:"/storage/images/arrow_left_alt.svg",onClick:_})])],64))])],32)]),_:1}))}};export{no as default};
