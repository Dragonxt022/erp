import{l as P,d,i as D,k as $,c as q,o as p,w as C,b as r,a as e,u as z,Z as U,m as c,e as v,F as B,h as F,t as m,x as S,n as j,v as f}from"./app-Bh3-sTA_.js";import{L as E}from"./LayoutFranqueado-BDfelG1B.js";import{_ as i}from"./LabelModel-4KJvSajk.js";import{B as I}from"./ButtonPrimaryMedio-DLPH7BKL.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-Ddy5XIz5.js";const N={class:"mt-5"},A={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4"},K={class:"bg-white rounded-lg px-12 py-5"},O={class:"flex flex-col flex-1"},T=["value"],Z=["value"],G={class:"bg-white rounded-lg px-12 py-5"},H={class:"flex items-center -mt-9"},J={class:"w-[40px] h-[40px] ml-2",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Q=["points","fill"],W={class:"bg-white rounded-lg px-12 py-5"},X={class:"mt-4 flex flex-col gap-3"},Y={class:"flex justify-between items-center px-4 py-2 rounded-lg"},ee={class:"relative flex items-center w-full"},oe={class:"flex justify-between items-center px-4 py-2 rounded-lg"},te={class:"flex justify-between items-center px-4 py-2 rounded-lg"},se={class:"rounded-lg px-12 py-5"},ae={class:"flex items-center -mt-5"},le={class:"font-bold text-[63.36px] text-[#424242] tracking-wider"},re={class:"flex items-center gap-2 text-[#6d6d6d] text-[15px] font-semibold -mt-4"},ie={class:"absolute bottom-4 right-4 botao-container"},ne={__name:"LimpesaSalmao",setup(de){const b=P(),y=d([]),w=d([]),l=d(0),n=d(0),_=d("R$ 0,00"),s=d({responsavel_id:"",calibre_id:"",valor_pago:"R$ 0,00",peso_bruto:"0,000",peso_limpo:"0,000"});D(async()=>{try{const a=await $.get("/api/gestao-residuos/limpeza");y.value=a.data.colaboradores,w.value=a.data.calibres}catch(a){console.error("Erro ao carregar dados:",a)}});const L=()=>{let a=s.value.valor_pago.replace(/\D/g,"");if(!a)s.value.valor_pago="R$ 0,00";else{let o=a.slice(0,-2)||"0",t=a.slice(-2).padStart(2,"0");s.value.valor_pago=`R$ ${Number(o).toLocaleString("pt-BR")},${t}`}R()},h=(a,o)=>{let t=o.replace(/\D/g,"");if(!t)s.value[a]="0,000";else{let x=t.slice(0,-3)||"0",g=t.slice(-3).padStart(3,"0");s.value[a]=`${Number(x).toLocaleString("pt-BR")},${g}`}V()},u=a=>parseFloat(a.replace(",",".")||"0"),V=()=>{const a=u(s.value.peso_bruto),o=u(s.value.peso_limpo);a>0?(l.value=(o/a*100).toFixed(2),n.value=(a-o).toFixed(3)):(l.value=0,n.value=0),R()},R=()=>{const a=parseFloat(s.value.valor_pago.replace(/[^\d,]/g,"").replace(",",".")||"0"),o=u(s.value.peso_bruto);if(o>0){const t=a/o,x=parseFloat(n.value),g=(t*x).toFixed(2);_.value=`R$ ${g.replace(".",",")}`}else _.value="R$ 0,00"},k=async()=>{try{const a=await $.post("/api/gestao-residuos/adicionar",{responsavel_id:s.value.responsavel_id,calibre_id:s.value.calibre_id,valor_pago:parseFloat(s.value.valor_pago.replace(/[^\d,]/g,"").replace(",",".")),peso_bruto:u(s.value.peso_bruto),peso_limpo:u(s.value.peso_limpo),aproveitamento:parseFloat(l.value),desperdicio:parseFloat(n.value)});b.success("Operação realizada com sucesso!"),console.log("Registro salvo:",a.data),s.value={responsavel_id:"",calibre_id:"",valor_pago:"R$ 0,00",peso_bruto:"0,000",peso_limpo:"0,000"},l.value=0,n.value=0,_.value="R$ 0,00"}catch(a){b.error("Ouve um erro:",a),console.error("Erro ao salvar:",a)}};return(a,o)=>(p(),q(E,null,{default:C(()=>[r(z(U),{title:"Limpeza de Salmão"}),o[9]||(o[9]=e("div",{class:"flex justify-between items-center mb-4"},[e("div",null,[e("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Limpeza de Salmão "),e("div",{class:"painel-subtitle"},[e("p",{class:"text-sm sm:text-base md:text-lg"}," Registre o aproveitamento de salmão ")])])],-1)),e("div",N,[e("div",A,[e("div",K,[e("div",O,[r(i,{text:"Responsável",class:"mb-2"}),c(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>s.value.responsavel_id=t),class:"input-select",required:""},[o[7]||(o[7]=e("option",{value:"",disabled:"",selected:""}," Selecione um Responsável ",-1)),(p(!0),v(B,null,F(y.value,t=>(p(),v("option",{key:t.id,value:t.id},m(t.name),9,T))),128))],512),[[S,s.value.responsavel_id]]),r(i,{text:"Calibre do Salmão",class:"mb-2"}),c(e("select",{"onUpdate:modelValue":o[1]||(o[1]=t=>s.value.calibre_id=t),class:"input-select",required:""},[o[8]||(o[8]=e("option",{value:"",disabled:"",selected:""},"Selecione um calibre",-1)),(p(!0),v(B,null,F(w.value,t=>(p(),v("option",{key:t.id,value:t.id},m(t.nome),9,Z))),128))],512),[[S,s.value.calibre_id]])])]),e("div",G,[r(i,{text:"Aproveitamento"}),e("div",H,[e("span",{class:j({"font-bold text-[120.01px] tracking-wider":!0,"text-[#1d5915]":l.value>=72,"text-red-600":l.value<72})},m(l.value)+"% ",3),(p(),v("svg",J,[e("polygon",{points:l.value>=72?"12,2 22,20 2,20":"12,22 22,2 2,2",fill:l.value>=72?"#6DB631":"#DC2626"},null,8,Q)]))])]),e("div",W,[e("div",X,[e("div",Y,[r(i,{text:"Valor Pago",class:"text-gray-800"}),e("div",ee,[c(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>s.value.valor_pago=t),onInput:L,class:"input-text",placeholder:"R$ 0,00",required:""},null,544),[[f,s.value.valor_pago]])])]),e("div",oe,[r(i,{text:"Peso Bruto",class:"text-gray-800"}),c(e("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>s.value.peso_bruto=t),onInput:o[4]||(o[4]=t=>h("peso_bruto",t.target.value)),class:"input-text",placeholder:"0,000",required:""},null,544),[[f,s.value.peso_bruto]])]),e("div",te,[r(i,{text:"Peso Limpo",class:"text-gray-800"}),c(e("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>s.value.peso_limpo=t),onInput:o[6]||(o[6]=t=>h("peso_limpo",t.target.value)),class:"input-text",placeholder:"0,000",required:""},null,544),[[f,s.value.peso_limpo]])])])]),e("div",se,[r(i,{text:"Desperdício"}),e("div",ae,[e("span",le,m(n.value)+" kg ",1)]),e("div",re,[e("p",null,"Equivalente a "+m(_.value),1)])])]),e("div",ie,[r(I,{text:"Concluir",iconPath:"/storage/images/arrow_left_alt.svg",onClick:k})])])]),_:1}))}},xe=M(ne,[["__scopeId","data-v-fc98e696"]]);export{xe as default};
