import{ae as Z,d as k,j as p,i as F,a3 as G,e as n,o as a,a as t,c as O,f as C,a0 as W,F as q,h as z,n as P,t as S,w as B,u as I,$ as N,k as M,af as H,q as j,a2 as T,ag as J,p as K,b as $,a4 as Q,ah as U,a6 as X,Z as Y,r as ee,ad as te}from"./app-C52zFhyA.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D=Z("sidebar",{state:()=>({isOpen:!1}),actions:{toggle(){this.isOpen=!this.isOpen},open(){this.isOpen=!0},close(){this.isOpen=!1}}}),se={class:"navbar"},ae={class:"navbar-content"},oe={class:"navbar-left"},ne={class:"navbar-logo"},ie=["href"],le={class:"navbar-right"},re={class:"notification-container mr-4"},ce={key:0,class:"notification-badge"},ue={key:0,class:"notification-tray"},de={class:"notification-header"},ve={class:"notification-list"},me={key:0,class:"notification-loading"},he={key:1,class:"no-notifications"},fe=["onClick"],pe={class:"notification-icon-type"},ge={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ke={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_e={key:2,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},be={class:"notification-content"},we={class:"notification-title"},Se={class:"notification-message"},ye={class:"notification-time"},Ce={key:0,class:"user-info"},xe=["src"],Ie={class:"user-details"},Le={class:"user-name"},Pe={class:"user-location"},Ee={key:1,class:"user-info loading"},Ae={__name:"Navbar",setup(h){const o=D(),m=()=>{o.toggle()},i=k(null),x=p(()=>{var s;return(s=i.value)==null?void 0:s.unidade}),d=k([]),b=k(!1),_=k(!1),L=p(()=>d.value.filter(s=>s.lida===0).length),w=p(()=>{var s,e;return((s=i.value)==null?void 0:s.profile_photo_path)||`https://ui-avatars.com/api/?name=${E((e=i.value)==null?void 0:e.name)}&color=7F9CF5&background=EBF4FF`}),E=s=>s?s.split(" ").map(r=>r.charAt(0).toUpperCase()).join(""):"*",A=async()=>{try{const s=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar perfil do usuário");const e=await s.json();i.value=e.data}catch(s){console.error("Erro ao buscar perfil:",s),i.value=null}},l=async()=>{b.value=!0;try{const s=await fetch("/api/notificacoes",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar notificações");const e=await s.json();d.value=e.data}catch(s){console.error("Erro ao buscar notificações:",s),d.value=[]}finally{b.value=!1}},c=async s=>{try{if((await M.post(`/api/notificacoes/${s}/ler`)).status===200){const r=d.value.findIndex(y=>y.id===s);r!==-1&&(d.value[r].lida=1,d.value[r].lida_em=new Date().toISOString())}}catch(e){console.error("Erro ao marcar notificação como lida:",e)}},v=async()=>{try{(await M.post("/api/notificacoes/ler-todas")).status===200&&d.value.forEach(e=>{e.lida=1,e.lida_em=new Date().toISOString()})}catch(s){console.error("Erro ao marcar todas notificações como lidas:",s)}},u=s=>{s.stopPropagation(),_.value=!_.value,_.value&&l()},f=s=>{const e=document.querySelector(".notification-container");e&&!e.contains(s.target)&&(_.value=!1)};let g;return F(()=>{A(),l(),document.addEventListener("click",f),g=setInterval(()=>{_.value||l()},3e5)}),G(()=>{document.removeEventListener("click",f),clearInterval(g)}),(s,e)=>(a(),n("div",se,[e[10]||(e[10]=t("div",{class:"navbar-background"},null,-1)),t("div",ae,[t("div",oe,[t("div",ne,[t("div",{class:"mr-4 mt-2 hide-mobile"},[t("button",{onClick:m},e[0]||(e[0]=[t("img",{src:"/storage/images/quadrados_verdes.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),t("div",null,[t("a",{href:s.route("franqueado.painel")},e[1]||(e[1]=[t("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,ie)])])]),t("div",le,[t("div",re,[t("div",{class:"notification-icon",onClick:u},[e[2]||(e[2]=W('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-ab8307da><mask id="mask0_4631_13059" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24" data-v-ab8307da><rect width="24" height="24" fill="#D9D9D9" data-v-ab8307da></rect></mask><g mask="url(#mask0_4631_13059)" data-v-ab8307da><path d="M2.40039 20.4V18H4.80039V9.6C4.80039 7.94 5.30039 6.465 6.30039 5.175C7.30039 3.885 8.60039 3.04 10.2004 2.64V1.8C10.2004 1.3 10.3754 0.875 10.7254 0.525C11.0754 0.175 11.5004 0 12.0004 0C12.5004 0 12.9254 0.175 13.2754 0.525C13.6254 0.875 13.8004 1.3 13.8004 1.8V2.64C15.4004 3.04 16.7004 3.885 17.7004 5.175C18.7004 6.465 19.2004 7.94 19.2004 9.6V18H21.6004V20.4H2.40039ZM12.0004 24C11.3404 24 10.7754 23.765 10.3054 23.295C9.83539 22.825 9.60039 22.26 9.60039 21.6H14.4004C14.4004 22.26 14.1654 22.825 13.6954 23.295C13.2254 23.765 12.6604 24 12.0004 24ZM7.20039 18H16.8004V9.6C16.8004 8.28 16.3304 7.15 15.3904 6.21C14.4504 5.27 13.3204 4.8 12.0004 4.8C10.6804 4.8 9.55039 5.27 8.61039 6.21C7.67039 7.15 7.20039 8.28 7.20039 9.6V18Z" fill="#6DB631" data-v-ab8307da></path></g></svg>',1)),L.value>0?(a(),n("div",ce)):C("",!0)]),_.value?(a(),n("div",ue,[t("div",de,[e[3]||(e[3]=t("h3",null,"Notificações",-1)),d.value.length>0?(a(),n("span",{key:0,onClick:v,class:"mark-all-read"}," Marcar todas como lidas ")):C("",!0)]),t("div",ve,[b.value?(a(),n("div",me,e[4]||(e[4]=[t("div",{class:"notification-skeleton"},null,-1),t("div",{class:"notification-skeleton"},null,-1)]))):d.value.length===0?(a(),n("div",he," Nenhuma notificação no momento ")):(a(!0),n(q,{key:2},z(d.value,r=>(a(),n("div",{key:r.id,class:P(["notification-item",{unread:r.lida===0}]),onClick:y=>c(r.id)},[t("div",pe,[r.tipo==="info"?(a(),n("svg",ge,e[5]||(e[5]=[t("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 100-16 8 8 0 000 16zM11 7h2v2h-2V7zm0 4h2v6h-2v-6z",fill:"#6DB631"},null,-1)]))):r.tipo==="alerta"?(a(),n("svg",ke,e[6]||(e[6]=[t("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-1-7v2h2v-2h-2zm0-8v6h2V7h-2z",fill:"#FF9800"},null,-1)]))):(a(),n("svg",_e,e[7]||(e[7]=[t("path",{d:"M4 19h16v2H4v-2zm5-4h11v2H9v-2zm-5-4h16v2H4v-2zm5-4h11v2H9V7zM4 3h16v2H4V3z",fill:"#6DB631"},null,-1)])))]),t("div",be,[t("div",we,S(r.titulo),1),t("div",Se,S(r.mensagem),1),t("div",ye,S(r.tempo),1)])],10,fe))),128))])])):C("",!0)]),t("div",{class:"view-mobile"},[t("button",{onClick:m},e[8]||(e[8]=[t("img",{src:"/storage/images/bx-menuv.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),i.value?(a(),O(I(N),{key:0,href:"https://login.taiksu.com.br/perfil",class:P(["user-info hide-mobile",{loading:!i.value}])},{default:B(()=>{var r;return[i.value?(a(),n("div",Ce,[t("img",{src:w.value,alt:"Avatar",class:"avatar"},null,8,xe),t("div",Ie,[t("div",Le,S(i.value.name),1),t("div",Pe,S(((r=x.value)==null?void 0:r.cidade)||"Taiksu Franchising"),1)])])):(a(),n("div",Ee,e[9]||(e[9]=[t("div",{class:"avatar-skeleton"},null,-1),t("div",{class:"user-details-skeleton"},[t("div",{class:"name-skeleton"}),t("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["class"])):C("",!0)])])]))}},$e=V(Ae,[["__scopeId","data-v-ab8307da"]]),qe={class:"icon"},ze=["src"],Me={class:"label"},Ve={type:"submit",class:"w-full h-full flex items-center"},Be={class:"icon"},Ne=["src"],Fe={class:"label"},Oe={key:2,class:"submenu"},De={class:"label"},He={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(h){const o=h,m=H("userPermissions",k({})),i=H("openSubmenuLink",k(null)),x=p(()=>i.value===o.link),d=p(()=>x.value),b=p(()=>o.link&&/^https?:\/\//.test(o.link)),_=p(()=>b.value?o.link:o.link?route(o.link):"#"),L=p(()=>!o.requiredPermission||m.value[o.requiredPermission]),w=p(()=>o.submenuItems.filter(e=>!e.requiredPermission||m.value[e.requiredPermission])),E=e=>{w.value.length>0&&(e.preventDefault(),A())},A=()=>{i.value===o.link?i.value=null:i.value=o.link,c()},l=()=>{const e=localStorage.getItem("openSubmenuLink");e!==null&&(i.value=e)},c=()=>{i.value?localStorage.setItem("openSubmenuLink",i.value):localStorage.removeItem("openSubmenuLink")},v=p(()=>f.value||o.isActive?"submenu-active":""),u=e=>{const r=window.location.pathname,y=new URL(route(e),window.location.origin).pathname;return r===y},f=p(()=>w.value.some(e=>u(e.link))),g=()=>{o.isLogout&&Q.post(route("logout.sair"))};return l(),j(f,()=>{!f.value&&i.value===o.link&&T(()=>{i.value=null,c()})}),j(i,()=>{T(()=>c())}),(e,r)=>(a(),n("div",null,[!h.isLogout&&h.link&&L.value?(a(),O(J(b.value?"a":I(N)),{key:0,class:P(["menu-item",[v.value,{active:h.isActive||f.value}]]),href:_.value,target:b.value?"_blank":null,onClick:E},{default:B(()=>[t("div",qe,[t("img",{src:h.icon,alt:"icon"},null,8,ze)]),t("div",Me,S(h.label),1),w.value.length>0?(a(),n("div",{key:0,class:P(["right-icon",{"rotate-icon":d.value}])},r[0]||(r[0]=[t("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):C("",!0)]),_:1},8,["class","href","target"])):h.isLogout&&L.value?(a(),n("form",{key:1,onSubmit:K(g,["prevent"]),class:"menu-item"},[t("button",Ve,[t("div",Be,[t("img",{src:h.icon,alt:"icon"},null,8,Ne)]),t("div",Fe,S(h.label),1)])],32)):C("",!0),w.value.length>0&&(x.value||f.value)?(a(),n("div",Oe,[(a(!0),n(q,null,z(w.value,(y,R)=>(a(),n("div",{key:R},[$(I(N),{class:P(["submenu-item",{active:u(y.link)}]),href:e.route(y.link)},{default:B(()=>[t("div",De,S(y.label),1)]),_:2},1032,["href","class"])]))),128))])):C("",!0)]))}},je=V(He,[["__scopeId","data-v-fe119916"]]),Te={key:0,class:"loader-container"},Ue={key:0,class:"category-title menu-categorias text-sm sm:text-base font-medium text-[#87ba73] mb-3 pl-4"},Re={__name:"Slidebar",setup(h){const o=k(null),m=k({}),i=k([]),x=D(),d=k(!0),b=k(null),_=async()=>{try{const l=await M.get("/api/navbar-profile");m.value=l.data.data.permissions||{}}catch(l){console.error("Erro ao carregar permissões:",l),m.value={}}},L=async()=>{try{const v=((await M.get("/api/menu")).data.data||[]).map(u=>{const f=(u.items||[]).slice().sort((g,s)=>g.order-s.order);return f.forEach(g=>{g.children&&Array.isArray(g.children)&&(g.children=g.children.slice().sort((s,e)=>s.order-e.order))}),{...u,items:f}}).sort((u,f)=>u.order-f.order);i.value=v}catch(l){console.error("Erro ao carregar menu:",l),i.value=[]}};U("userPermissions",m),U("openSubmenuLink",b);const w=p(()=>i.value.map(l=>({...l,items:l.items.filter(c=>!c.required_permission||m.value[c.required_permission]||c.children&&c.children.some(v=>!v.required_permission||m.value[v.required_permission])).map(c=>({...c,submenuItems:c.children||[]}))})).filter(l=>l.items.length>0));F(async()=>{d.value=!0,await _(),await L();const l=localStorage.getItem("sidebarScrollPosition");l&&o.value&&(o.value.scrollTop=l),d.value=!1});const E=()=>{o.value&&localStorage.setItem("sidebarScrollPosition",o.value.scrollTop)},A=l=>{const c=window.location.pathname,v=new URL(l,window.location.origin).pathname;return c===v||c.startsWith(v)};return(l,c)=>(a(),n("div",null,[d.value?(a(),n("div",Te,c[0]||(c[0]=[t("div",{class:"spinner"},null,-1)]))):(a(),n("div",{key:1,class:P(["sidebar fixed top-16 left-0 bg-[#164110] text-white flex flex-col p-3 overflow-y-auto h-full transition-transform duration-300 ease-in-out",I(x).isOpen?"translate-x-0":"-translate-x-full","md:translate-x-0 md:relative  md:top-0 md:left-0"]),ref_key:"sidebar",ref:o,onScroll:E},[(a(!0),n(q,null,z(w.value,v=>(a(),n("div",{key:v.name,class:"menu-category mb-6"},[v.items.length>0?(a(),n("div",Ue,S(v.name),1)):C("",!0),(a(!0),n(q,null,z(v.items,u=>(a(),O(je,{key:u.link||"no-link",label:u.label,icon:u.icon,link:u.link,submenuItems:u.submenuItems,isActive:u.link?A(u.link):!1,isLogout:u.isLogout,requiredPermission:u.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],34))]))}},Ze=V(Re,[["__scopeId","data-v-d40e1687"]]),Ge={__name:"LayoutFranqueado",props:{title:String},setup(h){const o=D();function m(){window.innerWidth<768?o.close():o.open()}return F(()=>{window.addEventListener("resize",m),m()}),X(()=>{window.removeEventListener("resize",m)}),(i,x)=>(a(),n("div",null,[$(I(Y),{title:h.title},null,8,["title"]),$($e),$(Ze),t("main",{class:"content",style:te({left:I(o).isOpen?"252px":"0",width:I(o).isOpen?"calc(100vw - 250px)":"100vw"})},[ee(i.$slots,"default",{},void 0,!0)],4)]))}},Ke=V(Ge,[["__scopeId","data-v-d63d761a"]]);export{Ke as L};
