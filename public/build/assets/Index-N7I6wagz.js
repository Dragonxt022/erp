import{L}from"./LayoutFranqueado-BgK6aJaP.js";import{d as i,y as D,i as C,o as n,e as r,a as t,h as v,F as M,g as I,t as w,k as $,l as P,m as z,b as g,c as y,w as V,u as j,Z as E}from"./app-B_IC-dFD.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as S}from"./InputModel-B4C_f38j.js";import{_ as k}from"./LabelModel-SppCun-u.js";import{D as U}from"./Deslizante-Bm2EEEwz.js";import"./user-_XaA0sgt.js";const B={key:0,class:"loading-overlay"},F={class:"card-container"},N=["onClick"],q={class:"card-inner"},A={class:"icon-container"},O={class:"icon-leaf"},Q=["src"],T={class:"text-container"},K={class:"city"},R={__name:"ListarMetodosPagamentos",emits:["dado-selecionado"],setup(x,{emit:u}){const p=u,l=i([]),f=i(""),a=i(!1),d=async()=>{a.value=!0;try{const o=await $.get("/api/metodos-pagamentos/lista");l.value=Object.values(o.data)}catch(o){console.error("Erro ao carregar os dados:",o)}finally{a.value=!1}},c=o=>o?new URL(o,window.location.origin).href:"/storage/images/no_imagem.svg";D(d);const _=o=>{p("dado-selecionado",o)},h=C(()=>{const o=f.value.toLowerCase();return l.value.filter(e=>String(e.id).toLowerCase().includes(o)||e.fornecedor_nome.toLowerCase().includes(o))});return(o,e)=>(n(),r("div",null,[a.value?(n(),r("div",B,e[0]||(e[0]=[t("div",{class:"spinner"},null,-1)]))):v("",!0),e[3]||(e[3]=t("div",{class:"painel-title"},"Métodos de pagamento",-1)),e[4]||(e[4]=t("div",{class:"painel-subtitle"},[t("p",null,"Ative formas de pagamento para o fluxo de caixa")],-1)),t("div",F,[(n(!0),r(M,null,I(h.value,s=>(n(),r("div",{key:s.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:m=>_(s)},[t("div",q,[t("div",A,[e[1]||(e[1]=t("div",{class:"icon-bg"},null,-1)),t("div",O,[t("img",{src:c(s.img_icon),alt:"Ícone"},null,8,Q)])]),t("div",T,[t("div",K,w(s.nome),1)]),e[2]||(e[2]=t("div",{class:"action-icon"},null,-1))])],8,N))),128))])]))}},Z=b(R,[["__scopeId","data-v-8a662b50"]]),G={class:"elemento-fixo"},H={key:0},J={key:0,class:"loading-overlay"},W={class:"w-full h-[237px] p-12 bg-white rounded-[20px] flex-col justify-center items-center gap-10 inline-flex"},X={class:"self-stretch text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[34px] tracking-tight"},Y={class:"w-full h-[63px] relative"},ee={class:"mt-8 w-full p-12 bg-white rounded-[20px] flex justify-between items-center gap-5"},te={class:"flex flex-col w-2/3"},oe={class:"text-sm font-semibold text-gray-700"},ae={class:"w-1/2 flex justify-end"},se={__name:"DetalhesMetodosPagamento",props:{dados:{type:Object,required:!0}},emits:["atualizar"],setup(x,{emit:u}){const p=P(),l=x,f=i(!1),a=i(0),d=i(!1),c=i(!1);let _=!1;const h=async()=>{c.value=!0;try{const e=await $.get(`/api/metodos-pagamentos/verificar-pagamentos/${l.dados.id}`);e.status===200&&e.data?(console.log("Dados recebidos:",e.data),a.value=e.data.data.porcentagem||0,d.value=e.data.data.status===1):(e.status===404||!e.data)&&(console.info("Nenhum método de pagamento encontrado para esta unidade."),a.value=0,d.value=!1)}catch(e){console.error("Erro ao buscar o método de pagamento:",e),a.value=0,d.value=!1}finally{c.value=!1}},o=async()=>{try{await new Promise(m=>setTimeout(m,2e3)),c.value=!0;const e={unidade_id:l.dados.id,default_payment_method_id:l.dados.id,porcentagem:a.value,status:d.value?1:0},s=await $.post("/api/metodos-pagamentos/upsert",e);_||(_=!0,p.success("Método atualizado",{onClose:()=>{_=!1}}))}catch(e){console.error("Erro ao atualizar o método de pagamento:",e)}finally{c.value=!1}};return z(()=>l.dados.id,()=>{h()}),D(()=>{h()}),(e,s)=>(n(),r("div",G,[f.value?v("",!0):(n(),r("div",H,[c.value?(n(),r("div",J,s[2]||(s[2]=[t("div",{class:"spinner"},null,-1)]))):v("",!0),t("div",W,[t("div",X,w(x.dados.nome),1),t("div",Y,[g(k,{class:"font-semibold text-gray-900",text:"Quanto você paga de taxa?"}),g(S,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=m=>a.value=m),placeholder:"5%",onInput:o},null,8,["modelValue"])])]),t("div",ee,[t("div",te,[g(k,{class:"font-semibold text-gray-900",text:"Utilizar este método de pagamento?"}),t("span",oe,w(d.value?"Ativado":"Desativado"),1)]),t("div",ae,[g(U,{status:d.value,"onUpdate:status":s[1]||(s[1]=m=>d.value=m),onClick:o},null,8,["status"])])])]))]))}},ne=b(se,[["__scopeId","data-v-84194dde"]]),le={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},de={key:0},ie={class:"flex flex-col gap-4"},re={__name:"Index",setup(x){const u=i(null),p=i(0),l=i(!1),f=a=>{u.value=a};return(a,d)=>(n(),y(L,null,{default:V(()=>[g(j(E),{title:"Métodos de pagamentos"}),t("div",le,[l.value?v("",!0):(n(),r("div",de,[(n(),y(Z,{key:p.value,ref:"listaDados",onDadoSelecionado:f}))])),t("div",ie,[l.value?v("",!0):(n(),r(M,{key:0},[u.value?(n(),y(ne,{key:0,dados:u.value},null,8,["dados"])):v("",!0)],64))])])]),_:1}))}},ge=b(re,[["__scopeId","data-v-690cf251"]]);export{ge as default};
