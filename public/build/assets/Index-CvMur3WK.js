import{A as G}from"./LayoutFranqueadora-DiH6JeKK.js";import{d as r,i as H,o as f,e as _,a as e,j as Q,v as Z,F as B,g as K,t as w,k as A,l as I,m as T,b as o,p as R,h as E,c as L,w as W,q as X,u as Y,Z as ee}from"./app-itAU4ZWH.js";import{_ as h,I as k,B as O,a as P,d as U}from"./ButtonCancelar-BybogMsa.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as oe}from"./ButtonEditeMedio-D98sA3y1.js";import{C as q}from"./ConfirmDialog-HmAOgdxe.js";import"./user-rGH4vatH.js";const te={class:"search-container relative flex items-center w-full mb-4"},ae={class:"card-container"},se=["onClick"],re={class:"card-inner"},le={class:"text-container"},ne={class:"city"},ie={class:"owner"},de={__name:"ListarFornecedores",emits:["fornecedor-selecionado"],setup(C,{emit:b}){const c=b,x=r([]),u=r(""),l=async()=>{try{const t=await A.get("/api/fornecedores");x.value=t.data.data}catch(t){console.error("Erro ao carregar fornecedores:",t)}},m=t=>{c("fornecedor-selecionado",t)},n=H(()=>{const t=u.value.toLowerCase();return x.value.filter(s=>s.razao_social.toLowerCase().includes(t)||s.cnpj.toLowerCase().includes(t))});return l(),(t,s)=>(f(),_("div",null,[s[4]||(s[4]=e("div",{class:"painel-title"},"Fornecedores",-1)),s[5]||(s[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Fornecedores de insumos homologados")],-1)),e("div",te,[s[1]||(s[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),Q(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=v=>u.value=v),placeholder:"Buscar um fornecedor",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[Z,u.value]])]),e("div",ae,[(f(!0),_(B,null,K(n.value,v=>(f(),_("div",{key:v.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:F=>m(v)},[e("div",re,[s[2]||(s[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/servicos_verde.svg",alt:"Ícone do fornecedor",class:"w-5 h-5 rounded-lg"})])],-1)),e("div",le,[e("div",ne,w(v.razao_social),1),e("div",ie,w(v.cnpj)+" / "+w(v.estado),1)]),s[3]||(s[3]=e("div",{class:"action-icon"},null,-1))])],8,se))),128))])]))}},ce=M(de,[["__scopeId","data-v-a0b13445"]]),ue={key:0,class:"sidebar-container"},ve={key:0,class:"loading-overlay"},pe={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},fe={class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},me={class:"flex justify-start space-x-1 mt-[50px]"},ge={__name:"EditarFornecedor",props:{isVisible:{type:Boolean,required:!0},fornecedor:{type:Object,required:!0}},emits:["cancelar"],setup(C,{emit:b}){const c=I(),x=C,u=b,l=r(""),m=r(""),n=r(""),t=r(""),s=r(!1),v=r(!1),F=r("");T(()=>x.fornecedor,d=>{d&&(l.value=d.razao_social||"",m.value=d.email||"",n.value=d.whatsapp||"",t.value=d.estado||"")},{immediate:!0});const $=async()=>{var d,p;if(!l.value||!m.value||!n.value||!t.value){c.error("Preencha todos os campos obrigatórios.");return}try{s.value=!0;const i=new FormData;i.append("id",x.fornecedor.id),i.append("cnpj",x.fornecedor.cnpj),i.append("razao_social",l.value),i.append("email",m.value),i.append("whatsapp",n.value),i.append("estado",t.value);const j=await A({method:"post",url:"/api/fornecedores/atualizar",data:i,headers:{"Content-Type":"multipart/form-data"}});U.Inertia.replace(route("franqueadora.fornecedores"),{fornecedor:j.data.fornecedor,preserveState:!0}),c.success("Fornecedor atualizado com sucesso!")}catch(i){c.error("Erro ao atualizar o fornecedor."),errorMessage.value=((p=(d=i.response)==null?void 0:d.data)==null?void 0:p.message)||"Erro inesperado."}finally{s.value=!1}},D=d=>{F.value=d,v.value=!0},z=()=>{$(),v.value=!1},N=()=>{v.value=!1},V=()=>{u("cancelar")};return(d,p)=>C.isVisible?(f(),_("div",ue,[s.value?(f(),_("div",ve,p[5]||(p[5]=[e("div",{class:"spinner"},null,-1)]))):(f(),_("div",pe,[e("form",{onSubmit:R($,["prevent"])},[o(h,{text:"CNPJ"}),e("div",fe,w(C.fornecedor.cnpj||"N/A"),1),o(h,{text:"Razão Social"}),o(k,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=i=>l.value=i),placeholder:""},null,8,["modelValue"]),o(h,{text:"E-mail"}),o(k,{modelValue:m.value,"onUpdate:modelValue":p[1]||(p[1]=i=>m.value=i),placeholder:""},null,8,["modelValue"]),o(h,{text:"WhatsApp"}),o(k,{modelValue:n.value,"onUpdate:modelValue":p[2]||(p[2]=i=>n.value=i),placeholder:""},null,8,["modelValue"]),o(h,{text:"Estado"}),o(k,{modelValue:t.value,"onUpdate:modelValue":p[3]||(p[3]=i=>t.value=i),placeholder:""},null,8,["modelValue"]),e("div",me,[o(O,{text:"Cancelar",onClick:V}),o(P,{text:"Atualizar",onClick:p[4]||(p[4]=i=>D("Atualizar esse Fornecedor?"))})])],32),o(q,{isVisible:v.value,motivo:F.value,onConfirm:z,onCancel:N},null,8,["isVisible","motivo"])]))])):E("",!0)}},_e=M(ge,[["__scopeId","data-v-92d72091"]]),xe={key:0,class:"w-full h-[530px] bg-white rounded-[20px] p-7 relative"},he={class:"relative w-full h-full"},be={class:"flex items-center"},ye={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[50px] tracking-tight"},we={class:"w-1/1"},Ce={class:"relative w-full h-full"},Fe={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},Ve={class:"w-[150px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},ke={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},$e={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Ee={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},je={class:"mt-[130px]"},De={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},ze={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Ne={class:"mt-4"},Se={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Ae={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Le={class:"mt-4"},Me={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Be={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Ie={class:"mt-4"},Pe={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Ue={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},qe={key:0,class:"mt-7"},Je={__name:"DetalhesFornecedor",props:{fornecedor:{type:Object,required:!0}},setup(C){const b=I(),c=r(!1),x=r(""),u=r(!1),l=r(!1),m=r(!1),n=C,t=r({...n.fornecedor}),s=async()=>{try{m.value=!0,await axios.delete(`/api/fornecedores/${n.fornecedor.id}`),U.Inertia.replace(route("franqueadora.fornecedores"),{preserveState:!0}),b.success("Fornecedor deletado com sucesso!")}catch(V){b.error(`Erro ao deletar o fornecedor: ${V.message}`)}finally{m.value=!1}},v=()=>{r.dadosfornecedor.fetchfornecedor()},F=()=>{l.value=!l.value,console.log("isEditMode:",l.value),u.value=!1},$=V=>{x.value=V,c.value=!0},D=()=>{s(),c.value=!1},z=()=>{c.value=!1},N=()=>{l.value=!1,u.value=!0};return(V,d)=>{var p,i,j;return f(),_(B,null,[l.value?E("",!0):(f(),_("div",xe,[e("div",he,[e("div",be,[e("div",ye,w(((p=t.value)==null?void 0:p.razao_social)||t.value.razao_social||"N/A"),1),e("div",we,[o(q,{isVisible:c.value,motivo:x.value,onConfirm:D,onCancel:z},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-3 right-4 cursor-pointer",onClick:d[0]||(d[0]=J=>$("Excluir esse Fornecedor?"))},d[1]||(d[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))]),e("div",Ce,[e("div",Fe,[e("div",Ve,[d[2]||(d[2]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",ke," ID# "+w((((i=t.value)==null?void 0:i.id)??0).toString().padStart(4,"0")),1)]),e("div",$e,[d[3]||(d[3]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",Ee,w(((j=t.value)==null?void 0:j.cnpj)||"N/A"),1)])])])]),e("div",je,[o(h,{text:"Razão Social"}),e("div",De,[e("div",ze,w(t.value.razao_social||"N/A"),1)])]),e("div",Ne,[o(h,{text:"E-mail"}),e("div",Se,[e("div",Ae,w(t.value.email||"N/A"),1)])]),e("div",Le,[o(h,{text:"WhatsApp"}),e("div",Me,[e("div",Be,w(t.value.whatsapp||"N/A"),1)])]),e("div",Ie,[o(h,{text:"Estado"}),e("div",Pe,[e("div",Ue,w(t.value.estado||"N/A"),1)])])]),C.fornecedor.id&&!l.value?(f(),_("div",qe,[o(oe,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:F,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):E("",!0)])),l.value?(f(),L(_e,{key:1,ref:"dadosfornecedor",isVisible:l.value,fornecedor:C.fornecedor,onDadosfornecedor:v,onCancelar:N},null,8,["isVisible","fornecedor"])):E("",!0)],64)}}},Te=M(Je,[["__scopeId","data-v-8875c9e7"]]),Re={key:0,class:"sidebar-container"},We={key:0,class:"loading-overlay"},Oe={key:1,class:"w-full h-[525px] bg-white rounded-[20px] p-12"},Ge={key:0,class:"error-message"},He={class:"form-buttons"},Qe={__name:"CadastroFornecedor",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(C,{emit:b}){const c=I(),x=b,u=r(""),l=r(""),m=r(""),n=r(""),t=r(""),s=r(""),v=r(!1),F=r(!1),$=r("");T(u,async y=>{y.replace(/\D/g,"").length===14&&await p()});const D=()=>{z(),x("cancelar")},z=()=>{u.value="",l.value="",m.value="",n.value="",t.value="",s.value=""},N=()=>u.value?!0:(c.error("Por favor, preencha todos os campos obrigatórios."),s.value="Por favor, preencha todos os campos obrigatórios.",!1),V=async()=>{var y,a;if(N())try{v.value=!0;const g=await A.post("/api/fornecedores",{razao_social:l.value,cnpj:u.value,email:m.value,whatsapp:n.value,estado:t.value});U.Inertia.replace(route("franqueadora.fornecedores"),{fornecedor:g.data.fornecedor,preserveState:!0}),c.success("Fornecedor cadastrado com sucesso!")}catch(g){c.error("Erro ao realizar o cadastro."),s.value=((a=(y=g.response)==null?void 0:y.data)==null?void 0:a.message)||"Erro ao realizar o cadastro."}finally{v.value=!1}},d=y=>{let a=y.target.value.replace(/\D/g,"");a.length>14&&(a=a.slice(0,14)),a=a.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"),u.value=a},p=async()=>{var y,a;if(!u.value||u.value.length<14){c.error("Por favor, insira um CNPJ válido.");return}try{v.value=!0;const g=u.value.replace(/\D/g,""),S=(await A.get(`https://publica.cnpj.ws/cnpj/${g}`)).data;l.value=S.razao_social||"",t.value=S.estabelecimento.estado.nome||"",n.value=S.estabelecimento.telefone1||"",m.value=S.estabelecimento.email||""}catch(g){s.value=((a=(y=g.response)==null?void 0:y.data)==null?void 0:a.message)||"Erro ao consultar o CNPJ."}finally{v.value=!1}},i=y=>{$.value=y,F.value=!0},j=()=>{V(),F.value=!1},J=()=>{F.value=!1};return(y,a)=>(f(),L(X,{name:"fade"},{default:W(()=>[C.isVisible?(f(),_("div",Re,[v.value?(f(),_("div",We,a[6]||(a[6]=[e("div",{class:"spinner"},null,-1)]))):(f(),_("div",Oe,[a[7]||(a[7]=e("div",{class:"painel-title"},[e("p",null,"Novo fornecedor")],-1)),e("form",{onSubmit:R(V,["prevent"])},[o(h,{text:"CNPJ"}),o(k,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=g=>u.value=g),onInput:d,placeholder:"000.000.000/0000-00"},null,8,["modelValue"]),o(h,{text:"Razão Social"}),o(k,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=g=>l.value=g),placeholder:"Silva Moura Pescados"},null,8,["modelValue"]),o(h,{text:"E-mail"}),o(k,{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=g=>m.value=g),placeholder:"contato@nobrezasdomar.com.br"},null,8,["modelValue"]),o(h,{text:"WhatsApp"}),o(k,{modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=g=>n.value=g),placeholder:"(00) 00000-0000"},null,8,["modelValue"]),o(h,{text:"Estado"}),o(k,{modelValue:t.value,"onUpdate:modelValue":a[4]||(a[4]=g=>t.value=g),placeholder:"Mato Grosso"},null,8,["modelValue"]),s.value?(f(),_("div",Ge,w(s.value),1)):E("",!0),o(q,{isVisible:F.value,motivo:$.value,onConfirm:j,onCancel:J},null,8,["isVisible","motivo"]),e("div",He,[o(O,{text:"Cancelar",onClick:D}),o(P,{text:"Cadastrar",onClick:a[5]||(a[5]=g=>i("Criar novo Fornecedor?"))})])],32)]))])):E("",!0)]),_:1}))}},Ze=M(Qe,[["__scopeId","data-v-d38b4e2b"]]),Ke={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2"},Xe={class:"flex flex-col gap-4"},Ye={class:"absolute bottom-4 right-4"},eo={key:1,class:"mt-4"},co={__name:"Index",setup(C){const b=r(null),c=r(!1),x=()=>{c.value=!c.value},u=()=>{l(),c.value=!1},l=()=>{var t;(t=r("listarFornecedores").value)==null||t.fetchFornecedores()},m=n=>{n&&typeof n=="object"?b.value=n:console.warn("Dados inválidos recebidos no evento fornecedor-selecionado:",n)};return(n,t)=>(f(),L(G,null,{default:W(()=>[o(Y(ee),{title:"Fornecedores"}),e("div",Ke,[e("div",null,[o(ce,{ref:"listarFornecedores",onFornecedorCadastrado:l,onFornecedorSelecionado:m},null,512)]),e("div",Xe,[c.value?(f(),_("div",eo,[o(Ze,{isVisible:c.value,onFornecedorCadastrado:u,onCancelar:x},null,8,["isVisible"])])):(f(),_(B,{key:0},[b.value?(f(),L(Te,{key:0,fornecedor:b.value},null,8,["fornecedor"])):E("",!0),e("div",Ye,[o(P,{text:"Novo Fornecedor",iconPath:"/storage/images/arrow_left_alt.svg",onClick:x})])],64))])])]),_:1}))}};export{co as default};
