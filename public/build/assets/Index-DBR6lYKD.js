import{d as n,i as B,e as i,o,a as t,t as d,c as E,w as P,b as D,u as A,Z as $,F as m,h as b,k as S}from"./app-CskWAS8J.js";import{L as I}from"./LayoutFranqueado-CzguKtsU.js";import{p as j}from"./chartjs-plugin-datalabels.esm-EXrChiyj.js";import{C as k,A as N,p as O,a as U,D as V,P as z,B as G,L as T,R as W,b as Z,c as q,d as H,e as J,f as K,g as Q,h as X,i as tt}from"./chart-D2B5U74o.js";import{d as R}from"./dayjs.min-czFjeB0S.js";import"./pt-br-CJQtBlhr.js";import{_ as et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-CRCuHGH3.js";const at={class:"flex items-center space-x-2"},st={class:"font-semibold text-gray-900 text-[17px]"},ot={__name:"CalendarFilterDre",emits:["update-filters"],setup(M,{emit:x}){R.locale("pt-br");const _=x,l=n(R()),f=()=>{l.value=l.value.subtract(1,"month"),s()},h=()=>{l.value=l.value.add(1,"month"),s()},s=()=>{const p=l.value.startOf("month").format("DD-MM-YYYY"),g=l.value.endOf("month").format("DD-MM-YYYY");_("update-filters",{startDate:p,endDate:g})};return B(()=>{s()}),(p,g)=>(o(),i("div",at,[t("button",{onClick:f,class:"p-2 rounded hover:bg-gray-200 text-gray-700 font-semibold"}," < "),t("span",st,d(l.value.format("MMMM YYYY")),1),t("button",{onClick:h,class:"p-2 rounded hover:bg-gray-200 text-gray-700 font-semibold"}," > ")]))}},lt={class:"flex justify-end mb-4"},rt={class:"text-[#262a27] text-[15px] font-semibold font-['Figtree'] leading-tight"},nt={class:"flex items-center space-x-2 justify-end"},it={class:"text-gray-900 text-[17px] font-semibold"},dt={class:"mt-5"},ct={class:"grid grid-cols-2 grid-rows-1 gap-4"},ut={class:"rounded-lg"},pt={class:"w-full text-left text-[14px] border-collapse font-['Figtree']"},gt={key:0},mt={key:1},xt={class:"px-5 py-2 text-right valores"},_t={class:"bg-[#174111] text-white"},ft={colspan:"2",class:"p-1 px-5"},ht={class:"p-1 px-5 categorias align-middle"},vt={class:"px-5 py-1 text-right valores"},bt={class:"bg-[#174111] text-white"},yt={colspan:"1",class:"p-2 text-right font-bold"},Ft={class:"mt-5"},wt={class:"bg-white rounded-lg shadow"},Ct={ref:"scrollContainer",class:"overflow-y-auto max-h-96 scroll-hidden"},Dt={class:"space-y-2"},kt={class:"text-center px-5 text-gray-600 font-semibold"},Rt={class:"text-center text-gray-600 font-medium"},Bt={class:"text-right text-gray-600 font-semibold"},Mt={__name:"Index",setup(M){const x=n("0,00"),_=n("0,00"),l=n([]),f=n([]),h=n(!0),s=n("pie");let p=null;const g=n([]),y=n([]),F=n([]),L=c=>{console.log("Filtros atualizados:",c),w(c.startDate,c.endDate)},w=async(c,e)=>{var a,r,v;try{const u=(await S.get("/api/painel-dre/analitycs-dre",{params:{start_date:c,end_date:e}})).data;x.value=u.total_caixas||"0,00",_.value=u.resultado_do_periodo||"0,00",l.value=u.grupos||[],f.value=u.calendario||[],y.value=((a=u.grafico_data)==null?void 0:a.labels)||[],g.value=((r=u.grafico_data)==null?void 0:r.data)||[],F.value=((v=u.grafico_data)==null?void 0:v.porcentagens)||[],Y()}catch(C){console.error("Erro ao buscar os dados do DRE:",C)}finally{h.value=!1}};k.register(N,O,U,V,z,G,T,W,Z,q,H,J,K,Q,X,tt,j);const Y=()=>{const c=document.getElementById("myChart").getContext("2d");p&&p.destroy();const e={type:s.value,data:{labels:y.value,datasets:[{data:g.value,backgroundColor:["#6DB631","#FF9500","#FF2D55","#5856D6","#F7464A","#FF7F50"],borderColor:s.value==="line"?"#36A2EB":void 0,borderWidth:s.value==="line"||s.value==="bar"?1:0,fill:s.value==="line"}]},options:{plugins:{tooltip:{callbacks:{label:function(a){const r=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a.raw);return a.label+": "+r}}},legend:{position:"bottom",labels:{usePointStyle:!0,padding:15,boxWidth:10}},datalabels:{anchor:"center",align:"center",color:s.value==="bar"||s.value==="line"?"#000":"#fff",font:{weight:"bold",size:14},formatter:(a,r)=>{const v=r.dataIndex;return F.value[v]},display:s.value==="pie"||s.value==="doughnut"||s.value==="polarArea"}},scales:s.value==="bar"||s.value==="line"?{x:{type:"category"},y:{beginAtZero:!0,ticks:{callback:function(a){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a)}}}}:void 0}};p=new k(c,e)};return B(w),(c,e)=>(o(),E(I,null,{default:P(()=>[D(A($),{title:"Painel"}),e[7]||(e[7]=t("div",{class:"painel-title"},"DRE Gerencial",-1)),e[8]||(e[8]=t("div",{class:"painel-subtitle"},[t("p",null,"Acompanhe a saúde da sua operação")],-1)),t("div",lt,[t("div",rt,[t("div",nt,[t("span",it,[D(ot,{onUpdateFilters:L})])])])]),t("div",dt,[t("div",ct,[t("div",ut,[t("table",pt,[e[3]||(e[3]=t("thead",null,[t("tr",{class:"bg-[#174111] text-white"},[t("th",{colspan:"2",class:"p-1 px-5"},"Faturamento do Período")])],-1)),h.value?(o(),i("tbody",gt,[(o(),i(m,null,b(25,a=>t("tr",{key:a},e[0]||(e[0]=[t("td",{class:"p-1 px-5 shimmer h-6 w-1/2 rounded"},null,-1),t("td",{class:"p-1 px-5 shimmer h-6 w-1/4 rounded text-right"},null,-1)]))),64))])):(o(),i("tbody",mt,[t("tr",null,[e[1]||(e[1]=t("td",{class:"p-1 px-5 categorias"},"Faturamento do Período",-1)),t("td",xt,"R$ "+d(x.value),1)])])),(o(!0),i(m,null,b(l.value,a=>(o(),i(m,{key:a.nome_grupo},[t("thead",null,[t("tr",_t,[t("th",ft,d(a.nome_grupo),1)])]),t("tbody",null,[(o(!0),i(m,null,b(a.categorias,r=>(o(),i("tr",{key:r.categoria,class:"odd:bg-gray-100 even:bg-white p-1 px-5"},[t("td",ht,d(r.categoria),1),t("td",vt,"R$ "+d(r.total),1)]))),128))])],64))),128)),t("thead",null,[t("tr",bt,[e[2]||(e[2]=t("th",{colspan:"1",class:"p-2"},"Resultado do Período",-1)),t("th",yt,"R$ "+d(_.value),1)])])])]),t("div",null,[e[6]||(e[6]=t("div",{class:"bg-white rounded-lg p-5 flex justify-center w-full h-[380px]"},[t("canvas",{id:"myChart"})],-1)),t("div",Ft,[e[5]||(e[5]=t("div",{class:"flex items-center justify-between"},[t("h3",{class:"text-[#262a27] text-[17px] font-semibold font-['Figtree'] leading-snug"}," Histórico de Resultados ")],-1)),t("div",wt,[e[4]||(e[4]=t("div",{class:"bg-[#164110] grid grid-cols-3 gap-4 py-2 px-6 text-xs font-semibold text-[#FFFFFF] uppercase tracking-wider rounded-tl-2xl rounded-tr-2xl"},[t("span",{class:"text-center px-5"},"MÊS"),t("span",{class:"text-center"},"CMV"),t("span",{class:"text-right"},"RESULTADO")],-1)),t("div",Ct,[t("ul",Dt,[(o(!0),i(m,null,b(f.value,a=>(o(),i("li",{key:a.nome_mes,class:"hover:bg-gray-200 grid grid-cols-3 gap-4 px-6 text-[14px]"},[t("span",kt,d(a.nome_mes),1),t("span",Rt," R$ "+d(a.categorias[0].valor_cmv),1),t("span",Bt," R$ "+d(a.categorias[0].resultado_do_periodo),1)]))),128))])],512)])])])])])]),_:1}))}},jt=et(Mt,[["__scopeId","data-v-7c041665"]]);export{jt as default};
