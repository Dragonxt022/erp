import{l as ie,d as _,i as se,o as n,e as c,a as e,j as R,s as Ve,F as j,g as O,t as h,b as C,h as w,v as D,w as A,f as E,p as Te,k as G,y as Ue,q as Se,c as M,R as B,S as Me,m as Oe,u as Ie,Z as Fe}from"./app-BlKfMOOe.js";import{_ as ce,I as Le,B as Ce,a as de}from"./ButtonCancelar-BrUOfQZz.js";import{B as Ne}from"./ButtonPrimary-BqVmkyFi.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as Be}from"./index-Xq5OVTbn.js";import{B as Ae}from"./ButtonEditeMedio-D1F2nsLO.js";import{L as Ge}from"./LayoutFranqueado-DXsD8Pkt.js";import"./user-_R9GIEcP.js";const ze={key:0,class:"w-[100%] h-full flex flex-col p-4 bg-gray-50"},Qe={class:"mb-6 relative"},Ke={class:"relative"},We=["value"],He={class:"w-full bg-white rounded-lg p-6 mb-6"},Je={class:"flex items-center"},Xe={class:"flex-shrink-0"},Ze=["src"],Ye={class:"ml-6"},et={class:"text-2xl font-semibold text-gray-800"},tt={key:0,class:"text-red-500 text-sm text-center"},ot={class:"relative flex items-center w-full"},at={class:"flex justify-end space-x-4"},rt={__name:"CadastrarInsumoEstoque",props:{produtoSelecionado:{type:Object,required:!1}},setup(t,{emit:o}){var N;const s=ie(),d=o,l=t,g=_([]),f=_(""),v=_(""),x=_(((N=l.produtoSelecionado)==null?void 0:N.valor)||""),u=_(!1);_(!1);const p=_(!1),m=_(""),S=se(()=>l.produtoSelecionado.unidadeDeMedida==="a_granel"?"Kg":"Quantidade"),I=se(()=>l.produtoSelecionado.unidadeDeMedida==="a_granel"?"Digite o peso (ex: 1.5)":"Digite a quantidade"),a=()=>{let k=/^[0-9]+(\.[0-9]+)?$/;l.produtoSelecionado.unidadeDeMedida==="unidade"&&(k=/^[0-9]+$/),u.value=!k.test(v.value),l.produtoSelecionado.unidadeDeMedida==="a_granel"&&(v.value.includes(".")||(v.value=`${v.value}.0`))},r=()=>{const k=x.value.replace(/\D/g,""),y=k.slice(0,-2)||"0",q=k.slice(-2).padStart(2,"0");x.value=`R$ ${Number(y).toLocaleString("pt-BR")},${q}`},i=()=>{v.value="",x.value=""};(async()=>{try{const k=await G.get("/api/estoque/fornecedores");g.value=k.data.data.map(y=>({id:y.id||"N/D",razao_social:y.razao_social||"N/D"}))}catch(k){console.error("Erro ao carregar fornecedores:",k)}})();const T=k=>k?new URL(k,window.location.origin).href:"/storage/images/no_imagem.svg",F=()=>(m.value="",f.value?!v.value||u.value?(s.error("Quantidade inválida."),m.value="Quantidade inválida.",!1):!x.value||p.value?(s.error("Valor inválido."),m.value="Valor inválido.",!1):!0:(s.error("Fornecedor não selecionado."),m.value="Fornecedor não selecionado.",!1)),U=()=>{if(!F())return;const k={...l.produtoSelecionado,fornecedor_id:f.value,quantidade:v.value,valor:x.value,unidade_de_medida:l.produtoSelecionado.unidadeDeMedida};s.success("Inusmo adicionado"),i(),d("adicionarAoCarrinho",k)};return(k,y)=>t.produtoSelecionado?(n(),c("div",ze,[y[5]||(y[5]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",Qe,[e("div",Ke,[R(e("select",{"onUpdate:modelValue":y[0]||(y[0]=q=>f.value=q),id:"fornecedor",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-green-600 focus:ring-2 focus:ring-green-500 font-['Figtree']"},[y[3]||(y[3]=e("option",{value:"",disabled:""},"Selecione um fornecedor",-1)),(n(!0),c(j,null,O(g.value,q=>(n(),c("option",{key:q.id,value:q.id},h(q.razao_social),9,We))),128))],512),[[Ve,f.value]])])]),e("div",He,[e("div",Je,[e("div",Xe,[e("img",{src:T(t.produtoSelecionado.profile_photo),alt:"Foto do Produto",class:"w-24 h-24 rounded-lg"},null,8,Ze)]),e("div",Ye,[e("div",et,h(t.produtoSelecionado.nome||"N/A"),1)])])]),e("form",{onSubmit:Te(U,["prevent"]),class:"space-y-4"},[e("div",null,[C(ce,{text:S.value},null,8,["text"]),C(Le,{modelValue:v.value,"onUpdate:modelValue":y[1]||(y[1]=q=>v.value=q),placeholder:I.value,onInput:a},null,8,["modelValue","placeholder"]),u.value?(n(),c("p",tt," Insira um valor válido. ")):w("",!0)]),e("div",null,[C(ce,{text:"Valor"}),e("div",ot,[R(e("input",{"onUpdate:modelValue":y[2]||(y[2]=q=>x.value=q),placeholder:"R$ 0,00",onInput:r,class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},null,544),[[D,x.value]])])]),e("div",at,[C(Ne,{onClick:U},{default:A(()=>y[4]||(y[4]=[E("Adicionar")])),_:1})])],32)])):w("",!0)}},nt=V(rt,[["__scopeId","data-v-8e8bc66e"]]),st={class:"flex gap-5"},it={key:0,class:"loading-overlay"},dt={class:"flex-1"},lt={class:"min-w-full table-auto"},ut=["onDblclick"],ct={class:"px-6 py-4 text-[16px] text-left text-gray-900 font-semibold"},ft={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-center"},pt=["onUpdate:modelValue"],vt={key:1},mt={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-left"},gt={key:0},xt=["onUpdate:modelValue"],_t={key:2},ht={class:"px-6 py-4 text-[16px] text-gray-500 text-center"},bt=["onUpdate:modelValue"],yt={key:1},$t={class:"px-6 py-4 text-center"},wt=["onClick"],kt={key:0,class:"botao-container"},qt={__name:"ResumoCarrinho",props:{carrinho:{type:Array,required:!0}},emits:["confirmar","cancelar"],setup(t,{emit:o}){const s=ie(),d=t,l=o,g=_(!1),f=_(!1),v=_(null),x=a=>{d.carrinho.splice(a,1),s.info("Item removido com sucesso!")},u=a=>{v.value=a},p=a=>{const r=parseFloat((a.valor||"0").replace("R$","").replace(",","."));return a.quantidade>0?r/a.quantidade:0},m=a=>a.unidadeDeMedida==="a_granel"?p(a)*a.quantidade:a.quantidade*parseFloat(a.valor.replace("R$","").replace(",",".")),S=async()=>{var a;g.value=!0,f.value=!0;try{const r={fornecedor_id:((a=d.carrinho[0])==null?void 0:a.fornecedor_id)||null,itens:d.carrinho.map(b=>({id:b.id,nome:b.nome,quantidade:b.quantidade,unidadeDeMedida:b.unidadeDeMedida,valorUnitario:Math.round(parseFloat(b.valor.replace("R$","").replace(",","."))*100),total:Math.round(m(b)*100)}))};console.log("Dados enviados:",JSON.stringify(r,null,2));const i=await axios.post("/api/estoque/armazenar-entrada",r);i.status===201?(console.log("Resposta da API:",i.data),Be.Inertia.visit(route("franqueado.inventario")),s.success("Lista de insumos salvas em seu estoque.")):s.error("Erro ao salvar no estoque, tente novamente.")}catch(r){console.error("Erro ao enviar entrada:",r),s.error("Erro ao confirmar entrada. Tente novamente ou chame o suporte.")}finally{g.value=!1}},I=()=>{l("cancelar")};return(a,r)=>(n(),c("div",st,[g.value?(n(),c("div",it,r[0]||(r[0]=[e("div",{class:"spinner"},null,-1)]))):w("",!0),r[3]||(r[3]=e("div",{class:"flex-1"},[e("div",{class:"painel-title"},"Confirmar entrada"),e("div",{class:"painel-subtitle"},[e("p",null,"Vamos conferir se está tudo certo")]),e("div",{class:"mt-[25%] text-[#6d6d6d] text-[18px] font-normal font-['Figtree'] leading-[23px] tracking-tight"},[E(" Você confirma que está "),e("br"),E(" realizando uma nova entrada "),e("br"),E(" com os seguintes itens? ")])],-1)),e("div",dt,[e("table",lt,[r[2]||(r[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-xs text-left font-medium text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," Item "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," QTD. "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," V. UN/KG "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," TOTAL "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider TrRedonDireita"}," AÇÃO ")])],-1)),e("tbody",null,[(n(!0),c(j,null,O(t.carrinho,(i,b)=>(n(),c("tr",{key:i.id,onDblclick:T=>u(b)},[e("td",ct,h(i.nome),1),e("td",ft,[v.value===b?R((n(),c("input",{key:0,type:"number","onUpdate:modelValue":T=>i.quantidade=T,class:"border border-gray-300 rounded px-2 py-1 w-16"},null,8,pt)),[[D,i.quantidade,void 0,{number:!0}]]):(n(),c("span",vt,h(i.quantidade)+" "+h(i.unidadeDeMedida==="a_granel"?"KG":"UN"),1))]),e("td",mt,[i.unidadeDeMedida==="a_granel"?(n(),c("span",gt," R$ "+h(p(i).toFixed(2)),1)):v.value===b?R((n(),c("input",{key:1,type:"text","onUpdate:modelValue":T=>i.valor=T,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,xt)),[[D,i.valor]]):(n(),c("span",_t,h(i.valor),1))]),e("td",ht,[v.value===b&&i.unidadeDeMedida==="a_granel"?R((n(),c("input",{key:0,type:"number","onUpdate:modelValue":T=>i.valorTotal=T,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,bt)),[[D,i.valorTotal,void 0,{number:!0}]]):(n(),c("span",yt,h(m(i).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1))]),e("td",$t,[e("button",{onClick:T=>x(b),class:"w-[16] h-[16]"},r[1]||(r[1]=[e("img",{src:"/storage/images/delete.svg",alt:"icone de excluir",class:"w-[16px] h-[16px]"},null,-1)]),8,wt)])],40,ut))),128))])]),f.value?w("",!0):(n(),c("div",kt,[C(Ce,{text:"Voltar",onClick:I}),C(de,{text:"Confirmar",onClick:S})]))])]))}},Tt=V(qt,[["__scopeId","data-v-44b49a7a"]]),St={key:0},It={key:0,class:"sidebar-container"},Ct={key:0,class:"loading-overlay"},Pt={key:1,class:"flex"},Rt={class:"flex-1 p-4"},jt={class:"relative flex items-center w-full mb-4"},Dt={class:"space-y-4"},Et=["onClick"],Vt={class:"flex-shrink-0"},Ut=["src"],Mt={class:"ml-4 flex-1"},Ot={class:"text-lg font-semibold flex items-center"},Ft={key:0,class:"ml-5 text-xs bg-green-100 text-green-600 font-bold rounded-full px-2 py-1"},Lt={key:1,class:"mr-2 ml-5 text-yellow-500",title:"Essa estrela sigifinica que esse insumo e um produto princial"},Nt={class:"absolute bottom-4 right-4 mt-5 botao-container"},Bt={class:"flex-1 p-4"},At={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},setup(t){const o=_([]),s=_(""),d=_(!1),l=_(null),g=_([]),f=_(!1),v=()=>{console.log("Entrada confirmada",g.value),mostrarModalRevisao.value=!1,g.value=[]},x=async()=>{d.value=!0;try{const a=await G.get("/api/produtos/lista");o.value=a.data}catch(a){console.error("Erro ao carregar os produtos:",a)}finally{d.value=!1}},u=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",p=a=>{l.value=a},m=a=>g.value.filter(r=>r.id===a).length,S=a=>{g.value.push(a),l.value=null},I=se(()=>o.value.filter(a=>a.nome.toLowerCase().includes(s.value.toLowerCase())));return Ue(x),(a,r)=>(n(),c(j,null,[C(Se,{name:"fade"},{default:A(()=>[f.value?w("",!0):(n(),c("div",St,[t.isVisible?(n(),c("div",It,[d.value?(n(),c("div",Ct,r[3]||(r[3]=[e("div",{class:"spinner"},null,-1)]))):(n(),c("div",Pt,[e("div",Rt,[r[5]||(r[5]=e("div",{class:"painel-title"},"Nova entrada",-1)),r[6]||(r[6]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",jt,[r[4]||(r[4]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),R(e("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>s.value=i),placeholder:"Buscar um produto",class:"pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[D,s.value]])]),e("div",Dt,[(n(!0),c(j,null,O(I.value,i=>(n(),c("div",{key:i.id,class:"flex items-center p-4 bg-white rounded-lg cursor-pointer",onClick:b=>p(i)},[e("div",Vt,[e("img",{src:u(i.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,Ut)]),e("div",Mt,[e("div",Ot,[E(h(i.nome)+" ",1),m(i.id)>0?(n(),c("span",Ft,h(m(i.id)),1)):w("",!0),i.estrela?(n(),c("span",Lt," ★ ")):w("",!0)])])],8,Et))),128))])]),e("div",Nt,[C(de,{text:"Finalizar",onClick:r[1]||(r[1]=i=>f.value=!0),iconPath:"/storage/images/arrow_left_alt.svg"})]),e("div",Bt,[C(nt,{produtoSelecionado:l.value,onAdicionarAoCarrinho:S},null,8,["produtoSelecionado"])])]))])):w("",!0)]))]),_:1}),f.value?(n(),M(Tt,{key:0,carrinho:g.value,onConfirmar:v,onCancelar:r[2]||(r[2]=i=>f.value=!1)},null,8,["carrinho"])):w("",!0)],64))}},Gt=V(At,[["__scopeId","data-v-4deae6b8"]]);var Q,fe;function Pe(){if(fe)return Q;fe=1;function t(o){var s=typeof o;return o!=null&&(s=="object"||s=="function")}return Q=t,Q}var K,pe;function zt(){if(pe)return K;pe=1;var t=typeof B=="object"&&B&&B.Object===Object&&B;return K=t,K}var W,ve;function Re(){if(ve)return W;ve=1;var t=zt(),o=typeof self=="object"&&self&&self.Object===Object&&self,s=t||o||Function("return this")();return W=s,W}var H,me;function Qt(){if(me)return H;me=1;var t=Re(),o=function(){return t.Date.now()};return H=o,H}var J,ge;function Kt(){if(ge)return J;ge=1;var t=/\s/;function o(s){for(var d=s.length;d--&&t.test(s.charAt(d)););return d}return J=o,J}var X,xe;function Wt(){if(xe)return X;xe=1;var t=Kt(),o=/^\s+/;function s(d){return d&&d.slice(0,t(d)+1).replace(o,"")}return X=s,X}var Z,_e;function je(){if(_e)return Z;_e=1;var t=Re(),o=t.Symbol;return Z=o,Z}var Y,he;function Ht(){if(he)return Y;he=1;var t=je(),o=Object.prototype,s=o.hasOwnProperty,d=o.toString,l=t?t.toStringTag:void 0;function g(f){var v=s.call(f,l),x=f[l];try{f[l]=void 0;var u=!0}catch{}var p=d.call(f);return u&&(v?f[l]=x:delete f[l]),p}return Y=g,Y}var ee,be;function Jt(){if(be)return ee;be=1;var t=Object.prototype,o=t.toString;function s(d){return o.call(d)}return ee=s,ee}var te,ye;function Xt(){if(ye)return te;ye=1;var t=je(),o=Ht(),s=Jt(),d="[object Null]",l="[object Undefined]",g=t?t.toStringTag:void 0;function f(v){return v==null?v===void 0?l:d:g&&g in Object(v)?o(v):s(v)}return te=f,te}var oe,$e;function Zt(){if($e)return oe;$e=1;function t(o){return o!=null&&typeof o=="object"}return oe=t,oe}var ae,we;function Yt(){if(we)return ae;we=1;var t=Xt(),o=Zt(),s="[object Symbol]";function d(l){return typeof l=="symbol"||o(l)&&t(l)==s}return ae=d,ae}var re,ke;function eo(){if(ke)return re;ke=1;var t=Wt(),o=Pe(),s=Yt(),d=NaN,l=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,f=/^0o[0-7]+$/i,v=parseInt;function x(u){if(typeof u=="number")return u;if(s(u))return d;if(o(u)){var p=typeof u.valueOf=="function"?u.valueOf():u;u=o(p)?p+"":p}if(typeof u!="string")return u===0?u:+u;u=t(u);var m=g.test(u);return m||f.test(u)?v(u.slice(2),m?2:8):l.test(u)?d:+u}return re=x,re}var ne,qe;function to(){if(qe)return ne;qe=1;var t=Pe(),o=Qt(),s=eo(),d="Expected a function",l=Math.max,g=Math.min;function f(v,x,u){var p,m,S,I,a,r,i=0,b=!1,T=!1,F=!0;if(typeof v!="function")throw new TypeError(d);x=s(x)||0,t(u)&&(b=!!u.leading,T="maxWait"in u,S=T?l(s(u.maxWait)||0,x):S,F="trailing"in u?!!u.trailing:F);function U($){var P=p,L=m;return p=m=void 0,i=$,I=v.apply(L,P),I}function N($){return i=$,a=setTimeout(q,x),b?U($):I}function k($){var P=$-r,L=$-i,ue=x-P;return T?g(ue,S-L):ue}function y($){var P=$-r,L=$-i;return r===void 0||P>=x||P<0||T&&L>=S}function q(){var $=o();if(y($))return le($);a=setTimeout(q,k($))}function le($){return a=void 0,F&&p?U($):(p=m=void 0,I)}function De(){a!==void 0&&clearTimeout(a),i=0,p=r=m=a=void 0}function Ee(){return a===void 0?I:le(o())}function z(){var $=o(),P=y($);if(p=arguments,m=this,r=$,P){if(a===void 0)return N(r);if(T)return clearTimeout(a),a=setTimeout(q,x),U(r)}return a===void 0&&(a=setTimeout(q,x)),I}return z.cancel=De,z.flush=Ee,z}return ne=f,ne}var oo=to();const ao=Me(oo),ro={key:0,class:"sidebar-container"},no={key:0,class:"loading-overlay"},so={key:1},io={class:"w-full h-[80%] bg-white rounded-[20px] p-12"},lo={class:"relative w-full h-full"},uo={class:"flex items-center"},co={class:"w-1/1 flex justify-center"},fo=["src"],po={class:"w-2/3 pl-5"},vo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},mo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},go={class:"mt-5"},xo={class:"min-w-full table-auto"},_o={class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonDireita"},ho={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},bo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},yo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},$o=["onUpdate:modelValue","onInput"],wo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},ko={class:"flex justify-left mt-12"},qo={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(t,{emit:o}){const s=ie(),d=t,l=o,g=_(""),f=_(""),v=_(!1),x=_(!1),u=_("");Oe(()=>d.produto,a=>{a&&(g.value=a.nome||"",f.value=a.categoria||"")},{immediate:!0});const p=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",m=ao(a=>{G.put(`/api/estoque/estoque/lote/${a.id}`,{quantidade:a.quantidade}).then(r=>{s.success("Quantidade do lote atualizada!")}).catch(r=>{s.error("Erro ao atualizar o lote.")})},1e3),S=a=>{u.value=a,x.value=!0},I=()=>{l("cancelar")};return(a,r)=>(n(),M(Se,{name:"fade"},{default:A(()=>[t.isVisible?(n(),c("div",ro,[v.value?(n(),c("div",no,r[1]||(r[1]=[e("div",{class:"spinner"},null,-1)]))):(n(),c("div",so,[e("div",io,[e("div",lo,[e("div",uo,[e("div",co,[e("img",{src:p(t.produto.profile_photo),alt:"Foto do Produto",class:"w-20 h-20 rounded-md shadow-lg"},null,8,fo)]),e("div",po,[e("div",vo,[E(h(t.produto.nome||"N/A")+" ",1),e("div",mo,h(t.produto.unidadeDeMedida==="a_granel"&&t.produto.valor_pago_por_quilo_lote?t.produto.valor_pago_por_quilo_lote:t.produto.valor_total_lote),1)])])])])]),e("form",{onSubmit:r[0]||(r[0]=Te(i=>S("Atualizar este produto?"),["prevent"]))},[e("div",go,[e("table",xo,[e("thead",null,[e("tr",null,[r[2]||(r[2]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),r[3]||(r[3]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," Fornecedor ",-1)),r[4]||(r[4]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," qtd ",-1)),e("th",_o,h(t.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1)])]),e("tbody",null,[(n(!0),c(j,null,O(t.produto.lotes,i=>(n(),c("tr",{key:i.id},[e("td",ho,h(i.data),1),e("td",bo,h(i.fornecedor),1),e("td",yo,[R(e("input",{"onUpdate:modelValue":b=>i.quantidade=b,type:"number",min:"0",class:"border rounded-lg px-2 py-1 w-[75px] h-[32px] text-center",onInput:b=>Ie(m)(i)},null,40,$o),[[D,i.quantidade]])]),e("td",wo,h(i.preco_unitario),1)]))),128))])])]),e("div",ko,[C(Ce,{text:"Voltar",onClick:I})])],32)]))])):w("",!0)]),_:1}))}},To=V(qo,[["__scopeId","data-v-9ad6d994"]]),So={class:"elemento-fixo"},Io={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Co={class:"relative w-full h-full"},Po={class:"flex items-center"},Ro={class:"w-1/1 flex justify-center"},jo=["src"],Do={class:"w-2/3 pl-5"},Eo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Vo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},Uo={key:1,class:""},Mo={class:"mt-8"},Oo={class:"min-w-full table-auto"},Fo={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Lo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},No={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Bo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ao={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Go={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},zo={key:0,class:"mt-4"},Qo={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},emits:["atualizar"],setup(t,{emit:o}){const s=o,d=_(!1),l=_(!1),g=()=>{_.dadosProduto.fetchProduto()},f=u=>u?new URL(u,window.location.origin).href:"/storage/images/no_imagem.svg",v=()=>{l.value=!l.value,d.value=!1},x=()=>{s("atualizar"),l.value=!1,d.value=!0};return(u,p)=>(n(),c("div",So,[l.value?w("",!0):(n(),c("div",Io,[e("div",Co,[e("div",Po,[e("div",Ro,[e("img",{src:f(t.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,jo)]),e("div",Do,[e("div",Eo,[E(h(t.produto.nome||"N/A")+" ",1),e("div",Vo,h(t.produto.unidadeDeMedida==="a_granel"&&t.produto.valor_pago_por_quilo_lote?t.produto.valor_pago_por_quilo_lote:t.produto.valor_total_lote),1)])])])])])),l.value?w("",!0):(n(),c("div",Uo,[e("div",Mo,[e("table",Oo,[e("thead",null,[e("tr",null,[p[0]||(p[0]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),p[1]||(p[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),p[2]||(p[2]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),e("th",Fo,h(t.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),p[3]||(p[3]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),e("tbody",null,[(n(!0),c(j,null,O(t.produto.lotes,(m,S)=>(n(),c("tr",{key:S,class:"text-center"},[e("td",Lo,h(m.data),1),e("td",No,h(m.fornecedor),1),e("td",Bo,h(m.quantidade)+" "+h(t.produto.unidadeDeMedida==="unitario"?"uni":"kg"),1),e("td",Ao,h(t.produto.unidadeDeMedida==="unitario"?m.preco_unitario:m.valor_pago_por_quilo),1),e("td",Go,h(t.produto.unidadeDeMedida==="unitario"?m.valor_total:m.preco_unitario),1)]))),128))])])]),t.produto.id&&!l.value?(n(),c("div",zo,[C(Ae,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:v,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):w("",!0)])),l.value?(n(),M(To,{key:2,ref:"dadosProduto",isVisible:l.value,produto:t.produto,onDadosProduto:g,onCancelar:x},null,8,["isVisible","produto"])):w("",!0)]))}},Ko=V(Qo,[["__scopeId","data-v-1594529a"]]),Wo={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const t=await G.get("/api/estoque/lista");console.log("Produtos carregados:",t.data),this.produtos=Object.values(t.data)}catch(t){console.error("Erro ao carregar os produtos:",t)}},getProfilePhotoUrl(t){return t?new URL(t,window.location.origin).href:"/storage/images/no_imagem.svg"},selecionarProduto(t){this.$emit("produto-selecionado",t)},getQuantidadeTotal(t){return t.reduce((o,s)=>o+s.quantidade,0)}},computed:{filteredProdutos(){const t=this.searchQuery.toLowerCase();return this.produtos.filter(o=>o.nome.toLowerCase().includes(t))}}},Ho={class:"search-container relative flex items-center w-full mb-4"},Jo={class:"card-container"},Xo=["onClick"],Zo={class:"card-inner"},Yo={class:"icon-container"},ea={class:"icon-leaf"},ta=["src"],oa={class:"text-container flex justify-between items-center p-2"},aa={class:"city"},ra={class:"quantidade text-gray-600 font-semibold"},na={class:"text-gray-600 font-semibold"};function sa(t,o,s,d,l,g){return n(),c("div",null,[o[3]||(o[3]=e("div",{class:"painel-title"},"Inventário da loja",-1)),o[4]||(o[4]=e("div",{class:"painel-subtitle"},[e("p",null,"Verifique a quantidade de cada item")],-1)),e("div",Ho,[o[1]||(o[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),R(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=f=>l.searchQuery=f),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[D,l.searchQuery]])]),e("div",Jo,[(n(!0),c(j,null,O(g.filteredProdutos,f=>(n(),c("div",{key:f.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:v=>g.selecionarProduto(f)},[e("div",Zo,[e("div",Yo,[o[2]||(o[2]=e("div",{class:"icon-bg"},null,-1)),e("div",ea,[e("img",{src:g.getProfilePhotoUrl(f.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,ta)])]),e("div",oa,[e("div",aa,h(f.nome),1),e("div",ra,[e("div",na,h(g.getQuantidadeTotal(f.lotes))+" "+h(f.unidadeDeMedida==="unitario"?"uni":"kg"),1)])])])],8,Xo))),128))])])}const ia=V(Wo,[["render",sa],["__scopeId","data-v-4a66bd72"]]),da={key:0,class:"mt-6"},la={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},ua={key:0},ca={class:"flex flex-col gap-4"},fa={key:1,class:"absolute bottom-4 right-4 botao-container"},pa={__name:"Index",setup(t){const o=_(null),s=_(0),d=_(!1),l=_(!1),g=()=>{d.value=!d.value},f=()=>{console.log("atualizando a lista"),o.value=null,s.value+=1},v=()=>{x(),d.value=!1},x=()=>{var m;(m=_("listarUnidades").value)==null||m.fetchUnidades()},u=p=>{p&&typeof p=="object"?o.value=p:console.warn("Dados inválidos recebidos no evento produto-selecionado:",p)};return(p,m)=>(n(),M(Ge,null,{default:A(()=>[C(Ie(Fe),{title:"Insumos"}),d.value?(n(),c("div",da,[C(Gt,{isVisible:d.value,onUnidadeCadastrada:v,onCancelar:g},null,8,["isVisible"])])):w("",!0),e("div",la,[d.value?w("",!0):(n(),c("div",ua,[(n(),M(ia,{key:s.value,ref:"listarUnidades",onUnidadeCadastrada:x,onProdutoSelecionado:u}))])),e("div",ca,[d.value?w("",!0):(n(),c(j,{key:0},[o.value?(n(),M(Ko,{key:0,onAtualizar:f,produto:o.value},null,8,["produto"])):w("",!0),l.value?w("",!0):(n(),c("div",fa,[C(de,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:g})]))],64))])])]),_:1}))}},$a=V(pa,[["__scopeId","data-v-65e679f0"]]);export{$a as default};
