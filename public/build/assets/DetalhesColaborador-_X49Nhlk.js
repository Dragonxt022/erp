import{_ as y}from"./LabelModel-oqMHav-v.js";import{l as L,d as c,j as U,e as l,o as i,a as e,f as h,c as O,b as n,t as m,g as T,F,h as H}from"./app-DYh8EFuX.js";import{C as k}from"./ConfirmDialog-UINhhakX.js";import{D as J}from"./Deslizante-CKS07ozl.js";import{B as K}from"./ButtonEditeMedio-CiMf2X6I.js";import{E as Q}from"./EditarColaborador-_IjZOSU-.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"elemento-fixo"},Y={key:0},Z={key:0,class:"loading-overlay"},ee={class:"w-full h-[300px] bg-white rounded-tl-[20px] rounded-tr-[20px] p-7 relative"},se={class:"flex justify-between items-center"},oe={class:"w-1/1 flex justify-center"},ae=["src"],te={class:"w-2/3"},re={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},ie={class:"flex"},le={class:"w-full h-[44px] mr-2 bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500 mt-2 flex items-center"},ne={class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500 mt-2 flex items-center"},de={class:"grid grid-cols-2 gap-4 mt-8"},ue={class:"w-full h-[44px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] p-2 text-base font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},ce={class:"w-full h-[44px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] p-2 text-base font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},me={class:"flex justify-between items-center mt-5 w-full p-1"},fe={class:"flex items-center w-2/3"},ge={key:0,class:"bg-[#EFEFEF] p-3 px-8 w-full rounded-bl-[20px] rounded-br-[20px]"},pe={class:"flex flex-col w-2/3"},xe={class:"w-1/2 flex justify-end"},_e={key:1,class:"flex flex-col h-[270px] items-center justify-center bg-[#EFEFEF] rounded-lg"},be={class:"text-[100px] font-bold text-[#6DB631]"},ve={key:0,class:"mt-4"},ye={__name:"DetalhesColaborador",props:{dados:{type:Object,required:!0}},emits:["voltar","atualiza"],setup(t,{emit:z}){const d=L(),s=t,p=z,u=c(!1),x=c(!1),_=c(!1),f=c(!1),C=c(!1),b=c(""),E=c(!0),D=["id","user_id","created_at","updated_at"],V=()=>{u.value=!u.value,C.value=!1},P=()=>{p("atualizar"),u.value=!1,C.value=!0},q=()=>{E.value=!E.value},B=o=>({controle_estoque:"Gestão de Estoque",controle_saida_estoque:"Saída de Estoque",gestao_equipe:"Gestão de Equipe",fluxo_caixa:"Fluxo de Caixa",dre:"DRE",contas_pagar:"Contas a Pagar",gestao_salmao:"Gestão de Salmão"})[o]||o,N=U(()=>s.dados.salario?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.dados.salario):"R$ 0,00"),j=async(o,a)=>{s.dados.user_permission||(s.dados.user_permission={}),s.dados.user_permission[o]=!!a,console.log(`Alterando ${o} para`,s.dados.user_permission[o]);const v={user_id:s.dados.id,controle_estoque:s.dados.user_permission.controle_estoque||!1,controle_saida_estoque:s.dados.user_permission.controle_saida_estoque||!1,gestao_equipe:s.dados.user_permission.gestao_equipe||!1,fluxo_caixa:s.dados.user_permission.fluxo_caixa||!1,dre:s.dados.user_permission.dre||!1,contas_pagar:s.dados.user_permission.contas_pagar||!1,gestao_salmao:s.dados.user_permission.gestao_salmao||!1};try{f.value=!0;const g=await axios.post("/api/usuarios/upsert-permissions",v);d.success("Permissões atualizadas com sucesso"),p("atualiza")}catch(g){console.error("Erro ao atualizar permissões:",g),d.error("Erro ao atualizar permissões")}finally{f.value=!1}},A=async()=>{try{_.value=!1,f.value=!0;const o=await axios.post("/api/usuarios/regenera-pin",{user_id:s.dados.id});d.success("PIN atualizado com sucesso"),p("voltar")}catch(o){console.error("Erro ao atualizar o PIN:",o),d.error("Erro ao atualizar o PIN")}finally{f.value=!1}},I=o=>{b.value=o,x.value=!0},$=o=>{b.value=o,_.value=!0},R=()=>{_.value=!1},S=()=>{x.value=!1,G()},M=()=>{x.value=!1},G=async()=>{if(!s.dados||!s.dados.id){d.error("Erro: Dados da conta não encontrados.");return}try{const o=await axios.delete(`/api/usuarios/delete/${s.dados.id}`);d.success("Conta excluída com sucesso"),p("voltar")}catch(o){d.error("Erro ao excluir a conta"),console.error("Erro ao excluir a conta:",o)}};return(o,a)=>{var v,g;return i(),l(F,null,[e("div",X,[u.value?h("",!0):(i(),l("div",Y,[f.value?(i(),l("div",Z,a[2]||(a[2]=[e("div",{class:"spinner"},null,-1)]))):h("",!0),e("div",null,[e("div",ee,[e("div",se,[e("div",oe,[e("img",{src:t.dados.profile_photo_url||"/storage/images/default-profile.png",alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-sm"},null,8,ae)]),e("div",te,[e("div",re,m(t.dados.name||"N/A"),1),e("div",ie,[e("div",le,[e("span",null,m(((v=t.dados.cargo)==null?void 0:v.nome)||"Cargo não atribuído"),1)]),e("div",ne,[e("span",null,m(((g=t.dados.setor)==null?void 0:g.name)||"Setor não atribuído"),1)])])]),e("button",{class:"text-gray-500 hover:text-red-600 mt-8",onClick:a[0]||(a[0]=r=>I("Excluir essa conta?"))},a[3]||(a[3]=[e("img",{src:"/storage/images/delete.svg",alt:"Excluir",class:"w-6 h-6"},null,-1)]))]),e("div",de,[e("div",null,[n(y,{text:"E-mail"}),e("p",ue,m(t.dados.email),1)]),e("div",null,[n(y,{text:"Salário"}),e("p",ce,m(N.value),1)])]),e("div",me,[e("div",fe,[a[4]||(a[4]=e("img",{class:"w-5 h-5 mr-2",src:"/storage/images/security_bleck.svg",alt:"icone svg"},null,-1)),n(y,{class:"font-semibold text-gray-900",text:"Permissões"})]),e("div",{class:"w-1/2 flex justify-end"},[e("p",{class:"font-bold text-[#6DB631] cursor-pointer",onClick:q},a[5]||(a[5]=[e("span",{class:"underline"},"***",-1),T(" PIN ")]))])])]),E.value?(i(),l("div",ge,[(i(!0),l(F,null,H(Object.keys(t.dados.user_permission||{}).filter(r=>!D.includes(r)),r=>(i(),l("div",{key:r,class:"flex justify-between items-center"},[e("div",pe,[n(y,{class:"font-semibold text-gray-900",text:B(r)},null,8,["text"])]),e("div",xe,[n(J,{status:t.dados.user_permission[r],"onUpdate:status":w=>t.dados.user_permission[r]=w,onClick:w=>j(r,t.dados.user_permission[r])},null,8,["status","onUpdate:status","onClick"])])]))),128))])):(i(),l("div",_e,[e("p",be,m(s.dados.pin),1),e("button",{onClick:a[1]||(a[1]=r=>$("Redefinir PIN?")),class:"text-[#FF2D55] font-semibold rounded-lg underline"}," Redefinir PIN ")]))])]))]),t.dados.id&&!u.value?(i(),l("div",ve,[n(K,{text:"Editar Colaborador","icon-path":"/storage/images/border_color.svg",onClick:V,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):h("",!0),u.value?(i(),O(Q,{key:1,user:t.dados,isVisible:u.value,onVoltar:P,onAtualizado:o.handleAtualizacao},null,8,["user","isVisible","onAtualizado"])):h("",!0),n(k,{isVisible:x.value,motivo:b.value,onConfirm:S,onCancel:M},null,8,["isVisible","motivo"]),n(k,{isVisible:_.value,motivo:b.value,onConfirm:A,onCancel:R},null,8,["isVisible","motivo"])],64)}}},De=W(ye,[["__scopeId","data-v-6db8230d"]]);export{De as D};
