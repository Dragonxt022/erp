import{_ as h,I as $,B as T,a as B,C as I,d as P}from"./ConfirmDialog-Cih5dzUr.js";import{s as U,d as r,x as R,o as f,e as _,a as e,b as o,t as w,i as W,h as E,y as A,c as L,F as q,w as O,z as G,m as H,j as Q,v as Z,g as K,u as X,Z as Y}from"./app-BtLXV0vF.js";import{B as ee}from"./ButtonEditeMedio-D6W-B_qZ.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as oe}from"./AppLayout-BnXik7ow.js";const te={key:0,class:"sidebar-container"},se={key:0,class:"loading-overlay"},ae={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},re={class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},le={class:"flex justify-start space-x-1 mt-[50px]"},ne={__name:"EditarFornecedor",props:{isVisible:{type:Boolean,required:!0},fornecedor:{type:Object,required:!0}},emits:["cancelar"],setup(C,{emit:b}){const c=U(),x=C,u=b,l=r(""),m=r(""),n=r(""),t=r(""),a=r(!1),v=r(!1),F=r("");R(()=>x.fornecedor,d=>{d&&(l.value=d.razao_social||"",m.value=d.email||"",n.value=d.whatsapp||"",t.value=d.estado||"")},{immediate:!0});const k=async()=>{var d,p;if(!l.value||!m.value||!n.value||!t.value){c.error("Preencha todos os campos obrigatórios.");return}try{a.value=!0;const i=new FormData;i.append("id",x.fornecedor.id),i.append("cnpj",x.fornecedor.cnpj),i.append("razao_social",l.value),i.append("email",m.value),i.append("whatsapp",n.value),i.append("estado",t.value);const j=await A({method:"post",url:"/api/atualizar-fornecedores",data:i,headers:{"Content-Type":"multipart/form-data"}});P.Inertia.replace(route("fornecedores"),{fornecedor:j.data.fornecedor,preserveState:!0}),c.success("Fornecedor atualizado com sucesso!")}catch(i){c.error("Erro ao atualizar o fornecedor."),errorMessage.value=((p=(d=i.response)==null?void 0:d.data)==null?void 0:p.message)||"Erro inesperado."}finally{a.value=!1}},D=d=>{F.value=d,v.value=!0},z=()=>{k(),v.value=!1},N=()=>{v.value=!1},V=()=>{u("cancelar")};return(d,p)=>C.isVisible?(f(),_("div",te,[a.value?(f(),_("div",se,p[5]||(p[5]=[e("div",{class:"spinner"},null,-1)]))):(f(),_("div",ae,[e("form",{onSubmit:W(k,["prevent"])},[o(h,{text:"CNPJ"}),e("div",re,w(C.fornecedor.cnpj||"N/A"),1),o(h,{text:"Razão Social"}),o($,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=i=>l.value=i),placeholder:""},null,8,["modelValue"]),o(h,{text:"E-mail"}),o($,{modelValue:m.value,"onUpdate:modelValue":p[1]||(p[1]=i=>m.value=i),placeholder:""},null,8,["modelValue"]),o(h,{text:"WhatsApp"}),o($,{modelValue:n.value,"onUpdate:modelValue":p[2]||(p[2]=i=>n.value=i),placeholder:""},null,8,["modelValue"]),o(h,{text:"Estado"}),o($,{modelValue:t.value,"onUpdate:modelValue":p[3]||(p[3]=i=>t.value=i),placeholder:""},null,8,["modelValue"]),e("div",le,[o(T,{text:"Cancelar",onClick:V}),o(B,{text:"Atualizar",onClick:p[4]||(p[4]=i=>D("Atualizar esse Fornecedor?"))})])],32),o(I,{isVisible:v.value,motivo:F.value,onConfirm:z,onCancel:N},null,8,["isVisible","motivo"])]))])):E("",!0)}},ie=M(ne,[["__scopeId","data-v-238890b7"]]),de={key:0,class:"w-full h-[530px] bg-white rounded-[20px] p-7 relative"},ce={class:"relative w-full h-full"},ue={class:"flex items-center"},ve={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[50px] tracking-tight"},pe={class:"w-1/1"},fe={class:"relative w-full h-full"},me={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},ge={class:"w-[150px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},_e={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},xe={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},he={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},be={class:"mt-[130px]"},ye={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},we={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Ce={class:"mt-4"},Fe={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Ve={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},$e={class:"mt-4"},ke={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Ee={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},je={class:"mt-4"},De={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},ze={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Ne={key:0,class:"mt-7"},Se={__name:"DetalhesFornecedor",props:{fornecedor:{type:Object,required:!0}},setup(C){const b=U(),c=r(!1),x=r(""),u=r(!1),l=r(!1),m=r(!1),n=C,t=r({...n.fornecedor}),a=async()=>{try{m.value=!0,await axios.delete(`/api/excluir-fornecedor/${n.fornecedor.id}`),P.Inertia.replace(route("fornecedores"),{preserveState:!0}),b.success("Fornecedor deletado com sucesso!")}catch(V){b.error(`Erro ao deletar o fornecedor: ${V.message}`)}finally{m.value=!1}},v=()=>{r.dadosfornecedor.fetchfornecedor()},F=()=>{l.value=!l.value,console.log("isEditMode:",l.value),u.value=!1},k=V=>{x.value=V,c.value=!0},D=()=>{a(),c.value=!1},z=()=>{c.value=!1},N=()=>{l.value=!1,u.value=!0};return(V,d)=>{var p,i,j;return f(),_(q,null,[l.value?E("",!0):(f(),_("div",de,[e("div",ce,[e("div",ue,[e("div",ve,w(((p=t.value)==null?void 0:p.razao_social)||t.value.razao_social||"N/A"),1),e("div",pe,[o(I,{isVisible:c.value,motivo:x.value,onConfirm:D,onCancel:z},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-3 right-4 cursor-pointer",onClick:d[0]||(d[0]=J=>k("Excluir esse Fornecedor?"))},d[1]||(d[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))]),e("div",fe,[e("div",me,[e("div",ge,[d[2]||(d[2]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",_e," ID# "+w((((i=t.value)==null?void 0:i.id)??0).toString().padStart(4,"0")),1)]),e("div",xe,[d[3]||(d[3]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",he,w(((j=t.value)==null?void 0:j.cnpj)||"N/A"),1)])])])]),e("div",be,[o(h,{text:"Razão Social"}),e("div",ye,[e("div",we,w(t.value.razao_social||"N/A"),1)])]),e("div",Ce,[o(h,{text:"E-mail"}),e("div",Fe,[e("div",Ve,w(t.value.email||"N/A"),1)])]),e("div",$e,[o(h,{text:"WhatsApp"}),e("div",ke,[e("div",Ee,w(t.value.whatsapp||"N/A"),1)])]),e("div",je,[o(h,{text:"Estado"}),e("div",De,[e("div",ze,w(t.value.estado||"N/A"),1)])])]),C.fornecedor.id&&!l.value?(f(),_("div",Ne,[o(ee,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:F,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):E("",!0)])),l.value?(f(),L(ie,{key:1,ref:"dadosfornecedor",isVisible:l.value,fornecedor:C.fornecedor,onDadosfornecedor:v,onCancelar:N},null,8,["isVisible","fornecedor"])):E("",!0)],64)}}},Ae=M(Se,[["__scopeId","data-v-04c6e630"]]),Le={key:0,class:"sidebar-container"},Me={key:0,class:"loading-overlay"},Be={key:1,class:"w-full h-[525px] bg-white rounded-[20px] p-12"},Ie={key:0,class:"error-message"},Pe={class:"form-buttons"},Ue={__name:"CadastroFornecedor",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(C,{emit:b}){const c=U(),x=b,u=r(""),l=r(""),m=r(""),n=r(""),t=r(""),a=r(""),v=r(!1),F=r(!1),k=r("");R(u,async y=>{y.replace(/\D/g,"").length===14&&await p()});const D=()=>{z(),x("cancelar")},z=()=>{u.value="",l.value="",m.value="",n.value="",t.value="",a.value=""},N=()=>u.value?!0:(c.error("Por favor, preencha todos os campos obrigatórios."),a.value="Por favor, preencha todos os campos obrigatórios.",!1),V=async()=>{var y,s;if(N())try{v.value=!0;const g=await A.post("/api/fornecedores",{razao_social:l.value,cnpj:u.value,email:m.value,whatsapp:n.value,estado:t.value});P.Inertia.replace(route("fornecedores"),{fornecedor:g.data.fornecedor,preserveState:!0}),c.success("Fornecedor cadastrado com sucesso!")}catch(g){c.error("Erro ao realizar o cadastro."),a.value=((s=(y=g.response)==null?void 0:y.data)==null?void 0:s.message)||"Erro ao realizar o cadastro."}finally{v.value=!1}},d=y=>{let s=y.target.value.replace(/\D/g,"");s.length>14&&(s=s.slice(0,14)),s=s.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"),u.value=s},p=async()=>{var y,s;if(!u.value||u.value.length<14){c.error("Por favor, insira um CNPJ válido.");return}try{v.value=!0;const g=u.value.replace(/\D/g,""),S=(await A.get(`https://publica.cnpj.ws/cnpj/${g}`)).data;l.value=S.razao_social||"",t.value=S.estabelecimento.estado.nome||"",n.value=S.estabelecimento.telefone1||"",m.value=S.estabelecimento.email||""}catch(g){a.value=((s=(y=g.response)==null?void 0:y.data)==null?void 0:s.message)||"Erro ao consultar o CNPJ."}finally{v.value=!1}},i=y=>{k.value=y,F.value=!0},j=()=>{V(),F.value=!1},J=()=>{F.value=!1};return(y,s)=>(f(),L(G,{name:"fade"},{default:O(()=>[C.isVisible?(f(),_("div",Le,[v.value?(f(),_("div",Me,s[6]||(s[6]=[e("div",{class:"spinner"},null,-1)]))):(f(),_("div",Be,[s[7]||(s[7]=e("div",{class:"painel-title"},[e("p",null,"Novo fornecedor")],-1)),e("form",{onSubmit:W(V,["prevent"])},[o(h,{text:"CNPJ"}),o($,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=g=>u.value=g),onInput:d,placeholder:"000.000.000/0000-00"},null,8,["modelValue"]),o(h,{text:"Razão Social"}),o($,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=g=>l.value=g),placeholder:"Silva Moura Pescados"},null,8,["modelValue"]),o(h,{text:"E-mail"}),o($,{modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=g=>m.value=g),placeholder:"contato@nobrezasdomar.com.br"},null,8,["modelValue"]),o(h,{text:"WhatsApp"}),o($,{modelValue:n.value,"onUpdate:modelValue":s[3]||(s[3]=g=>n.value=g),placeholder:"(00) 00000-0000"},null,8,["modelValue"]),o(h,{text:"Estado"}),o($,{modelValue:t.value,"onUpdate:modelValue":s[4]||(s[4]=g=>t.value=g),placeholder:"Mato Grosso"},null,8,["modelValue"]),a.value?(f(),_("div",Ie,w(a.value),1)):E("",!0),o(I,{isVisible:F.value,motivo:k.value,onConfirm:j,onCancel:J},null,8,["isVisible","motivo"]),e("div",Pe,[o(T,{text:"Cancelar",onClick:D}),o(B,{text:"Cadastrar",onClick:s[5]||(s[5]=g=>i("Criar novo Fornecedor?"))})])],32)]))])):E("",!0)]),_:1}))}},qe=M(Ue,[["__scopeId","data-v-d212ce73"]]),Je={class:"search-container relative flex items-center w-full mb-4"},Te={class:"card-container"},Re=["onClick"],We={class:"card-inner"},Oe={class:"text-container"},Ge={class:"city"},He={class:"owner"},Qe={__name:"ListarFornecedores",emits:["fornecedor-selecionado"],setup(C,{emit:b}){const c=b,x=r([]),u=r(""),l=async()=>{try{const t=await A.get("/api/fornecedores");x.value=t.data.data}catch(t){console.error("Erro ao carregar fornecedores:",t)}},m=t=>{c("fornecedor-selecionado",t)},n=H(()=>{const t=u.value.toLowerCase();return x.value.filter(a=>a.razao_social.toLowerCase().includes(t)||a.cnpj.toLowerCase().includes(t))});return l(),(t,a)=>(f(),_("div",null,[a[4]||(a[4]=e("div",{class:"painel-title"},"Fornecedores",-1)),a[5]||(a[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Fornecedores de insumos homologados")],-1)),e("div",Je,[a[1]||(a[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),Q(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=v=>u.value=v),placeholder:"Buscar um fornecedor",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[Z,u.value]])]),e("div",Te,[(f(!0),_(q,null,K(n.value,v=>(f(),_("div",{key:v.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:F=>m(v)},[e("div",We,[a[2]||(a[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/servicos_verde.svg",alt:"Ícone do fornecedor",class:"w-5 h-5 rounded-lg"})])],-1)),e("div",Oe,[e("div",Ge,w(v.razao_social),1),e("div",He,w(v.cnpj)+" / "+w(v.estado),1)]),a[3]||(a[3]=e("div",{class:"action-icon"},null,-1))])],8,Re))),128))])]))}},Ze=M(Qe,[["__scopeId","data-v-234b50cf"]]),Ke={class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2"},Xe={class:"flex flex-col gap-4"},Ye={class:"absolute bottom-4 right-4"},eo={key:1,class:"mt-4"},no={__name:"Index",setup(C){const b=r(null),c=r(!1),x=()=>{c.value=!c.value},u=()=>{l(),c.value=!1},l=()=>{var t;(t=r("listarFornecedores").value)==null||t.fetchFornecedores()},m=n=>{n&&typeof n=="object"?b.value=n:console.warn("Dados inválidos recebidos no evento fornecedor-selecionado:",n)};return(n,t)=>(f(),L(oe,null,{default:O(()=>[o(X(Y),{title:"Fornecedores"}),e("div",Ke,[e("div",null,[o(Ze,{ref:"listarFornecedores",onFornecedorCadastrado:l,onFornecedorSelecionado:m},null,512)]),e("div",Xe,[c.value?(f(),_("div",eo,[o(qe,{isVisible:c.value,onFornecedorCadastrado:u,onCancelar:x},null,8,["isVisible"])])):(f(),_(q,{key:0},[b.value?(f(),L(Ae,{key:0,fornecedor:b.value},null,8,["fornecedor"])):E("",!0),e("div",Ye,[o(B,{text:"Novo Fornecedor",iconPath:"/storage/images/arrow_left_alt.svg",onClick:x})])],64))])])]),_:1}))}};export{no as default};
