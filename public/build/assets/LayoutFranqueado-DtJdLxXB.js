import{d as p,j as g,i as R,O as T,e as r,o as t,a as e,c as j,f as k,A as G,F as A,h as L,n as x,t as h,w as F,u as E,z as V,k as D,P as O,q as M,C as B,R as U,p as Z,b as I,N as z,S as J,Z as K,r as Q}from"./app-BMqAefqQ.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"navbar"},X={class:"navbar-content"},Y={class:"navbar-left"},ee={class:"navbar-logo"},se=["href"],ae={class:"navbar-right"},oe={class:"notification-container"},ie={key:0,class:"notification-badge"},te={key:0,class:"notification-tray"},ne={class:"notification-header"},re={class:"notification-list"},le={key:0,class:"notification-loading"},ce={key:1,class:"no-notifications"},ue=["onClick"],de={class:"notification-content"},me={class:"notification-title"},ve={class:"notification-message"},fe={class:"notification-time"},ge={key:0,class:"user-info"},he=["src"],_e={class:"user-details"},pe={class:"user-name"},ke={class:"user-location"},be={key:1,class:"user-info loading"},qe={__name:"Navbar",setup(u){const o=p(null),f=g(()=>{var s;return(s=o.value)==null?void 0:s.unidade}),l=p([]),b=p(!1),m=p(!1),w=g(()=>l.value.filter(s=>s.lida===0).length),P=g(()=>{var s,a;return((s=o.value)==null?void 0:s.profile_photo_url)||`https://ui-avatars.com/api/?name=${n((a=o.value)==null?void 0:a.name)}&color=7F9CF5&background=EBF4FF`}),n=s=>s?s.split(" ").map(i=>i.charAt(0).toUpperCase()).join(""):"*",v=async()=>{try{const s=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar perfil do usuário");const a=await s.json();o.value=a.data}catch(s){console.error("Erro ao buscar perfil:",s),o.value=null}},c=async()=>{b.value=!0;try{const s=await fetch("/api/notificacoes",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Erro ao carregar notificações");const a=await s.json();l.value=a.data}catch(s){console.error("Erro ao buscar notificações:",s),l.value=[]}finally{b.value=!1}},d=async s=>{try{if((await D.post(`/api/notificacoes/${s}/ler`)).status===200){const i=l.value.findIndex(q=>q.id===s);i!==-1&&(l.value[i].lida=1,l.value[i].lida_em=new Date().toISOString())}}catch(a){console.error("Erro ao marcar notificação como lida:",a)}},y=async()=>{try{(await D.post("/api/notificacoes/ler-todas")).status===200&&l.value.forEach(a=>{a.lida=1,a.lida_em=new Date().toISOString()})}catch(s){console.error("Erro ao marcar todas notificações como lidas:",s)}},N=s=>{s.stopPropagation(),m.value=!m.value,m.value&&c()},S=s=>{const a=document.querySelector(".notification-container");a&&!a.contains(s.target)&&(m.value=!1)};let _;return R(()=>{v(),c(),document.addEventListener("click",S),_=setInterval(()=>{m.value||c()},3e5)}),T(()=>{document.removeEventListener("click",S),clearInterval(_)}),(s,a)=>(t(),r("div",W,[a[6]||(a[6]=e("div",{class:"navbar-background"},null,-1)),e("div",X,[e("div",Y,[e("div",ee,[a[1]||(a[1]=e("div",{class:"mr-4"},[e("a",{href:"https://www.taiksu.com.br/office/",target:"_blank"},[e("img",{src:"/storage/images/quadrados_verdes.svg",alt:"Quadrados verdes",class:"w-full h-full"})])],-1)),e("div",null,[e("a",{href:s.route("franqueado.painel")},a[0]||(a[0]=[e("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,se)])])]),e("div",ae,[e("div",oe,[e("div",{class:"notification-icon",onClick:N},[a[2]||(a[2]=G('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-4085e103><mask id="mask0_4631_13059" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24" data-v-4085e103><rect width="24" height="24" fill="#D9D9D9" data-v-4085e103></rect></mask><g mask="url(#mask0_4631_13059)" data-v-4085e103><path d="M2.40039 20.4V18H4.80039V9.6C4.80039 7.94 5.30039 6.465 6.30039 5.175C7.30039 3.885 8.60039 3.04 10.2004 2.64V1.8C10.2004 1.3 10.3754 0.875 10.7254 0.525C11.0754 0.175 11.5004 0 12.0004 0C12.5004 0 12.9254 0.175 13.2754 0.525C13.6254 0.875 13.8004 1.3 13.8004 1.8V2.64C15.4004 3.04 16.7004 3.885 17.7004 5.175C18.7004 6.465 19.2004 7.94 19.2004 9.6V18H21.6004V20.4H2.40039ZM12.0004 24C11.3404 24 10.7754 23.765 10.3054 23.295C9.83539 22.825 9.60039 22.26 9.60039 21.6H14.4004C14.4004 22.26 14.1654 22.825 13.6954 23.295C13.2254 23.765 12.6604 24 12.0004 24ZM7.20039 18H16.8004V9.6C16.8004 8.28 16.3304 7.15 15.3904 6.21C14.4504 5.27 13.3204 4.8 12.0004 4.8C10.6804 4.8 9.55039 5.27 8.61039 6.21C7.67039 7.15 7.20039 8.28 7.20039 9.6V18Z" fill="#6DB631" data-v-4085e103></path></g></svg>',1)),w.value>0?(t(),r("div",ie)):k("",!0)]),m.value?(t(),r("div",te,[e("div",ne,[a[3]||(a[3]=e("h3",null,"Notificações",-1)),l.value.length>0?(t(),r("span",{key:0,onClick:y,class:"mark-all-read"},"Marcar todas como lidas")):k("",!0)]),e("div",re,[b.value?(t(),r("div",le,a[4]||(a[4]=[e("div",{class:"notification-skeleton"},null,-1),e("div",{class:"notification-skeleton"},null,-1)]))):l.value.length===0?(t(),r("div",ce," Nenhuma notificação no momento ")):(t(!0),r(A,{key:2},L(l.value,i=>(t(),r("div",{key:i.id,class:x(["notification-item",{unread:i.lida===0}]),onClick:q=>d(i.id)},[e("div",de,[e("div",me,h(i.titulo),1),e("div",ve,h(i.mensagem),1),e("div",fe,h(i.tempo),1)])],10,ue))),128))])])):k("",!0)]),o.value?(t(),j(E(V),{key:0,href:s.route("franqueado.perfil"),class:x(["user-info",{loading:!o.value}])},{default:F(()=>{var i;return[o.value?(t(),r("div",ge,[e("img",{src:P.value,alt:"Avatar",class:"avatar"},null,8,he),e("div",_e,[e("div",pe,h(o.value.name),1),e("div",ke,h(((i=f.value)==null?void 0:i.cidade)||"Taiksu Franchising"),1)])])):(t(),r("div",be,a[5]||(a[5]=[e("div",{class:"avatar-skeleton"},null,-1),e("div",{class:"user-details-skeleton"},[e("div",{class:"name-skeleton"}),e("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["href","class"])):k("",!0)])])]))}},Pe=$(qe,[["__scopeId","data-v-4085e103"]]),we={class:"icon"},ye=["src"],Se={class:"label"},Ce={type:"submit",class:"w-full h-full flex items-center"},xe={class:"icon"},Ie=["src"],Ae={class:"label"},Le={key:2,class:"submenu"},Ee={class:"label"},$e={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(u){const o=u,f=O("userPermissions",p({})),l=p(!1),b=g(()=>l.value),m=g(()=>o.link&&/^https?:\/\//.test(o.link)),w=g(()=>m.value?o.link:o.link?route(o.link):"#"),P=g(()=>!o.requiredPermission||f.value[o.requiredPermission]),n=g(()=>o.submenuItems.filter(i=>!i.requiredPermission||f.value[i.requiredPermission])),v=i=>{n.value.length>0&&(i.preventDefault(),c())},c=()=>{l.value=!l.value,y()},d=()=>{const i=localStorage.getItem(`submenu-${o.link}`);i!==null&&(l.value=JSON.parse(i))},y=()=>{localStorage.setItem(`submenu-${o.link}`,JSON.stringify(l.value))},N=g(()=>_.value||o.isActive?"submenu-active":""),S=i=>{const q=window.location.pathname,C=new URL(route(i),window.location.origin).pathname;return q===C},_=g(()=>n.value.some(i=>S(i.link))),s=()=>{o.isLogout&&z.post(route("logout"))};return d(),M(_,()=>{_.value||B(()=>{l.value=!1,y()})}),M(l,()=>{B(()=>y())}),(i,q)=>(t(),r("div",null,[!u.isLogout&&u.link&&P.value?(t(),j(U(m.value?"a":E(V)),{key:0,class:x(["menu-item",[N.value,{active:u.isActive||_.value}]]),href:w.value,target:m.value?"_blank":null,onClick:v},{default:F(()=>[e("div",we,[e("img",{src:u.icon,alt:"icon"},null,8,ye)]),e("div",Se,h(u.label),1),n.value.length>0?(t(),r("div",{key:0,class:x(["right-icon",{"rotate-icon":b.value}])},q[0]||(q[0]=[e("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):k("",!0)]),_:1},8,["class","href","target"])):u.isLogout&&P.value?(t(),r("form",{key:1,onSubmit:Z(s,["prevent"]),class:"menu-item"},[e("button",Ce,[e("div",xe,[e("img",{src:u.icon,alt:"icon"},null,8,Ie)]),e("div",Ae,h(u.label),1)])],32)):k("",!0),n.value.length>0&&(l.value||_.value)?(t(),r("div",Le,[(t(!0),r(A,null,L(n.value,(C,H)=>(t(),r("div",{key:H},[I(E(V),{class:x(["submenu-item",{active:S(C.link)}]),href:i.route(C.link)},{default:F(()=>[e("div",Ee,h(C.label),1)]),_:2},1032,["href","class"])]))),128))])):k("",!0)]))}},Ne=$($e,[["__scopeId","data-v-bed64f61"]]),Fe={key:0,class:"category-title menu-categorias text-sm sm:text-base font-medium text-[#87ba73] mb-3 pl-4"},Ve={__name:"Slidebar",setup(u){const o=p(null),f=p({}),l=async()=>{try{const n=await D.get("/api/navbar-profile");f.value=n.data.data.permissions||{}}catch(n){console.error("Erro ao carregar permissões:",n),f.value={}}};J("userPermissions",f);const b=[{name:"",items:[{label:"Inicio",icon:"/storage/images/inicio.svg",link:"franqueado.painel",isLogout:!1,isActive:!1,requiredPermission:null}]},{name:"Ferramentas",items:[{label:"E-mail",icon:"/storage/images/email.svg",link:"https://arquivos.taiksu.com.br/apps/mail/box/1",isLogout:!1,isActive:!1,requiredPermission:null},{label:"Comunidade",icon:"/storage/images/diversity_4.svg",link:"https://arquivos.taiksu.com.br/call/wprjfww7",isLogout:!1,isActive:!1,requiredPermission:null},{label:"Treinamento",icon:"/storage/images/treinamento.svg",link:"https://treinamento.taiksu.com.br/",isLogout:!1,isActive:!1,requiredPermission:null},{label:"Mídias",icon:"/storage/images/perm_media.svg",link:"https://arquivos.taiksu.com.br/s/P5nypCADKccgcib",isLogout:!1,isActive:!1,requiredPermission:null}]},{name:"Gestão da loja",items:[{label:"Gestão de estoque",icon:"/storage/images/estoque.svg",link:"franqueado.estoque",isLogout:!1,requiredPermission:"controle_estoque",submenuItems:[{label:"Inventário",link:"franqueado.inventario",requiredPermission:"controle_estoque"},{label:"Saida de estoque",link:"franqueado.controleEstoque",requiredPermission:"controle_saida_estoque"},{label:"Fornecedores",link:"franqueado.fornecedores",requiredPermission:"controle_estoque"},{label:"Novo Pedidos",link:"franqueado.pedidos",requiredPermission:"controle_estoque"},{label:"Histórico de Pedidos",link:"franqueado.historicoPedidos",requiredPermission:"controle_estoque"}],isActive:!1},{label:"Gestão de resíduos",icon:"/storage/images/delete_branco.svg",link:"franqueado.supervisaoResidos",isLogout:!1,requiredPermission:"gestao_salmao",submenuItems:[{label:"Limpeza de salmão",link:"franqueado.limpesaSalmoes",requiredPermission:"gestao_salmao"}],isActive:!1},{label:"Gestão de equipe",icon:"/storage/images/gestao_servisos.svg",link:"franqueado.gestaoEquipe",isLogout:!1,requiredPermission:"gestao_equipe",submenuItems:[{label:"Controle de ponto",icon:"/storage/images/add_product.svg",link:"franqueado.controlePonto",requiredPermission:"gestao_equipe"},{label:"Folha de pagamento",link:"franqueado.folhaPagamento",requiredPermission:"gestao_equipe"}],isActive:!1}]},{name:"Financeiro",items:[{label:"Fluxo de caixa",icon:"/storage/images/fluxo_caixa.svg",link:"franqueado.abrirCaixa",isLogout:!1,requiredPermission:"fluxo_caixa",submenuItems:[{label:"Métodos de pagamento",link:"franqueado.metodosPagamentos",requiredPermission:"fluxo_caixa"},{label:"Canais de Vendas",link:"franqueado.canaisVendas",requiredPermission:"fluxo_caixa"},{label:"Histórico de Caixa",link:"franqueado.historicoCaixa",requiredPermission:"fluxo_caixa"},{label:"Caixa Retroativo",link:"franqueado.caixaRetroativo",requiredPermission:"fluxo_caixa"}],isActive:!1},{label:"Contas a pagar",icon:"/storage/images/attach_money.svg",link:"franqueado.contasApagar",isLogout:!1,requiredPermission:"contas_pagar",submenuItems:[{label:"Histórico de Despesas",link:"franqueado.historicoContas",requiredPermission:"contas_pagar"}],isActive:!1},{label:"DRE Gerencial",icon:"/storage/images/analitic.svg",link:"franqueado.dreGerencial",isLogout:!1,requiredPermission:"dre",isActive:!1}]},{name:"",items:[{label:"Sair",icon:"/storage/images/log-out.png",link:"logout",isLogout:!0}]}],m=g(()=>b.map(n=>({...n,items:n.items.filter(v=>!v.requiredPermission||f.value[v.requiredPermission]||v.submenuItems&&v.submenuItems.some(c=>!c.requiredPermission||f.value[c.requiredPermission]))})).filter(n=>n.items.length>0));R(async()=>{await l();const n=localStorage.getItem("sidebarScrollPosition");n&&o.value&&(o.value.scrollTop=n)});const w=()=>{o.value&&localStorage.setItem("sidebarScrollPosition",o.value.scrollTop)},P=n=>{const v=window.location.pathname,c=new URL(n,window.location.origin).pathname;return v===c||v.startsWith(c)};return(n,v)=>(t(),r("div",null,[e("div",{class:"sidebar fixed top-16 left-0 bg-[#164110] text-white flex flex-col p-3 overflow-y-auto h-full sm:w-64 md:w-72 lg:w-80 xl:w-80",ref_key:"sidebar",ref:o,onScroll:w},[(t(!0),r(A,null,L(m.value,c=>(t(),r("div",{key:c.name,class:"menu-category mb-6"},[c.items.length>0?(t(),r("div",Fe,h(c.name),1)):k("",!0),(t(!0),r(A,null,L(c.items,d=>(t(),j(Ne,{key:d.link||"no-link",label:d.label,icon:d.icon,link:d.link,submenuItems:d.submenuItems,isActive:d.link?P(d.link):!1,isLogout:d.isLogout,requiredPermission:d.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],544)]))}},De=$(Ve,[["__scopeId","data-v-e3fe6b6a"]]),je={class:"content"},Me={__name:"LayoutFranqueado",props:{title:String},setup(u){return(o,f)=>(t(),r("div",null,[I(E(K),{title:u.title},null,8,["title"]),I(Pe),I(De),e("main",je,[Q(o.$slots,"default",{},void 0,!0)])]))}},He=$(Me,[["__scopeId","data-v-d4397c97"]]);export{He as L};
