import{d as g,j as h,i as j,a4 as W,e as u,o as r,a as e,ae as H,c as M,f as x,b as $,w as N,t as L,n as E,u as I,a0 as F,af as U,q as z,a3 as D,ag as Z,p as J,F as T,h as B,a5 as K,ah as R,k as V,$ as Q,Z as X,r as Y,ad as ee}from"./app-D3ViAvpV.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se=["href"],te=["src"],ae={__name:"iconeNotificacao",setup(m){const s=g(null),i=g(null),t=g(!1),b=g(!0),k=h(()=>i.value?`https://alertas.taiksu.com.br/callback?token=${i.value}`:"https://alertas.taiksu.com.br"),w=h(()=>b.value?"https://login.taiksu.com.br/frontend/img/sinale0.png":t.value?"https://login.taiksu.com.br/frontend/img/sino-alerta-com-mensagem.png":"https://login.taiksu.com.br/frontend/img/sinale0.png"),y=async()=>{try{const l=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!l.ok)throw new Error("Erro ao carregar perfil do usuário");const p=await l.json();p.status==="success"&&p.data&&(s.value=p.data.id,i.value=p.data.rh_token||p.data.id,await n())}catch(l){console.error("Erro ao buscar dados do usuário:",l)}finally{b.value=!1}},n=async()=>{if(s.value)try{const l=`https://alertas.taiksu.com.br/api/status/${s.value}`,p=await fetch(l,{method:"GET",headers:{Accept:"application/json"}});if(!p.ok)throw new Error("Erro ao verificar status das notificações");const o=await p.json();t.value=o.status===!0}catch(l){console.error("Erro ao consultar status das notificações:",l),t.value=!1}};let a;return j(async()=>{await y(),a=setInterval(()=>{n()},3e5)}),W(()=>{a&&clearInterval(a)}),(l,p)=>(r(),u("a",{class:"notification-link",href:k.value,target:"_blank",rel:"noopener noreferrer"},[e("img",{src:w.value,alt:"Notificações",class:"notification-icon"},null,8,te)],8,se))}},ne=q(ae,[["__scopeId","data-v-81702bd5"]]),O=H("sidebar",{state:()=>({isOpen:!1}),actions:{toggle(){this.isOpen=!this.isOpen},open(){this.isOpen=!0},close(){this.isOpen=!1}}}),oe={class:"navbar"},re={class:"navbar-content"},ie={class:"navbar-left"},le={class:"navbar-logo"},ce=["href"],ue={class:"navbar-right"},de={class:"mr-4"},ve={key:0,class:"user-info"},me=["src"],fe={class:"user-details"},pe={class:"user-name"},he={class:"user-location"},ge={key:1,class:"user-info loading"},be={__name:"Navbar",setup(m){const s=O(),i=()=>{s.toggle()},t=g(null),b=h(()=>{var n;return(n=t.value)==null?void 0:n.unidade}),k=h(()=>{var n,a;return((n=t.value)==null?void 0:n.profile_photo_path)||`https://ui-avatars.com/api/?name=${w((a=t.value)==null?void 0:a.name)}&color=7F9CF5&background=EBF4FF`}),w=n=>n?n.split(" ").map(l=>l.charAt(0).toUpperCase()).join(""):"*",y=async()=>{try{const n=await fetch("/api/navbar-profile",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!n.ok)throw new Error("Erro ao carregar perfil do usuário");const a=await n.json();t.value=a.data}catch(n){console.error("Erro ao buscar perfil:",n),t.value=null}};return j(()=>{y()}),(n,a)=>(r(),u("div",oe,[a[4]||(a[4]=e("div",{class:"navbar-background"},null,-1)),e("div",re,[e("div",ie,[e("div",le,[e("div",{class:"mr-4 mt-2 hide-mobile"},[e("button",{onClick:i},a[0]||(a[0]=[e("img",{src:"/storage/images/quadrados_verdes.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),e("div",null,[e("a",{href:n.route("franqueado.painel")},a[1]||(a[1]=[e("img",{src:"/storage/images/logo_tipo_verde.svg",alt:"logo tipo verde",class:"w-full h-full"},null,-1)]),8,ce)])])]),e("div",ue,[e("div",de,[$(ne)]),e("div",{class:"view-mobile"},[e("button",{onClick:i},a[2]||(a[2]=[e("img",{src:"/storage/images/bx-menuv.svg",alt:"Menu",class:"w-full h-full"},null,-1)]))]),t.value?(r(),M(I(F),{key:0,href:"https://login.taiksu.com.br/perfil",class:E(["user-info hide-mobile",{loading:!t.value}])},{default:N(()=>{var l;return[t.value?(r(),u("div",ve,[e("img",{src:k.value,alt:"Avatar",class:"avatar"},null,8,me),e("div",fe,[e("div",pe,L(t.value.name),1),e("div",he,L(((l=b.value)==null?void 0:l.cidade)||"Taiksu Franchising"),1)])])):(r(),u("div",ge,a[3]||(a[3]=[e("div",{class:"avatar-skeleton"},null,-1),e("div",{class:"user-details-skeleton"},[e("div",{class:"name-skeleton"}),e("div",{class:"location-skeleton"})],-1)])))]}),_:1},8,["class"])):x("",!0)])])]))}},_e=q(be,[["__scopeId","data-v-516e4133"]]),ke={class:"icon"},we=["src"],Se={class:"label"},ye={type:"submit",class:"w-full h-full flex items-center"},Ie={class:"icon"},Le=["src"],Pe={class:"label"},xe={key:2,class:"submenu"},$e={class:"label"},Ee={__name:"MenuItem",props:{label:String,icon:String,link:String,isActive:Boolean,isLogout:Boolean,submenuItems:{type:Array,default:()=>[]},requiredPermission:String},setup(m){const s=m,i=U("userPermissions",g({})),t=U("openSubmenuLink",g(null)),b=h(()=>t.value===s.link),k=h(()=>b.value),w=h(()=>s.link&&/^https?:\/\//.test(s.link)),y=h(()=>w.value?s.link:s.link?route(s.link):"#"),n=h(()=>!s.requiredPermission||i.value[s.requiredPermission]),a=h(()=>s.submenuItems.filter(v=>!v.requiredPermission||i.value[v.requiredPermission])),l=v=>{a.value.length>0&&(v.preventDefault(),p())},p=()=>{t.value===s.link?t.value=null:t.value=s.link,c()},o=()=>{const v=localStorage.getItem("openSubmenuLink");v!==null&&(t.value=v)},c=()=>{t.value?localStorage.setItem("openSubmenuLink",t.value):localStorage.removeItem("openSubmenuLink")},f=h(()=>_.value||s.isActive?"submenu-active":""),d=v=>{const C=window.location.pathname,P=new URL(route(v),window.location.origin).pathname;return C===P},_=h(()=>a.value.some(v=>d(v.link))),S=()=>{s.isLogout&&K.post(route("logout.sair"))};return o(),z(_,()=>{!_.value&&t.value===s.link&&D(()=>{t.value=null,c()})}),z(t,()=>{D(()=>c())}),(v,C)=>(r(),u("div",null,[!m.isLogout&&m.link&&n.value?(r(),M(Z(w.value?"a":I(F)),{key:0,class:E(["menu-item",[f.value,{active:m.isActive||_.value}]]),href:y.value,target:w.value?"_blank":null,onClick:l},{default:N(()=>[e("div",ke,[e("img",{src:m.icon,alt:"icon"},null,8,we)]),e("div",Se,L(m.label),1),a.value.length>0?(r(),u("div",{key:0,class:E(["right-icon",{"rotate-icon":k.value}])},C[0]||(C[0]=[e("img",{src:"/storage/images/arrow_drop_down.svg",alt:"arrow icon"},null,-1)]),2)):x("",!0)]),_:1},8,["class","href","target"])):m.isLogout&&n.value?(r(),u("form",{key:1,onSubmit:J(S,["prevent"]),class:"menu-item"},[e("button",ye,[e("div",Ie,[e("img",{src:m.icon,alt:"icon"},null,8,Le)]),e("div",Pe,L(m.label),1)])],32)):x("",!0),a.value.length>0&&(b.value||_.value)?(r(),u("div",xe,[(r(!0),u(T,null,B(a.value,(P,G)=>(r(),u("div",{key:G},[$(I(F),{class:E(["submenu-item",{active:d(P.link)}]),href:v.route(P.link)},{default:N(()=>[e("div",$e,L(P.label),1)]),_:2},1032,["href","class"])]))),128))])):x("",!0)]))}},qe=q(Ee,[["__scopeId","data-v-fe119916"]]),Ae={key:0,class:"loader-container"},Ce={key:0,class:"category-title menu-categorias text-sm sm:text-base font-medium text-[#87ba73] mb-3 pl-4"},je={__name:"Slidebar",setup(m){const s=g(null),i=g({}),t=g([]),b=O(),k=g(!0),w=g(null),y=async()=>{try{const o=await V.get("/api/navbar-profile");i.value=o.data.data.permissions||{}}catch(o){console.error("Erro ao carregar permissões:",o),i.value={}}},n=async()=>{try{const f=((await V.get("/api/menu")).data.data||[]).map(d=>{const _=(d.items||[]).slice().sort((S,A)=>S.order-A.order);return _.forEach(S=>{S.children&&Array.isArray(S.children)&&(S.children=S.children.slice().sort((A,v)=>A.order-v.order))}),{...d,items:_}}).sort((d,_)=>d.order-_.order);t.value=f}catch(o){console.error("Erro ao carregar menu:",o),t.value=[]}};R("userPermissions",i),R("openSubmenuLink",w);const a=h(()=>t.value.map(o=>({...o,items:o.items.filter(c=>!c.required_permission||i.value[c.required_permission]||c.children&&c.children.some(f=>!f.required_permission||i.value[f.required_permission])).map(c=>({...c,submenuItems:c.children||[]}))})).filter(o=>o.items.length>0));j(async()=>{k.value=!0,await y(),await n();const o=localStorage.getItem("sidebarScrollPosition");o&&s.value&&(s.value.scrollTop=o),k.value=!1});const l=()=>{s.value&&localStorage.setItem("sidebarScrollPosition",s.value.scrollTop)},p=o=>{const c=window.location.pathname,f=new URL(o,window.location.origin).pathname;return c===f||c.startsWith(f)};return(o,c)=>(r(),u("div",null,[k.value?(r(),u("div",Ae,c[0]||(c[0]=[e("div",{class:"spinner"},null,-1)]))):(r(),u("div",{key:1,class:E(["sidebar fixed top-16 left-0 bg-[#164110] text-white flex flex-col p-3 overflow-y-auto h-full transition-transform duration-300 ease-in-out",I(b).isOpen?"translate-x-0":"-translate-x-full","md:translate-x-0 md:relative  md:top-0 md:left-0"]),ref_key:"sidebar",ref:s,onScroll:l},[(r(!0),u(T,null,B(a.value,f=>(r(),u("div",{key:f.name,class:"menu-category mb-6"},[f.items.length>0?(r(),u("div",Ce,L(f.name),1)):x("",!0),(r(!0),u(T,null,B(f.items,d=>(r(),M(qe,{key:d.link||"no-link",label:d.label,icon:d.icon,link:d.link,submenuItems:d.submenuItems,isActive:d.link?p(d.link):!1,isLogout:d.isLogout,requiredPermission:d.requiredPermission},null,8,["label","icon","link","submenuItems","isActive","isLogout","requiredPermission"]))),128))]))),128))],34))]))}},Ne=q(je,[["__scopeId","data-v-d40e1687"]]),Fe={__name:"LayoutFranqueado",props:{title:String},setup(m){const s=O();function i(){window.innerWidth<768?s.close():s.open()}return j(()=>{window.addEventListener("resize",i),i()}),Q(()=>{window.removeEventListener("resize",i)}),(t,b)=>(r(),u("div",null,[$(I(X),{title:m.title},null,8,["title"]),$(_e),$(Ne),e("main",{class:"content",style:ee({left:I(s).isOpen?"252px":"0",width:I(s).isOpen?"calc(100vw - 250px)":"100vw"})},[Y(t.$slots,"default",{},void 0,!0)],4)]))}},Me=q(Fe,[["__scopeId","data-v-d63d761a"]]);export{Me as L};
