import{A as O}from"./AppLayout-q3hYI7np.js";import{y as E,o as t,e as i,a as e,j as Z,v as G,F as D,g as H,t as j,s as B,d as r,c as U,w as L,i as I,b as f,h as k,z as N,u as J,Z as K}from"./app-BXxGr5kr.js";import{_ as T,I as Q,a as R,B as M,C as z}from"./ConfirmDialog-CiJZaXX1.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as X}from"./index-B4K9qmp2.js";import{B as W}from"./ButtonEditeMedio-CShCCiK5.js";const Y={data(){return{produtos:[],searchQuery:""}},mounted(){this.fetchProdutos()},methods:{async fetchProdutos(){try{const c=await E.get("/api/lista-produtos");this.produtos=c.data}catch(c){console.error("Erro ao carregar os produtos:",c)}},selecionarProduto(c){this.$emit("produto-selecionado",c)}},computed:{filteredProdutos(){const c=this.searchQuery.toLowerCase();return this.produtos.filter(o=>o.nome.toLowerCase().includes(c))}}},ee={class:"search-container relative flex items-center w-full mb-4"},oe={class:"card-container"},se=["onClick"],te={class:"card-inner"},ae={class:"icon-container"},re={class:"icon-leaf"},le=["src"],ne={class:"text-container"},ie={class:"city"};function de(c,o,n,_,u,d){return t(),i("div",null,[o[4]||(o[4]=e("div",{class:"painel-title"},"Insumos",-1)),o[5]||(o[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",ee,[o[1]||(o[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),Z(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=s=>u.searchQuery=s),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[G,u.searchQuery]])]),e("div",oe,[(t(!0),i(D,null,H(d.filteredProdutos,s=>(t(),i("div",{key:s.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:l=>d.selecionarProduto(s)},[e("div",te,[e("div",ae,[o[2]||(o[2]=e("div",{class:"icon-bg"},null,-1)),e("div",re,[e("img",{src:s.profile_photo||"/storage/images/no_imagem.svg",alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,le)])]),e("div",ne,[e("div",ie,j(s.nome),1)]),o[3]||(o[3]=e("div",{class:"action-icon"},null,-1))])],8,se))),128))])])}const ce=S(Y,[["render",de],["__scopeId","data-v-07f3cea0"]]),ue={key:0,class:"sidebar-container"},me={key:0,class:"loading-overlay"},ve={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},pe={class:"flex justify-center mb-6 relative group"},fe=["src"],ge={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},he={key:0,class:"error-message"},_e={class:"flex justify-start space-x-1 mt-5"},ye={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(c,{emit:o}){const n=B(),_=o,u=r(""),d=r(""),s=r(null),l=r(""),g=r(null),w=r(!1),C=()=>{var m;(m=g.value)==null||m.click()},P=()=>{d.value="",n.info("Imagem removida.")},V=m=>{const a=m.target.files[0];if(a){s.value=a;const v=new FileReader;v.onload=()=>{d.value=v.result,n.success("Imagem carregada com sucesso!")},v.readAsDataURL(a)}},F=()=>{h(),_("cancelar")},h=()=>{u.value="",d.value="",s.value=null,l.value=""},b=()=>!u.value||!s.value?(n.error("Por favor, preencha todos os campos obrigatórios."),l.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,$=async()=>{var m,a;if(b())try{w.value=!0;const v=new FormData;v.append("name",u.value),v.append("image",s.value);const A=await E.post("/api/produtos",v,{headers:{"Content-Type":"multipart/form-data"}});n.success("Produto cadastrado com sucesso!"),h()}catch(v){n.error("Erro ao cadastrar o produto."),l.value=((a=(m=v.response)==null?void 0:m.data)==null?void 0:a.message)||"Erro inesperado."}finally{w.value=!1}};return(m,a)=>(t(),U(N,{name:"fade"},{default:L(()=>[c.isVisible?(t(),i("div",ue,[w.value?(t(),i("div",me,a[3]||(a[3]=[e("div",{class:"spinner"},null,-1)]))):(t(),i("div",ve,[e("form",{onSubmit:I($,["prevent"])},[e("div",pe,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:C},[d.value?(t(),i(D,{key:0},[e("img",{src:d.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,fe),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:a[0]||(a[0]=I(()=>{},["stop"]))},[e("button",{onClick:I(P,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(t(),i("img",ge))]),e("input",{type:"file",ref_key:"fileInput",ref:g,accept:"image/*",class:"hidden",onChange:V},null,544)]),f(T,{text:"Nome"}),f(Q,{modelValue:m.nome,"onUpdate:modelValue":a[1]||(a[1]=v=>m.nome=v),placeholder:"Shoyu Premium Sakaki"},null,8,["modelValue"]),l.value?(t(),i("div",he,j(l.value),1)):k("",!0),e("div",_e,[f(R,{text:"Cancelar",onClick:F}),f(M,{text:"Atualizar",onClick:a[2]||(a[2]=v=>m.showConfirmDialog("Atualizar esse Produto?"))})])],32)]))])):k("",!0)]),_:1}))}},be=S(ye,[["__scopeId","data-v-ef223cec"]]),xe={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12 relative overflow-y-auto scrollbar-hidden"},we={class:"relative w-full h-full"},Ce={class:"flex items-center"},ke={class:"w-1/1 flex justify-center"},$e=["src"],Pe={class:"w-2/3 pl-5"},Ie={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Ve={class:"w-1/1"},Fe={key:1,class:"mt-4"},Ue={__name:"Detalhesproduto",props:{produto:{type:Object,required:!0}},setup(c){const o=B(),n=c,_=r(!1),u=r(""),d=r(!1),s=r(!1),l=r(!1),g=()=>{r.dadosProduto.fetchProduto()},w=async()=>{var h,b,$,m;try{l.value=!0;const a=await E.delete(`/api/excluir-produto/${n.produto.id}`);console.log(a.data.message),o.success("Produto deletado com sucesso!"),X.Inertia.visit("/insumos")}catch(a){o.error("Erro ao deletar o produto:",((b=(h=a.response)==null?void 0:h.data)==null?void 0:b.error)||a.message),console.error("Erro ao deletar o produto:",((m=($=a.response)==null?void 0:$.data)==null?void 0:m.error)||a.message)}finally{l.value=!1}},C=()=>{s.value=!s.value,d.value=!1},P=h=>{u.value=h,_.value=!0},V=()=>{w(),_.value=!1},F=()=>{_.value=!1};return(h,b)=>(t(),i(D,null,[s.value?k("",!0):(t(),i("div",xe,[e("div",we,[e("div",Ce,[e("div",ke,[e("img",{src:c.produto.profile_photo||"/storage/images/no_imagem.svg",alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,$e)]),e("div",Pe,[e("div",Ie,j(c.produto.nome||"N/A"),1)]),e("div",Ve,[f(z,{isVisible:_.value,motivo:u.value,onConfirm:V,onCancel:F},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-4 right-4 cursor-pointer",onClick:b[0]||(b[0]=$=>P("Excluir esse produto?"))},b[1]||(b[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))])])])])),c.produto.id&&!s.value?(t(),i("div",Fe,[f(W,{text:"Editar Unidade","icon-path":"/storage/images/border_color.svg",onClick:C,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):k("",!0),s.value?(t(),U(be,{key:2,ref:"dadosProduto",isVisible:s.value,unidade:h.unidade,onDadosProduto:g,onCancelar:h.cancelEdit},null,8,["isVisible","unidade","onCancelar"])):k("",!0)],64))}},De=S(Ue,[["__scopeId","data-v-368388ba"]]),Ee={key:0,class:"sidebar-container"},je={key:0,class:"loading-overlay"},Se={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},Be={class:"flex justify-center mb-6 relative group"},Le=["src"],Me={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},Ae={key:0,class:"error-message"},qe={class:"flex justify-start space-x-1 mt-5"},Ne={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(c,{emit:o}){const n=B(),_=o,u=r(""),d=r(""),s=r(null),l=r(""),g=r(null),w=r(!1),C=r(!1),P=r(""),V=()=>{var x;(x=g.value)==null||x.click()},F=x=>{P.value=x,C.value=!0},h=()=>{q(),C.value=!1},b=()=>{C.value=!1},$=()=>{d.value="",n.info("Imagem removida.")},m=x=>{const p=x.target.files[0];if(p){s.value=p;const y=new FileReader;y.onload=()=>{d.value=y.result,n.success("Imagem carregada com sucesso!")},y.readAsDataURL(p)}},a=()=>{v(),_("cancelar")},v=()=>{u.value="",d.value="",s.value=null,l.value=""},A=()=>!u.value||!s.value?(n.error("Por favor, preencha todos os campos obrigatórios."),l.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,q=async()=>{var x,p;if(A())try{w.value=!0;const y=new FormData;y.append("nome",u.value),y.append("profile_photo",s.value);const Xe=await E.post("/api/cadastar-produtos",y,{headers:{"Content-Type":"multipart/form-data"}});n.success("Produto cadastrado com sucesso!"),X.Inertia.visit("/insumos"),v()}catch(y){n.error("Erro ao cadastrar o produto."),l.value=((p=(x=y.response)==null?void 0:x.data)==null?void 0:p.message)||"Erro inesperado."}finally{w.value=!1}};return(x,p)=>(t(),U(N,{name:"fade"},{default:L(()=>[c.isVisible?(t(),i("div",Ee,[w.value?(t(),i("div",je,p[3]||(p[3]=[e("div",{class:"spinner"},null,-1)]))):(t(),i("div",Se,[e("form",{onSubmit:I(q,["prevent"])},[e("div",Be,[e("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden relative",onClick:V},[d.value?(t(),i(D,{key:0},[e("img",{src:d.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,Le),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:p[0]||(p[0]=I(()=>{},["stop"]))},[e("button",{onClick:I($,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(t(),i("img",Me))]),e("input",{type:"file",ref_key:"fileInput",ref:g,accept:"image/*",class:"hidden",onChange:m},null,544)]),f(T,{text:"Nome"}),f(Q,{modelValue:u.value,"onUpdate:modelValue":p[1]||(p[1]=y=>u.value=y),placeholder:"Shoyu Premium Sakaki"},null,8,["modelValue"]),l.value?(t(),i("div",Ae,j(l.value),1)):k("",!0),e("div",qe,[f(R,{text:"Cancelar",onClick:a}),f(M,{text:"Cadastrar",onClick:p[2]||(p[2]=y=>F("Criar novo Produto?"))})])],32)])),f(z,{isVisible:C.value,motivo:P.value,onConfirm:h,onCancel:b},null,8,["isVisible","motivo"])])):k("",!0)]),_:1}))}},Te=S(Ne,[["__scopeId","data-v-5d14becd"]]),Qe={class:"flex flex-col gap-4"},Re={class:"absolute bottom-4 right-4"},ze={key:1,class:"mt-4"},We={__name:"Index",setup(c){const o=r(null),n=r(!1),_=()=>{n.value=!n.value},u=()=>{d(),n.value=!1},d=()=>{var g;(g=r("listarUnidades").value)==null||g.fetchUnidades()},s=l=>{l&&typeof l=="object"?o.value=l:console.warn("Dados inválidos recebidos no evento produto-selecionado:",l)};return(l,g)=>(t(),U(O,null,{default:L(()=>[f(J(K),{title:"Insumos"}),e("div",{class:"grid grid-cols-1 gap-4 mt-3 sm:grid-cols-2 overflow-hidden card-container h-full overflow-y-scroll",onScrollPassive:g[0]||(g[0]=()=>{})},[e("div",null,[f(ce,{ref:"listarUnidades",onUnidadeCadastrada:d,onProdutoSelecionado:s},null,512)]),e("div",Qe,[n.value?(t(),i("div",ze,[f(Te,{isVisible:n.value,onUnidadeCadastrada:u,onCancelar:_},null,8,["isVisible"])])):(t(),i(D,{key:0},[o.value?(t(),U(De,{key:0,produto:o.value},null,8,["produto"])):k("",!0),e("div",Re,[f(M,{text:"Cadastrar insumo",iconPath:"/storage/images/arrow_left_alt.svg",onClick:_})])],64))])],32)]),_:1}))}};export{We as default};
